(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Validators=f()}})((function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,(function(r){var n=e[i][1][r];return o(n||r)}),p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){const jsonld=require("jsonld");const Ajv=require("ajv");const addFormats=require("ajv-formats");const apply=require("ajv-formats-draft2019");const lzs=require("lz-string");const jsYaml=require("js-yaml");const coreAssertions=require("./shared");const tdSchema=require("./td-schema.json");const fullTdSchema=require("./td-schema-full.json");const tmSchema=require("./tm-schema.json");const builder=require("junit-report-builder");module.exports.tdValidator=tdValidator;module.exports.tmValidator=tmValidator;module.exports.propUniqueness=coreAssertions.checkPropUniqueness;module.exports.multiLangConsistency=coreAssertions.checkMultiLangConsistency;module.exports.checkLinksRelTypeCount=coreAssertions.checkLinksRelTypeCount;module.exports.security=coreAssertions.checkSecurity;module.exports.checkUriSecurity=coreAssertions.checkUriSecurity;module.exports.compress=compress;module.exports.decompress=decompress;module.exports.checkTmOptionalPointer=coreAssertions.checkTmOptionalPointer;module.exports.checkLinkedAffordances=coreAssertions.checkLinkedAffordances;module.exports.checkLinkedStructure=coreAssertions.checkLinkedStructure;module.exports.detectProtocolSchemes=detectProtocolSchemes;module.exports.convertTDJsonToYaml=convertTDJsonToYaml;module.exports.convertTDYamlToJson=convertTDYamlToJson;const jsonValidator=require("json-dup-key-validator");function tdValidator(tdString,logFunc,{checkDefaults:checkDefaults=true,checkJsonLd:checkJsonLd=true,checkTmConformance:checkTmConformance=true},suite){return new Promise((async(res,rej)=>{if(typeof tdString!=="string"){rej("Thing Description input should be a String")}if(checkDefaults===undefined){checkDefaults=true}if(checkJsonLd===undefined){checkJsonLd=true}if(typeof logFunc!=="function"){rej("Expected logFunc to be a function")}if(suite===undefined){suite=builder.testSuite().name("tests")}const report={json:null,schema:null,defaults:null,jsonld:null,additional:null};const details={enumConst:null,propItems:null,security:null,propUniqueness:null,multiLangConsistency:null,linksRelTypeCount:null,readWriteOnly:null,uriVariableSecurity:null,linkedAffordances:null,linkedStructure:null};const detailComments={enumConst:"Checking whether a data schema has enum and const at the same time.",propItems:"Checking whether a data schema has an object but not properties or array but no items.",security:"Check if used Security definitions are properly defined previously.",propUniqueness:"Checking whether in one interaction pattern there are duplicate names, e.g. two properties called temp.",multiLangConsistency:"Checks whether all titles and descriptions have the same language fields.",linksRelTypeCount:"Checks whether rel:type is used more than once in the links array",readWriteOnly:"Warns if a property has readOnly or writeOnly set to true conflicting with another property.",uriVariableSecurity:"Checks if the name of an APIKey security scheme with in:uri show up in href and does not             conflict with normal uriVariables",linkedAffordances:"Check if TD has all affordances required by linked TM",linkedStructure:"Check if TD structure corresponds to the one imposed by linked TM"};let tdJson;let start=Date.now();try{tdJson=JSON.parse(tdString);report.json="passed";const end=Date.now();suite.testCase().className("tdValidator").name("JSON Validation").time(end-start)}catch(err){report.json="failed";logFunc("X JSON validation failed:");logFunc(err);const end=Date.now();suite.testCase().className("tdValidator").name("JSON Validation").time(end-start).failure("Not a valid JSON file");res({report:report,details:details,detailComments:detailComments})}start=Date.now();let ajv=new Ajv({strict:false});ajv=addFormats(ajv);ajv=apply(ajv);ajv.addSchema(tdSchema,"td");const valid=ajv.validate("td",tdJson);if(valid){report.schema="passed";let end=Date.now();suite.testCase().className("tdValidator").name("Schema Validation").time(end-start);if(checkDefaults){start=Date.now();ajv.addSchema(fullTdSchema,"fulltd");const fullValid=ajv.validate("fulltd",tdJson);if(fullValid){report.defaults="passed";end=Date.now();suite.testCase().className("tdValidator").name("Defaults Validation").time(end-start)}else{report.defaults="warning";end=Date.now();suite.testCase().className("tdValidator").name("Defaults Validation").time(end-start).error(ajv.errorsText(filterErrorMessages(ajv.errors)));logFunc("Optional validation failed:");logFunc("> "+ajv.errorsText(filterErrorMessages(ajv.errors)))}}start=Date.now();checkEnumConst(tdJson);checkPropItems(tdJson);checkReadWriteOnly(tdJson);details.security=evalAssertion(coreAssertions.checkSecurity(tdJson));details.propUniqueness=evalAssertion(coreAssertions.checkPropUniqueness(tdString));if(details.propUniqueness==="passed"){details.propUniqueness=checkSecPropUniqueness(tdString,tdJson)}else{checkSecPropUniqueness(tdString,tdJson)}details.multiLangConsistency=evalAssertion(coreAssertions.checkMultiLangConsistency(tdJson));details.linksRelTypeCount=evalAssertion(coreAssertions.checkLinksRelTypeCount(tdJson));details.uriVariableSecurity=evalAssertion(coreAssertions.checkUriSecurity(tdJson));if(checkTmConformance){details.linkedAffordances=evalAssertion(await coreAssertions.checkLinkedAffordances(tdJson),false);details.linkedStructure=evalAssertion(await coreAssertions.checkLinkedStructure(tdJson),false)}report.additional="passed";Object.keys(details).forEach((prop=>{if(details[prop]==="warning"&&report.additional==="passed"){report.additional="warning"}else if(details[prop]==="failed"&&report.additional!=="failed"){report.additional="failed"}}));end=Date.now();if(report.additional==="passed"){suite.testCase().className("tdValidator").name("Additional Validation").time(end-start)}else if(report.additional==="warning"){suite.testCase().className("tdValidator").name("Additional Validation").time(end-start).error("Warning!")}else{suite.testCase().className("tdValidator").name("Additional Validation").time(end-start).failure()}}else{report.schema="failed";const end=Date.now();suite.testCase().className("tdValidator").name("Schema Validation").time(end-start).failure(ajv.errorsText(filterErrorMessages(ajv.errors)));logFunc("X JSON Schema validation failed:");logFunc("> "+ajv.errorsText(filterErrorMessages(ajv.errors)));res({report:report,details:details,detailComments:detailComments})}if(checkJsonLd){start=Date.now();jsonld.toRDF(tdJson,{format:"application/nquads"}).then((nquads=>{report.jsonld="passed";const end=Date.now();suite.testCase().className("tdValidator").name("JSON LD Validation").time(end-start);res({report:report,details:details,detailComments:detailComments})}),(err=>{report.jsonld="failed";const end=Date.now();suite.testCase().className("tdValidator").name("JSON LD Validation").time(end-start).failure(err);logFunc("X JSON-LD validation failed:");logFunc("Hint: Make sure you have internet connection available.");logFunc("> "+err);res({report:report,details:details,detailComments:detailComments})}))}else{res({report:report,details:details,detailComments:detailComments})}function checkEnumConst(td){details.enumConst="passed";if(td.hasOwnProperty("properties")){tdProperties=Object.keys(td.properties);for(let i=0;i<tdProperties.length;i++){const curPropertyName=tdProperties[i];const curProperty=td.properties[curPropertyName];if(curProperty.hasOwnProperty("enum")&&curProperty.hasOwnProperty("const")){details.enumConst="warning";logFunc("! Warning: In property "+curPropertyName+" enum and const are used at the same time, the values in enum"+" can never be valid in the received JSON value")}}}if(td.hasOwnProperty("actions")){tdActions=Object.keys(td.actions);for(let i=0;i<tdActions.length;i++){const curActionName=tdActions[i];const curAction=td.actions[curActionName];if(curAction.hasOwnProperty("input")){const curInput=curAction.input;if(curInput.hasOwnProperty("enum")&&curInput.hasOwnProperty("const")){details.enumConst="warning";logFunc("! Warning: In the input of action "+curActionName+" enum and const are used at the same time, the values in enum can"+" never be valid in the received JSON value")}}if(curAction.hasOwnProperty("output")){const curOutput=curAction.output;if(curOutput.hasOwnProperty("enum")&&curOutput.hasOwnProperty("const")){details.enumConst="warning";logFunc("! Warning: In the output of action "+curActionName+" enum and const are used at the same time, the values in enum can"+" never be valid in the received JSON value")}}}}if(td.hasOwnProperty("events")){tdEvents=Object.keys(td.events);for(let i=0;i<tdEvents.length;i++){const curEventName=tdEvents[i];const curEvent=td.events[curEventName];if(curEvent.hasOwnProperty("enum")&&curEvent.hasOwnProperty("const")){details.enumConst="warning";logFunc("! Warning: In event "+curEventName+" enum and const are used at the same time, the"+" values in enum can never be valid in the received JSON value")}}}return}function checkPropItems(td){details.propItems="passed";if(td.hasOwnProperty("properties")){tdProperties=Object.keys(td.properties);for(let i=0;i<tdProperties.length;i++){const curPropertyName=tdProperties[i];const curProperty=td.properties[curPropertyName];if(curProperty.hasOwnProperty("type")){if(curProperty.type==="object"&&!curProperty.hasOwnProperty("properties")){details.propItems="warning";logFunc("! Warning: In property "+curPropertyName+", the type is object but its properties are not specified")}if(curProperty.type==="array"&&!curProperty.hasOwnProperty("items")){details.propItems="warning";logFunc("! Warning: In property "+curPropertyName+", the type is array but its items are not specified")}}}}if(td.hasOwnProperty("actions")){tdActions=Object.keys(td.actions);for(let i=0;i<tdActions.length;i++){const curActionName=tdActions[i];const curAction=td.actions[curActionName];if(curAction.hasOwnProperty("input")){const curInput=curAction.input;if(curInput.hasOwnProperty("type")){if(curInput.type==="object"&&!curInput.hasOwnProperty("properties")){details.propItems="warning";logFunc("! Warning: In the input of action "+curActionName+", the type is object but its properties are not specified")}if(curInput.type==="array"&&!curInput.hasOwnProperty("items")){details.propItems="warning";logFunc("! Warning: In the output of action "+curActionName+", the type is array but its items are not specified")}}}if(curAction.hasOwnProperty("output")){const curOutput=curAction.output;if(curOutput.hasOwnProperty("type")){if(curOutput.type==="object"&&!curOutput.hasOwnProperty("properties")){details.propItems="warning";logFunc("! Warning: In the output of action "+curActionName+", the type is object but its properties are not specified")}if(curOutput.type==="array"&&!curOutput.hasOwnProperty("items")){details.propItems="warning";logFunc("! Warning: In the output of action "+curActionName+", the type is array but its items are not specified")}}}}}if(td.hasOwnProperty("events")){tdEvents=Object.keys(td.events);for(let i=0;i<tdEvents.length;i++){const curEventName=tdEvents[i];const curEvent=td.events[curEventName];if(curEvent.hasOwnProperty("type")){if(curEvent.type==="object"&&!curEvent.hasOwnProperty("properties")){details.propItems="warning";logFunc("! Warning: In event "+curEventName+", the type is object but its properties are not specified")}if(curEvent.type==="array"&&!curEvent.hasOwnProperty("items")){details.propItems="warning";logFunc("! Warning: In event "+curEventName+", the type is array but its items are not specified")}}}}return}function checkReadWriteOnly(td){details.readWriteOnly="passed";if(td.hasOwnProperty("properties")){tdProperties=Object.keys(td.properties);for(let i=0;i<tdProperties.length;i++){const curPropertyName=tdProperties[i];const curProperty=td.properties[curPropertyName];if(curProperty.hasOwnProperty("readOnly")&&curProperty.readOnly===true){if(curProperty.hasOwnProperty("writeOnly")&&curProperty.writeOnly===true){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+", both readOnly and writeOnly are set to true!")}if(curProperty.hasOwnProperty("forms")){for(const formElIndex in curProperty.forms){if(curProperty.forms.hasOwnProperty(formElIndex)){const formEl=curProperty.forms[formElIndex];if(formEl.hasOwnProperty("op")){if(typeof formEl.op==="string"&&formEl.op==="writeproperty"||typeof formEl.op==="object"&&formEl.op.some((el=>el==="writeproperty"))){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], readOnly is set but the op property contains "writeproperty"')}}else{details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], readOnly is set but a form op property defaults to ["writeproperty", "readproperty"]')}}}}}if(curProperty.hasOwnProperty("writeOnly")&&curProperty.writeOnly===true){if(curProperty.hasOwnProperty("forms")){for(const formElIndex in curProperty.forms){if(curProperty.forms.hasOwnProperty(formElIndex)){const formEl=curProperty.forms[formElIndex];if(formEl.hasOwnProperty("op")){if(typeof formEl.op==="string"&&formEl.op==="readproperty"||typeof formEl.op==="object"&&formEl.op.some((el=>el==="readproperty"))){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], writeOnly is set but the op property contains "readproperty"')}else if(typeof formEl.op==="string"&&formEl.op==="observeproperty"||typeof formEl.op==="object"&&formEl.op.some((el=>el==="observeproperty"))){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], writeOnly is set but the op property contains "observeproperty"')}}else{details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], writeOnly is set but a form op property defaults to ["writeproperty", "readproperty"]')}}}}if(curProperty.hasOwnProperty("observable")&&curProperty.observable===true){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+", both writeOnly and observable are set to true!")}}}}}function checkSecPropUniqueness(tdStr,td){let result="passed";try{jsonValidator.parse(tdStr,false)}catch(error){const errorString=error.toString();const startQuote=errorString.indexOf('"');const restString=errorString.slice(startQuote+1);const endQuote=restString.indexOf('"');const securitySchemeName=restString.slice(0,endQuote);if(td.securityDefinitions.hasOwnProperty(securitySchemeName)){result="failed";logFunc("KO Error: The securityDefinitions contain a duplicate")}}return result}function evalAssertion(results,failOnly=true){let out="passed";results.forEach((resultobj=>{if(resultobj.Status==="fail"){out="failed";logFunc("KO Error: Assertion: "+resultobj.ID);logFunc(resultobj.Comment)}else if(!failOnly&&resultobj.Status!=="pass"){out=resultobj.Status;logFunc(`Assertion: ${resultobj.ID}: ${resultobj.Status}${resultobj.Comment?" => "+resultobj.Comment:""}`)}}));return out}function filterErrorMessages(errors){const output=[];errors.forEach((el=>{if(!output.some((ce=>ce.dataPath===el.dataPath&&ce.message===el.message))){output.push(el)}}));return output}}))}function tmValidator(tmString,logFunc,{checkDefaults:checkDefaults=true,checkJsonLd:checkJsonLd=true},suite){return new Promise(((res,rej)=>{if(typeof tmString!=="string"){rej("Thing Model input should be a String")}if(checkDefaults===undefined){checkDefaults=true}if(checkJsonLd===undefined){checkJsonLd=true}if(typeof logFunc!=="function"){rej("Expected logFunc to be a function")}if(suite===undefined){suite=builder.testSuite().name("tests")}const report={json:null,schema:null,defaults:null,jsonld:null,additional:null};const details={enumConst:null,propItems:null,propUniqueness:null,multiLangConsistency:null,linksRelTypeCount:null,readWriteOnly:null,tmOptionalPointer:null};const detailComments={enumConst:"Checking whether a data schema has enum and const at the same time.",propItems:"Checking whether a data schema has an object but not properties or array but no items.",propUniqueness:"Checking whether in one interaction pattern there are duplicate names, e.g. two properties called temp.",multiLangConsistency:"Checks whether all titles and descriptions have the same language fields.",linksRelTypeCount:"Checks whether rel:type is used more than once in the links array",readWriteOnly:"Warns if a property has readOnly or writeOnly set to true conflicting with another property.",tmOptionalPointer:"Checking whether tm:optional points to an actual affordance"};let start=Date.now();let tmJson;try{tmJson=JSON.parse(tmString);report.json="passed";const end=Date.now();suite.testCase().className("tdValidator").name("JSON Validation").time(end-start)}catch(err){report.json="failed";logFunc("X JSON validation failed:");logFunc(err);const end=Date.now();suite.testCase().className("tdValidator").name("JSON Validation").time(end-start).failure("Not a valid JSON file");res({report:report,details:details,detailComments:detailComments})}start=Date.now();let ajv=new Ajv({strict:false});ajv=addFormats(ajv);ajv=apply(ajv);ajv.addSchema(tmSchema,"tm");const valid=ajv.validate("tm",tmJson);if(valid){report.schema="passed";let end=Date.now();suite.testCase().className("tdValidator").name("Schema Validation").time(end-start);checkEnumConst(tmJson);checkPropItems(tmJson);checkReadWriteOnly(tmJson);details.propUniqueness=evalAssertion(coreAssertions.checkPropUniqueness(tmString));if(details.propUniqueness==="passed"){details.propUniqueness=checkSecPropUniqueness(tmString,tmJson)}else{checkSecPropUniqueness(tmString,tmJson)}details.multiLangConsistency=evalAssertion(coreAssertions.checkMultiLangConsistency(tmJson));details.linksRelTypeCount=evalAssertion(coreAssertions.checkLinksRelTypeCount(tmJson));details.tmOptionalPointer=evalAssertion(coreAssertions.checkTmOptionalPointer(tmJson));report.additional="passed";Object.keys(details).forEach((prop=>{if(details[prop]==="warning"&&report.additional==="passed"){report.additional="warning"}else if(details[prop]==="failed"&&report.additional!=="failed"){report.additional="failed"}}));end=Date.now();if(report.additional==="passed"){suite.testCase().className("tmValidator").name("Additional Validation").time(end-start)}else if(report.additional==="warning"){suite.testCase().className("tmValidator").name("Additional Validation").time(end-start).error("Warning!")}else{suite.testCase().className("tmValidator").name("Additional Validation").time(end-start).failure()}}else{report.schema="failed";const end=Date.now();suite.testCase().className("tdValidator").name("Schema Validation").time(end-start).failure(ajv.errorsText(filterErrorMessages(ajv.errors)));logFunc("X JSON Schema validation failed:");logFunc("> "+ajv.errorsText(filterErrorMessages(ajv.errors)));res({report:report,details:details,detailComments:detailComments})}if(checkJsonLd){start=Date.now();jsonld.toRDF(tmJson,{format:"application/nquads"}).then((nquads=>{report.jsonld="passed";const end=Date.now();suite.testCase().className("tdValidator").name("JSON LD Validation").time(end-start);res({report:report,details:details,detailComments:detailComments})}),(err=>{report.jsonld="failed";const end=Date.now();suite.testCase().className("tdValidator").name("JSON LD Validation").time(end-start).failure(err);logFunc("X JSON-LD validation failed:");logFunc("Hint: Make sure you have internet connection available.");logFunc("> "+err);res({report:report,details:details,detailComments:detailComments})}))}else{res({report:report,details:details,detailComments:detailComments})}function checkEnumConst(tm){details.enumConst="passed";if(tm.hasOwnProperty("properties")){tmProperties=Object.keys(tm.properties);for(let i=0;i<tmProperties.length;i++){const curPropertyName=tmProperties[i];const curProperty=tm.properties[curPropertyName];if(curProperty.hasOwnProperty("enum")&&curProperty.hasOwnProperty("const")){details.enumConst="warning";logFunc("! Warning: In property "+curPropertyName+" enum and const are used at the same time, the values in enum"+" can never be valid in the received JSON value")}}}if(tm.hasOwnProperty("actions")){tmActions=Object.keys(tm.actions);for(let i=0;i<tmActions.length;i++){const curActionName=tmActions[i];const curAction=tm.actions[curActionName];if(curAction.hasOwnProperty("input")){const curInput=curAction.input;if(curInput.hasOwnProperty("enum")&&curInput.hasOwnProperty("const")){details.enumConst="warning";logFunc("! Warning: In the input of action "+curActionName+" enum and const are used at the same time, the values in enum can"+" never be valid in the received JSON value")}}if(curAction.hasOwnProperty("output")){const curOutput=curAction.output;if(curOutput.hasOwnProperty("enum")&&curOutput.hasOwnProperty("const")){details.enumConst="warning";logFunc("! Warning: In the output of action "+curActionName+" enum and const are used at the same time, the values in enum can"+" never be valid in the received JSON value")}}}}if(tm.hasOwnProperty("events")){tmEvents=Object.keys(tm.events);for(let i=0;i<tmEvents.length;i++){const curEventName=tmEvents[i];const curEvent=tm.events[curEventName];if(curEvent.hasOwnProperty("enum")&&curEvent.hasOwnProperty("const")){details.enumConst="warning";logFunc("! Warning: In event "+curEventName+" enum and const are used at the same time, the"+" values in enum can never be valid in the received JSON value")}}}return}function checkPropItems(tm){details.propItems="passed";if(tm.hasOwnProperty("properties")){tmProperties=Object.keys(tm.properties);for(let i=0;i<tmProperties.length;i++){const curPropertyName=tmProperties[i];const curProperty=tm.properties[curPropertyName];if(curProperty.hasOwnProperty("type")){if(curProperty.type==="object"&&!curProperty.hasOwnProperty("properties")){details.propItems="warning";logFunc("! Warning: In property "+curPropertyName+", the type is object but its properties are not specified")}if(curProperty.type==="array"&&!curProperty.hasOwnProperty("items")){details.propItems="warning";logFunc("! Warning: In property "+curPropertyName+", the type is array but its items are not specified")}}}}if(tm.hasOwnProperty("actions")){tmActions=Object.keys(tm.actions);for(let i=0;i<tmActions.length;i++){const curActionName=tmActions[i];const curAction=tm.actions[curActionName];if(curAction.hasOwnProperty("input")){const curInput=curAction.input;if(curInput.hasOwnProperty("type")){if(curInput.type==="object"&&!curInput.hasOwnProperty("properties")){details.propItems="warning";logFunc("! Warning: In the input of action "+curActionName+", the type is object but its properties are not specified")}if(curInput.type==="array"&&!curInput.hasOwnProperty("items")){details.propItems="warning";logFunc("! Warning: In the output of action "+curActionName+", the type is array but its items are not specified")}}}if(curAction.hasOwnProperty("output")){const curOutput=curAction.output;if(curOutput.hasOwnProperty("type")){if(curOutput.type==="object"&&!curOutput.hasOwnProperty("properties")){details.propItems="warning";logFunc("! Warning: In the output of action "+curActionName+", the type is object but its properties are not specified")}if(curOutput.type==="array"&&!curOutput.hasOwnProperty("items")){details.propItems="warning";logFunc("! Warning: In the output of action "+curActionName+", the type is array but its items are not specified")}}}}}if(tm.hasOwnProperty("events")){tmEvents=Object.keys(tm.events);for(let i=0;i<tmEvents.length;i++){const curEventName=tmEvents[i];const curEvent=tm.events[curEventName];if(curEvent.hasOwnProperty("type")){if(curEvent.type==="object"&&!curEvent.hasOwnProperty("properties")){details.propItems="warning";logFunc("! Warning: In event "+curEventName+", the type is object but its properties are not specified")}if(curEvent.type==="array"&&!curEvent.hasOwnProperty("items")){details.propItems="warning";logFunc("! Warning: In event "+curEventName+", the type is array but its items are not specified")}}}}return}function checkReadWriteOnly(tm){details.readWriteOnly="passed";if(tm.hasOwnProperty("properties")){tmProperties=Object.keys(tm.properties);for(let i=0;i<tmProperties.length;i++){const curPropertyName=tmProperties[i];const curProperty=tm.properties[curPropertyName];if(curProperty.hasOwnProperty("readOnly")&&curProperty.readOnly===true){if(curProperty.hasOwnProperty("writeOnly")&&curProperty.writeOnly===true){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+", both readOnly and writeOnly are set to true!")}if(curProperty.hasOwnProperty("forms")){for(const formElIndex in curProperty.forms){if(curProperty.forms.hasOwnProperty(formElIndex)){const formEl=curProperty.forms[formElIndex];if(formEl.hasOwnProperty("op")){if(typeof formEl.op==="string"&&formEl.op==="writeproperty"||typeof formEl.op==="object"&&formEl.op.some((el=>el==="writeproperty"))){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], readOnly is set but the op property contains "writeproperty"')}}else{details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], readOnly is set but a form op property defaults to ["writeproperty", "readproperty"]')}}}}}if(curProperty.hasOwnProperty("writeOnly")&&curProperty.writeOnly===true){if(curProperty.hasOwnProperty("forms")){for(const formElIndex in curProperty.forms){if(curProperty.forms.hasOwnProperty(formElIndex)){const formEl=curProperty.forms[formElIndex];if(formEl.hasOwnProperty("op")){if(typeof formEl.op==="string"&&formEl.op==="readproperty"||typeof formEl.op==="object"&&formEl.op.some((el=>el==="readproperty"))){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], writeOnly is set but the op property contains "readproperty"')}else if(typeof formEl.op==="string"&&formEl.op==="observeproperty"||typeof formEl.op==="object"&&formEl.op.some((el=>el==="observeproperty"))){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], writeOnly is set but the op property contains "observeproperty"')}}else{details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+" in forms["+formElIndex+'], writeOnly is set but a form op property defaults to ["writeproperty", "readproperty"]')}}}}if(curProperty.hasOwnProperty("observable")&&curProperty.observable===true){details.readWriteOnly="warning";logFunc("! Warning: In property "+curPropertyName+", both writeOnly and observable are set to true!")}}}}}function checkSecPropUniqueness(tmStr,tm){let result="passed";try{jsonValidator.parse(tmStr,false)}catch(error){const errorString=error.toString();const startQuote=errorString.indexOf('"');const restString=errorString.slice(startQuote+1);const endQuote=restString.indexOf('"');const securitySchemeName=restString.slice(0,endQuote);if(td.securityDefinitions.hasOwnProperty(securitySchemeName)){result="failed";logFunc("KO Error: The securityDefinitions contain a duplicate")}}return result}function evalAssertion(results){let out="passed";results.forEach((resultobj=>{if(resultobj.Status==="fail"){out="failed";logFunc("KO Error: Assertion: "+resultobj.ID);logFunc(resultobj.Comment)}}));return out}function filterErrorMessages(errors){const output=[];errors.forEach((el=>{if(!output.some((ce=>ce.dataPath===el.dataPath&&ce.message===el.message))){output.push(el)}}));return output}}))}function compress(data){return lzs.compressToEncodedURIComponent(data)}function decompress(data){return lzs.decompressFromEncodedURIComponent(data)}function detectProtocolSchemes(td){let tdJson;try{tdJson=JSON.parse(td)}catch(err){return[]}const baseUriProtocol=getHrefProtocol(tdJson.base);const thingProtocols=detectProtocolInForms(tdJson.forms);const actionsProtocols=detectProtocolInAffordance(tdJson.actions);const eventsProtocols=detectProtocolInAffordance(tdJson.events);const propertiesProtcols=detectProtocolInAffordance(tdJson.properties);const protocolSchemes=[...new Set([baseUriProtocol,...thingProtocols,...actionsProtocols,...eventsProtocols,...propertiesProtcols])].filter((p=>p!==undefined));return protocolSchemes}function detectProtocolInAffordance(affordance){if(!affordance){return[]}let protocolSchemes=[];for(const key in affordance){if(key){protocolSchemes=protocolSchemes.concat(detectProtocolInForms(affordance[key].forms))}}return protocolSchemes}function detectProtocolInForms(forms){if(!forms){return[]}const protocolSchemes=[];forms.forEach((form=>{protocolSchemes.push(getHrefProtocol(form.href))}));return protocolSchemes}function getHrefProtocol(href){if(!href){return}return href.split(":")[0]}function convertTDJsonToYaml(td){if(td===""){return}try{return jsYaml.dump(JSON.parse(td))}catch(err){console.log("TD generation problem: "+err)}}function convertTDYamlToJson(td){if(td===""){return}try{return JSON.stringify(jsYaml.load(td))}catch(err){console.log("TD generation problem: "+err)}}},{"./shared":479,"./td-schema-full.json":480,"./td-schema.json":481,"./tm-schema.json":482,ajv:78,"ajv-formats":76,"ajv-formats-draft2019":74,"js-yaml":286,"json-dup-key-validator":314,jsonld:334,"junit-report-builder":345,"lz-string":350}],2:[function(require,module,exports){module.exports=require("./lib/difflib")},{"./lib/difflib":3}],3:[function(require,module,exports){(function(){var Differ,Heap,IS_CHARACTER_JUNK,IS_LINE_JUNK,SequenceMatcher,_any,_arrayCmp,_calculateRatio,_countLeading,_formatRangeContext,_formatRangeUnified,_has,assert,contextDiff,floor,getCloseMatches,max,min,ndiff,restore,unifiedDiff,indexOf=[].indexOf;({floor:floor,max:max,min:min}=Math);Heap=require("heap");assert=require("assert");_calculateRatio=function(matches,length){if(length){return 2*matches/length}else{return 1}};_arrayCmp=function(a,b){var i,l,la,lb,ref;[la,lb]=[a.length,b.length];for(i=l=0,ref=min(la,lb);0<=ref?l<ref:l>ref;i=0<=ref?++l:--l){if(a[i]<b[i]){return-1}if(a[i]>b[i]){return 1}}return la-lb};_has=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)};_any=function(items){var item,l,len;for(l=0,len=items.length;l<len;l++){item=items[l];if(item){return true}}return false};SequenceMatcher=class SequenceMatcher{constructor(isjunk1,a="",b="",autojunk=true){this.isjunk=isjunk1;this.autojunk=autojunk;this.a=this.b=null;this.setSeqs(a,b)}setSeqs(a,b){this.setSeq1(a);return this.setSeq2(b)}setSeq1(a){if(a===this.a){return}this.a=a;return this.matchingBlocks=this.opcodes=null}setSeq2(b){if(b===this.b){return}this.b=b;this.matchingBlocks=this.opcodes=null;this.fullbcount=null;return this._chainB()}_chainB(){var b,b2j,elt,i,indices,isjunk,junk,l,len,n,ntest,popular;b=this.b;this.b2j=b2j=new Map;for(i=l=0,len=b.length;l<len;i=++l){elt=b[i];if(!b2j.has(elt)){b2j.set(elt,[])}indices=b2j.get(elt);indices.push(i)}junk=new Map;isjunk=this.isjunk;if(isjunk){b2j.forEach((function(idxs,elt){if(isjunk(elt)){junk.set(elt,true);return b2j.delete(elt)}}))}popular=new Map;n=b.length;if(this.autojunk&&n>=200){ntest=floor(n/100)+1;b2j.forEach((function(idxs,elt){if(idxs.length>ntest){popular.set(elt,true);return b2j.delete(elt)}}))}this.isbjunk=function(b){return junk.has(b)};return this.isbpopular=function(b){return popular.has(b)}}findLongestMatch(alo,ahi,blo,bhi){var a,b,b2j,besti,bestj,bestsize,i,isbjunk,j,j2len,jlist,k,l,len,m,newj2len,ref,ref1;[a,b,b2j,isbjunk]=[this.a,this.b,this.b2j,this.isbjunk];[besti,bestj,bestsize]=[alo,blo,0];j2len={};for(i=l=ref=alo,ref1=ahi;ref<=ref1?l<ref1:l>ref1;i=ref<=ref1?++l:--l){newj2len={};jlist=[];if(b2j.has(a[i])){jlist=b2j.get(a[i])}for(m=0,len=jlist.length;m<len;m++){j=jlist[m];if(j<blo){continue}if(j>=bhi){break}k=newj2len[j]=(j2len[j-1]||0)+1;if(k>bestsize){[besti,bestj,bestsize]=[i-k+1,j-k+1,k]}}j2len=newj2len}while(besti>alo&&bestj>blo&&!isbjunk(b[bestj-1])&&a[besti-1]===b[bestj-1]){[besti,bestj,bestsize]=[besti-1,bestj-1,bestsize+1]}while(besti+bestsize<ahi&&bestj+bestsize<bhi&&!isbjunk(b[bestj+bestsize])&&a[besti+bestsize]===b[bestj+bestsize]){bestsize++}while(besti>alo&&bestj>blo&&isbjunk(b[bestj-1])&&a[besti-1]===b[bestj-1]){[besti,bestj,bestsize]=[besti-1,bestj-1,bestsize+1]}while(besti+bestsize<ahi&&bestj+bestsize<bhi&&isbjunk(b[bestj+bestsize])&&a[besti+bestsize]===b[bestj+bestsize]){bestsize++}return[besti,bestj,bestsize]}getMatchingBlocks(){var ahi,alo,bhi,blo,i,i1,i2,j,j1,j2,k,k1,k2,l,la,lb,len,matchingBlocks,nonAdjacent,queue,x;if(this.matchingBlocks){return this.matchingBlocks}[la,lb]=[this.a.length,this.b.length];queue=[[0,la,0,lb]];matchingBlocks=[];while(queue.length){[alo,ahi,blo,bhi]=queue.pop();[i,j,k]=x=this.findLongestMatch(alo,ahi,blo,bhi);if(k){matchingBlocks.push(x);if(alo<i&&blo<j){queue.push([alo,i,blo,j])}if(i+k<ahi&&j+k<bhi){queue.push([i+k,ahi,j+k,bhi])}}}matchingBlocks.sort(_arrayCmp);i1=j1=k1=0;nonAdjacent=[];for(l=0,len=matchingBlocks.length;l<len;l++){[i2,j2,k2]=matchingBlocks[l];if(i1+k1===i2&&j1+k1===j2){k1+=k2}else{if(k1){nonAdjacent.push([i1,j1,k1])}[i1,j1,k1]=[i2,j2,k2]}}if(k1){nonAdjacent.push([i1,j1,k1])}nonAdjacent.push([la,lb,0]);return this.matchingBlocks=nonAdjacent}getOpcodes(){var ai,answer,bj,i,j,l,len,ref,size,tag;if(this.opcodes){return this.opcodes}i=j=0;this.opcodes=answer=[];ref=this.getMatchingBlocks();for(l=0,len=ref.length;l<len;l++){[ai,bj,size]=ref[l];tag="";if(i<ai&&j<bj){tag="replace"}else if(i<ai){tag="delete"}else if(j<bj){tag="insert"}if(tag){answer.push([tag,i,ai,j,bj])}[i,j]=[ai+size,bj+size];if(size){answer.push(["equal",ai,i,bj,j])}}return answer}getGroupedOpcodes(n=3){var codes,group,groups,i1,i2,j1,j2,l,len,nn,tag;codes=this.getOpcodes();if(!codes.length){codes=[["equal",0,1,0,1]]}if(codes[0][0]==="equal"){[tag,i1,i2,j1,j2]=codes[0];codes[0]=[tag,max(i1,i2-n),i2,max(j1,j2-n),j2]}if(codes[codes.length-1][0]==="equal"){[tag,i1,i2,j1,j2]=codes[codes.length-1];codes[codes.length-1]=[tag,i1,min(i2,i1+n),j1,min(j2,j1+n)]}nn=n+n;groups=[];group=[];for(l=0,len=codes.length;l<len;l++){[tag,i1,i2,j1,j2]=codes[l];if(tag==="equal"&&i2-i1>nn){group.push([tag,i1,min(i2,i1+n),j1,min(j2,j1+n)]);groups.push(group);group=[];[i1,j1]=[max(i1,i2-n),max(j1,j2-n)]}group.push([tag,i1,i2,j1,j2])}if(group.length&&!(group.length===1&&group[0][0]==="equal")){groups.push(group)}return groups}ratio(){var l,len,match,matches,ref;matches=0;ref=this.getMatchingBlocks();for(l=0,len=ref.length;l<len;l++){match=ref[l];matches+=match[2]}return _calculateRatio(matches,this.a.length+this.b.length)}quickRatio(){var avail,elt,fullbcount,l,len,len1,m,matches,numb,ref,ref1;if(!this.fullbcount){this.fullbcount=fullbcount={};ref=this.b;for(l=0,len=ref.length;l<len;l++){elt=ref[l];fullbcount[elt]=(fullbcount[elt]||0)+1}}fullbcount=this.fullbcount;avail={};matches=0;ref1=this.a;for(m=0,len1=ref1.length;m<len1;m++){elt=ref1[m];if(_has(avail,elt)){numb=avail[elt]}else{numb=fullbcount[elt]||0}avail[elt]=numb-1;if(numb>0){matches++}}return _calculateRatio(matches,this.a.length+this.b.length)}realQuickRatio(){var la,lb;[la,lb]=[this.a.length,this.b.length];return _calculateRatio(min(la,lb),la+lb)}};getCloseMatches=function(word,possibilities,n=3,cutoff=.6){var l,len,len1,m,result,results,s,score,x;if(!(n>0)){throw new Error(`n must be > 0: (${n})`)}if(!(0<=cutoff&&cutoff<=1)){throw new Error(`cutoff must be in [0.0, 1.0]: (${cutoff})`)}result=[];s=new SequenceMatcher;s.setSeq2(word);for(l=0,len=possibilities.length;l<len;l++){x=possibilities[l];s.setSeq1(x);if(s.realQuickRatio()>=cutoff&&s.quickRatio()>=cutoff&&s.ratio()>=cutoff){result.push([s.ratio(),x])}}result=Heap.nlargest(result,n,_arrayCmp);results=[];for(m=0,len1=result.length;m<len1;m++){[score,x]=result[m];results.push(x)}return results};_countLeading=function(line,ch){var i,n;[i,n]=[0,line.length];while(i<n&&line[i]===ch){i++}return i};Differ=class Differ{constructor(linejunk1,charjunk1){this.linejunk=linejunk1;this.charjunk=charjunk1}compare(a,b){var ahi,alo,bhi,blo,cruncher,g,l,len,len1,line,lines,m,ref,tag;cruncher=new SequenceMatcher(this.linejunk,a,b);lines=[];ref=cruncher.getOpcodes();for(l=0,len=ref.length;l<len;l++){[tag,alo,ahi,blo,bhi]=ref[l];switch(tag){case"replace":g=this._fancyReplace(a,alo,ahi,b,blo,bhi);break;case"delete":g=this._dump("-",a,alo,ahi);break;case"insert":g=this._dump("+",b,blo,bhi);break;case"equal":g=this._dump(" ",a,alo,ahi);break;default:throw new Error(`unknow tag (${tag})`)}for(m=0,len1=g.length;m<len1;m++){line=g[m];lines.push(line)}}return lines}_dump(tag,x,lo,hi){var i,l,ref,ref1,results;results=[];for(i=l=ref=lo,ref1=hi;ref<=ref1?l<ref1:l>ref1;i=ref<=ref1?++l:--l){results.push(`${tag} ${x[i]}`)}return results}_plainReplace(a,alo,ahi,b,blo,bhi){var first,g,l,len,len1,line,lines,m,ref,second;assert(alo<ahi&&blo<bhi);if(bhi-blo<ahi-alo){first=this._dump("+",b,blo,bhi);second=this._dump("-",a,alo,ahi)}else{first=this._dump("-",a,alo,ahi);second=this._dump("+",b,blo,bhi)}lines=[];ref=[first,second];for(l=0,len=ref.length;l<len;l++){g=ref[l];for(m=0,len1=g.length;m<len1;m++){line=g[m];lines.push(line)}}return lines}_fancyReplace(a,alo,ahi,b,blo,bhi){var aelt,ai,ai1,ai2,atags,belt,bestRatio,besti,bestj,bj,bj1,bj2,btags,cruncher,cutoff,eqi,eqj,i,j,l,la,lb,len,len1,len2,len3,len4,line,lines,m,o,p,q,r,ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7,ref8,t,tag;[bestRatio,cutoff]=[.74,.75];cruncher=new SequenceMatcher(this.charjunk);[eqi,eqj]=[null,null];lines=[];for(j=l=ref=blo,ref1=bhi;ref<=ref1?l<ref1:l>ref1;j=ref<=ref1?++l:--l){bj=b[j];cruncher.setSeq2(bj);for(i=m=ref2=alo,ref3=ahi;ref2<=ref3?m<ref3:m>ref3;i=ref2<=ref3?++m:--m){ai=a[i];if(ai===bj){if(eqi===null){[eqi,eqj]=[i,j]}continue}cruncher.setSeq1(ai);if(cruncher.realQuickRatio()>bestRatio&&cruncher.quickRatio()>bestRatio&&cruncher.ratio()>bestRatio){[bestRatio,besti,bestj]=[cruncher.ratio(),i,j]}}}if(bestRatio<cutoff){if(eqi===null){ref4=this._plainReplace(a,alo,ahi,b,blo,bhi);for(o=0,len=ref4.length;o<len;o++){line=ref4[o];lines.push(line)}return lines}[besti,bestj,bestRatio]=[eqi,eqj,1]}else{eqi=null}ref5=this._fancyHelper(a,alo,besti,b,blo,bestj);for(p=0,len1=ref5.length;p<len1;p++){line=ref5[p];lines.push(line)}[aelt,belt]=[a[besti],b[bestj]];if(eqi===null){atags=btags="";cruncher.setSeqs(aelt,belt);ref6=cruncher.getOpcodes();for(q=0,len2=ref6.length;q<len2;q++){[tag,ai1,ai2,bj1,bj2]=ref6[q];[la,lb]=[ai2-ai1,bj2-bj1];switch(tag){case"replace":atags+=Array(la+1).join("^");btags+=Array(lb+1).join("^");break;case"delete":atags+=Array(la+1).join("-");break;case"insert":btags+=Array(lb+1).join("+");break;case"equal":atags+=Array(la+1).join(" ");btags+=Array(lb+1).join(" ");break;default:throw new Error(`unknow tag (${tag})`)}}ref7=this._qformat(aelt,belt,atags,btags);for(r=0,len3=ref7.length;r<len3;r++){line=ref7[r];lines.push(line)}}else{lines.push("  "+aelt)}ref8=this._fancyHelper(a,besti+1,ahi,b,bestj+1,bhi);for(t=0,len4=ref8.length;t<len4;t++){line=ref8[t];lines.push(line)}return lines}_fancyHelper(a,alo,ahi,b,blo,bhi){var g;g=[];if(alo<ahi){if(blo<bhi){g=this._fancyReplace(a,alo,ahi,b,blo,bhi)}else{g=this._dump("-",a,alo,ahi)}}else if(blo<bhi){g=this._dump("+",b,blo,bhi)}return g}_qformat(aline,bline,atags,btags){var common,lines;lines=[];common=min(_countLeading(aline,"\t"),_countLeading(bline,"\t"));common=min(common,_countLeading(atags.slice(0,common)," "));common=min(common,_countLeading(btags.slice(0,common)," "));atags=atags.slice(common).replace(/\s+$/,"");btags=btags.slice(common).replace(/\s+$/,"");lines.push("- "+aline);if(atags.length){lines.push(`? ${Array(common+1).join("\t")}${atags}\n`)}lines.push("+ "+bline);if(btags.length){lines.push(`? ${Array(common+1).join("\t")}${btags}\n`)}return lines}};IS_LINE_JUNK=function(line,pat=/^\s*#?\s*$/){return pat.test(line)};IS_CHARACTER_JUNK=function(ch,ws=" \t"){return indexOf.call(ws,ch)>=0};_formatRangeUnified=function(start,stop){var beginning,length;beginning=start+1;length=stop-start;if(length===1){return`${beginning}`}if(!length){beginning--}return`${beginning},${length}`};unifiedDiff=function(a,b,{fromfile:fromfile,tofile:tofile,fromfiledate:fromfiledate,tofiledate:tofiledate,n:n,lineterm:lineterm}={}){var file1Range,file2Range,first,fromdate,group,i1,i2,j1,j2,l,last,len,len1,len2,len3,len4,line,lines,m,o,p,q,ref,ref1,ref2,ref3,started,tag,todate;if(fromfile==null){fromfile=""}if(tofile==null){tofile=""}if(fromfiledate==null){fromfiledate=""}if(tofiledate==null){tofiledate=""}if(n==null){n=3}if(lineterm==null){lineterm="\n"}lines=[];started=false;ref=new SequenceMatcher(null,a,b).getGroupedOpcodes();for(l=0,len=ref.length;l<len;l++){group=ref[l];if(!started){started=true;fromdate=fromfiledate?`\t${fromfiledate}`:"";todate=tofiledate?`\t${tofiledate}`:"";lines.push(`--- ${fromfile}${fromdate}${lineterm}`);lines.push(`+++ ${tofile}${todate}${lineterm}`)}[first,last]=[group[0],group[group.length-1]];file1Range=_formatRangeUnified(first[1],last[2]);file2Range=_formatRangeUnified(first[3],last[4]);lines.push(`@@ -${file1Range} +${file2Range} @@${lineterm}`);for(m=0,len1=group.length;m<len1;m++){[tag,i1,i2,j1,j2]=group[m];if(tag==="equal"){ref1=a.slice(i1,i2);for(o=0,len2=ref1.length;o<len2;o++){line=ref1[o];lines.push(" "+line)}continue}if(tag==="replace"||tag==="delete"){ref2=a.slice(i1,i2);for(p=0,len3=ref2.length;p<len3;p++){line=ref2[p];lines.push("-"+line)}}if(tag==="replace"||tag==="insert"){ref3=b.slice(j1,j2);for(q=0,len4=ref3.length;q<len4;q++){line=ref3[q];lines.push("+"+line)}}}}return lines};_formatRangeContext=function(start,stop){var beginning,length;beginning=start+1;length=stop-start;if(!length){beginning--}if(length<=1){return`${beginning}`}return`${beginning},${beginning+length-1}`};contextDiff=function(a,b,{fromfile:fromfile,tofile:tofile,fromfiledate:fromfiledate,tofiledate:tofiledate,n:n,lineterm:lineterm}={}){var _,file1Range,file2Range,first,fromdate,group,i1,i2,j1,j2,l,last,len,len1,len2,len3,len4,line,lines,m,o,p,prefix,q,ref,ref1,ref2,started,tag,todate;if(fromfile==null){fromfile=""}if(tofile==null){tofile=""}if(fromfiledate==null){fromfiledate=""}if(tofiledate==null){tofiledate=""}if(n==null){n=3}if(lineterm==null){lineterm="\n"}prefix={insert:"+ ",delete:"- ",replace:"! ",equal:"  "};started=false;lines=[];ref=new SequenceMatcher(null,a,b).getGroupedOpcodes();for(l=0,len=ref.length;l<len;l++){group=ref[l];if(!started){started=true;fromdate=fromfiledate?`\t${fromfiledate}`:"";todate=tofiledate?`\t${tofiledate}`:"";lines.push(`*** ${fromfile}${fromdate}${lineterm}`);lines.push(`--- ${tofile}${todate}${lineterm}`);[first,last]=[group[0],group[group.length-1]];lines.push("***************"+lineterm);file1Range=_formatRangeContext(first[1],last[2]);lines.push(`*** ${file1Range} ****${lineterm}`);if(_any(function(){var len1,m,results;results=[];for(m=0,len1=group.length;m<len1;m++){[tag,_,_,_,_]=group[m];results.push(tag==="replace"||tag==="delete")}return results}())){for(m=0,len1=group.length;m<len1;m++){[tag,i1,i2,_,_]=group[m];if(tag!=="insert"){ref1=a.slice(i1,i2);for(o=0,len2=ref1.length;o<len2;o++){line=ref1[o];lines.push(prefix[tag]+line)}}}}file2Range=_formatRangeContext(first[3],last[4]);lines.push(`--- ${file2Range} ----${lineterm}`);if(_any(function(){var len3,p,results;results=[];for(p=0,len3=group.length;p<len3;p++){[tag,_,_,_,_]=group[p];results.push(tag==="replace"||tag==="insert")}return results}())){for(p=0,len3=group.length;p<len3;p++){[tag,_,_,j1,j2]=group[p];if(tag!=="delete"){ref2=b.slice(j1,j2);for(q=0,len4=ref2.length;q<len4;q++){line=ref2[q];lines.push(prefix[tag]+line)}}}}}}return lines};ndiff=function(a,b,linejunk,charjunk=IS_CHARACTER_JUNK){return new Differ(linejunk,charjunk).compare(a,b)};restore=function(delta,which){var l,len,line,lines,prefixes,ref,tag;tag={1:"- ",2:"+ "}[which];if(!tag){throw new Error(`unknow delta choice (must be 1 or 2): ${which}`)}prefixes=["  ",tag];lines=[];for(l=0,len=delta.length;l<len;l++){line=delta[l];if(ref=line.slice(0,2),indexOf.call(prefixes,ref)>=0){lines.push(line.slice(2))}}return lines};exports._arrayCmp=_arrayCmp;exports.SequenceMatcher=SequenceMatcher;exports.getCloseMatches=getCloseMatches;exports._countLeading=_countLeading;exports.Differ=Differ;exports.IS_LINE_JUNK=IS_LINE_JUNK;exports.IS_CHARACTER_JUNK=IS_CHARACTER_JUNK;exports._formatRangeUnified=_formatRangeUnified;exports.unifiedDiff=unifiedDiff;exports._formatRangeContext=_formatRangeContext;exports.contextDiff=contextDiff;exports.ndiff=ndiff;exports.restore=restore}).call(this)},{assert:141,heap:275}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setContextLanguage=exports.findPort=exports.findProtocol=void 0;function findProtocol(td){const base=td.base;const columnLoc=base.indexOf(":");return base.substring(0,columnLoc)}exports.findProtocol=findProtocol;function findPort(td){const base=td.base;const columnLoc=base.indexOf(":",6);const divLoc=base.indexOf("/",columnLoc);const returnString=base.substring(columnLoc+1,divLoc);return parseInt(returnString)}exports.findPort=findPort;function setContextLanguage(thing,language,forceOverride){if(Array.isArray(thing["@context"])){const arrayContext=thing["@context"];let languageSet=false;for(const arrayEntry of arrayContext){if(typeof arrayEntry==="object"){if(arrayEntry["@language"]!==undefined){if(forceOverride){arrayEntry["@language"]=language}languageSet=true}}}if(!languageSet){arrayContext.push({"@language":language})}}}exports.setContextLanguage=setContextLanguage},{}],5:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}})}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.serializeTD=exports.parseTD=void 0;const TD=__importStar(require("./thing-description"));const TDHelpers=__importStar(require("./td-helpers"));const isAbsoluteUrl=require("is-absolute-url");const URLToolkit=require("url-toolkit");const debug_1=__importDefault(require("debug"));const namespace="node-wot:td-tools:td-parser";const logDebug=(0,debug_1.default)(`${namespace}:debug`);const logWarn=(0,debug_1.default)(`${namespace}:warn`);function parseTD(td,normalize){logDebug(`parseTD() parsing\n\`\`\`\n${td}\n\`\`\``);const thing=JSON.parse(td.replace(/^\uFEFF/,""));if(thing["@context"]===undefined){thing["@context"]=[TD.DEFAULT_CONTEXT_V1,TD.DEFAULT_CONTEXT_V11]}else if(Array.isArray(thing["@context"])){let semContext=thing["@context"];const indexV1=semContext.indexOf(TD.DEFAULT_CONTEXT_V1);const indexV11=semContext.indexOf(TD.DEFAULT_CONTEXT_V11);if(indexV1===-1&&indexV11===-1){semContext.unshift(TD.DEFAULT_CONTEXT_V11);semContext.unshift(TD.DEFAULT_CONTEXT_V1)}else{if(indexV1!==-1&&indexV11!==-1){semContext=semContext.filter((function(e){return e!==TD.DEFAULT_CONTEXT_V1}));semContext=semContext.filter((function(e){return e!==TD.DEFAULT_CONTEXT_V11}));semContext.unshift(TD.DEFAULT_CONTEXT_V11);semContext.unshift(TD.DEFAULT_CONTEXT_V1)}else{if(indexV1!==-1&&indexV1!==0){semContext=semContext.filter((function(e){return e!==TD.DEFAULT_CONTEXT_V1}));semContext.unshift(TD.DEFAULT_CONTEXT_V1)}if(indexV11!==-1&&indexV11!==0){semContext=semContext.filter((function(e){return e!==TD.DEFAULT_CONTEXT_V11}));semContext.unshift(TD.DEFAULT_CONTEXT_V11)}}thing["@context"]=semContext}}else if(thing["@context"]!==TD.DEFAULT_CONTEXT_V1&&thing["@context"]!==TD.DEFAULT_CONTEXT_V11){const semContext=thing["@context"];thing["@context"]=[TD.DEFAULT_CONTEXT_V1,TD.DEFAULT_CONTEXT_V11,semContext]}TDHelpers.setContextLanguage(thing,TD.DEFAULT_CONTEXT_LANGUAGE,false);if(thing["@type"]===undefined){thing["@type"]=TD.DEFAULT_THING_TYPE}else if(Array.isArray(thing["@type"])){const semTypes=thing["@type"];if(semTypes.indexOf(TD.DEFAULT_THING_TYPE)===-1){semTypes.unshift(TD.DEFAULT_THING_TYPE)}}else if(thing["@type"]!==TD.DEFAULT_THING_TYPE){const semType=thing["@type"];thing["@type"]=[TD.DEFAULT_THING_TYPE,semType]}if(thing.properties!==undefined&&thing.properties instanceof Object){for(const propName in thing.properties){const prop=thing.properties[propName];if(prop.readOnly===undefined||typeof prop.readOnly!=="boolean"){prop.readOnly=false}if(prop.writeOnly===undefined||typeof prop.writeOnly!=="boolean"){prop.writeOnly=false}if(prop.observable===undefined||typeof prop.observable!=="boolean"){prop.observable=false}}}if(thing.actions!==undefined&&thing.actions instanceof Object){for(const actName in thing.actions){const act=thing.actions[actName];if(act.safe===undefined||typeof act.safe!=="boolean"){act.safe=false}if(act.idempotent===undefined||typeof act.idempotent!=="boolean"){act.idempotent=false}}}if(typeof thing.properties!=="object"||thing.properties===null){thing.properties={}}if(typeof thing.actions!=="object"||thing.actions===null){thing.actions={}}if(typeof thing.events!=="object"||thing.events===null){thing.events={}}if(thing.security===undefined){logWarn("parseTD() found no security metadata")}if(typeof thing.security==="string"){thing.security=[thing.security]}const allForms=[];for(const propName in thing.properties){const prop=thing.properties[propName];if(!prop.forms){throw new Error(`Property '${propName}' has no forms field`)}for(const form of prop.forms){if(!form.href){throw new Error(`Form of Property '${propName}' has no href field`)}if(!isAbsoluteUrl(form.href)&&!thing.base)throw new Error(`Form of Property '${propName}' has relative URI while TD has no base field`);allForms.push(form)}}for(const actName in thing.actions){const act=thing.actions[actName];if(!act.forms){throw new Error(`Action '${actName}' has no forms field`)}for(const form of act.forms){if(!form.href){throw new Error(`Form of Action '${actName}' has no href field`)}if(!isAbsoluteUrl(form.href)&&!thing.base)throw new Error(`Form of Action '${actName}' has relative URI while TD has no base field`);allForms.push(form)}}for(const evtName in thing.events){const evt=thing.events[evtName];if(!evt.forms){throw new Error(`Event '${evtName}' has no forms field`)}for(const form of evt.forms){if(!form.href){throw new Error(`Form of Event '${evtName}' has no href field`)}if(!isAbsoluteUrl(form.href)&&!thing.base)throw new Error(`Form of Event '${evtName}' has relative URI while TD has no base field`);allForms.push(form)}}if(Object.prototype.hasOwnProperty.call(thing,"base")){if(normalize===undefined||normalize===true){logDebug("parseTD() normalizing 'base' into 'forms'");for(const form of allForms){if(!form.href.match(/^([a-z0-9+-.]+:).+/i)){logDebug(`parseTDString() applying base '${thing.base}' to '${form.href}'`);form.href=URLToolkit.buildAbsoluteURL(thing.base,form.href)}}}}return thing}exports.parseTD=parseTD;function serializeTD(thing){const copy=JSON.parse(JSON.stringify(thing));if(!copy.security||copy.security.length===0){copy.securityDefinitions={nosec_sc:{scheme:"nosec"}};copy.security=["nosec_sc"]}if(copy.forms&&copy.forms.length===0){delete copy.forms}if(copy.properties&&Object.keys(copy.properties).length===0){delete copy.properties}else if(copy.properties){for(const propName in copy.properties){const prop=copy.properties[propName];if(prop.readOnly===undefined||typeof prop.readOnly!=="boolean"){prop.readOnly=false}if(prop.writeOnly===undefined||typeof prop.writeOnly!=="boolean"){prop.writeOnly=false}if(prop.observable===undefined||typeof prop.observable!=="boolean"){prop.observable=false}}}if(copy.actions&&Object.keys(copy.actions).length===0){delete copy.actions}else if(copy.actions){for(const actName in copy.actions){const act=copy.actions[actName];if(act.idempotent===undefined||typeof act.idempotent!=="boolean"){act.idempotent=false}if(act.safe===undefined||typeof act.safe!=="boolean"){act.safe=false}}}if(copy.events&&Object.keys(copy.events).length===0){delete copy.events}if(copy.links&&copy.links.length===0){delete copy.links}const td=JSON.stringify(copy);return td}exports.serializeTD=serializeTD},{"./td-helpers":4,"./thing-description":7,debug:178,"is-absolute-url":280,"url-toolkit":436}],6:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}})}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.Thing=void 0;var thing_description_1=require("./thing-description");Object.defineProperty(exports,"Thing",{enumerable:true,get:function(){return __importDefault(thing_description_1).default}});__exportStar(require("./thing-description"),exports);__exportStar(require("./td-parser"),exports);__exportStar(require("./td-helpers"),exports);__exportStar(require("./thing-model-helpers"),exports);__exportStar(require("./util/asset-interface-description"),exports)},{"./td-helpers":4,"./td-parser":5,"./thing-description":7,"./thing-model-helpers":8,"./util/asset-interface-description":9}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ThingEvent=exports.ThingAction=exports.ThingProperty=exports.BaseSchema=exports.Form=exports.DEFAULT_THING_TYPE=exports.DEFAULT_CONTEXT_LANGUAGE=exports.DEFAULT_CONTEXT_V11=exports.DEFAULT_CONTEXT_V1=void 0;exports.DEFAULT_CONTEXT_V1="https://www.w3.org/2019/wot/td/v1";exports.DEFAULT_CONTEXT_V11="https://www.w3.org/2022/wot/td/v1.1";exports.DEFAULT_CONTEXT_LANGUAGE="en";exports.DEFAULT_THING_TYPE="Thing";class Thing{constructor(){this["@context"]=[exports.DEFAULT_CONTEXT_V1,exports.DEFAULT_CONTEXT_V11];this["@type"]=exports.DEFAULT_THING_TYPE;this.title="";this.securityDefinitions={};this.security="";this.properties={};this.actions={};this.events={};this.links=[]}}exports.default=Thing;class Form{constructor(href,contentType){this.href=href;if(contentType)this.contentType=contentType}}exports.Form=Form;class BaseSchema{}exports.BaseSchema=BaseSchema;class ThingProperty extends BaseSchema{}exports.ThingProperty=ThingProperty;class ThingAction{}exports.ThingAction=ThingAction;class ThingEvent{}exports.ThingEvent=ThingEvent},{}],8:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}})}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.ThingModelHelpers=void 0;const ajv_1=__importDefault(require("ajv"));const http=__importStar(require("http"));const https=__importStar(require("https"));const fs=__importStar(require("fs"));const json_placeholder_replacer_1=require("json-placeholder-replacer");const tm_json_schema_validation_json_1=__importDefault(require("wot-thing-model-types/schema/tm-json-schema-validation.json"));const debug_1=__importDefault(require("debug"));const namespace="node-wot:td-tools:thing-model-helpers";const logDebug=(0,debug_1.default)(`${namespace}:debug`);const logError=(0,debug_1.default)(`${namespace}:error`);const tmSchema=tm_json_schema_validation_json_1.default;const ajv=new ajv_1.default({strict:false}).addFormat("iri-reference",/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i).addFormat("uri-reference",/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i).addFormat("uri",/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/).addFormat("json-pointer",/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/).addFormat("date-time",/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/);class ThingModelHelpers{constructor(_resolver){this.deps=[];this.resolver=undefined;if(_resolver){this.resolver=_resolver}}static isThingModel(_data){if(_data===null||_data===undefined){return false}if(!(typeof _data==="object")||Array.isArray(_data)){return false}const data=_data;if(Array.isArray(data["@type"])){const valid=data["@type"].filter((x=>x==="tm:ThingModel")).length>0;if(valid){return true}}else if(data["@type"]==="tm:ThingModel"){return true}if(Object.keys(this.getThingModelRef(data)).length>0){return true}if("links"in data&&Array.isArray(data.links)){const foundTmExtendsRel=data.links.find((link=>link.rel==="tm:extends"));if(foundTmExtendsRel)return true}if(data.properties!==undefined){if(this.isThingModel(data.properties))return true}if(data.actions!==undefined){if(this.isThingModel(data.actions))return true}if(data.events!==undefined){if(this.isThingModel(data.events))return true}return false}static getModelVersion(data){if("version"in data&&data.version&&typeof data.version==="object"&&"model"in data.version&&typeof data.version.model==="string"){return data.version.model}else{return undefined}}static validateThingModel(data){var _a;const isValid=ThingModelHelpers.tsSchemaValidator(data);let errors;if(!isValid){errors=(_a=ThingModelHelpers.tsSchemaValidator.errors)===null||_a===void 0?void 0:_a.map((o=>o.message)).join("\n")}return{valid:isValid,errors:errors}}getPartialTDs(model,options){return __awaiter(this,void 0,void 0,(function*(){const extendedModels=yield this._getPartialTDs(model,options);const extendedPartialTDs=extendedModels.map((_data=>{const data=_data;if(data["@type"]instanceof Array){data["@type"]=data["@type"].map((el=>{if(el==="tm:ThingModel"){return"Thing"}return el}))}else{data["@type"]="Thing"}return data}));return extendedPartialTDs}))}fetchModel(uri){return __awaiter(this,void 0,void 0,(function*(){this.addDependency(uri);let tm;if(this.resolver){tm=yield this.resolver.fetch(uri)}else{tm=yield this.localFetch(uri)}if(!ThingModelHelpers.isThingModel(tm)){throw new Error(`Data at ${uri} is not a Thing Model`)}return tm}))}localFetch(uri){const proto=uri.split("://")[0];switch(proto){case"file":{const file=uri.split("://")[1];return new Promise(((resolve,reject)=>{fs.readFile(file,{encoding:"utf-8"},(function(err,data){if(!err){resolve(JSON.parse(data))}else{reject(err)}}))}))}case"http":{return new Promise(((resolve,reject)=>{http.get(uri,(res=>{res.setEncoding("utf8");let rawData="";res.on("data",(chunk=>{rawData+=chunk}));res.on("end",(()=>{try{const parsedData=JSON.parse(rawData);logDebug(`https fetched: ${parsedData}`);resolve(parsedData)}catch(error){logError(error)}}))})).on("error",(e=>{reject(e)}))}))}case"https":{return new Promise(((resolve,reject)=>{https.get(uri,(res=>{res.setEncoding("utf8");let rawData="";res.on("data",(chunk=>{rawData+=chunk}));res.on("end",(()=>{try{const parsedData=JSON.parse(rawData);logDebug(`https fetched: ${parsedData}`);resolve(parsedData)}catch(error){logError(error)}}))})).on("error",(e=>{reject(e)}))}))}default:break}return null}_getPartialTDs(model,options){return __awaiter(this,void 0,void 0,(function*(){if(!ThingModelHelpers.isThingModel(model)){throw new Error(`${model} is not a Thing Model`)}let isValid=ThingModelHelpers.validateThingModel(model);if(isValid.valid===false||isValid.errors!==undefined){throw new Error(isValid.errors)}isValid=this.checkPlaceholderMap(model,options===null||options===void 0?void 0:options.map);if(isValid.valid===false||isValid.errors!==undefined){throw new Error(isValid.errors)}const modelInput=yield this.fetchAffordances(model);const extendedModels=yield this.composeModel(model,modelInput,options);return extendedModels}))}fetchAffordances(data){var _a;return __awaiter(this,void 0,void 0,(function*(){const modelInput={};const extLinks=ThingModelHelpers.getThingModelLinks(data,"tm:extends");if(extLinks.length>0){modelInput.extends=[];for(const s of extLinks){let source=yield this.fetchModel(s.href);[source]=yield this._getPartialTDs(source);modelInput.extends.push(source)}}const affordanceTypes=["properties","actions","events"];modelInput.imports=[];for(const affType of affordanceTypes){const affRefs=ThingModelHelpers.getThingModelRef(data[affType]);if(Object.keys(affRefs).length>0){for(const aff in affRefs){const affUri=affRefs[aff];const refObj=this.parseTmRef(affUri);if(!refObj.uri){throw new Error(`Missing remote path in ${affUri}`)}let source=yield this.fetchModel(refObj.uri);[source]=yield this._getPartialTDs(source);delete data[affType][aff]["tm:ref"];const importedAffordance=(_a=this.getRefAffordance(refObj,source))!==null&&_a!==void 0?_a:{};refObj.name=aff;modelInput.imports.push(Object.assign({affordance:importedAffordance},refObj))}}}const tmLinks=ThingModelHelpers.getThingModelLinks(data,"tm:submodel");if(tmLinks.length>0){modelInput.submodel={};for(const l of tmLinks){const submodel=yield this.fetchModel(l.href);modelInput.submodel[l.href]=submodel}}return modelInput}))}composeModel(data,modelObject,options){var _a,_b,_c,_d,_e;return __awaiter(this,void 0,void 0,(function*(){let tmpThingModels=[];const title=((_a=data.title)!==null&&_a!==void 0?_a:"").replace(/ /g,"");if(!options){options={}}if(!options.baseUrl){options.baseUrl="."}const newTMHref=this.returnNewTMHref(options.baseUrl,title);const newTDHref=this.returnNewTDHref(options.baseUrl,title);if("extends"in modelObject){const extendObjs=(_b=modelObject.extends)!==null&&_b!==void 0?_b:[];for(const extendObj of extendObjs){data=ThingModelHelpers.extendThingModel(extendObj,data)}data.links=(_c=data.links)===null||_c===void 0?void 0:_c.filter((link=>link.rel!=="tm:extends"))}if("imports"in modelObject){const importObjs=(_d=modelObject.imports)!==null&&_d!==void 0?_d:[];for(const importedObj of importObjs){data=ThingModelHelpers.importAffordance(importedObj.type,importedObj.name,importedObj.affordance,data)}}if("submodel"in modelObject){const submodelObj=modelObject.submodel;for(const key in submodelObj){const sub=submodelObj[key];if(options.selfComposition){if(!data.links){throw new Error("You used self composition but links are missing; they are needed to extract the instance name")}const index=data.links.findIndex((el=>el.href===key));const el=data.links[index];const instanceName=el.instanceName;if(!instanceName){throw new Error("Self composition is not possible without instance names")}const[subPartialTD]=yield this._getPartialTDs(sub,options);const affordanceTypes=["properties","actions","events"];for(const affType of affordanceTypes){for(const affKey in subPartialTD[affType]){const newAffKey=`${instanceName}_${affKey}`;if(!(affType in data)){data[affType]={}}data[affType][newAffKey]=subPartialTD[affType][affKey]}}}else{const subTitle=((_e=sub.title)!==null&&_e!==void 0?_e:"").replace(/ /g,"");const subNewHref=this.returnNewTDHref(options.baseUrl,subTitle);if(!sub.links){sub.links=[]}sub.links.push({rel:"collection",href:newTDHref,type:"application/td+json"});const tmpPartialSubTDs=yield this._getPartialTDs(sub,options);tmpThingModels.push(...tmpPartialSubTDs);data=ThingModelHelpers.formatSubmodelLink(data,key,subNewHref)}}}if(!data.links||options.selfComposition){data.links=[]}data.links.push({rel:"type",href:newTMHref,type:"application/tm+json"});if("version"in data){delete data.version}if(options.map){data=this.fillPlaceholder(data,options.map)}tmpThingModels.unshift(data);tmpThingModels=tmpThingModels.map((el=>this.fillPlaceholder(el,options===null||options===void 0?void 0:options.map)));if(this.deps.length>0){this.removeDependency()}return tmpThingModels}))}static getThingModelRef(data){const refs={};if(!data){return refs}for(const key in data){for(const key1 in data[key]){if(key1==="tm:ref"){refs[key]=data[key]["tm:ref"]}}}return refs}static getThingModelLinks(data,type){let links=[];if("links"in data&&Array.isArray(data.links)){links=data.links}return links.filter((el=>el.rel===type))}static extendThingModel(source,dest){let extendedModel={};const properties=source.properties;const actions=source.actions;const events=source.events;extendedModel=Object.assign(Object.assign({},source),dest);if(properties){if(!extendedModel.properties){extendedModel.properties={}}for(const key in properties){if(dest.properties&&dest.properties[key]){extendedModel.properties[key]=Object.assign(Object.assign({},properties[key]),dest.properties[key])}else{extendedModel.properties[key]=properties[key]}}}if(actions){if(!extendedModel.actions){extendedModel.actions={}}for(const key in actions){if(dest.actions&&key in dest.actions){extendedModel.actions[key]=Object.assign(Object.assign({},actions[key]),dest.actions[key])}else{extendedModel.actions[key]=actions[key]}}}if(events){if(!extendedModel.events){extendedModel.events={}}for(const key in events){if(dest.events&&key in dest.events){extendedModel.events[key]=Object.assign(Object.assign({},events[key]),dest.events[key])}else{extendedModel.events[key]=events[key]}}}return extendedModel}static importAffordance(affordanceType,affordanceName,source,dest){if(!dest[affordanceType]){dest[affordanceType]={}}const d=dest[affordanceType][affordanceName];dest[affordanceType][affordanceName]=Object.assign(Object.assign({},source),d);for(const key in dest[affordanceType][affordanceName]){if(dest[affordanceType][affordanceName][key]===undefined){delete dest[affordanceType][affordanceName][key]}}return dest}static formatSubmodelLink(source,oldHref,newHref){if(!source.links){throw new Error("Links are missing")}const index=source.links.findIndex((el=>el.href===oldHref));if(index===-1){throw new Error("Link not found")}const el=source.links[index];if("instanceName"in el){delete el.instanceName}source.links[index]=Object.assign(Object.assign({},el),{href:newHref,type:"application/td+json",rel:"item"});return source}parseTmRef(value){const thingModelUri=value.split("#")[0];const affordaceUri=value.split("#")[1];const affordaceType=affordaceUri.split("/")[1];const affordaceName=affordaceUri.split("/")[2];return{uri:thingModelUri,type:affordaceType,name:affordaceName}}getRefAffordance(obj,thing){const affordanceType=obj.type;const affordanceKey=obj.name;if(!(affordanceType in thing)){return undefined}const affordances=thing[affordanceType];if(!(affordanceKey in affordances)){return undefined}return affordances[affordanceKey]}fillPlaceholder(data,map={}){const placeHolderReplacer=new json_placeholder_replacer_1.JsonPlaceholderReplacer;placeHolderReplacer.addVariableMap(map);return placeHolderReplacer.replace(data)}checkPlaceholderMap(model,map={}){const regex="{{.*?}}";const modelString=JSON.stringify(model);let keys=modelString.match(new RegExp(regex,"g"))||[];keys=keys.map((el=>el.replace("{{","").replace("}}","")));let isValid=true;let errors;if(keys&&keys.length>0&&(map===undefined||map===null)){isValid=false;errors=`No map provided for model ${model.title}`}else if(keys.length>0){keys.every((key=>{if(!(key in map)){errors=`Missing required fields in map for model ${model.title}`;isValid=false;return false}return true}))}return{valid:isValid,errors:errors}}returnNewTMHref(baseUrl,tdname){return`${baseUrl}/${tdname}.tm.jsonld`}returnNewTDHref(baseUrl,tdname){return`${baseUrl}/${tdname}.td.jsonld`}addDependency(dep){if(this.deps.indexOf(dep)>-1){throw new Error(`Circular dependency found for ${dep}`)}this.deps.push(dep)}removeDependency(dep){if(dep){this.deps=this.deps.filter((el=>el!==dep))}else{this.deps.pop()}}}exports.ThingModelHelpers=ThingModelHelpers;ThingModelHelpers.tsSchemaValidator=ajv.compile(tmSchema)},{ajv:10,debug:178,fs:149,http:401,https:277,"json-placeholder-replacer":315,"wot-thing-model-types/schema/tm-json-schema-validation.json":444}],9:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.AssetInterfaceDescriptionUtil=void 0;const debug_1=__importDefault(require("debug"));const namespace="node-wot:td-tools:asset-interface-description-util";const logDebug=(0,debug_1.default)(`${namespace}:debug`);const logInfo=(0,debug_1.default)(`${namespace}:info`);const noSecSS={scheme:"nosec"};const noSecName=0+"_sc";class AssetInterfaceDescriptionUtil{getBaseFromEndpointMetadata(endpointMetadata){if((endpointMetadata===null||endpointMetadata===void 0?void 0:endpointMetadata.value)&&endpointMetadata.value instanceof Array){for(const v of endpointMetadata.value){if(v.idShort==="base"){return v.value}}}return"undefined"}getContentTypeFromEndpointMetadata(endpointMetadata){if((endpointMetadata===null||endpointMetadata===void 0?void 0:endpointMetadata.value)&&endpointMetadata.value instanceof Array){for(const v of endpointMetadata.value){if(v.idShort==="contentType"){return v.value}}}return""}getSecuritySchemesFromEndpointMetadata(endpointMetadata){if((endpointMetadata===null||endpointMetadata===void 0?void 0:endpointMetadata.value)&&endpointMetadata.value instanceof Array){for(const v of endpointMetadata.value){if(v.idShort==="securityDefinitions"){const securitySchemes=[];if(v.value&&v.value instanceof Array){for(const secValue of v.value){const ss={scheme:secValue.idShort};securitySchemes.push(ss);if(secValue.value&&secValue.value instanceof Array){for(const v of secValue.value){if(v.idShort&&typeof v.idShort==="string"&&v.idShort.length>0&&v.value){ss[v.idShort]=v.value}}}}}return securitySchemes}}}return undefined}createInteractionForm(vi,addSecurity){const form={href:this.getBaseFromEndpointMetadata(vi.endpointMetadata),contentType:this.getContentTypeFromEndpointMetadata(vi.endpointMetadata)};if(addSecurity){const securitySchemes=this.getSecuritySchemesFromEndpointMetadata(vi.endpointMetadata);if(securitySchemes===undefined){form.security=[noSecName]}else{if(vi.secNamesForEndpoint){form.security=vi.secNamesForEndpoint}}}if(vi.interaction.value instanceof Array){for(const v of vi.interaction.value){if(v.idShort==="href"){if(form.href&&form.href.length>0){form.href=form.href+v.value}else{form.href=v.value}}else if(typeof v.idShort==="string"&&v.idShort.length>0){if(v.value){form[v.idShort]=v.value;if(v.valueType&&v.valueType&&v.valueType.dataObjectType&&v.valueType.dataObjectType.name&&typeof v.valueType.dataObjectType.name==="string"){switch(v.valueType.dataObjectType.name){case"boolean":form[v.idShort]=form[v.idShort]==="true";break;case"float":case"double":case"decimal":case"integer":case"nonPositiveInteger":case"negativeInteger":case"long":case"int":case"short":case"byte":case"nonNegativeInteger":case"unsignedLong":case"unsignedInt":case"unsignedShort":case"unsignedByte":case"positiveInteger":form[v.idShort]=Number(form[v.idShort]);break}}}}}}return form}processSubmodel(smInformation,submodel,submodelRegex){if(submodel instanceof Object&&submodel.idShort&&submodel.idShort==="AssetInterfaceDescription"){if(submodel.submodelElements&&submodel.submodelElements instanceof Array){for(const submodelElement of submodel.submodelElements){if(submodelElement instanceof Object){logDebug("SubmodelElement.idShort: "+submodelElement.idShort);if(submodelRegex&&typeof submodelRegex==="string"&&submodelRegex.length>0){const regex=new RegExp(submodelRegex);if(!regex.test(submodelElement.idShort)){logInfo("submodel not of interest");continue}}this.processSubmodelElement(smInformation,submodelElement)}}}}}processSubmodelElement(smInformation,submodelElement){var _a,_b,_c;if(submodelElement.value&&submodelElement.value instanceof Array){let endpointMetadata={};for(const smValue of submodelElement.value){if(smValue instanceof Object){if(smValue.idShort==="EndpointMetadata"){logInfo("EndpointMetadata");endpointMetadata=smValue;smInformation.endpointMetadataArray.push(endpointMetadata)}}}for(const smValue of submodelElement.value){if(smValue instanceof Object){if(smValue.idShort==="InterfaceMetadata"){logInfo("InterfaceMetadata");if(smValue.value&&smValue.value instanceof Array){for(const interactionValue of smValue.value){if(interactionValue.idShort==="Properties"){if(interactionValue.value instanceof Array){for(const iValue of interactionValue.value){logInfo("Property: "+iValue.idShort);if(!smInformation.properties.has(iValue.idShort)){smInformation.properties.set(iValue.idShort,[])}const propInter={endpointMetadata:endpointMetadata,interaction:iValue};(_a=smInformation.properties.get(iValue.idShort))===null||_a===void 0?void 0:_a.push(propInter)}}}else if(interactionValue.idShort==="Operations"){if(interactionValue.value instanceof Array){for(const iValue of interactionValue.value){logInfo("Action: "+iValue.idShort);if(!smInformation.actions.has(iValue.idShort)){smInformation.actions.set(iValue.idShort,[])}const actInter={endpointMetadata:endpointMetadata,interaction:iValue};(_b=smInformation.actions.get(iValue.idShort))===null||_b===void 0?void 0:_b.push(actInter)}}}else if(interactionValue.idShort==="Events"){if(interactionValue.value instanceof Array){for(const iValue of interactionValue.value){logInfo("Event: "+iValue.idShort);if(!smInformation.events.has(iValue.idShort)){smInformation.events.set(iValue.idShort,[])}const evInter={endpointMetadata:endpointMetadata,interaction:iValue};(_c=smInformation.events.get(iValue.idShort))===null||_c===void 0?void 0:_c.push(evInter)}}}}}}}}}}getSubmodelInformation(aas,submodelRegex){const aidModel=JSON.parse(aas);const smInformation={actions:new Map,events:new Map,properties:new Map,endpointMetadataArray:[]};if(aidModel instanceof Object&&aidModel.submodels){if(aidModel.submodels instanceof Array){for(const submodel of aidModel.submodels){this.processSubmodel(smInformation,submodel,submodelRegex)}}}return smInformation}_transform(smInformation,template){const thing=template?JSON.parse(template):{};if(!thing["@context"]){thing["@context"]="https://www.w3.org/2022/wot/td/v1.1"}if(!thing.title){thing.title="?TODO?"}if(!thing.securityDefinitions){thing.securityDefinitions={}}let cnt=1;const secSchemeNamesAll=new Array;const secNamesForEndpointMetadata=new Map;for(const endpointMetadata of smInformation.endpointMetadataArray){const secNames=[];const securitySchemes=this.getSecuritySchemesFromEndpointMetadata(endpointMetadata);if(securitySchemes===undefined){thing.securityDefinitions[noSecName]=noSecSS;secSchemeNamesAll.push(noSecName);secNames.push(noSecName)}else{for(const secScheme of securitySchemes){const secName=cnt+"_sc";thing.securityDefinitions[secName]=secScheme;secSchemeNamesAll.push(secName);secNames.push(secName);cnt++}}secNamesForEndpointMetadata.set(endpointMetadata,secNames)}if(secSchemeNamesAll.length===0){thing.securityDefinitions.nosec_sc=noSecSS;thing.security=[noSecName]}else{thing.security=secSchemeNamesAll}logDebug("########### PROPERTIES ("+smInformation.properties.size+")");if(smInformation.properties.size>0){thing.properties={};for(const entry of smInformation.properties.entries()){const key=entry[0];const value=entry[1];logInfo("Property"+key+" = "+value);thing.properties[key]={};thing.properties[key].forms=[];for(const vi of value){if(vi.endpointMetadata){vi.secNamesForEndpoint=secNamesForEndpointMetadata.get(vi.endpointMetadata)}const form=this.createInteractionForm(vi,smInformation.endpointMetadataArray.length>1);thing.properties[key].forms.push(form)}}}logDebug("########### ACTIONS ("+smInformation.actions.size+")");if(smInformation.actions.size>0){thing.actions={};for(const entry of smInformation.actions.entries()){const key=entry[0];const value=entry[1];logInfo("Action"+key+" = "+value);thing.actions[key]={};thing.actions[key].forms=[];for(const vi of value){if(vi.endpointMetadata){vi.secNamesForEndpoint=secNamesForEndpointMetadata.get(vi.endpointMetadata)}const form=this.createInteractionForm(vi,smInformation.endpointMetadataArray.length>1);thing.properties[key].forms.push(form)}}}logDebug("########### EVENTS ("+smInformation.events.size+")");if(smInformation.events.size>0){thing.events={};for(const entry of smInformation.events.entries()){const key=entry[0];const value=entry[1];logInfo("Event "+key+" = "+value);thing.events[key]={};thing.events[key].forms=[];for(const vi of value){if(vi.endpointMetadata){vi.secNamesForEndpoint=secNamesForEndpointMetadata.get(vi.endpointMetadata)}const form=this.createInteractionForm(vi,smInformation.endpointMetadataArray.length>1);thing.properties[key].forms.push(form)}}}return JSON.stringify(thing)}transformToTD(aid,template,submodelRegex){return this.transformAAS2TD(aid,submodelRegex)}transformAAS2TD(aas,template,submodelRegex){const smInformation=this.getSubmodelInformation(aas,submodelRegex);return this._transform(smInformation,template)}transformSM2TD(aid,template,submodelRegex){const submodel=JSON.parse(aid);const smInformation={actions:new Map,events:new Map,properties:new Map,endpointMetadataArray:[]};this.processSubmodel(smInformation,submodel,submodelRegex);return this._transform(smInformation,template)}}exports.AssetInterfaceDescriptionUtil=AssetInterfaceDescriptionUtil},{debug:178}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CodeGen=exports.Name=exports.nil=exports.stringify=exports.str=exports._=exports.KeywordCxt=void 0;const context_1=require("./compile/context");exports.KeywordCxt=context_1.default;var codegen_1=require("./compile/codegen");Object.defineProperty(exports,"_",{enumerable:true,get:function(){return codegen_1._}});Object.defineProperty(exports,"str",{enumerable:true,get:function(){return codegen_1.str}});Object.defineProperty(exports,"stringify",{enumerable:true,get:function(){return codegen_1.stringify}});Object.defineProperty(exports,"nil",{enumerable:true,get:function(){return codegen_1.nil}});Object.defineProperty(exports,"Name",{enumerable:true,get:function(){return codegen_1.Name}});Object.defineProperty(exports,"CodeGen",{enumerable:true,get:function(){return codegen_1.CodeGen}});const core_1=require("./core");const draft7_1=require("./vocabularies/draft7");const draft7MetaSchema=require("./refs/json-schema-draft-07.json");const META_SUPPORT_DATA=["/properties"];const META_SCHEMA_ID="http://json-schema.org/draft-07/schema";class Ajv extends core_1.default{_addVocabularies(){super._addVocabularies();draft7_1.default.forEach((v=>this.addVocabulary(v)))}_addDefaultMetaSchema(){super._addDefaultMetaSchema();if(!this.opts.meta)return;const metaSchema=this.opts.$data?this.$dataMetaSchema(draft7MetaSchema,META_SUPPORT_DATA):draft7MetaSchema;this.addMetaSchema(metaSchema,META_SCHEMA_ID,false);this.refs["http://json-schema.org/schema"]=META_SCHEMA_ID}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(META_SCHEMA_ID)?META_SCHEMA_ID:undefined)}}exports.default=Ajv},{"./compile/codegen":12,"./compile/context":14,"./core":31,"./refs/json-schema-draft-07.json":33,"./vocabularies/draft7":53}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getProperty=exports.safeStringify=exports.stringify=exports.strConcat=exports.addCodeArg=exports.str=exports._=exports.nil=exports._Code=exports.Name=exports.IDENTIFIER=exports._CodeOrName=void 0;class _CodeOrName{}exports._CodeOrName=_CodeOrName;exports.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class Name extends _CodeOrName{constructor(s){super();if(!exports.IDENTIFIER.test(s))throw new Error("CodeGen: name must be a valid identifier");this.str=s}toString(){return this.str}emptyStr(){return false}get names(){return{[this.str]:1}}}exports.Name=Name;class _Code extends _CodeOrName{constructor(code){super();this._items=typeof code==="string"?[code]:code}toString(){return this.str}emptyStr(){if(this._items.length>1)return false;const item=this._items[0];return item===""||item==='""'}get str(){var _a;return(_a=this._str)!==null&&_a!==void 0?_a:this._str=this._items.reduce(((s,c)=>`${s}${c}`),"")}get names(){var _a;return(_a=this._names)!==null&&_a!==void 0?_a:this._names=this._items.reduce(((names,c)=>{if(c instanceof Name)names[c.str]=(names[c.str]||0)+1;return names}),{})}}exports._Code=_Code;exports.nil=new _Code("");function _(strs,...args){const code=[strs[0]];let i=0;while(i<args.length){addCodeArg(code,args[i]);code.push(strs[++i])}return new _Code(code)}exports._=_;const plus=new _Code("+");function str(strs,...args){const expr=[safeStringify(strs[0])];let i=0;while(i<args.length){expr.push(plus);addCodeArg(expr,args[i]);expr.push(plus,safeStringify(strs[++i]))}optimize(expr);return new _Code(expr)}exports.str=str;function addCodeArg(code,arg){if(arg instanceof _Code)code.push(...arg._items);else if(arg instanceof Name)code.push(arg);else code.push(interpolate(arg))}exports.addCodeArg=addCodeArg;function optimize(expr){let i=1;while(i<expr.length-1){if(expr[i]===plus){const res=mergeExprItems(expr[i-1],expr[i+1]);if(res!==undefined){expr.splice(i-1,3,res);continue}expr[i++]="+"}i++}}function mergeExprItems(a,b){if(b==='""')return a;if(a==='""')return b;if(typeof a=="string"){if(b instanceof Name||a[a.length-1]!=='"')return;if(typeof b!="string")return`${a.slice(0,-1)}${b}"`;if(b[0]==='"')return a.slice(0,-1)+b.slice(1);return}if(typeof b=="string"&&b[0]==='"'&&!(a instanceof Name))return`"${a}${b.slice(1)}`;return}function strConcat(c1,c2){return c2.emptyStr()?c1:c1.emptyStr()?c2:str`${c1}${c2}`}exports.strConcat=strConcat;function interpolate(x){return typeof x=="number"||typeof x=="boolean"||x===null?x:safeStringify(Array.isArray(x)?x.join(","):x)}function stringify(x){return new _Code(safeStringify(x))}exports.stringify=stringify;function safeStringify(x){return JSON.stringify(x).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}exports.safeStringify=safeStringify;function getProperty(key){return typeof key=="string"&&exports.IDENTIFIER.test(key)?new _Code(`.${key}`):_`[${key}]`}exports.getProperty=getProperty},{}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.or=exports.and=exports.not=exports.CodeGen=exports.operators=exports.varKinds=exports.ValueScopeName=exports.ValueScope=exports.Scope=exports.Name=exports.stringify=exports.getProperty=exports.nil=exports.strConcat=exports.str=exports._=void 0;const code_1=require("./code");const scope_1=require("./scope");var code_2=require("./code");Object.defineProperty(exports,"_",{enumerable:true,get:function(){return code_2._}});Object.defineProperty(exports,"str",{enumerable:true,get:function(){return code_2.str}});Object.defineProperty(exports,"strConcat",{enumerable:true,get:function(){return code_2.strConcat}});Object.defineProperty(exports,"nil",{enumerable:true,get:function(){return code_2.nil}});Object.defineProperty(exports,"getProperty",{enumerable:true,get:function(){return code_2.getProperty}});Object.defineProperty(exports,"stringify",{enumerable:true,get:function(){return code_2.stringify}});Object.defineProperty(exports,"Name",{enumerable:true,get:function(){return code_2.Name}});var scope_2=require("./scope");Object.defineProperty(exports,"Scope",{enumerable:true,get:function(){return scope_2.Scope}});Object.defineProperty(exports,"ValueScope",{enumerable:true,get:function(){return scope_2.ValueScope}});Object.defineProperty(exports,"ValueScopeName",{enumerable:true,get:function(){return scope_2.ValueScopeName}});Object.defineProperty(exports,"varKinds",{enumerable:true,get:function(){return scope_2.varKinds}});exports.operators={GT:new code_1._Code(">"),GTE:new code_1._Code(">="),LT:new code_1._Code("<"),LTE:new code_1._Code("<="),EQ:new code_1._Code("==="),NEQ:new code_1._Code("!=="),NOT:new code_1._Code("!"),OR:new code_1._Code("||"),AND:new code_1._Code("&&"),ADD:new code_1._Code("+")};class Node{optimizeNodes(){return this}optimizeNames(_names,_constants){return this}}class Def extends Node{constructor(varKind,name,rhs){super();this.varKind=varKind;this.name=name;this.rhs=rhs}render({es5:es5,_n:_n}){const varKind=es5?scope_1.varKinds.var:this.varKind;const rhs=this.rhs===undefined?"":` = ${this.rhs}`;return`${varKind} ${this.name}${rhs};`+_n}optimizeNames(names,constants){if(!names[this.name.str])return;if(this.rhs)this.rhs=optimizeExpr(this.rhs,names,constants);return this}get names(){return this.rhs instanceof code_1._CodeOrName?this.rhs.names:{}}}class Assign extends Node{constructor(lhs,rhs,sideEffects){super();this.lhs=lhs;this.rhs=rhs;this.sideEffects=sideEffects}render({_n:_n}){return`${this.lhs} = ${this.rhs};`+_n}optimizeNames(names,constants){if(this.lhs instanceof code_1.Name&&!names[this.lhs.str]&&!this.sideEffects)return;this.rhs=optimizeExpr(this.rhs,names,constants);return this}get names(){const names=this.lhs instanceof code_1.Name?{}:{...this.lhs.names};return addExprNames(names,this.rhs)}}class AssignOp extends Assign{constructor(lhs,op,rhs,sideEffects){super(lhs,rhs,sideEffects);this.op=op}render({_n:_n}){return`${this.lhs} ${this.op}= ${this.rhs};`+_n}}class Label extends Node{constructor(label){super();this.label=label;this.names={}}render({_n:_n}){return`${this.label}:`+_n}}class Break extends Node{constructor(label){super();this.label=label;this.names={}}render({_n:_n}){const label=this.label?` ${this.label}`:"";return`break${label};`+_n}}class Throw extends Node{constructor(error){super();this.error=error}render({_n:_n}){return`throw ${this.error};`+_n}get names(){return this.error.names}}class AnyCode extends Node{constructor(code){super();this.code=code}render({_n:_n}){return`${this.code};`+_n}optimizeNodes(){return`${this.code}`?this:undefined}optimizeNames(names,constants){this.code=optimizeExpr(this.code,names,constants);return this}get names(){return this.code instanceof code_1._CodeOrName?this.code.names:{}}}class ParentNode extends Node{constructor(nodes=[]){super();this.nodes=nodes}render(opts){return this.nodes.reduce(((code,n)=>code+n.render(opts)),"")}optimizeNodes(){const{nodes:nodes}=this;let i=nodes.length;while(i--){const n=nodes[i].optimizeNodes();if(Array.isArray(n))nodes.splice(i,1,...n);else if(n)nodes[i]=n;else nodes.splice(i,1)}return nodes.length>0?this:undefined}optimizeNames(names,constants){const{nodes:nodes}=this;let i=nodes.length;while(i--){const n=nodes[i];if(n.optimizeNames(names,constants))continue;subtractNames(names,n.names);nodes.splice(i,1)}return nodes.length>0?this:undefined}get names(){return this.nodes.reduce(((names,n)=>addNames(names,n.names)),{})}}class BlockNode extends ParentNode{render(opts){return"{"+opts._n+super.render(opts)+"}"+opts._n}}class Root extends ParentNode{}class Else extends BlockNode{}Else.kind="else";class If extends BlockNode{constructor(condition,nodes){super(nodes);this.condition=condition}render(opts){let code=`if(${this.condition})`+super.render(opts);if(this.else)code+="else "+this.else.render(opts);return code}optimizeNodes(){super.optimizeNodes();const cond=this.condition;if(cond===true)return this.nodes;let e=this.else;if(e){const ns=e.optimizeNodes();e=this.else=Array.isArray(ns)?new Else(ns):ns}if(e){if(cond===false)return e instanceof If?e:e.nodes;if(this.nodes.length)return this;return new If(not(cond),e instanceof If?[e]:e.nodes)}if(cond===false||!this.nodes.length)return undefined;return this}optimizeNames(names,constants){var _a;this.else=(_a=this.else)===null||_a===void 0?void 0:_a.optimizeNames(names,constants);if(!(super.optimizeNames(names,constants)||this.else))return;this.condition=optimizeExpr(this.condition,names,constants);return this}get names(){const names=super.names;addExprNames(names,this.condition);if(this.else)addNames(names,this.else.names);return names}}If.kind="if";class For extends BlockNode{}For.kind="for";class ForLoop extends For{constructor(iteration){super();this.iteration=iteration}render(opts){return`for(${this.iteration})`+super.render(opts)}optimizeNames(names,constants){if(!super.optimizeNames(names,constants))return;this.iteration=optimizeExpr(this.iteration,names,constants);return this}get names(){return addNames(super.names,this.iteration.names)}}class ForRange extends For{constructor(varKind,name,from,to){super();this.varKind=varKind;this.name=name;this.from=from;this.to=to}render(opts){const varKind=opts.es5?scope_1.varKinds.var:this.varKind;const{name:name,from:from,to:to}=this;return`for(${varKind} ${name}=${from}; ${name}<${to}; ${name}++)`+super.render(opts)}get names(){const names=addExprNames(super.names,this.from);return addExprNames(names,this.to)}}class ForIter extends For{constructor(loop,varKind,name,iterable){super();this.loop=loop;this.varKind=varKind;this.name=name;this.iterable=iterable}render(opts){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(opts)}optimizeNames(names,constants){if(!super.optimizeNames(names,constants))return;this.iterable=optimizeExpr(this.iterable,names,constants);return this}get names(){return addNames(super.names,this.iterable.names)}}class Func extends BlockNode{constructor(name,args,async){super();this.name=name;this.args=args;this.async=async}render(opts){const _async=this.async?"async ":"";return`${_async}function ${this.name}(${this.args})`+super.render(opts)}}Func.kind="func";class Return extends ParentNode{render(opts){return"return "+super.render(opts)}}Return.kind="return";class Try extends BlockNode{render(opts){let code="try"+super.render(opts);if(this.catch)code+=this.catch.render(opts);if(this.finally)code+=this.finally.render(opts);return code}optimizeNodes(){var _a,_b;super.optimizeNodes();(_a=this.catch)===null||_a===void 0?void 0:_a.optimizeNodes();(_b=this.finally)===null||_b===void 0?void 0:_b.optimizeNodes();return this}optimizeNames(names,constants){var _a,_b;super.optimizeNames(names,constants);(_a=this.catch)===null||_a===void 0?void 0:_a.optimizeNames(names,constants);(_b=this.finally)===null||_b===void 0?void 0:_b.optimizeNames(names,constants);return this}get names(){const names=super.names;if(this.catch)addNames(names,this.catch.names);if(this.finally)addNames(names,this.finally.names);return names}}class Catch extends BlockNode{constructor(error){super();this.error=error}render(opts){return`catch(${this.error})`+super.render(opts)}}Catch.kind="catch";class Finally extends BlockNode{render(opts){return"finally"+super.render(opts)}}Finally.kind="finally";class CodeGen{constructor(extScope,opts={}){this._values={};this._blockStarts=[];this._constants={};this.opts={...opts,_n:opts.lines?"\n":""};this._extScope=extScope;this._scope=new scope_1.Scope({parent:extScope});this._nodes=[new Root]}toString(){return this._root.render(this.opts)}name(prefix){return this._scope.name(prefix)}scopeName(prefix){return this._extScope.name(prefix)}scopeValue(prefixOrName,value){const name=this._extScope.value(prefixOrName,value);const vs=this._values[name.prefix]||(this._values[name.prefix]=new Set);vs.add(name);return name}getScopeValue(prefix,keyOrRef){return this._extScope.getValue(prefix,keyOrRef)}scopeRefs(scopeName){return this._extScope.scopeRefs(scopeName,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(varKind,nameOrPrefix,rhs,constant){const name=this._scope.toName(nameOrPrefix);if(rhs!==undefined&&constant)this._constants[name.str]=rhs;this._leafNode(new Def(varKind,name,rhs));return name}const(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.const,nameOrPrefix,rhs,_constant)}let(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.let,nameOrPrefix,rhs,_constant)}var(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.var,nameOrPrefix,rhs,_constant)}assign(lhs,rhs,sideEffects){return this._leafNode(new Assign(lhs,rhs,sideEffects))}add(lhs,rhs){return this._leafNode(new AssignOp(lhs,exports.operators.ADD,rhs))}code(c){if(typeof c=="function")c();else if(c!==code_1.nil)this._leafNode(new AnyCode(c));return this}object(...keyValues){const code=["{"];for(const[key,value]of keyValues){if(code.length>1)code.push(",");code.push(key);if(key!==value||this.opts.es5){code.push(":");code_1.addCodeArg(code,value)}}code.push("}");return new code_1._Code(code)}if(condition,thenBody,elseBody){this._blockNode(new If(condition));if(thenBody&&elseBody){this.code(thenBody).else().code(elseBody).endIf()}else if(thenBody){this.code(thenBody).endIf()}else if(elseBody){throw new Error('CodeGen: "else" body without "then" body')}return this}elseIf(condition){return this._elseNode(new If(condition))}else(){return this._elseNode(new Else)}endIf(){return this._endBlockNode(If,Else)}_for(node,forBody){this._blockNode(node);if(forBody)this.code(forBody).endFor();return this}for(iteration,forBody){return this._for(new ForLoop(iteration),forBody)}forRange(nameOrPrefix,from,to,forBody,varKind=(this.opts.es5?scope_1.varKinds.var:scope_1.varKinds.let)){const name=this._scope.toName(nameOrPrefix);return this._for(new ForRange(varKind,name,from,to),(()=>forBody(name)))}forOf(nameOrPrefix,iterable,forBody,varKind=scope_1.varKinds.const){const name=this._scope.toName(nameOrPrefix);if(this.opts.es5){const arr=iterable instanceof code_1.Name?iterable:this.var("_arr",iterable);return this.forRange("_i",0,code_1._`${arr}.length`,(i=>{this.var(name,code_1._`${arr}[${i}]`);forBody(name)}))}return this._for(new ForIter("of",varKind,name,iterable),(()=>forBody(name)))}forIn(nameOrPrefix,obj,forBody,varKind=(this.opts.es5?scope_1.varKinds.var:scope_1.varKinds.const)){if(this.opts.ownProperties){return this.forOf(nameOrPrefix,code_1._`Object.keys(${obj})`,forBody)}const name=this._scope.toName(nameOrPrefix);return this._for(new ForIter("in",varKind,name,obj),(()=>forBody(name)))}endFor(){return this._endBlockNode(For)}label(label){return this._leafNode(new Label(label))}break(label){return this._leafNode(new Break(label))}return(value){const node=new Return;this._blockNode(node);this.code(value);if(node.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Return)}try(tryBody,catchCode,finallyCode){if(!catchCode&&!finallyCode)throw new Error('CodeGen: "try" without "catch" and "finally"');const node=new Try;this._blockNode(node);this.code(tryBody);if(catchCode){const error=this.name("e");this._currNode=node.catch=new Catch(error);catchCode(error)}if(finallyCode){this._currNode=node.finally=new Finally;this.code(finallyCode)}return this._endBlockNode(Catch,Finally)}throw(error){return this._leafNode(new Throw(error))}block(body,nodeCount){this._blockStarts.push(this._nodes.length);if(body)this.code(body).endBlock(nodeCount);return this}endBlock(nodeCount){const len=this._blockStarts.pop();if(len===undefined)throw new Error("CodeGen: not in self-balancing block");const toClose=this._nodes.length-len;if(toClose<0||nodeCount!==undefined&&toClose!==nodeCount){throw new Error(`CodeGen: wrong number of nodes: ${toClose} vs ${nodeCount} expected`)}this._nodes.length=len;return this}func(name,args=code_1.nil,async,funcBody){this._blockNode(new Func(name,args,async));if(funcBody)this.code(funcBody).endFunc();return this}endFunc(){return this._endBlockNode(Func)}optimize(n=1){while(n-- >0){this._root.optimizeNodes();this._root.optimizeNames(this._root.names,this._constants)}}_leafNode(node){this._currNode.nodes.push(node);return this}_blockNode(node){this._currNode.nodes.push(node);this._nodes.push(node)}_endBlockNode(N1,N2){const n=this._currNode;if(n instanceof N1||N2&&n instanceof N2){this._nodes.pop();return this}throw new Error(`CodeGen: not in block "${N2?`${N1.kind}/${N2.kind}`:N1.kind}"`)}_elseNode(node){const n=this._currNode;if(!(n instanceof If)){throw new Error('CodeGen: "else" without "if"')}this._currNode=n.else=node;return this}get _root(){return this._nodes[0]}get _currNode(){const ns=this._nodes;return ns[ns.length-1]}set _currNode(node){const ns=this._nodes;ns[ns.length-1]=node}}exports.CodeGen=CodeGen;function addNames(names,from){for(const n in from)names[n]=(names[n]||0)+(from[n]||0);return names}function addExprNames(names,from){return from instanceof code_1._CodeOrName?addNames(names,from.names):names}function optimizeExpr(expr,names,constants){if(expr instanceof code_1.Name)return replaceName(expr);if(!canOptimize(expr))return expr;return new code_1._Code(expr._items.reduce(((items,c)=>{if(c instanceof code_1.Name)c=replaceName(c);if(c instanceof code_1._Code)items.push(...c._items);else items.push(c);return items}),[]));function replaceName(n){const c=constants[n.str];if(c===undefined||names[n.str]!==1)return n;delete names[n.str];return c}function canOptimize(e){return e instanceof code_1._Code&&e._items.some((c=>c instanceof code_1.Name&&names[c.str]===1&&constants[c.str]!==undefined))}}function subtractNames(names,from){for(const n in from)names[n]=(names[n]||0)-(from[n]||0)}function not(x){return typeof x=="boolean"||typeof x=="number"||x===null?!x:code_1._`!${par(x)}`}exports.not=not;const andCode=mappend(exports.operators.AND);function and(...args){return args.reduce(andCode)}exports.and=and;const orCode=mappend(exports.operators.OR);function or(...args){return args.reduce(orCode)}exports.or=or;function mappend(op){return(x,y)=>x===code_1.nil?y:y===code_1.nil?x:code_1._`${par(x)} ${op} ${par(y)}`}function par(x){return x instanceof code_1.Name?x:code_1._`(${x})`}},{"./code":11,"./scope":13}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ValueScope=exports.ValueScopeName=exports.Scope=exports.varKinds=exports.UsedValueState=void 0;const code_1=require("./code");class ValueError extends Error{constructor(name){super(`CodeGen: "code" for ${name} not defined`);this.value=name.value}}var UsedValueState;(function(UsedValueState){UsedValueState[UsedValueState["Started"]=0]="Started";UsedValueState[UsedValueState["Completed"]=1]="Completed"})(UsedValueState=exports.UsedValueState||(exports.UsedValueState={}));exports.varKinds={const:new code_1.Name("const"),let:new code_1.Name("let"),var:new code_1.Name("var")};class Scope{constructor({prefixes:prefixes,parent:parent}={}){this._names={};this._prefixes=prefixes;this._parent=parent}toName(nameOrPrefix){return nameOrPrefix instanceof code_1.Name?nameOrPrefix:this.name(nameOrPrefix)}name(prefix){return new code_1.Name(this._newName(prefix))}_newName(prefix){const ng=this._names[prefix]||this._nameGroup(prefix);return`${prefix}${ng.index++}`}_nameGroup(prefix){var _a,_b;if(((_b=(_a=this._parent)===null||_a===void 0?void 0:_a._prefixes)===null||_b===void 0?void 0:_b.has(prefix))||this._prefixes&&!this._prefixes.has(prefix)){throw new Error(`CodeGen: prefix "${prefix}" is not allowed in this scope`)}return this._names[prefix]={prefix:prefix,index:0}}}exports.Scope=Scope;class ValueScopeName extends code_1.Name{constructor(prefix,nameStr){super(nameStr);this.prefix=prefix}setValue(value,{property:property,itemIndex:itemIndex}){this.value=value;this.scopePath=code_1._`.${new code_1.Name(property)}[${itemIndex}]`}}exports.ValueScopeName=ValueScopeName;const line=code_1._`\n`;class ValueScope extends Scope{constructor(opts){super(opts);this._values={};this._scope=opts.scope;this.opts={...opts,_n:opts.lines?line:code_1.nil}}get(){return this._scope}name(prefix){return new ValueScopeName(prefix,this._newName(prefix))}value(nameOrPrefix,value){var _a;if(value.ref===undefined)throw new Error("CodeGen: ref must be passed in value");const name=this.toName(nameOrPrefix);const{prefix:prefix}=name;const valueKey=(_a=value.key)!==null&&_a!==void 0?_a:value.ref;let vs=this._values[prefix];if(vs){const _name=vs.get(valueKey);if(_name)return _name}else{vs=this._values[prefix]=new Map}vs.set(valueKey,name);const s=this._scope[prefix]||(this._scope[prefix]=[]);const itemIndex=s.length;s[itemIndex]=value.ref;name.setValue(value,{property:prefix,itemIndex:itemIndex});return name}getValue(prefix,keyOrRef){const vs=this._values[prefix];if(!vs)return;return vs.get(keyOrRef)}scopeRefs(scopeName,values=this._values){return this._reduceValues(values,(name=>{if(name.scopePath===undefined)throw new Error(`CodeGen: name "${name}" has no value`);return code_1._`${scopeName}${name.scopePath}`}))}scopeCode(values=this._values,usedValues,getCode){return this._reduceValues(values,(name=>{if(name.value===undefined)throw new Error(`CodeGen: name "${name}" has no value`);return name.value.code}),usedValues,getCode)}_reduceValues(values,valueCode,usedValues={},getCode){let code=code_1.nil;for(const prefix in values){const vs=values[prefix];if(!vs)continue;const nameSet=usedValues[prefix]=usedValues[prefix]||new Map;vs.forEach((name=>{if(nameSet.has(name))return;nameSet.set(name,UsedValueState.Started);let c=valueCode(name);if(c){const def=this.opts.es5?exports.varKinds.var:exports.varKinds.const;code=code_1._`${code}${def} ${name} = ${c};${this.opts._n}`}else if(c=getCode===null||getCode===void 0?void 0:getCode(name)){code=code_1._`${code}${c}${this.opts._n}`}else{throw new ValueError(name)}nameSet.set(name,UsedValueState.Completed)}))}return code}}exports.ValueScope=ValueScope},{"./code":11}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getData=void 0;const dataType_1=require("./validate/dataType");const util_1=require("./util");const errors_1=require("./errors");const codegen_1=require("./codegen");const names_1=require("./names");const subschema_1=require("./subschema");class KeywordCxt{constructor(it,def,keyword){validateKeywordUsage(it,def,keyword);this.gen=it.gen;this.allErrors=it.allErrors;this.keyword=keyword;this.data=it.data;this.schema=it.schema[keyword];this.$data=def.$data&&it.opts.$data&&this.schema&&this.schema.$data;this.schemaValue=util_1.schemaRefOrVal(it,this.schema,keyword,this.$data);this.schemaType=def.schemaType;this.parentSchema=it.schema;this.params={};this.it=it;this.def=def;if(this.$data){this.schemaCode=it.gen.const("vSchema",getData(this.$data,it))}else{this.schemaCode=this.schemaValue;if(!validSchemaType(this.schema,def.schemaType,def.allowUndefined)){throw new Error(`${keyword} value must be ${JSON.stringify(def.schemaType)}`)}}if("code"in def?def.trackErrors:def.errors!==false){this.errsCount=it.gen.const("_errs",names_1.default.errors)}}result(condition,successAction,failAction){this.gen.if(codegen_1.not(condition));if(failAction)failAction();else this.error();if(successAction){this.gen.else();successAction();if(this.allErrors)this.gen.endIf()}else{if(this.allErrors)this.gen.endIf();else this.gen.else()}}pass(condition,failAction){this.result(condition,undefined,failAction)}fail(condition){if(condition===undefined){this.error();if(!this.allErrors)this.gen.if(false);return}this.gen.if(condition);this.error();if(this.allErrors)this.gen.endIf();else this.gen.else()}fail$data(condition){if(!this.$data)return this.fail(condition);const{schemaCode:schemaCode}=this;this.fail(codegen_1._`${schemaCode} !== undefined && (${codegen_1.or(this.invalid$data(),condition)})`)}error(append){(append?errors_1.reportExtraError:errors_1.reportError)(this,this.def.error)}$dataError(){errors_1.reportError(this,this.def.$dataError||errors_1.keyword$DataError)}reset(){if(this.errsCount===undefined)throw new Error('add "trackErrors" to keyword definition');errors_1.resetErrorsCount(this.gen,this.errsCount)}ok(cond){if(!this.allErrors)this.gen.if(cond)}setParams(obj,assign){if(assign)Object.assign(this.params,obj);else this.params=obj}block$data(valid,codeBlock,$dataValid=codegen_1.nil){this.gen.block((()=>{this.check$data(valid,$dataValid);codeBlock()}))}check$data(valid=codegen_1.nil,$dataValid=codegen_1.nil){if(!this.$data)return;const{gen:gen,schemaCode:schemaCode,schemaType:schemaType,def:def}=this;gen.if(codegen_1.or(codegen_1._`${schemaCode} === undefined`,$dataValid));if(valid!==codegen_1.nil)gen.assign(valid,true);if(schemaType.length||def.validateSchema){gen.elseIf(this.invalid$data());this.$dataError();if(valid!==codegen_1.nil)gen.assign(valid,false)}gen.else()}invalid$data(){const{gen:gen,schemaCode:schemaCode,schemaType:schemaType,def:def,it:it}=this;return codegen_1.or(wrong$DataType(),invalid$DataSchema());function wrong$DataType(){if(schemaType.length){if(!(schemaCode instanceof codegen_1.Name))throw new Error("ajv implementation error");const st=Array.isArray(schemaType)?schemaType:[schemaType];return codegen_1._`${dataType_1.checkDataTypes(st,schemaCode,it.opts.strict,dataType_1.DataType.Wrong)}`}return codegen_1.nil}function invalid$DataSchema(){if(def.validateSchema){const validateSchemaRef=gen.scopeValue("validate$data",{ref:def.validateSchema});return codegen_1._`!${validateSchemaRef}(${schemaCode})`}return codegen_1.nil}}subschema(appl,valid){return subschema_1.applySubschema(this.it,appl,valid)}mergeEvaluated(schemaCxt,toName){const{it:it,gen:gen}=this;if(!it.opts.unevaluated)return;if(it.props!==true&&schemaCxt.props!==undefined){it.props=util_1.mergeEvaluated.props(gen,schemaCxt.props,it.props,toName)}if(it.items!==true&&schemaCxt.items!==undefined){it.items=util_1.mergeEvaluated.items(gen,schemaCxt.items,it.items,toName)}}mergeValidEvaluated(schemaCxt,valid){const{it:it,gen:gen}=this;if(it.opts.unevaluated&&(it.props!==true||it.items!==true)){gen.if(valid,(()=>this.mergeEvaluated(schemaCxt,codegen_1.Name)));return true}}}exports.default=KeywordCxt;function validSchemaType(schema,schemaType,allowUndefined=false){return!schemaType.length||schemaType.some((st=>st==="array"?Array.isArray(schema):st==="object"?schema&&typeof schema=="object"&&!Array.isArray(schema):typeof schema==st||allowUndefined&&typeof schema=="undefined"))}function validateKeywordUsage({schema:schema,opts:opts,self:self},def,keyword){if(Array.isArray(def.keyword)?!def.keyword.includes(keyword):def.keyword!==keyword){throw new Error("ajv implementation error")}const deps=def.dependencies;if(deps===null||deps===void 0?void 0:deps.some((kwd=>!Object.prototype.hasOwnProperty.call(schema,kwd)))){throw new Error(`parent schema must have dependencies of ${keyword}: ${deps.join(",")}`)}if(def.validateSchema){const valid=def.validateSchema(schema[keyword]);if(!valid){const msg="keyword value is invalid: "+self.errorsText(def.validateSchema.errors);if(opts.validateSchema==="log")self.logger.error(msg);else throw new Error(msg)}}}const JSON_POINTER=/^\/(?:[^~]|~0|~1)*$/;const RELATIVE_JSON_POINTER=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function getData($data,{dataLevel:dataLevel,dataNames:dataNames,dataPathArr:dataPathArr}){let jsonPointer;let data;if($data==="")return names_1.default.rootData;if($data[0]==="/"){if(!JSON_POINTER.test($data))throw new Error(`Invalid JSON-pointer: ${$data}`);jsonPointer=$data;data=names_1.default.rootData}else{const matches=RELATIVE_JSON_POINTER.exec($data);if(!matches)throw new Error(`Invalid JSON-pointer: ${$data}`);const up=+matches[1];jsonPointer=matches[2];if(jsonPointer==="#"){if(up>=dataLevel)throw new Error(errorMsg("property/index",up));return dataPathArr[dataLevel-up]}if(up>dataLevel)throw new Error(errorMsg("data",up));data=dataNames[dataLevel-up];if(!jsonPointer)return data}let expr=data;const segments=jsonPointer.split("/");for(const segment of segments){if(segment){data=codegen_1._`${data}${codegen_1.getProperty(util_1.unescapeJsonPointer(segment))}`;expr=codegen_1._`${expr} && ${data}`}}return expr;function errorMsg(pointerType,up){return`Cannot access ${pointerType} ${up} levels up, current level is ${dataLevel}`}}exports.getData=getData},{"./codegen":12,"./errors":16,"./names":18,"./subschema":21,"./util":23,"./validate/dataType":26}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MissingRefError=exports.ValidationError=void 0;const resolve_1=require("./resolve");class ValidationError extends Error{constructor(errors){super("validation failed");this.errors=errors;this.ajv=this.validation=true}}exports.ValidationError=ValidationError;class MissingRefError extends Error{constructor(baseId,ref,msg){super(msg||`can't resolve reference ${ref} from id ${baseId}`);this.missingRef=resolve_1.resolveUrl(baseId,ref);this.missingSchema=resolve_1.normalizeId(resolve_1.getFullPath(this.missingRef))}}exports.MissingRefError=MissingRefError;module.exports={ValidationError:ValidationError,MissingRefError:MissingRefError}},{"./resolve":19}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.extendErrors=exports.resetErrorsCount=exports.reportExtraError=exports.reportError=exports.keyword$DataError=exports.keywordError=void 0;const codegen_1=require("./codegen");const names_1=require("./names");exports.keywordError={message:({keyword:keyword})=>codegen_1.str`should pass "${keyword}" keyword validation`};exports.keyword$DataError={message:({keyword:keyword,schemaType:schemaType})=>schemaType?codegen_1.str`"${keyword}" keyword must be ${schemaType} ($data)`:codegen_1.str`"${keyword}" keyword is invalid ($data)`};function reportError(cxt,error=exports.keywordError,overrideAllErrors){const{it:it}=cxt;const{gen:gen,compositeRule:compositeRule,allErrors:allErrors}=it;const errObj=errorObjectCode(cxt,error);if(overrideAllErrors!==null&&overrideAllErrors!==void 0?overrideAllErrors:compositeRule||allErrors){addError(gen,errObj)}else{returnErrors(it,codegen_1._`[${errObj}]`)}}exports.reportError=reportError;function reportExtraError(cxt,error=exports.keywordError){const{it:it}=cxt;const{gen:gen,compositeRule:compositeRule,allErrors:allErrors}=it;const errObj=errorObjectCode(cxt,error);addError(gen,errObj);if(!(compositeRule||allErrors)){returnErrors(it,names_1.default.vErrors)}}exports.reportExtraError=reportExtraError;function resetErrorsCount(gen,errsCount){gen.assign(names_1.default.errors,errsCount);gen.if(codegen_1._`${names_1.default.vErrors} !== null`,(()=>gen.if(errsCount,(()=>gen.assign(codegen_1._`${names_1.default.vErrors}.length`,errsCount)),(()=>gen.assign(names_1.default.vErrors,null)))))}exports.resetErrorsCount=resetErrorsCount;function extendErrors({gen:gen,keyword:keyword,schemaValue:schemaValue,data:data,errsCount:errsCount,it:it}){if(errsCount===undefined)throw new Error("ajv implementation error");const err=gen.name("err");gen.forRange("i",errsCount,names_1.default.errors,(i=>{gen.const(err,codegen_1._`${names_1.default.vErrors}[${i}]`);gen.if(codegen_1._`${err}.dataPath === undefined`,(()=>gen.assign(codegen_1._`${err}.dataPath`,codegen_1.strConcat(names_1.default.dataPath,it.errorPath))));gen.assign(codegen_1._`${err}.schemaPath`,codegen_1.str`${it.errSchemaPath}/${keyword}`);if(it.opts.verbose){gen.assign(codegen_1._`${err}.schema`,schemaValue);gen.assign(codegen_1._`${err}.data`,data)}}))}exports.extendErrors=extendErrors;function addError(gen,errObj){const err=gen.const("err",errObj);gen.if(codegen_1._`${names_1.default.vErrors} === null`,(()=>gen.assign(names_1.default.vErrors,codegen_1._`[${err}]`)),codegen_1._`${names_1.default.vErrors}.push(${err})`);gen.code(codegen_1._`${names_1.default.errors}++`)}function returnErrors(it,errs){const{gen:gen,validateName:validateName,schemaEnv:schemaEnv}=it;if(schemaEnv.$async){gen.throw(codegen_1._`new ${it.ValidationError}(${errs})`)}else{gen.assign(codegen_1._`${validateName}.errors`,errs);gen.return(false)}}const E={keyword:new codegen_1.Name("keyword"),schemaPath:new codegen_1.Name("schemaPath"),params:new codegen_1.Name("params"),propertyName:new codegen_1.Name("propertyName"),message:new codegen_1.Name("message"),schema:new codegen_1.Name("schema"),parentSchema:new codegen_1.Name("parentSchema"),instancePath:new codegen_1.Name("instancePath")};function errorObjectCode(cxt,error){const{createErrors:createErrors,opts:opts}=cxt.it;if(createErrors===false)return codegen_1._`{}`;return(opts.jtd&&!opts.ajvErrors?jtdErrorObject:ajvErrorObject)(cxt,error)}function jtdErrorObject(cxt,{message:message}){const{gen:gen,keyword:keyword,it:it}=cxt;const{errorPath:errorPath,errSchemaPath:errSchemaPath,opts:opts}=it;const keyValues=[[E.instancePath,codegen_1.strConcat(names_1.default.dataPath,errorPath)],[E.schemaPath,codegen_1.str`${errSchemaPath}/${keyword}`]];if(opts.messages){keyValues.push([E.message,typeof message=="function"?message(cxt):message])}return gen.object(...keyValues)}function ajvErrorObject(cxt,error){const{gen:gen,keyword:keyword,data:data,schemaValue:schemaValue,it:it}=cxt;const{topSchemaRef:topSchemaRef,schemaPath:schemaPath,errorPath:errorPath,errSchemaPath:errSchemaPath,propertyName:propertyName,opts:opts}=it;const{params:params,message:message}=error;const keyValues=[[E.keyword,keyword],[names_1.default.dataPath,codegen_1.strConcat(names_1.default.dataPath,errorPath)],[E.schemaPath,codegen_1.str`${errSchemaPath}/${keyword}`],[E.params,typeof params=="function"?params(cxt):params||codegen_1._`{}`]];if(propertyName)keyValues.push([E.propertyName,propertyName]);if(opts.messages){keyValues.push([E.message,typeof message=="function"?message(cxt):message])}if(opts.verbose){keyValues.push([E.schema,schemaValue],[E.parentSchema,codegen_1._`${topSchemaRef}${schemaPath}`],[names_1.default.data,data])}return gen.object(...keyValues)}},{"./codegen":12,"./names":18}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.resolveSchema=exports.getCompilingSchema=exports.resolveRef=exports.compileSchema=exports.SchemaEnv=void 0;const codegen_1=require("./codegen");const error_classes_1=require("./error_classes");const names_1=require("./names");const resolve_1=require("./resolve");const util_1=require("./util");const validate_1=require("./validate");const URI=require("uri-js");class SchemaEnv{constructor(env){var _a;this.refs={};this.dynamicAnchors={};let schema;if(typeof env.schema=="object")schema=env.schema;this.schema=env.schema;this.root=env.root||this;this.baseId=(_a=env.baseId)!==null&&_a!==void 0?_a:resolve_1.normalizeId(schema===null||schema===void 0?void 0:schema.$id);this.localRefs=env.localRefs;this.meta=env.meta;this.$async=schema===null||schema===void 0?void 0:schema.$async;this.refs={}}}exports.SchemaEnv=SchemaEnv;function compileSchema(sch){const _sch=getCompilingSchema.call(this,sch);if(_sch)return _sch;const rootId=resolve_1.getFullPath(sch.root.baseId);const{es5:es5,lines:lines}=this.opts.code;const{ownProperties:ownProperties}=this.opts;const gen=new codegen_1.CodeGen(this.scope,{es5:es5,lines:lines,ownProperties:ownProperties});let _ValidationError;if(sch.$async){_ValidationError=gen.scopeValue("Error",{ref:error_classes_1.ValidationError,code:codegen_1._`require("ajv/dist/compile/error_classes").ValidationError`})}const validateName=gen.scopeName("validate");sch.validateName=validateName;const schemaCxt={gen:gen,allErrors:this.opts.allErrors,data:names_1.default.data,parentData:names_1.default.parentData,parentDataProperty:names_1.default.parentDataProperty,dataNames:[names_1.default.data],dataPathArr:[codegen_1.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:gen.scopeValue("schema",this.opts.code.source===true?{ref:sch.schema,code:codegen_1.stringify(sch.schema)}:{ref:sch.schema}),validateName:validateName,ValidationError:_ValidationError,schema:sch.schema,schemaEnv:sch,rootId:rootId,baseId:sch.baseId||rootId,schemaPath:codegen_1.nil,errSchemaPath:this.opts.jtd?"":"#",errorPath:codegen_1._`""`,opts:this.opts,self:this};let sourceCode;try{this._compilations.add(sch);validate_1.validateFunctionCode(schemaCxt);gen.optimize(this.opts.code.optimize);const validateCode=gen.toString();sourceCode=`${gen.scopeRefs(names_1.default.scope)}return ${validateCode}`;if(this.opts.code.process)sourceCode=this.opts.code.process(sourceCode,sch);const makeValidate=new Function(`${names_1.default.self}`,`${names_1.default.scope}`,sourceCode);const validate=makeValidate(this,this.scope.get());this.scope.value(validateName,{ref:validate});validate.errors=null;validate.schema=sch.schema;validate.schemaEnv=sch;if(sch.$async)validate.$async=true;if(this.opts.code.source===true){validate.source={validateName:validateName,validateCode:validateCode,scopeValues:gen._values}}if(this.opts.unevaluated){const{props:props,items:items}=schemaCxt;validate.evaluated={props:props instanceof codegen_1.Name?undefined:props,items:items instanceof codegen_1.Name?undefined:items,dynamicProps:props instanceof codegen_1.Name,dynamicItems:items instanceof codegen_1.Name};if(validate.source)validate.source.evaluated=codegen_1.stringify(validate.evaluated)}sch.validate=validate;return sch}catch(e){delete sch.validate;delete sch.validateName;if(sourceCode)this.logger.error("Error compiling schema, function code:",sourceCode);throw e}finally{this._compilations.delete(sch)}}exports.compileSchema=compileSchema;function resolveRef(root,baseId,ref){var _a;ref=resolve_1.resolveUrl(baseId,ref);const schOrFunc=root.refs[ref];if(schOrFunc)return schOrFunc;let _sch=resolve.call(this,root,ref);if(_sch===undefined){const schema=(_a=root.localRefs)===null||_a===void 0?void 0:_a[ref];if(schema)_sch=new SchemaEnv({schema:schema,root:root,baseId:baseId})}if(_sch===undefined)return;return root.refs[ref]=inlineOrCompile.call(this,_sch)}exports.resolveRef=resolveRef;function inlineOrCompile(sch){if(resolve_1.inlineRef(sch.schema,this.opts.inlineRefs))return sch.schema;return sch.validate?sch:compileSchema.call(this,sch)}function getCompilingSchema(schEnv){for(const sch of this._compilations){if(sameSchemaEnv(sch,schEnv))return sch}}exports.getCompilingSchema=getCompilingSchema;function sameSchemaEnv(s1,s2){return s1.schema===s2.schema&&s1.root===s2.root&&s1.baseId===s2.baseId}function resolve(root,ref){let sch;while(typeof(sch=this.refs[ref])=="string")ref=sch;return sch||this.schemas[ref]||resolveSchema.call(this,root,ref)}function resolveSchema(root,ref){const p=URI.parse(ref);const refPath=resolve_1._getFullPath(p);let baseId=resolve_1.getFullPath(root.baseId);if(Object.keys(root.schema).length>0&&refPath===baseId){return getJsonPointer.call(this,p,root)}const id=resolve_1.normalizeId(refPath);const schOrRef=this.refs[id]||this.schemas[id];if(typeof schOrRef=="string"){const sch=resolveSchema.call(this,root,schOrRef);if(typeof(sch===null||sch===void 0?void 0:sch.schema)!=="object")return;return getJsonPointer.call(this,p,sch)}if(typeof(schOrRef===null||schOrRef===void 0?void 0:schOrRef.schema)!=="object")return;if(!schOrRef.validate)compileSchema.call(this,schOrRef);if(id===resolve_1.normalizeId(ref)){const{schema:schema}=schOrRef;if(schema.$id)baseId=resolve_1.resolveUrl(baseId,schema.$id);return new SchemaEnv({schema:schema,root:root,baseId:baseId})}return getJsonPointer.call(this,p,schOrRef)}exports.resolveSchema=resolveSchema;const PREVENT_SCOPE_CHANGE=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function getJsonPointer(parsedRef,{baseId:baseId,schema:schema,root:root}){var _a;if(((_a=parsedRef.fragment)===null||_a===void 0?void 0:_a[0])!=="/")return;for(const part of parsedRef.fragment.slice(1).split("/")){if(typeof schema=="boolean")return;schema=schema[util_1.unescapeFragment(part)];if(schema===undefined)return;if(!PREVENT_SCOPE_CHANGE.has(part)&&typeof schema=="object"&&schema.$id){baseId=resolve_1.resolveUrl(baseId,schema.$id)}}let env;if(typeof schema!="boolean"&&schema.$ref&&!util_1.schemaHasRulesButRef(schema,this.RULES)){const $ref=resolve_1.resolveUrl(baseId,schema.$ref);env=resolveSchema.call(this,root,$ref)}env=env||new SchemaEnv({schema:schema,root:root,baseId:baseId});if(env.schema!==env.root.schema)return env;return undefined}},{"./codegen":12,"./error_classes":15,"./names":18,"./resolve":19,"./util":23,"./validate":28,"uri-js":435}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("./codegen");const names={data:new codegen_1.Name("data"),valCxt:new codegen_1.Name("valCxt"),dataPath:new codegen_1.Name("dataPath"),parentData:new codegen_1.Name("parentData"),parentDataProperty:new codegen_1.Name("parentDataProperty"),rootData:new codegen_1.Name("rootData"),dynamicAnchors:new codegen_1.Name("dynamicAnchors"),vErrors:new codegen_1.Name("vErrors"),errors:new codegen_1.Name("errors"),this:new codegen_1.Name("this"),self:new codegen_1.Name("self"),scope:new codegen_1.Name("scope"),json:new codegen_1.Name("json"),jsonPos:new codegen_1.Name("jsonPos"),jsonLen:new codegen_1.Name("jsonLen"),jsonPart:new codegen_1.Name("jsonPart")};exports.default=names},{"./codegen":12}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSchemaRefs=exports.resolveUrl=exports.normalizeId=exports._getFullPath=exports.getFullPath=exports.inlineRef=void 0;const util_1=require("./util");const equal=require("fast-deep-equal");const traverse=require("json-schema-traverse");const URI=require("uri-js");const SIMPLE_INLINED=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function inlineRef(schema,limit=true){if(typeof schema=="boolean")return true;if(limit===true)return!hasRef(schema);if(!limit)return false;return countKeys(schema)<=limit}exports.inlineRef=inlineRef;const REF_KEYWORDS=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function hasRef(schema){for(const key in schema){if(REF_KEYWORDS.has(key))return true;const sch=schema[key];if(Array.isArray(sch)&&sch.some(hasRef))return true;if(typeof sch=="object"&&hasRef(sch))return true}return false}function countKeys(schema){let count=0;for(const key in schema){if(key==="$ref")return Infinity;count++;if(SIMPLE_INLINED.has(key))continue;if(typeof schema[key]=="object"){util_1.eachItem(schema[key],(sch=>count+=countKeys(sch)))}if(count===Infinity)return Infinity}return count}function getFullPath(id="",normalize){if(normalize!==false)id=normalizeId(id);const p=URI.parse(id);return _getFullPath(p)}exports.getFullPath=getFullPath;function _getFullPath(p){return URI.serialize(p).split("#")[0]+"#"}exports._getFullPath=_getFullPath;const TRAILING_SLASH_HASH=/#\/?$/;function normalizeId(id){return id?id.replace(TRAILING_SLASH_HASH,""):""}exports.normalizeId=normalizeId;function resolveUrl(baseId,id){id=normalizeId(id);return URI.resolve(baseId,id)}exports.resolveUrl=resolveUrl;const ANCHOR=/^[a-z_][-a-z0-9._]*$/i;function getSchemaRefs(schema){if(typeof schema=="boolean")return{};const schemaId=normalizeId(schema.$id);const baseIds={"":schemaId};const pathPrefix=getFullPath(schemaId,false);const localRefs={};const schemaRefs=new Set;traverse(schema,{allKeys:true},((sch,jsonPtr,_,parentJsonPtr)=>{if(parentJsonPtr===undefined)return;const fullPath=pathPrefix+jsonPtr;let baseId=baseIds[parentJsonPtr];if(typeof sch.$id=="string")baseId=addRef.call(this,sch.$id);addAnchor.call(this,sch.$anchor);addAnchor.call(this,sch.$dynamicAnchor);baseIds[jsonPtr]=baseId;function addRef(ref){ref=normalizeId(baseId?URI.resolve(baseId,ref):ref);if(schemaRefs.has(ref))throw ambiguos(ref);schemaRefs.add(ref);let schOrRef=this.refs[ref];if(typeof schOrRef=="string")schOrRef=this.refs[schOrRef];if(typeof schOrRef=="object"){checkAmbiguosRef(sch,schOrRef.schema,ref)}else if(ref!==normalizeId(fullPath)){if(ref[0]==="#"){checkAmbiguosRef(sch,localRefs[ref],ref);localRefs[ref]=sch}else{this.refs[ref]=fullPath}}return ref}function addAnchor(anchor){if(typeof anchor=="string"){if(!ANCHOR.test(anchor))throw new Error(`invalid anchor "${anchor}"`);addRef.call(this,`#${anchor}`)}}}));return localRefs;function checkAmbiguosRef(sch1,sch2,ref){if(sch2!==undefined&&!equal(sch1,sch2))throw ambiguos(ref)}function ambiguos(ref){return new Error(`reference "${ref}" resolves to more than one schema`)}}exports.getSchemaRefs=getSchemaRefs},{"./util":23,"fast-deep-equal":266,"json-schema-traverse":317,"uri-js":435}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getRules=exports.isJSONType=void 0;const _jsonTypes=["string","number","integer","boolean","null","object","array"];const jsonTypes=new Set(_jsonTypes);function isJSONType(x){return typeof x=="string"&&jsonTypes.has(x)}exports.isJSONType=isJSONType;function getRules(){const groups={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...groups,integer:true,boolean:true,null:true},rules:[{rules:[]},groups.number,groups.string,groups.array,groups.object],post:{rules:[]},all:{},keywords:{}}}exports.getRules=getRules},{}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.applySubschema=exports.Type=void 0;const validate_1=require("./validate");const util_1=require("./util");const codegen_1=require("./codegen");var Type;(function(Type){Type[Type["Num"]=0]="Num";Type[Type["Str"]=1]="Str"})(Type=exports.Type||(exports.Type={}));function applySubschema(it,appl,valid){const subschema=getSubschema(it,appl);extendSubschemaData(subschema,it,appl);extendSubschemaMode(subschema,appl);const nextContext={...it,...subschema,items:undefined,props:undefined};validate_1.subschemaCode(nextContext,valid);return nextContext}exports.applySubschema=applySubschema;function getSubschema(it,{keyword:keyword,schemaProp:schemaProp,schema:schema,schemaPath:schemaPath,errSchemaPath:errSchemaPath,topSchemaRef:topSchemaRef}){if(keyword!==undefined&&schema!==undefined){throw new Error('both "keyword" and "schema" passed, only one allowed')}if(keyword!==undefined){const sch=it.schema[keyword];return schemaProp===undefined?{schema:sch,schemaPath:codegen_1._`${it.schemaPath}${codegen_1.getProperty(keyword)}`,errSchemaPath:`${it.errSchemaPath}/${keyword}`}:{schema:sch[schemaProp],schemaPath:codegen_1._`${it.schemaPath}${codegen_1.getProperty(keyword)}${codegen_1.getProperty(schemaProp)}`,errSchemaPath:`${it.errSchemaPath}/${keyword}/${util_1.escapeFragment(schemaProp)}`}}if(schema!==undefined){if(schemaPath===undefined||errSchemaPath===undefined||topSchemaRef===undefined){throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"')}return{schema:schema,schemaPath:schemaPath,topSchemaRef:topSchemaRef,errSchemaPath:errSchemaPath}}throw new Error('either "keyword" or "schema" must be passed')}function extendSubschemaData(subschema,it,{dataProp:dataProp,dataPropType:dpType,data:data,dataTypes:dataTypes,propertyName:propertyName}){if(data!==undefined&&dataProp!==undefined){throw new Error('both "data" and "dataProp" passed, only one allowed')}const{gen:gen}=it;if(dataProp!==undefined){const{errorPath:errorPath,dataPathArr:dataPathArr,opts:opts}=it;const nextData=gen.let("data",codegen_1._`${it.data}${codegen_1.getProperty(dataProp)}`,true);dataContextProps(nextData);subschema.errorPath=codegen_1.str`${errorPath}${getErrorPath(dataProp,dpType,opts.jsPropertySyntax)}`;subschema.parentDataProperty=codegen_1._`${dataProp}`;subschema.dataPathArr=[...dataPathArr,subschema.parentDataProperty]}if(data!==undefined){const nextData=data instanceof codegen_1.Name?data:gen.let("data",data,true);dataContextProps(nextData);if(propertyName!==undefined)subschema.propertyName=propertyName}if(dataTypes)subschema.dataTypes=dataTypes;function dataContextProps(_nextData){subschema.data=_nextData;subschema.dataLevel=it.dataLevel+1;subschema.dataTypes=[];it.definedProperties=new Set;subschema.parentData=it.data;subschema.dataNames=[...it.dataNames,_nextData]}}function extendSubschemaMode(subschema,{jtdDiscriminator:jtdDiscriminator,jtdMetadata:jtdMetadata,compositeRule:compositeRule,createErrors:createErrors,allErrors:allErrors}){if(compositeRule!==undefined)subschema.compositeRule=compositeRule;if(createErrors!==undefined)subschema.createErrors=createErrors;if(allErrors!==undefined)subschema.allErrors=allErrors;subschema.jtdDiscriminator=jtdDiscriminator;subschema.jtdMetadata=jtdMetadata}function getErrorPath(dataProp,dataPropType,jsPropertySyntax){if(dataProp instanceof codegen_1.Name){const isNumber=dataPropType===Type.Num;return jsPropertySyntax?isNumber?codegen_1._`"[" + ${dataProp} + "]"`:codegen_1._`"['" + ${dataProp} + "']"`:isNumber?codegen_1._`"/" + ${dataProp}`:codegen_1._`"/" + ${dataProp}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return jsPropertySyntax?codegen_1.getProperty(dataProp).toString():"/"+util_1.escapeJsonPointer(dataProp)}},{"./codegen":12,"./util":23,"./validate":28}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function ucs2length(str){const len=str.length;let length=0;let pos=0;let value;while(pos<len){length++;value=str.charCodeAt(pos++);if(value>=55296&&value<=56319&&pos<len){value=str.charCodeAt(pos);if((value&64512)===56320)pos++}}return length}exports.default=ucs2length},{}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.func=exports.setEvaluated=exports.evaluatedPropsToName=exports.mergeEvaluated=exports.eachItem=exports.unescapeJsonPointer=exports.escapeJsonPointer=exports.escapeFragment=exports.unescapeFragment=exports.schemaRefOrVal=exports.schemaHasRulesButRef=exports.schemaHasRules=exports.checkUnknownRules=exports.alwaysValidSchema=exports.toHash=void 0;const codegen_1=require("./codegen");const validate_1=require("./validate");function toHash(arr){const hash={};for(const item of arr)hash[item]=true;return hash}exports.toHash=toHash;function alwaysValidSchema(it,schema){if(typeof schema=="boolean")return schema;if(Object.keys(schema).length===0)return true;checkUnknownRules(it,schema);return!schemaHasRules(schema,it.self.RULES.all)}exports.alwaysValidSchema=alwaysValidSchema;function checkUnknownRules(it,schema=it.schema){const{opts:opts,self:self}=it;if(!opts.strict)return;if(typeof schema==="boolean")return;const rules=self.RULES.keywords;for(const key in schema){if(!rules[key])validate_1.checkStrictMode(it,`unknown keyword: "${key}"`)}}exports.checkUnknownRules=checkUnknownRules;function schemaHasRules(schema,rules){if(typeof schema=="boolean")return!schema;for(const key in schema)if(rules[key])return true;return false}exports.schemaHasRules=schemaHasRules;function schemaHasRulesButRef(schema,RULES){if(typeof schema=="boolean")return!schema;for(const key in schema)if(key!=="$ref"&&RULES.all[key])return true;return false}exports.schemaHasRulesButRef=schemaHasRulesButRef;function schemaRefOrVal({topSchemaRef:topSchemaRef,schemaPath:schemaPath},schema,keyword,$data){if(!$data){if(typeof schema=="number"||typeof schema=="boolean")return schema;if(typeof schema=="string")return codegen_1._`${schema}`}return codegen_1._`${topSchemaRef}${schemaPath}${codegen_1.getProperty(keyword)}`}exports.schemaRefOrVal=schemaRefOrVal;function unescapeFragment(str){return unescapeJsonPointer(decodeURIComponent(str))}exports.unescapeFragment=unescapeFragment;function escapeFragment(str){return encodeURIComponent(escapeJsonPointer(str))}exports.escapeFragment=escapeFragment;function escapeJsonPointer(str){if(typeof str=="number")return`${str}`;return str.replace(/~/g,"~0").replace(/\//g,"~1")}exports.escapeJsonPointer=escapeJsonPointer;function unescapeJsonPointer(str){return str.replace(/~1/g,"/").replace(/~0/g,"~")}exports.unescapeJsonPointer=unescapeJsonPointer;function eachItem(xs,f){if(Array.isArray(xs)){for(const x of xs)f(x)}else{f(xs)}}exports.eachItem=eachItem;function makeMergeEvaluated({mergeNames:mergeNames,mergeToName:mergeToName,mergeValues:mergeValues,resultToName:resultToName}){return(gen,from,to,toName)=>{const res=to===undefined?from:to instanceof codegen_1.Name?(from instanceof codegen_1.Name?mergeNames(gen,from,to):mergeToName(gen,from,to),to):from instanceof codegen_1.Name?(mergeToName(gen,to,from),from):mergeValues(from,to);return toName===codegen_1.Name&&!(res instanceof codegen_1.Name)?resultToName(gen,res):res}}exports.mergeEvaluated={props:makeMergeEvaluated({mergeNames:(gen,from,to)=>gen.if(codegen_1._`${to} !== true && ${from} !== undefined`,(()=>{gen.if(codegen_1._`${from} === true`,(()=>gen.assign(to,true)),(()=>gen.assign(to,codegen_1._`${to} || {}`).code(codegen_1._`Object.assign(${to}, ${from})`)))})),mergeToName:(gen,from,to)=>gen.if(codegen_1._`${to} !== true`,(()=>{if(from===true){gen.assign(to,true)}else{gen.assign(to,codegen_1._`${to} || {}`);setEvaluated(gen,to,from)}})),mergeValues:(from,to)=>from===true?true:{...from,...to},resultToName:evaluatedPropsToName}),items:makeMergeEvaluated({mergeNames:(gen,from,to)=>gen.if(codegen_1._`${to} !== true && ${from} !== undefined`,(()=>gen.assign(to,codegen_1._`${from} === true ? true : ${to} > ${from} ? ${to} : ${from}`))),mergeToName:(gen,from,to)=>gen.if(codegen_1._`${to} !== true`,(()=>gen.assign(to,from===true?true:codegen_1._`${to} > ${from} ? ${to} : ${from}`))),mergeValues:(from,to)=>from===true?true:Math.max(from,to),resultToName:(gen,items)=>gen.var("items",items)})};function evaluatedPropsToName(gen,ps){if(ps===true)return gen.var("props",true);const props=gen.var("props",codegen_1._`{}`);if(ps!==undefined)setEvaluated(gen,props,ps);return props}exports.evaluatedPropsToName=evaluatedPropsToName;function setEvaluated(gen,props,ps){Object.keys(ps).forEach((p=>gen.assign(codegen_1._`${props}${codegen_1.getProperty(p)}`,true)))}exports.setEvaluated=setEvaluated;function func(gen,f){return gen.scopeValue("func",{ref:f,code:f.code})}exports.func=func},{"./codegen":12,"./validate":28}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.shouldUseRule=exports.shouldUseGroup=exports.schemaHasRulesForType=void 0;function schemaHasRulesForType({schema:schema,self:self},type){const group=self.RULES.types[type];return group&&group!==true&&shouldUseGroup(schema,group)}exports.schemaHasRulesForType=schemaHasRulesForType;function shouldUseGroup(schema,group){return group.rules.some((rule=>shouldUseRule(schema,rule)))}exports.shouldUseGroup=shouldUseGroup;function shouldUseRule(schema,rule){var _a;return schema[rule.keyword]!==undefined||((_a=rule.definition.implements)===null||_a===void 0?void 0:_a.some((kwd=>schema[kwd]!==undefined)))}exports.shouldUseRule=shouldUseRule},{}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.boolOrEmptySchema=exports.topBoolOrEmptySchema=void 0;const errors_1=require("../errors");const codegen_1=require("../codegen");const names_1=require("../names");const boolError={message:"boolean schema is false"};function topBoolOrEmptySchema(it){const{gen:gen,schema:schema,validateName:validateName}=it;if(schema===false){falseSchemaError(it,false)}else if(typeof schema=="object"&&schema.$async===true){gen.return(names_1.default.data)}else{gen.assign(codegen_1._`${validateName}.errors`,null);gen.return(true)}}exports.topBoolOrEmptySchema=topBoolOrEmptySchema;function boolOrEmptySchema(it,valid){const{gen:gen,schema:schema}=it;if(schema===false){gen.var(valid,false);falseSchemaError(it)}else{gen.var(valid,true)}}exports.boolOrEmptySchema=boolOrEmptySchema;function falseSchemaError(it,overrideAllErrors){const{gen:gen,data:data}=it;const cxt={gen:gen,keyword:"false schema",data:data,schema:false,schemaCode:false,schemaValue:false,params:{},it:it};errors_1.reportError(cxt,boolError,overrideAllErrors)}},{"../codegen":12,"../errors":16,"../names":18}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.reportTypeError=exports.checkDataTypes=exports.checkDataType=exports.coerceAndCheckDataType=exports.getJSONTypes=exports.getSchemaTypes=exports.DataType=void 0;const rules_1=require("../rules");const applicability_1=require("./applicability");const errors_1=require("../errors");const codegen_1=require("../codegen");const util_1=require("../util");var DataType;(function(DataType){DataType[DataType["Correct"]=0]="Correct";DataType[DataType["Wrong"]=1]="Wrong"})(DataType=exports.DataType||(exports.DataType={}));function getSchemaTypes(schema){const types=getJSONTypes(schema.type);const hasNull=types.includes("null");if(hasNull){if(schema.nullable===false)throw new Error("type: null contradicts nullable: false")}else{if(!types.length&&schema.nullable!==undefined){throw new Error('"nullable" cannot be used without "type"')}if(schema.nullable===true)types.push("null")}return types}exports.getSchemaTypes=getSchemaTypes;function getJSONTypes(ts){const types=Array.isArray(ts)?ts:ts?[ts]:[];if(types.every(rules_1.isJSONType))return types;throw new Error("type must be JSONType or JSONType[]: "+types.join(","))}exports.getJSONTypes=getJSONTypes;function coerceAndCheckDataType(it,types){const{gen:gen,data:data,opts:opts}=it;const coerceTo=coerceToTypes(types,opts.coerceTypes);const checkTypes=types.length>0&&!(coerceTo.length===0&&types.length===1&&applicability_1.schemaHasRulesForType(it,types[0]));if(checkTypes){const wrongType=checkDataTypes(types,data,opts.strict,DataType.Wrong);gen.if(wrongType,(()=>{if(coerceTo.length)coerceData(it,types,coerceTo);else reportTypeError(it)}))}return checkTypes}exports.coerceAndCheckDataType=coerceAndCheckDataType;const COERCIBLE=new Set(["string","number","integer","boolean","null"]);function coerceToTypes(types,coerceTypes){return coerceTypes?types.filter((t=>COERCIBLE.has(t)||coerceTypes==="array"&&t==="array")):[]}function coerceData(it,types,coerceTo){const{gen:gen,data:data,opts:opts}=it;const dataType=gen.let("dataType",codegen_1._`typeof ${data}`);const coerced=gen.let("coerced",codegen_1._`undefined`);if(opts.coerceTypes==="array"){gen.if(codegen_1._`${dataType} == 'object' && Array.isArray(${data}) && ${data}.length == 1`,(()=>gen.assign(data,codegen_1._`${data}[0]`).assign(dataType,codegen_1._`typeof ${data}`).if(checkDataTypes(types,data,opts.strict),(()=>gen.assign(coerced,data)))))}gen.if(codegen_1._`${coerced} !== undefined`);for(const t of coerceTo){if(COERCIBLE.has(t)||t==="array"&&opts.coerceTypes==="array"){coerceSpecificType(t)}}gen.else();reportTypeError(it);gen.endIf();gen.if(codegen_1._`${coerced} !== undefined`,(()=>{gen.assign(data,coerced);assignParentData(it,coerced)}));function coerceSpecificType(t){switch(t){case"string":gen.elseIf(codegen_1._`${dataType} == "number" || ${dataType} == "boolean"`).assign(coerced,codegen_1._`"" + ${data}`).elseIf(codegen_1._`${data} === null`).assign(coerced,codegen_1._`""`);return;case"number":gen.elseIf(codegen_1._`${dataType} == "boolean" || ${data} === null
              || (${dataType} == "string" && ${data} && ${data} == +${data})`).assign(coerced,codegen_1._`+${data}`);return;case"integer":gen.elseIf(codegen_1._`${dataType} === "boolean" || ${data} === null
              || (${dataType} === "string" && ${data} && ${data} == +${data} && !(${data} % 1))`).assign(coerced,codegen_1._`+${data}`);return;case"boolean":gen.elseIf(codegen_1._`${data} === "false" || ${data} === 0 || ${data} === null`).assign(coerced,false).elseIf(codegen_1._`${data} === "true" || ${data} === 1`).assign(coerced,true);return;case"null":gen.elseIf(codegen_1._`${data} === "" || ${data} === 0 || ${data} === false`);gen.assign(coerced,null);return;case"array":gen.elseIf(codegen_1._`${dataType} === "string" || ${dataType} === "number"
              || ${dataType} === "boolean" || ${data} === null`).assign(coerced,codegen_1._`[${data}]`)}}}function assignParentData({gen:gen,parentData:parentData,parentDataProperty:parentDataProperty},expr){gen.if(codegen_1._`${parentData} !== undefined`,(()=>gen.assign(codegen_1._`${parentData}[${parentDataProperty}]`,expr)))}function checkDataType(dataType,data,strictNums,correct=DataType.Correct){const EQ=correct===DataType.Correct?codegen_1.operators.EQ:codegen_1.operators.NEQ;let cond;switch(dataType){case"null":return codegen_1._`${data} ${EQ} null`;case"array":cond=codegen_1._`Array.isArray(${data})`;break;case"object":cond=codegen_1._`${data} && typeof ${data} == "object" && !Array.isArray(${data})`;break;case"integer":cond=numCond(codegen_1._`!(${data} % 1) && !isNaN(${data})`);break;case"number":cond=numCond();break;default:return codegen_1._`typeof ${data} ${EQ} ${dataType}`}return correct===DataType.Correct?cond:codegen_1.not(cond);function numCond(_cond=codegen_1.nil){return codegen_1.and(codegen_1._`typeof ${data} == "number"`,_cond,strictNums?codegen_1._`isFinite(${data})`:codegen_1.nil)}}exports.checkDataType=checkDataType;function checkDataTypes(dataTypes,data,strictNums,correct){if(dataTypes.length===1){return checkDataType(dataTypes[0],data,strictNums,correct)}let cond;const types=util_1.toHash(dataTypes);if(types.array&&types.object){const notObj=codegen_1._`typeof ${data} != "object"`;cond=types.null?notObj:codegen_1._`!${data} || ${notObj}`;delete types.null;delete types.array;delete types.object}else{cond=codegen_1.nil}if(types.number)delete types.integer;for(const t in types)cond=codegen_1.and(cond,checkDataType(t,data,strictNums,correct));return cond}exports.checkDataTypes=checkDataTypes;const typeError={message:({schema:schema})=>codegen_1.str`should be ${schema}`,params:({schema:schema,schemaValue:schemaValue})=>typeof schema=="string"?codegen_1._`{type: ${schema}}`:codegen_1._`{type: ${schemaValue}}`};function reportTypeError(it){const cxt=getTypeErrorContext(it);errors_1.reportError(cxt,typeError)}exports.reportTypeError=reportTypeError;function getTypeErrorContext(it){const{gen:gen,data:data,schema:schema}=it;const schemaCode=util_1.schemaRefOrVal(it,schema,"type");return{gen:gen,keyword:"type",data:data,schema:schema.type,schemaCode:schemaCode,schemaValue:schemaCode,parentSchema:schema,params:{},it:it}}},{"../codegen":12,"../errors":16,"../rules":20,"../util":23,"./applicability":24}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.assignDefaults=void 0;const codegen_1=require("../codegen");const _1=require(".");function assignDefaults(it,ty){const{properties:properties,items:items}=it.schema;if(ty==="object"&&properties){for(const key in properties){assignDefault(it,key,properties[key].default)}}else if(ty==="array"&&Array.isArray(items)){items.forEach(((sch,i)=>assignDefault(it,i,sch.default)))}}exports.assignDefaults=assignDefaults;function assignDefault(it,prop,defaultValue){const{gen:gen,compositeRule:compositeRule,data:data,opts:opts}=it;if(defaultValue===undefined)return;const childData=codegen_1._`${data}${codegen_1.getProperty(prop)}`;if(compositeRule){_1.checkStrictMode(it,`default is ignored for: ${childData}`);return}let condition=codegen_1._`${childData} === undefined`;if(opts.useDefaults==="empty"){condition=codegen_1._`${condition} || ${childData} === null || ${childData} === ""`}gen.if(condition,codegen_1._`${childData} = ${codegen_1.stringify(defaultValue)}`)}},{".":28,"../codegen":12}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkStrictMode=exports.schemaCxtHasRules=exports.subschemaCode=exports.validateFunctionCode=void 0;const boolSchema_1=require("./boolSchema");const dataType_1=require("./dataType");const iterate_1=require("./iterate");const codegen_1=require("../codegen");const names_1=require("../names");const resolve_1=require("../resolve");const util_1=require("../util");function validateFunctionCode(it){if(isSchemaObj(it)){checkKeywords(it);if(schemaCxtHasRules(it)){topSchemaObjCode(it);return}}validateFunction(it,(()=>boolSchema_1.topBoolOrEmptySchema(it)))}exports.validateFunctionCode=validateFunctionCode;function validateFunction({gen:gen,validateName:validateName,schema:schema,schemaEnv:schemaEnv,opts:opts},body){if(opts.code.es5){gen.func(validateName,codegen_1._`${names_1.default.data}, ${names_1.default.valCxt}`,schemaEnv.$async,(()=>{gen.code(codegen_1._`"use strict"; ${funcSourceUrl(schema,opts)}`);destructureValCxtES5(gen,opts);gen.code(body)}))}else{gen.func(validateName,codegen_1._`${names_1.default.data}, ${destructureValCxt(opts)}`,schemaEnv.$async,(()=>gen.code(funcSourceUrl(schema,opts)).code(body)))}}function destructureValCxt(opts){return codegen_1._`{${names_1.default.dataPath}="", ${names_1.default.parentData}, ${names_1.default.parentDataProperty}, ${names_1.default.rootData}=${names_1.default.data}${opts.dynamicRef?codegen_1._`, ${names_1.default.dynamicAnchors}={}`:codegen_1.nil}}={}`}function destructureValCxtES5(gen,opts){gen.if(names_1.default.valCxt,(()=>{gen.var(names_1.default.dataPath,codegen_1._`${names_1.default.valCxt}.${names_1.default.dataPath}`);gen.var(names_1.default.parentData,codegen_1._`${names_1.default.valCxt}.${names_1.default.parentData}`);gen.var(names_1.default.parentDataProperty,codegen_1._`${names_1.default.valCxt}.${names_1.default.parentDataProperty}`);gen.var(names_1.default.rootData,codegen_1._`${names_1.default.valCxt}.${names_1.default.rootData}`);if(opts.dynamicRef)gen.var(names_1.default.dynamicAnchors,codegen_1._`${names_1.default.valCxt}.${names_1.default.dynamicAnchors}`)}),(()=>{gen.var(names_1.default.dataPath,codegen_1._`""`);gen.var(names_1.default.parentData,codegen_1._`undefined`);gen.var(names_1.default.parentDataProperty,codegen_1._`undefined`);gen.var(names_1.default.rootData,names_1.default.data);if(opts.dynamicRef)gen.var(names_1.default.dynamicAnchors,codegen_1._`{}`)}))}function topSchemaObjCode(it){const{schema:schema,opts:opts,gen:gen}=it;validateFunction(it,(()=>{if(opts.$comment&&schema.$comment)commentKeyword(it);checkNoDefault(it);gen.let(names_1.default.vErrors,null);gen.let(names_1.default.errors,0);if(opts.unevaluated)resetEvaluated(it);typeAndKeywords(it);returnResults(it)}));return}function resetEvaluated(it){const{gen:gen,validateName:validateName}=it;it.evaluated=gen.const("evaluated",codegen_1._`${validateName}.evaluated`);gen.if(codegen_1._`${it.evaluated}.dynamicProps`,(()=>gen.assign(codegen_1._`${it.evaluated}.props`,codegen_1._`undefined`)));gen.if(codegen_1._`${it.evaluated}.dynamicItems`,(()=>gen.assign(codegen_1._`${it.evaluated}.items`,codegen_1._`undefined`)))}function funcSourceUrl(schema,opts){return typeof schema=="object"&&schema.$id&&(opts.code.source||opts.code.process)?codegen_1._`/*# sourceURL=${schema.$id} */`:codegen_1.nil}function subschemaCode(it,valid){if(isSchemaObj(it)){checkKeywords(it);if(schemaCxtHasRules(it)){subSchemaObjCode(it,valid);return}}boolSchema_1.boolOrEmptySchema(it,valid)}exports.subschemaCode=subschemaCode;function schemaCxtHasRules({schema:schema,self:self}){if(typeof schema=="boolean")return!schema;for(const key in schema)if(self.RULES.all[key])return true;return false}exports.schemaCxtHasRules=schemaCxtHasRules;function isSchemaObj(it){return typeof it.schema!="boolean"}function subSchemaObjCode(it,valid){const{schema:schema,gen:gen,opts:opts}=it;if(opts.$comment&&schema.$comment)commentKeyword(it);updateContext(it);checkAsync(it);const errsCount=gen.const("_errs",names_1.default.errors);typeAndKeywords(it,errsCount);gen.var(valid,codegen_1._`${errsCount} === ${names_1.default.errors}`)}function checkKeywords(it){util_1.checkUnknownRules(it);checkRefsAndKeywords(it)}function typeAndKeywords(it,errsCount){if(it.opts.jtd)return iterate_1.schemaKeywords(it,[],false,errsCount);const types=dataType_1.getSchemaTypes(it.schema);const checkedTypes=dataType_1.coerceAndCheckDataType(it,types);iterate_1.schemaKeywords(it,types,!checkedTypes,errsCount)}function checkRefsAndKeywords(it){const{schema:schema,errSchemaPath:errSchemaPath,opts:opts,self:self}=it;if(schema.$ref&&opts.ignoreKeywordsWithRef&&util_1.schemaHasRulesButRef(schema,self.RULES)){self.logger.warn(`$ref: keywords ignored in schema at path "${errSchemaPath}"`)}}function checkNoDefault(it){const{schema:schema,opts:opts}=it;if(schema.default!==undefined&&opts.useDefaults&&opts.strict){checkStrictMode(it,"default is ignored in the schema root")}}function updateContext(it){if(it.schema.$id)it.baseId=resolve_1.resolveUrl(it.baseId,it.schema.$id)}function checkAsync(it){if(it.schema.$async&&!it.schemaEnv.$async)throw new Error("async schema in sync schema")}function commentKeyword({gen:gen,schemaEnv:schemaEnv,schema:schema,errSchemaPath:errSchemaPath,opts:opts}){const msg=schema.$comment;if(opts.$comment===true){gen.code(codegen_1._`${names_1.default.self}.logger.log(${msg})`)}else if(typeof opts.$comment=="function"){const schemaPath=codegen_1.str`${errSchemaPath}/$comment`;const rootName=gen.scopeValue("root",{ref:schemaEnv.root});gen.code(codegen_1._`${names_1.default.self}.opts.$comment(${msg}, ${schemaPath}, ${rootName}.schema)`)}}function returnResults(it){const{gen:gen,schemaEnv:schemaEnv,validateName:validateName,ValidationError:ValidationError,opts:opts}=it;if(schemaEnv.$async){gen.if(codegen_1._`${names_1.default.errors} === 0`,(()=>gen.return(names_1.default.data)),(()=>gen.throw(codegen_1._`new ${ValidationError}(${names_1.default.vErrors})`)))}else{gen.assign(codegen_1._`${validateName}.errors`,names_1.default.vErrors);if(opts.unevaluated)assignEvaluated(it);gen.return(codegen_1._`${names_1.default.errors} === 0`)}}function assignEvaluated({gen:gen,evaluated:evaluated,props:props,items:items}){if(props instanceof codegen_1.Name)gen.assign(codegen_1._`${evaluated}.props`,props);if(items instanceof codegen_1.Name)gen.assign(codegen_1._`${evaluated}.items`,items)}function checkStrictMode(it,msg,mode=it.opts.strict){if(!mode)return;msg=`strict mode: ${msg}`;if(mode===true)throw new Error(msg);it.self.logger.warn(msg)}exports.checkStrictMode=checkStrictMode},{"../codegen":12,"../names":18,"../resolve":19,"../util":23,"./boolSchema":25,"./dataType":26,"./iterate":29}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.schemaKeywords=void 0;const applicability_1=require("./applicability");const dataType_1=require("./dataType");const defaults_1=require("./defaults");const keyword_1=require("./keyword");const util_1=require("../util");const _1=require(".");const codegen_1=require("../codegen");const names_1=require("../names");function schemaKeywords(it,types,typeErrors,errsCount){const{gen:gen,schema:schema,data:data,allErrors:allErrors,opts:opts,self:self}=it;const{RULES:RULES}=self;if(schema.$ref&&(opts.ignoreKeywordsWithRef||!util_1.schemaHasRulesButRef(schema,RULES))){gen.block((()=>keyword_1.keywordCode(it,"$ref",RULES.all.$ref.definition)));return}if(!opts.jtd)checkStrictTypes(it,types);gen.block((()=>{for(const group of RULES.rules)groupKeywords(group);groupKeywords(RULES.post)}));function groupKeywords(group){if(!applicability_1.shouldUseGroup(schema,group))return;if(group.type){gen.if(dataType_1.checkDataType(group.type,data,opts.strict));iterateKeywords(it,group);if(types.length===1&&types[0]===group.type&&typeErrors){gen.else();dataType_1.reportTypeError(it)}gen.endIf()}else{iterateKeywords(it,group)}if(!allErrors)gen.if(codegen_1._`${names_1.default.errors} === ${errsCount||0}`)}}exports.schemaKeywords=schemaKeywords;function iterateKeywords(it,group){const{gen:gen,schema:schema,opts:{useDefaults:useDefaults}}=it;if(useDefaults)defaults_1.assignDefaults(it,group.type);gen.block((()=>{for(const rule of group.rules){if(applicability_1.shouldUseRule(schema,rule)){keyword_1.keywordCode(it,rule.keyword,rule.definition,group.type)}}}))}function checkStrictTypes(it,types){if(it.schemaEnv.meta||!it.opts.strictTypes)return;checkContextTypes(it,types);if(!it.opts.allowUnionTypes)checkMultipleTypes(it,types);checkKeywordTypes(it,it.dataTypes)}function checkContextTypes(it,types){if(!types.length)return;if(!it.dataTypes.length){it.dataTypes=types;return}types.forEach((t=>{if(!includesType(it.dataTypes,t)){strictTypesError(it,`type "${t}" not allowed by context "${it.dataTypes.join(",")}"`)}}));it.dataTypes=it.dataTypes.filter((t=>includesType(types,t)))}function checkMultipleTypes(it,ts){if(ts.length>1&&!(ts.length===2&&ts.includes("null"))){strictTypesError(it,"use allowUnionTypes to allow union type keyword")}}function checkKeywordTypes(it,ts){const rules=it.self.RULES.all;for(const keyword in rules){const rule=rules[keyword];if(typeof rule=="object"&&applicability_1.shouldUseRule(it.schema,rule)){const{type:type}=rule.definition;if(type.length&&!type.some((t=>hasApplicableType(ts,t)))){strictTypesError(it,`missing type "${type.join(",")}" for keyword "${keyword}"`)}}}}function hasApplicableType(schTs,kwdT){return schTs.includes(kwdT)||kwdT==="number"&&schTs.includes("integer")}function includesType(ts,t){return ts.includes(t)||t==="integer"&&ts.includes("number")}function strictTypesError(it,msg){const schemaPath=it.schemaEnv.baseId+it.errSchemaPath;msg+=` at "${schemaPath}" (strictTypes)`;_1.checkStrictMode(it,msg,it.opts.strictTypes)}},{".":28,"../codegen":12,"../names":18,"../util":23,"./applicability":24,"./dataType":26,"./defaults":27,"./keyword":30}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.keywordCode=void 0;const context_1=require("../context");const errors_1=require("../errors");const code_1=require("../../vocabularies/code");const codegen_1=require("../codegen");const names_1=require("../names");function keywordCode(it,keyword,def,ruleType){const cxt=new context_1.default(it,def,keyword);if("code"in def){def.code(cxt,ruleType)}else if(cxt.$data&&def.validate){funcKeywordCode(cxt,def)}else if("macro"in def){macroKeywordCode(cxt,def)}else if(def.compile||def.validate){funcKeywordCode(cxt,def)}}exports.keywordCode=keywordCode;function macroKeywordCode(cxt,def){const{gen:gen,keyword:keyword,schema:schema,parentSchema:parentSchema,it:it}=cxt;const macroSchema=def.macro.call(it.self,schema,parentSchema,it);const schemaRef=useKeyword(gen,keyword,macroSchema);if(it.opts.validateSchema!==false)it.self.validateSchema(macroSchema,true);const valid=gen.name("valid");cxt.subschema({schema:macroSchema,schemaPath:codegen_1.nil,errSchemaPath:`${it.errSchemaPath}/${keyword}`,topSchemaRef:schemaRef,compositeRule:true},valid);cxt.pass(valid,(()=>cxt.error(true)))}function funcKeywordCode(cxt,def){var _a;const{gen:gen,keyword:keyword,schema:schema,parentSchema:parentSchema,$data:$data,it:it}=cxt;checkAsync(it,def);const validate=!$data&&def.compile?def.compile.call(it.self,schema,parentSchema,it):def.validate;const validateRef=useKeyword(gen,keyword,validate);const valid=gen.let("valid");cxt.block$data(valid,validateKeyword);cxt.ok((_a=def.valid)!==null&&_a!==void 0?_a:valid);function validateKeyword(){if(def.errors===false){assignValid();if(def.modifying)modifyData(cxt);reportErrs((()=>cxt.error()))}else{const ruleErrs=def.async?validateAsync():validateSync();if(def.modifying)modifyData(cxt);reportErrs((()=>addErrs(cxt,ruleErrs)))}}function validateAsync(){const ruleErrs=gen.let("ruleErrs",null);gen.try((()=>assignValid(codegen_1._`await `)),(e=>gen.assign(valid,false).if(codegen_1._`${e} instanceof ${it.ValidationError}`,(()=>gen.assign(ruleErrs,codegen_1._`${e}.errors`)),(()=>gen.throw(e)))));return ruleErrs}function validateSync(){const validateErrs=codegen_1._`${validateRef}.errors`;gen.assign(validateErrs,null);assignValid(codegen_1.nil);return validateErrs}function assignValid(_await=(def.async?codegen_1._`await `:codegen_1.nil)){const passCxt=it.opts.passContext?names_1.default.this:names_1.default.self;const passSchema=!("compile"in def&&!$data||def.schema===false);gen.assign(valid,codegen_1._`${_await}${code_1.callValidateCode(cxt,validateRef,passCxt,passSchema)}`,def.modifying)}function reportErrs(errors){var _a;gen.if(codegen_1.not((_a=def.valid)!==null&&_a!==void 0?_a:valid),errors)}}function modifyData(cxt){const{gen:gen,data:data,it:it}=cxt;gen.if(it.parentData,(()=>gen.assign(data,codegen_1._`${it.parentData}[${it.parentDataProperty}]`)))}function addErrs(cxt,errs){const{gen:gen}=cxt;gen.if(codegen_1._`Array.isArray(${errs})`,(()=>{gen.assign(names_1.default.vErrors,codegen_1._`${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`).assign(names_1.default.errors,codegen_1._`${names_1.default.vErrors}.length`);errors_1.extendErrors(cxt)}),(()=>cxt.error()))}function checkAsync({schemaEnv:schemaEnv},def){if(def.async&&!schemaEnv.$async)throw new Error("async keyword in sync schema")}function useKeyword(gen,keyword,result){if(result===undefined)throw new Error(`keyword "${keyword}" failed to compile`);return gen.scopeValue("keyword",typeof result=="function"?{ref:result}:{ref:result,code:codegen_1.stringify(result)})}},{"../../vocabularies/code":49,"../codegen":12,"../context":14,"../errors":16,"../names":18}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CodeGen=exports.Name=exports.nil=exports.stringify=exports.str=exports._=exports.KeywordCxt=void 0;const context_1=require("./compile/context");exports.KeywordCxt=context_1.default;var codegen_1=require("./compile/codegen");Object.defineProperty(exports,"_",{enumerable:true,get:function(){return codegen_1._}});Object.defineProperty(exports,"str",{enumerable:true,get:function(){return codegen_1.str}});Object.defineProperty(exports,"stringify",{enumerable:true,get:function(){return codegen_1.stringify}});Object.defineProperty(exports,"nil",{enumerable:true,get:function(){return codegen_1.nil}});Object.defineProperty(exports,"Name",{enumerable:true,get:function(){return codegen_1.Name}});Object.defineProperty(exports,"CodeGen",{enumerable:true,get:function(){return codegen_1.CodeGen}});const error_classes_1=require("./compile/error_classes");const rules_1=require("./compile/rules");const compile_1=require("./compile");const codegen_2=require("./compile/codegen");const resolve_1=require("./compile/resolve");const dataType_1=require("./compile/validate/dataType");const util_1=require("./compile/util");const $dataRefSchema=require("./refs/data.json");const META_IGNORE_OPTIONS=["removeAdditional","useDefaults","coerceTypes"];const EXT_SCOPE_NAMES=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]);const removedOptions={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",schemaId:"JSON Schema draft-04 is not supported in Ajv v7.",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",strictNumbers:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key."};const deprecatedOptions={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function requiredOptions(o){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m;const strict=(_a=o.strict)!==null&&_a!==void 0?_a:true;const strictLog=strict?"log":false;const _optz=(_b=o.code)===null||_b===void 0?void 0:_b.optimize;const optimize=_optz===true||_optz===undefined?1:_optz||0;return{strict:strict,strictTypes:(_c=o.strictTypes)!==null&&_c!==void 0?_c:strictLog,strictTuples:(_d=o.strictTuples)!==null&&_d!==void 0?_d:strictLog,code:o.code?{...o.code,optimize:optimize}:{optimize:optimize},loopRequired:(_e=o.loopRequired)!==null&&_e!==void 0?_e:Infinity,loopEnum:(_f=o.loopEnum)!==null&&_f!==void 0?_f:Infinity,meta:(_g=o.meta)!==null&&_g!==void 0?_g:true,messages:(_h=o.messages)!==null&&_h!==void 0?_h:true,inlineRefs:(_j=o.inlineRefs)!==null&&_j!==void 0?_j:true,addUsedSchema:(_k=o.addUsedSchema)!==null&&_k!==void 0?_k:true,validateSchema:(_l=o.validateSchema)!==null&&_l!==void 0?_l:true,validateFormats:(_m=o.validateFormats)!==null&&_m!==void 0?_m:true}}class Ajv{constructor(opts={}){this.schemas={};this.refs={};this.formats={};this._compilations=new Set;this._loading={};this._cache=new Map;opts=this.opts={...opts,...requiredOptions(opts)};const{es5:es5,lines:lines}=this.opts.code;this.scope=new codegen_2.ValueScope({scope:{},prefixes:EXT_SCOPE_NAMES,es5:es5,lines:lines});this.logger=getLogger(opts.logger);const formatOpt=opts.validateFormats;opts.validateFormats=false;this.RULES=rules_1.getRules();checkOptions.call(this,removedOptions,opts,"NOT SUPPORTED");checkOptions.call(this,deprecatedOptions,opts,"DEPRECATED","warn");this._metaOpts=getMetaSchemaOptions.call(this);if(opts.formats)addInitialFormats.call(this);this._addVocabularies();this._addDefaultMetaSchema();if(opts.keywords)addInitialKeywords.call(this,opts.keywords);if(typeof opts.meta=="object")this.addMetaSchema(opts.meta);addInitialSchemas.call(this);opts.validateFormats=formatOpt}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:$data,meta:meta}=this.opts;if(meta&&$data)this.addMetaSchema($dataRefSchema,$dataRefSchema.$id,false)}defaultMeta(){const{meta:meta}=this.opts;return this.opts.defaultMeta=typeof meta=="object"?meta.$id||meta:undefined}validate(schemaKeyRef,data){let v;if(typeof schemaKeyRef=="string"){v=this.getSchema(schemaKeyRef);if(!v)throw new Error(`no schema with key or ref "${schemaKeyRef}"`)}else{v=this.compile(schemaKeyRef)}const valid=v(data);if(!("$async"in v))this.errors=v.errors;return valid}compile(schema,_meta){const sch=this._addSchema(schema,_meta);return sch.validate||this._compileSchemaEnv(sch)}compileAsync(schema,meta){if(typeof this.opts.loadSchema!="function"){throw new Error("options.loadSchema should be a function")}const{loadSchema:loadSchema}=this.opts;return runCompileAsync.call(this,schema,meta);async function runCompileAsync(_schema,_meta){await loadMetaSchema.call(this,_schema.$schema);const sch=this._addSchema(_schema,_meta);return sch.validate||_compileAsync.call(this,sch)}async function loadMetaSchema($ref){if($ref&&!this.getSchema($ref)){await runCompileAsync.call(this,{$ref:$ref},true)}}async function _compileAsync(sch){try{return this._compileSchemaEnv(sch)}catch(e){if(!(e instanceof error_classes_1.MissingRefError))throw e;checkLoaded.call(this,e);await loadMissingSchema.call(this,e.missingSchema);return _compileAsync.call(this,sch)}}function checkLoaded({missingSchema:ref,missingRef:missingRef}){if(this.refs[ref]){throw new Error(`AnySchema ${ref} is loaded but ${missingRef} cannot be resolved`)}}async function loadMissingSchema(ref){const _schema=await _loadSchema.call(this,ref);if(!this.refs[ref])await loadMetaSchema.call(this,_schema.$schema);if(!this.refs[ref])this.addSchema(_schema,ref,meta)}async function _loadSchema(ref){const p=this._loading[ref];if(p)return p;try{return await(this._loading[ref]=loadSchema(ref))}finally{delete this._loading[ref]}}}addSchema(schema,key,_meta,_validateSchema=this.opts.validateSchema){if(Array.isArray(schema)){for(const sch of schema)this.addSchema(sch,undefined,_meta,_validateSchema);return this}let id;if(typeof schema==="object"){id=schema.$id;if(id!==undefined&&typeof id!="string")throw new Error("schema id must be string")}key=resolve_1.normalizeId(key||id);this._checkUnique(key);this.schemas[key]=this._addSchema(schema,_meta,_validateSchema,true);return this}addMetaSchema(schema,key,_validateSchema=this.opts.validateSchema){this.addSchema(schema,key,true,_validateSchema);return this}validateSchema(schema,throwOrLogError){if(typeof schema=="boolean")return true;let $schema;$schema=schema.$schema;if($schema!==undefined&&typeof $schema!="string"){throw new Error("$schema must be a string")}$schema=$schema||this.opts.defaultMeta||this.defaultMeta();if(!$schema){this.logger.warn("meta-schema not available");this.errors=null;return true}const valid=this.validate($schema,schema);if(!valid&&throwOrLogError){const message="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(message);else throw new Error(message)}return valid}getSchema(keyRef){let sch;while(typeof(sch=getSchEnv.call(this,keyRef))=="string")keyRef=sch;if(sch===undefined){const root=new compile_1.SchemaEnv({schema:{}});sch=compile_1.resolveSchema.call(this,root,keyRef);if(!sch)return;this.refs[keyRef]=sch}return sch.validate||this._compileSchemaEnv(sch)}removeSchema(schemaKeyRef){if(schemaKeyRef instanceof RegExp){this._removeAllSchemas(this.schemas,schemaKeyRef);this._removeAllSchemas(this.refs,schemaKeyRef);return this}switch(typeof schemaKeyRef){case"undefined":this._removeAllSchemas(this.schemas);this._removeAllSchemas(this.refs);this._cache.clear();return this;case"string":{const sch=getSchEnv.call(this,schemaKeyRef);if(typeof sch=="object")this._cache.delete(sch.schema);delete this.schemas[schemaKeyRef];delete this.refs[schemaKeyRef];return this}case"object":{const cacheKey=schemaKeyRef;this._cache.delete(cacheKey);let id=schemaKeyRef.$id;if(id){id=resolve_1.normalizeId(id);delete this.schemas[id];delete this.refs[id]}return this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(definitions){for(const def of definitions)this.addKeyword(def);return this}addKeyword(kwdOrDef,def){let keyword;if(typeof kwdOrDef=="string"){keyword=kwdOrDef;if(typeof def=="object"){this.logger.warn("these parameters are deprecated, see docs for addKeyword");def.keyword=keyword}}else if(typeof kwdOrDef=="object"&&def===undefined){def=kwdOrDef;keyword=def.keyword;if(Array.isArray(keyword)&&!keyword.length){throw new Error("addKeywords: keyword must be string or non-empty array")}}else{throw new Error("invalid addKeywords parameters")}checkKeyword.call(this,keyword,def);if(!def){util_1.eachItem(keyword,(kwd=>addRule.call(this,kwd)));return this}keywordMetaschema.call(this,def);const definition={...def,type:dataType_1.getJSONTypes(def.type),schemaType:dataType_1.getJSONTypes(def.schemaType)};util_1.eachItem(keyword,definition.type.length===0?k=>addRule.call(this,k,definition):k=>definition.type.forEach((t=>addRule.call(this,k,definition,t))));return this}getKeyword(keyword){const rule=this.RULES.all[keyword];return typeof rule=="object"?rule.definition:!!rule}removeKeyword(keyword){const{RULES:RULES}=this;delete RULES.keywords[keyword];delete RULES.all[keyword];for(const group of RULES.rules){const i=group.rules.findIndex((rule=>rule.keyword===keyword));if(i>=0)group.rules.splice(i,1)}return this}addFormat(name,format){if(typeof format=="string")format=new RegExp(format);this.formats[name]=format;return this}errorsText(errors=this.errors,{separator:separator=", ",dataVar:dataVar="data"}={}){if(!errors||errors.length===0)return"No errors";return errors.map((e=>`${dataVar}${e.dataPath} ${e.message}`)).reduce(((text,msg)=>text+separator+msg))}$dataMetaSchema(metaSchema,keywordsJsonPointers){const rules=this.RULES.all;metaSchema=JSON.parse(JSON.stringify(metaSchema));for(const jsonPointer of keywordsJsonPointers){const segments=jsonPointer.split("/").slice(1);let keywords=metaSchema;for(const seg of segments)keywords=keywords[seg];for(const key in rules){const rule=rules[key];if(typeof rule!="object")continue;const{$data:$data}=rule.definition;const schema=keywords[key];if($data&&schema)keywords[key]=schemaOrData(schema)}}return metaSchema}_removeAllSchemas(schemas,regex){for(const keyRef in schemas){const sch=schemas[keyRef];if(!regex||regex.test(keyRef)){if(typeof sch=="string"){delete schemas[keyRef]}else if(sch&&!sch.meta){this._cache.delete(sch.schema);delete schemas[keyRef]}}}}_addSchema(schema,meta,validateSchema=this.opts.validateSchema,addSchema=this.opts.addUsedSchema){if(typeof schema!="object"){if(this.opts.jtd)throw new Error("schema must be object");else if(typeof schema!="boolean")throw new Error("schema must be object or boolean")}let sch=this._cache.get(schema);if(sch!==undefined)return sch;const localRefs=resolve_1.getSchemaRefs.call(this,schema);sch=new compile_1.SchemaEnv({schema:schema,meta:meta,localRefs:localRefs});this._cache.set(sch.schema,sch);const id=sch.baseId;if(addSchema&&!id.startsWith("#")){if(id)this._checkUnique(id);this.refs[id]=sch}if(validateSchema)this.validateSchema(schema,true);return sch}_checkUnique(id){if(this.schemas[id]||this.refs[id]){throw new Error(`schema with key or id "${id}" already exists`)}}_compileSchemaEnv(sch){if(sch.meta)this._compileMetaSchema(sch);else compile_1.compileSchema.call(this,sch);if(!sch.validate)throw new Error("ajv implementation error");return sch.validate}_compileMetaSchema(sch){const currentOpts=this.opts;this.opts=this._metaOpts;try{compile_1.compileSchema.call(this,sch)}finally{this.opts=currentOpts}}}exports.default=Ajv;Ajv.ValidationError=error_classes_1.ValidationError;Ajv.MissingRefError=error_classes_1.MissingRefError;function checkOptions(checkOpts,options,msg,log="error"){for(const key in checkOpts){const opt=key;if(opt in options)this.logger[log](`${msg}: option ${key}. ${checkOpts[opt]}`)}}function getSchEnv(keyRef){keyRef=resolve_1.normalizeId(keyRef);return this.schemas[keyRef]||this.refs[keyRef]}function addInitialSchemas(){const optsSchemas=this.opts.schemas;if(!optsSchemas)return;if(Array.isArray(optsSchemas))this.addSchema(optsSchemas);else for(const key in optsSchemas)this.addSchema(optsSchemas[key],key)}function addInitialFormats(){for(const name in this.opts.formats){const format=this.opts.formats[name];if(format)this.addFormat(name,format)}}function addInitialKeywords(defs){if(Array.isArray(defs)){this.addVocabulary(defs);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const keyword in defs){const def=defs[keyword];if(!def.keyword)def.keyword=keyword;this.addKeyword(def)}}function getMetaSchemaOptions(){const metaOpts={...this.opts};for(const opt of META_IGNORE_OPTIONS)delete metaOpts[opt];return metaOpts}const noLogs={log(){},warn(){},error(){}};function getLogger(logger){if(logger===false)return noLogs;if(logger===undefined)return console;if(logger.log&&logger.warn&&logger.error)return logger;throw new Error("logger must implement log, warn and error methods")}const KEYWORD_NAME=/^[a-z_$][a-z0-9_$:-]*$/i;function checkKeyword(keyword,def){const{RULES:RULES}=this;util_1.eachItem(keyword,(kwd=>{if(RULES.keywords[kwd])throw new Error(`Keyword ${kwd} is already defined`);if(!KEYWORD_NAME.test(kwd))throw new Error(`Keyword ${kwd} has invalid name`)}));if(!def)return;if(def.$data&&!("code"in def||"validate"in def)){throw new Error('$data keyword must have "code" or "validate" function')}}function addRule(keyword,definition,dataType){var _a;const post=definition===null||definition===void 0?void 0:definition.post;if(dataType&&post)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:RULES}=this;let ruleGroup=post?RULES.post:RULES.rules.find((({type:t})=>t===dataType));if(!ruleGroup){ruleGroup={type:dataType,rules:[]};RULES.rules.push(ruleGroup)}RULES.keywords[keyword]=true;if(!definition)return;const rule={keyword:keyword,definition:{...definition,type:dataType_1.getJSONTypes(definition.type),schemaType:dataType_1.getJSONTypes(definition.schemaType)}};if(definition.before)addBeforeRule.call(this,ruleGroup,rule,definition.before);else ruleGroup.rules.push(rule);RULES.all[keyword]=rule;(_a=definition.implements)===null||_a===void 0?void 0:_a.forEach((kwd=>this.addKeyword(kwd)))}function addBeforeRule(ruleGroup,rule,before){const i=ruleGroup.rules.findIndex((_rule=>_rule.keyword===before));if(i>=0){ruleGroup.rules.splice(i,0,rule)}else{ruleGroup.rules.push(rule);this.logger.warn(`rule ${before} is not defined`)}}function keywordMetaschema(def){let{metaSchema:metaSchema}=def;if(metaSchema===undefined)return;if(def.$data&&this.opts.$data)metaSchema=schemaOrData(metaSchema);def.validateSchema=this.compile(metaSchema,true)}const $dataRef={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function schemaOrData(schema){return{anyOf:[schema,$dataRef]}}},{"./compile":17,"./compile/codegen":12,"./compile/context":14,"./compile/error_classes":15,"./compile/resolve":19,"./compile/rules":20,"./compile/util":23,"./compile/validate/dataType":26,"./refs/data.json":32}],32:[function(require,module,exports){module.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:false}},{}],33:[function(require,module,exports){module.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:true,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:true,readOnly:{type:"boolean",default:false},examples:{type:"array",items:true},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:true},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:false},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:true,enum:{type:"array",items:true,minItems:1,uniqueItems:true},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:true}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:true}},{}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const subschema_1=require("../../compile/subschema");const util_1=require("../../compile/util");const validate_1=require("../../compile/validate");const error={message:({params:{len:len}})=>codegen_1.str`should NOT have more than ${len} items`,params:({params:{len:len}})=>codegen_1._`{limit: ${len}}`};const def={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:error,code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,it:it}=cxt;const{items:items}=parentSchema;if(!Array.isArray(items)){validate_1.checkStrictMode(it,'"additionalItems" is ignored when "items" is not an array of schemas');return}it.items=true;const len=gen.const("len",codegen_1._`${data}.length`);if(schema===false){cxt.setParams({len:items.length});cxt.pass(codegen_1._`${len} <= ${items.length}`)}else if(typeof schema=="object"&&!util_1.alwaysValidSchema(it,schema)){const valid=gen.var("valid",codegen_1._`${len} <= ${items.length}`);gen.if(codegen_1.not(valid),(()=>validateItems(valid)));cxt.ok(valid)}function validateItems(valid){gen.forRange("i",items.length,len,(i=>{cxt.subschema({keyword:"additionalItems",dataProp:i,dataPropType:subschema_1.Type.Num},valid);if(!it.allErrors)gen.if(codegen_1.not(valid),(()=>gen.break()))}))}}};exports.default=def},{"../../compile/codegen":12,"../../compile/subschema":21,"../../compile/util":23,"../../compile/validate":28}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const codegen_1=require("../../compile/codegen");const names_1=require("../../compile/names");const subschema_1=require("../../compile/subschema");const util_1=require("../../compile/util");const error={message:"should NOT have additional properties",params:({params:params})=>codegen_1._`{additionalProperty: ${params.additionalProperty}}`};const def={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:true,trackErrors:true,error:error,code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,errsCount:errsCount,it:it}=cxt;if(!errsCount)throw new Error("ajv implementation error");const{allErrors:allErrors,opts:opts}=it;it.props=true;if(opts.removeAdditional!=="all"&&util_1.alwaysValidSchema(it,schema))return;const props=code_1.allSchemaProperties(parentSchema.properties);const patProps=code_1.allSchemaProperties(parentSchema.patternProperties);checkAdditionalProperties();cxt.ok(codegen_1._`${errsCount} === ${names_1.default.errors}`);function checkAdditionalProperties(){gen.forIn("key",data,(key=>{if(!props.length&&!patProps.length)additionalPropertyCode(key);else gen.if(isAdditional(key),(()=>additionalPropertyCode(key)))}))}function isAdditional(key){let definedProp;if(props.length>8){const propsSchema=util_1.schemaRefOrVal(it,parentSchema.properties,"properties");definedProp=code_1.isOwnProperty(gen,propsSchema,key)}else if(props.length){definedProp=codegen_1.or(...props.map((p=>codegen_1._`${key} === ${p}`)))}else{definedProp=codegen_1.nil}if(patProps.length){definedProp=codegen_1.or(definedProp,...patProps.map((p=>codegen_1._`${code_1.usePattern(gen,p)}.test(${key})`)))}return codegen_1.not(definedProp)}function deleteAdditional(key){gen.code(codegen_1._`delete ${data}[${key}]`)}function additionalPropertyCode(key){if(opts.removeAdditional==="all"||opts.removeAdditional&&schema===false){deleteAdditional(key);return}if(schema===false){cxt.setParams({additionalProperty:key});cxt.error();if(!allErrors)gen.break();return}if(typeof schema=="object"&&!util_1.alwaysValidSchema(it,schema)){const valid=gen.name("valid");if(opts.removeAdditional==="failing"){applyAdditionalSchema(key,valid,false);gen.if(codegen_1.not(valid),(()=>{cxt.reset();deleteAdditional(key)}))}else{applyAdditionalSchema(key,valid);if(!allErrors)gen.if(codegen_1.not(valid),(()=>gen.break()))}}}function applyAdditionalSchema(key,valid,errors){const subschema={keyword:"additionalProperties",dataProp:key,dataPropType:subschema_1.Type.Str};if(errors===false){Object.assign(subschema,{compositeRule:true,createErrors:false,allErrors:false})}cxt.subschema(subschema,valid)}}};exports.default=def},{"../../compile/codegen":12,"../../compile/names":18,"../../compile/subschema":21,"../../compile/util":23,"../code":49}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const util_1=require("../../compile/util");const def={keyword:"allOf",schemaType:"array",code(cxt){const{gen:gen,schema:schema,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");const valid=gen.name("valid");schema.forEach(((sch,i)=>{if(util_1.alwaysValidSchema(it,sch))return;const schCxt=cxt.subschema({keyword:"allOf",schemaProp:i},valid);cxt.ok(valid);cxt.mergeEvaluated(schCxt)}))}};exports.default=def},{"../../compile/util":23}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const def={keyword:"anyOf",schemaType:"array",trackErrors:true,code:code_1.validateUnion,error:{message:"should match some schema in anyOf"}};exports.default=def},{"../code":49}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const subschema_1=require("../../compile/subschema");const util_1=require("../../compile/util");const validate_1=require("../../compile/validate");const error={message:({params:{min:min,max:max}})=>max===undefined?codegen_1.str`should contain at least ${min} valid item(s)`:codegen_1.str`should contain at least ${min} and no more than ${max} valid item(s)`,params:({params:{min:min,max:max}})=>max===undefined?codegen_1._`{minContains: ${min}}`:codegen_1._`{minContains: ${min}, maxContains: ${max}}`};const def={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:true,error:error,code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,it:it}=cxt;let min;let max;const{minContains:minContains,maxContains:maxContains}=parentSchema;if(it.opts.next){min=minContains===undefined?1:minContains;max=maxContains}else{min=1}const len=gen.const("len",codegen_1._`${data}.length`);cxt.setParams({min:min,max:max});if(max===undefined&&min===0){validate_1.checkStrictMode(it,`"minContains" == 0 without "maxContains": "contains" keyword ignored`);return}if(max!==undefined&&min>max){validate_1.checkStrictMode(it,`"minContains" > "maxContains" is always invalid`);cxt.fail();return}if(util_1.alwaysValidSchema(it,schema)){let cond=codegen_1._`${len} >= ${min}`;if(max!==undefined)cond=codegen_1._`${cond} && ${len} <= ${max}`;cxt.pass(cond);return}it.items=true;const valid=gen.name("valid");if(max===undefined&&min===1){validateItems(valid,(()=>gen.if(valid,(()=>gen.break()))))}else{gen.let(valid,false);const schValid=gen.name("_valid");const count=gen.let("count",0);validateItems(schValid,(()=>gen.if(schValid,(()=>checkLimits(count)))))}cxt.result(valid,(()=>cxt.reset()));function validateItems(_valid,block){gen.forRange("i",0,len,(i=>{cxt.subschema({keyword:"contains",dataProp:i,dataPropType:subschema_1.Type.Num,compositeRule:true},_valid);block()}))}function checkLimits(count){gen.code(codegen_1._`${count}++`);if(max===undefined){gen.if(codegen_1._`${count} >= ${min}`,(()=>gen.assign(valid,true).break()))}else{gen.if(codegen_1._`${count} > ${max}`,(()=>gen.assign(valid,false).break()));if(min===1)gen.assign(valid,true);else gen.if(codegen_1._`${count} >= ${min}`,(()=>gen.assign(valid,true)))}}}};exports.default=def},{"../../compile/codegen":12,"../../compile/subschema":21,"../../compile/util":23,"../../compile/validate":28}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateSchemaDeps=exports.validatePropertyDeps=exports.error=void 0;const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const code_1=require("../code");exports.error={message:({params:{property:property,depsCount:depsCount,deps:deps}})=>{const property_ies=depsCount===1?"property":"properties";return codegen_1.str`should have ${property_ies} ${deps} when property ${property} is present`},params:({params:{property:property,depsCount:depsCount,deps:deps,missingProperty:missingProperty}})=>codegen_1._`{property: ${property},
    missingProperty: ${missingProperty},
    depsCount: ${depsCount},
    deps: ${deps}}`};const def={keyword:"dependencies",type:"object",schemaType:"object",error:exports.error,code(cxt){const[propDeps,schDeps]=splitDependencies(cxt);validatePropertyDeps(cxt,propDeps);validateSchemaDeps(cxt,schDeps)}};function splitDependencies({schema:schema}){const propertyDeps={};const schemaDeps={};for(const key in schema){if(key==="__proto__")continue;const deps=Array.isArray(schema[key])?propertyDeps:schemaDeps;deps[key]=schema[key]}return[propertyDeps,schemaDeps]}function validatePropertyDeps(cxt,propertyDeps=cxt.schema){const{gen:gen,data:data,it:it}=cxt;if(Object.keys(propertyDeps).length===0)return;const missing=gen.let("missing");for(const prop in propertyDeps){const deps=propertyDeps[prop];if(deps.length===0)continue;const hasProperty=code_1.propertyInData(gen,data,prop,it.opts.ownProperties);cxt.setParams({property:prop,depsCount:deps.length,deps:deps.join(", ")});if(it.allErrors){gen.if(hasProperty,(()=>{for(const depProp of deps){code_1.checkReportMissingProp(cxt,depProp)}}))}else{gen.if(codegen_1._`${hasProperty} && (${code_1.checkMissingProp(cxt,deps,missing)})`);code_1.reportMissingProp(cxt,missing);gen.else()}}}exports.validatePropertyDeps=validatePropertyDeps;function validateSchemaDeps(cxt,schemaDeps=cxt.schema){const{gen:gen,data:data,keyword:keyword,it:it}=cxt;const valid=gen.name("valid");for(const prop in schemaDeps){if(util_1.alwaysValidSchema(it,schemaDeps[prop]))continue;gen.if(code_1.propertyInData(gen,data,prop,it.opts.ownProperties),(()=>{const schCxt=cxt.subschema({keyword:keyword,schemaProp:prop},valid);cxt.mergeValidEvaluated(schCxt,valid)}),(()=>gen.var(valid,true)));cxt.ok(valid)}}exports.validateSchemaDeps=validateSchemaDeps;exports.default=def},{"../../compile/codegen":12,"../../compile/util":23,"../code":49}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const validate_1=require("../../compile/validate");const error={message:({params:params})=>codegen_1.str`should match "${params.ifClause}" schema`,params:({params:params})=>codegen_1._`{failingKeyword: ${params.ifClause}}`};const def={keyword:"if",schemaType:["object","boolean"],trackErrors:true,error:error,code(cxt){const{gen:gen,parentSchema:parentSchema,it:it}=cxt;if(parentSchema.then===undefined&&parentSchema.else===undefined){validate_1.checkStrictMode(it,'"if" without "then" and "else" is ignored')}const hasThen=hasSchema(it,"then");const hasElse=hasSchema(it,"else");if(!hasThen&&!hasElse)return;const valid=gen.let("valid",true);const schValid=gen.name("_valid");validateIf();cxt.reset();if(hasThen&&hasElse){const ifClause=gen.let("ifClause");cxt.setParams({ifClause:ifClause});gen.if(schValid,validateClause("then",ifClause),validateClause("else",ifClause))}else if(hasThen){gen.if(schValid,validateClause("then"))}else{gen.if(codegen_1.not(schValid),validateClause("else"))}cxt.pass(valid,(()=>cxt.error(true)));function validateIf(){const schCxt=cxt.subschema({keyword:"if",compositeRule:true,createErrors:false,allErrors:false},schValid);cxt.mergeEvaluated(schCxt)}function validateClause(keyword,ifClause){return()=>{const schCxt=cxt.subschema({keyword:keyword},schValid);gen.assign(valid,schValid);cxt.mergeValidEvaluated(schCxt,valid);if(ifClause)gen.assign(ifClause,codegen_1._`${keyword}`);else cxt.setParams({ifClause:keyword})}}}};function hasSchema(it,keyword){const schema=it.schema[keyword];return schema!==undefined&&!util_1.alwaysValidSchema(it,schema)}exports.default=def},{"../../compile/codegen":12,"../../compile/util":23,"../../compile/validate":28}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const additionalItems_1=require("./additionalItems");const items_1=require("./items");const contains_1=require("./contains");const dependencies_1=require("./dependencies");const propertyNames_1=require("./propertyNames");const additionalProperties_1=require("./additionalProperties");const properties_1=require("./properties");const patternProperties_1=require("./patternProperties");const not_1=require("./not");const anyOf_1=require("./anyOf");const oneOf_1=require("./oneOf");const allOf_1=require("./allOf");const if_1=require("./if");const thenElse_1=require("./thenElse");const applicator=[not_1.default,anyOf_1.default,oneOf_1.default,allOf_1.default,if_1.default,thenElse_1.default,additionalItems_1.default,items_1.default,contains_1.default,propertyNames_1.default,additionalProperties_1.default,dependencies_1.default,properties_1.default,patternProperties_1.default];exports.default=applicator},{"./additionalItems":34,"./additionalProperties":35,"./allOf":36,"./anyOf":37,"./contains":38,"./dependencies":39,"./if":40,"./items":42,"./not":43,"./oneOf":44,"./patternProperties":45,"./properties":46,"./propertyNames":47,"./thenElse":48}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const validate_1=require("../../compile/validate");const code_1=require("../code");const def={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(cxt){const{gen:gen,schema:schema,it:it}=cxt;if(Array.isArray(schema)){if(it.opts.unevaluated&&schema.length&&it.items!==true){it.items=util_1.mergeEvaluated.items(gen,schema.length,it.items)}validateTuple(schema)}else{it.items=true;if(util_1.alwaysValidSchema(it,schema))return;cxt.ok(code_1.validateArray(cxt))}function validateTuple(schArr){const{parentSchema:parentSchema,data:data}=cxt;if(it.opts.strictTuples&&!fullTupleSchema(schArr.length,parentSchema)){const msg=`"items" is ${schArr.length}-tuple, but minItems or maxItems/additionalItems are not specified or different`;validate_1.checkStrictMode(it,msg,it.opts.strictTuples)}const valid=gen.name("valid");const len=gen.const("len",codegen_1._`${data}.length`);schArr.forEach(((sch,i)=>{if(util_1.alwaysValidSchema(it,sch))return;gen.if(codegen_1._`${len} > ${i}`,(()=>cxt.subschema({keyword:"items",schemaProp:i,dataProp:i},valid)));cxt.ok(valid)}))}}};function fullTupleSchema(len,sch){return len===sch.minItems&&(len===sch.maxItems||sch.additionalItems===false)}exports.default=def},{"../../compile/codegen":12,"../../compile/util":23,"../../compile/validate":28,"../code":49}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const util_1=require("../../compile/util");const def={keyword:"not",schemaType:["object","boolean"],trackErrors:true,code(cxt){const{gen:gen,schema:schema,it:it}=cxt;if(util_1.alwaysValidSchema(it,schema)){cxt.fail();return}const valid=gen.name("valid");cxt.subschema({keyword:"not",compositeRule:true,createErrors:false,allErrors:false},valid);cxt.result(valid,(()=>cxt.error()),(()=>cxt.reset()))},error:{message:"should NOT be valid"}};exports.default=def},{"../../compile/util":23}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const error={message:"should match exactly one schema in oneOf",params:({params:params})=>codegen_1._`{passingSchemas: ${params.passing}}`};const def={keyword:"oneOf",schemaType:"array",trackErrors:true,error:error,code(cxt){const{gen:gen,schema:schema,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");const schArr=schema;const valid=gen.let("valid",false);const passing=gen.let("passing",null);const schValid=gen.name("_valid");cxt.setParams({passing:passing});gen.block(validateOneOf);cxt.result(valid,(()=>cxt.reset()),(()=>cxt.error(true)));function validateOneOf(){schArr.forEach(((sch,i)=>{let schCxt;if(util_1.alwaysValidSchema(it,sch)){gen.var(schValid,true)}else{schCxt=cxt.subschema({keyword:"oneOf",schemaProp:i,compositeRule:true},schValid)}if(i>0){gen.if(codegen_1._`${schValid} && ${valid}`).assign(valid,false).assign(passing,codegen_1._`[${passing}, ${i}]`).else()}gen.if(schValid,(()=>{gen.assign(valid,true);gen.assign(passing,i);if(schCxt)cxt.mergeEvaluated(schCxt,codegen_1.Name)}))}))}}};exports.default=def},{"../../compile/codegen":12,"../../compile/util":23}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const codegen_1=require("../../compile/codegen");const subschema_1=require("../../compile/subschema");const validate_1=require("../../compile/validate");const util_1=require("../../compile/util");const def={keyword:"patternProperties",type:"object",schemaType:"object",code(cxt){const{gen:gen,schema:schema,data:data,parentSchema:parentSchema,it:it}=cxt;const{opts:opts}=it;const patterns=code_1.schemaProperties(it,schema);if(patterns.length===0)return;const checkProperties=opts.strict&&!opts.allowMatchingProperties&&parentSchema.properties;const valid=gen.name("valid");if(it.props!==true&&!(it.props instanceof codegen_1.Name)){it.props=util_1.evaluatedPropsToName(gen,it.props)}const{props:props}=it;validatePatternProperties();function validatePatternProperties(){for(const pat of patterns){if(checkProperties)checkMatchingProperties(pat);if(it.allErrors){validateProperties(pat)}else{gen.var(valid,true);validateProperties(pat);gen.if(valid)}}}function checkMatchingProperties(pat){for(const prop in checkProperties){if(new RegExp(pat).test(prop)){validate_1.checkStrictMode(it,`property ${prop} matches pattern ${pat} (use allowMatchingProperties)`)}}}function validateProperties(pat){gen.forIn("key",data,(key=>{gen.if(codegen_1._`${code_1.usePattern(gen,pat)}.test(${key})`,(()=>{cxt.subschema({keyword:"patternProperties",schemaProp:pat,dataProp:key,dataPropType:subschema_1.Type.Str},valid);if(it.opts.unevaluated&&props!==true){gen.assign(codegen_1._`${props}[${key}]`,true)}else if(!it.allErrors){gen.if(codegen_1.not(valid),(()=>gen.break()))}}))}))}}};exports.default=def},{"../../compile/codegen":12,"../../compile/subschema":21,"../../compile/util":23,"../../compile/validate":28,"../code":49}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const context_1=require("../../compile/context");const code_1=require("../code");const util_1=require("../../compile/util");const additionalProperties_1=require("./additionalProperties");const def={keyword:"properties",type:"object",schemaType:"object",code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,it:it}=cxt;if(it.opts.removeAdditional==="all"&&parentSchema.additionalProperties===undefined){additionalProperties_1.default.code(new context_1.default(it,additionalProperties_1.default,"additionalProperties"))}const allProps=code_1.allSchemaProperties(schema);for(const prop of allProps){it.definedProperties.add(prop)}if(it.opts.unevaluated&&allProps.length&&it.props!==true){it.props=util_1.mergeEvaluated.props(gen,util_1.toHash(allProps),it.props)}const properties=allProps.filter((p=>!util_1.alwaysValidSchema(it,schema[p])));if(properties.length===0)return;const valid=gen.name("valid");for(const prop of properties){if(hasDefault(prop)){applyPropertySchema(prop)}else{gen.if(code_1.propertyInData(gen,data,prop,it.opts.ownProperties));applyPropertySchema(prop);if(!it.allErrors)gen.else().var(valid,true);gen.endIf()}cxt.it.definedProperties.add(prop);cxt.ok(valid)}function hasDefault(prop){return it.opts.useDefaults&&!it.compositeRule&&schema[prop].default!==undefined}function applyPropertySchema(prop){cxt.subschema({keyword:"properties",schemaProp:prop,dataProp:prop},valid)}}};exports.default=def},{"../../compile/context":14,"../../compile/util":23,"../code":49,"./additionalProperties":35}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const error={message:({params:params})=>codegen_1.str`property name '${params.propertyName}' is invalid`,params:({params:params})=>codegen_1._`{propertyName: ${params.propertyName}}`};const def={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:error,code(cxt){const{gen:gen,schema:schema,data:data,it:it}=cxt;if(util_1.alwaysValidSchema(it,schema))return;const valid=gen.name("valid");gen.forIn("key",data,(key=>{cxt.setParams({propertyName:key});cxt.subschema({keyword:"propertyNames",data:key,dataTypes:["string"],propertyName:key,compositeRule:true},valid);gen.if(codegen_1.not(valid),(()=>{cxt.error(true);if(!it.allErrors)gen.break()}))}));cxt.ok(valid)}};exports.default=def},{"../../compile/codegen":12,"../../compile/util":23}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const validate_1=require("../../compile/validate");const def={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:keyword,parentSchema:parentSchema,it:it}){if(parentSchema.if===undefined)validate_1.checkStrictMode(it,`"${keyword}" without "if" is ignored`)}};exports.default=def},{"../../compile/validate":28}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateUnion=exports.validateArray=exports.usePattern=exports.callValidateCode=exports.schemaProperties=exports.allSchemaProperties=exports.noPropertyInData=exports.propertyInData=exports.isOwnProperty=exports.hasPropFunc=exports.reportMissingProp=exports.checkMissingProp=exports.checkReportMissingProp=void 0;const codegen_1=require("../compile/codegen");const util_1=require("../compile/util");const subschema_1=require("../compile/subschema");const names_1=require("../compile/names");function checkReportMissingProp(cxt,prop){const{gen:gen,data:data,it:it}=cxt;gen.if(noPropertyInData(gen,data,prop,it.opts.ownProperties),(()=>{cxt.setParams({missingProperty:codegen_1._`${prop}`},true);cxt.error()}))}exports.checkReportMissingProp=checkReportMissingProp;function checkMissingProp({gen:gen,data:data,it:{opts:opts}},properties,missing){return codegen_1.or(...properties.map((prop=>codegen_1.and(noPropertyInData(gen,data,prop,opts.ownProperties),codegen_1._`${missing} = ${prop}`))))}exports.checkMissingProp=checkMissingProp;function reportMissingProp(cxt,missing){cxt.setParams({missingProperty:missing},true);cxt.error()}exports.reportMissingProp=reportMissingProp;function hasPropFunc(gen){return gen.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:codegen_1._`Object.prototype.hasOwnProperty`})}exports.hasPropFunc=hasPropFunc;function isOwnProperty(gen,data,property){return codegen_1._`${hasPropFunc(gen)}.call(${data}, ${property})`}exports.isOwnProperty=isOwnProperty;function propertyInData(gen,data,property,ownProperties){const cond=codegen_1._`${data}${codegen_1.getProperty(property)} !== undefined`;return ownProperties?codegen_1._`${cond} && ${isOwnProperty(gen,data,property)}`:cond}exports.propertyInData=propertyInData;function noPropertyInData(gen,data,property,ownProperties){const cond=codegen_1._`${data}${codegen_1.getProperty(property)} === undefined`;return ownProperties?codegen_1.or(cond,codegen_1.not(isOwnProperty(gen,data,property))):cond}exports.noPropertyInData=noPropertyInData;function allSchemaProperties(schemaMap){return schemaMap?Object.keys(schemaMap).filter((p=>p!=="__proto__")):[]}exports.allSchemaProperties=allSchemaProperties;function schemaProperties(it,schemaMap){return allSchemaProperties(schemaMap).filter((p=>!util_1.alwaysValidSchema(it,schemaMap[p])))}exports.schemaProperties=schemaProperties;function callValidateCode({schemaCode:schemaCode,data:data,it:{gen:gen,topSchemaRef:topSchemaRef,schemaPath:schemaPath,errorPath:errorPath},it:it},func,context,passSchema){const dataAndSchema=passSchema?codegen_1._`${schemaCode}, ${data}, ${topSchemaRef}${schemaPath}`:data;const valCxt=[[names_1.default.dataPath,codegen_1.strConcat(names_1.default.dataPath,errorPath)],[names_1.default.parentData,it.parentData],[names_1.default.parentDataProperty,it.parentDataProperty],[names_1.default.rootData,names_1.default.rootData]];if(it.opts.dynamicRef)valCxt.push([names_1.default.dynamicAnchors,names_1.default.dynamicAnchors]);const args=codegen_1._`${dataAndSchema}, ${gen.object(...valCxt)}`;return context!==codegen_1.nil?codegen_1._`${func}.call(${context}, ${args})`:codegen_1._`${func}(${args})`}exports.callValidateCode=callValidateCode;function usePattern(gen,pattern){return gen.scopeValue("pattern",{key:pattern,ref:new RegExp(pattern,"u"),code:codegen_1._`new RegExp(${pattern}, "u")`})}exports.usePattern=usePattern;function validateArray(cxt){const{gen:gen,data:data,keyword:keyword,it:it}=cxt;const valid=gen.name("valid");if(it.allErrors){const validArr=gen.let("valid",true);validateItems((()=>gen.assign(validArr,false)));return validArr}gen.var(valid,true);validateItems((()=>gen.break()));return valid;function validateItems(notValid){const len=gen.const("len",codegen_1._`${data}.length`);gen.forRange("i",0,len,(i=>{cxt.subschema({keyword:keyword,dataProp:i,dataPropType:subschema_1.Type.Num},valid);gen.if(codegen_1.not(valid),notValid)}))}}exports.validateArray=validateArray;function validateUnion(cxt){const{gen:gen,schema:schema,keyword:keyword,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");const alwaysValid=schema.some((sch=>util_1.alwaysValidSchema(it,sch)));if(alwaysValid&&!it.opts.unevaluated)return;const valid=gen.let("valid",false);const schValid=gen.name("_valid");gen.block((()=>schema.forEach(((_sch,i)=>{const schCxt=cxt.subschema({keyword:keyword,schemaProp:i,compositeRule:true},schValid);gen.assign(valid,codegen_1._`${valid} || ${schValid}`);const merged=cxt.mergeValidEvaluated(schCxt,schValid);if(!merged)gen.if(codegen_1.not(valid))}))));cxt.result(valid,(()=>cxt.reset()),(()=>cxt.error(true)))}exports.validateUnion=validateUnion},{"../compile/codegen":12,"../compile/names":18,"../compile/subschema":21,"../compile/util":23}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const def={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};exports.default=def},{}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const id_1=require("./id");const ref_1=require("./ref");const core=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",id_1.default,ref_1.default];exports.default=core},{"./id":50,"./ref":52}],52:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.callRef=exports.getValidate=void 0;const error_classes_1=require("../../compile/error_classes");const code_1=require("../code");const codegen_1=require("../../compile/codegen");const names_1=require("../../compile/names");const compile_1=require("../../compile");const util_1=require("../../compile/util");const def={keyword:"$ref",schemaType:"string",code(cxt){const{gen:gen,schema:schema,it:it}=cxt;const{baseId:baseId,schemaEnv:env,validateName:validateName,opts:opts,self:self}=it;if(schema==="#"||schema==="#/")return callRootRef();const schOrEnv=compile_1.resolveRef.call(self,env.root,baseId,schema);if(schOrEnv===undefined)throw new error_classes_1.MissingRefError(baseId,schema);if(schOrEnv instanceof compile_1.SchemaEnv)return callValidate(schOrEnv);return inlineRefSchema(schOrEnv);function callRootRef(){if(env===env.root)return callRef(cxt,validateName,env,env.$async);const rootName=gen.scopeValue("root",{ref:env.root});return callRef(cxt,codegen_1._`${rootName}.validate`,env.root,env.root.$async)}function callValidate(sch){const v=getValidate(cxt,sch);callRef(cxt,v,sch,sch.$async)}function inlineRefSchema(sch){const schName=gen.scopeValue("schema",opts.code.source===true?{ref:sch,code:codegen_1.stringify(sch)}:{ref:sch});const valid=gen.name("valid");const schCxt=cxt.subschema({schema:sch,dataTypes:[],schemaPath:codegen_1.nil,topSchemaRef:schName,errSchemaPath:schema},valid);cxt.mergeEvaluated(schCxt);cxt.ok(valid)}}};function getValidate(cxt,sch){const{gen:gen}=cxt;return sch.validate?gen.scopeValue("validate",{ref:sch.validate}):codegen_1._`${gen.scopeValue("wrapper",{ref:sch})}.validate`}exports.getValidate=getValidate;function callRef(cxt,v,sch,$async){const{gen:gen,it:it}=cxt;const{allErrors:allErrors,schemaEnv:env,opts:opts}=it;const passCxt=opts.passContext?names_1.default.this:codegen_1.nil;if($async)callAsyncRef();else callSyncRef();function callAsyncRef(){if(!env.$async)throw new Error("async schema referenced by sync schema");const valid=gen.let("valid");gen.try((()=>{gen.code(codegen_1._`await ${code_1.callValidateCode(cxt,v,passCxt)}`);addEvaluatedFrom(v);if(!allErrors)gen.assign(valid,true)}),(e=>{gen.if(codegen_1._`!(${e} instanceof ${it.ValidationError})`,(()=>gen.throw(e)));addErrorsFrom(e);if(!allErrors)gen.assign(valid,false)}));cxt.ok(valid)}function callSyncRef(){cxt.result(code_1.callValidateCode(cxt,v,passCxt),(()=>addEvaluatedFrom(v)),(()=>addErrorsFrom(v)))}function addErrorsFrom(source){const errs=codegen_1._`${source}.errors`;gen.assign(names_1.default.vErrors,codegen_1._`${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`);gen.assign(names_1.default.errors,codegen_1._`${names_1.default.vErrors}.length`)}function addEvaluatedFrom(source){var _a;if(!it.opts.unevaluated)return;const schEvaluated=(_a=sch===null||sch===void 0?void 0:sch.validate)===null||_a===void 0?void 0:_a.evaluated;if(it.props!==true){if(schEvaluated&&!schEvaluated.dynamicProps){if(schEvaluated.props!==undefined){it.props=util_1.mergeEvaluated.props(gen,schEvaluated.props,it.props)}}else{const props=gen.var("props",codegen_1._`${source}.evaluated.props`);it.props=util_1.mergeEvaluated.props(gen,props,it.props,codegen_1.Name)}}if(it.items!==true){if(schEvaluated&&!schEvaluated.dynamicItems){if(schEvaluated.items!==undefined){it.items=util_1.mergeEvaluated.items(gen,schEvaluated.items,it.items)}}else{const items=gen.var("items",codegen_1._`${source}.evaluated.items`);it.items=util_1.mergeEvaluated.items(gen,items,it.items,codegen_1.Name)}}}}exports.callRef=callRef;exports.default=def},{"../../compile":17,"../../compile/codegen":12,"../../compile/error_classes":15,"../../compile/names":18,"../../compile/util":23,"../code":49}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const core_1=require("./core");const validation_1=require("./validation");const applicator_1=require("./applicator");const format_1=require("./format");const metadata_1=require("./metadata");const draft7Vocabularies=[core_1.default,validation_1.default,applicator_1.default,format_1.default,metadata_1.metadataVocabulary,metadata_1.contentVocabulary];exports.default=draft7Vocabularies},{"./applicator":41,"./core":51,"./format":55,"./metadata":56,"./validation":59}],54:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const error={message:({schemaCode:schemaCode})=>codegen_1.str`should match format "${schemaCode}"`,params:({schemaCode:schemaCode})=>codegen_1._`{format: ${schemaCode}}`};const def={keyword:"format",type:["number","string"],schemaType:"string",$data:true,error:error,code(cxt,ruleType){const{gen:gen,data:data,$data:$data,schema:schema,schemaCode:schemaCode,it:it}=cxt;const{opts:opts,errSchemaPath:errSchemaPath,schemaEnv:schemaEnv,self:self}=it;if(!opts.validateFormats)return;if($data)validate$DataFormat();else validateFormat();function validate$DataFormat(){const fmts=gen.scopeValue("formats",{ref:self.formats,code:opts.code.formats});const fDef=gen.const("fDef",codegen_1._`${fmts}[${schemaCode}]`);const fType=gen.let("fType");const format=gen.let("format");gen.if(codegen_1._`typeof ${fDef} == "object" && !(${fDef} instanceof RegExp)`,(()=>gen.assign(fType,codegen_1._`${fDef}.type || "string"`).assign(format,codegen_1._`${fDef}.validate`)),(()=>gen.assign(fType,codegen_1._`"string"`).assign(format,fDef)));cxt.fail$data(codegen_1.or(unknownFmt(),invalidFmt()));function unknownFmt(){if(opts.strict===false)return codegen_1.nil;return codegen_1._`${schemaCode} && !${format}`}function invalidFmt(){const callFormat=schemaEnv.$async?codegen_1._`(${fDef}.async ? await ${format}(${data}) : ${format}(${data}))`:codegen_1._`${format}(${data})`;const validData=codegen_1._`(typeof ${format} == "function" ? ${callFormat} : ${format}.test(${data}))`;return codegen_1._`${format} && ${format} !== true && ${fType} === ${ruleType} && !${validData}`}}function validateFormat(){const formatDef=self.formats[schema];if(!formatDef){unknownFormat();return}if(formatDef===true)return;const[fmtType,format,fmtRef]=getFormat(formatDef);if(fmtType===ruleType)cxt.pass(validCondition());function unknownFormat(){if(opts.strict===false){self.logger.warn(unknownMsg());return}throw new Error(unknownMsg());function unknownMsg(){return`unknown format "${schema}" ignored in schema at path "${errSchemaPath}"`}}function getFormat(fmtDef){const fmt=gen.scopeValue("formats",{key:schema,ref:fmtDef,code:opts.code.formats?codegen_1._`${opts.code.formats}${codegen_1.getProperty(schema)}`:undefined});if(typeof fmtDef=="object"&&!(fmtDef instanceof RegExp)){return[fmtDef.type||"string",fmtDef.validate,codegen_1._`${fmt}.validate`]}return["string",fmtDef,fmt]}function validCondition(){if(typeof formatDef=="object"&&!(formatDef instanceof RegExp)&&formatDef.async){if(!schemaEnv.$async)throw new Error("async format in sync schema");return codegen_1._`await ${fmtRef}(${data})`}return typeof format=="function"?codegen_1._`${fmtRef}(${data})`:codegen_1._`${fmtRef}.test(${data})`}}}};exports.default=def},{"../../compile/codegen":12}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const format_1=require("./format");const format=[format_1.default];exports.default=format},{"./format":54}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.contentVocabulary=exports.metadataVocabulary=void 0;exports.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];exports.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},{}],57:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const equal=require("fast-deep-equal");const error={message:"should be equal to constant",params:({schemaCode:schemaCode})=>codegen_1._`{allowedValue: ${schemaCode}}`};const def={keyword:"const",$data:true,error:error,code(cxt){const eql=cxt.gen.scopeValue("func",{ref:equal,code:codegen_1._`require("ajv/dist/compile/equal")`});cxt.fail$data(codegen_1._`!${eql}(${cxt.data}, ${cxt.schemaCode})`)}};exports.default=def},{"../../compile/codegen":12,"fast-deep-equal":266}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const equal=require("fast-deep-equal");const error={message:"should be equal to one of the allowed values",params:({schemaCode:schemaCode})=>codegen_1._`{allowedValues: ${schemaCode}}`};const def={keyword:"enum",schemaType:"array",$data:true,error:error,code(cxt){const{gen:gen,data:data,$data:$data,schema:schema,schemaCode:schemaCode,it:it}=cxt;if(!$data&&schema.length===0)throw new Error("enum must have non-empty array");const useLoop=schema.length>=it.opts.loopEnum;const eql=cxt.gen.scopeValue("func",{ref:equal,code:codegen_1._`require("ajv/dist/compile/equal")`});let valid;if(useLoop||$data){valid=gen.let("valid");cxt.block$data(valid,loopEnum)}else{if(!Array.isArray(schema))throw new Error("ajv implementation error");const vSchema=gen.const("vSchema",schemaCode);valid=codegen_1.or(...schema.map(((_x,i)=>equalCode(vSchema,i))))}cxt.pass(valid);function loopEnum(){gen.assign(valid,false);gen.forOf("v",schemaCode,(v=>gen.if(codegen_1._`${eql}(${data}, ${v})`,(()=>gen.assign(valid,true).break()))))}function equalCode(vSchema,i){const sch=schema[i];return sch&&typeof sch==="object"?codegen_1._`${eql}(${data}, ${vSchema}[${i}])`:codegen_1._`${data} === ${sch}`}}};exports.default=def},{"../../compile/codegen":12,"fast-deep-equal":266}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const limitNumber_1=require("./limitNumber");const multipleOf_1=require("./multipleOf");const limitLength_1=require("./limitLength");const pattern_1=require("./pattern");const limitProperties_1=require("./limitProperties");const required_1=require("./required");const limitItems_1=require("./limitItems");const uniqueItems_1=require("./uniqueItems");const const_1=require("./const");const enum_1=require("./enum");const validation=[limitNumber_1.default,multipleOf_1.default,limitLength_1.default,pattern_1.default,limitProperties_1.default,required_1.default,limitItems_1.default,uniqueItems_1.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},const_1.default,enum_1.default];exports.default=validation},{"./const":57,"./enum":58,"./limitItems":60,"./limitLength":61,"./limitNumber":62,"./limitProperties":63,"./multipleOf":64,"./pattern":65,"./required":66,"./uniqueItems":67}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const error={message({keyword:keyword,schemaCode:schemaCode}){const comp=keyword==="maxItems"?"more":"fewer";return codegen_1.str`should NOT have ${comp} than ${schemaCode} items`},params:({schemaCode:schemaCode})=>codegen_1._`{limit: ${schemaCode}}`};const def={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:true,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt;const op=keyword==="maxItems"?codegen_1.operators.GT:codegen_1.operators.LT;cxt.fail$data(codegen_1._`${data}.length ${op} ${schemaCode}`)}};exports.default=def},{"../../compile/codegen":12}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const ucs2length_1=require("../../compile/ucs2length");const error={message({keyword:keyword,schemaCode:schemaCode}){const comp=keyword==="maxLength"?"more":"fewer";return codegen_1.str`should NOT have ${comp} than ${schemaCode} characters`},params:({schemaCode:schemaCode})=>codegen_1._`{limit: ${schemaCode}}`};const def={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:true,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode,it:it}=cxt;const op=keyword==="maxLength"?codegen_1.operators.GT:codegen_1.operators.LT;let len;if(it.opts.unicode===false){len=codegen_1._`${data}.length`}else{const u2l=cxt.gen.scopeValue("func",{ref:ucs2length_1.default,code:codegen_1._`require("ajv/dist/compile/ucs2length").default`});len=codegen_1._`${u2l}(${data})`}cxt.fail$data(codegen_1._`${len} ${op} ${schemaCode}`)}};exports.default=def},{"../../compile/codegen":12,"../../compile/ucs2length":22}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const ops=codegen_1.operators;const KWDs={maximum:{okStr:"<=",ok:ops.LTE,fail:ops.GT},minimum:{okStr:">=",ok:ops.GTE,fail:ops.LT},exclusiveMaximum:{okStr:"<",ok:ops.LT,fail:ops.GTE},exclusiveMinimum:{okStr:">",ok:ops.GT,fail:ops.LTE}};const error={message:({keyword:keyword,schemaCode:schemaCode})=>codegen_1.str`should be ${KWDs[keyword].okStr} ${schemaCode}`,params:({keyword:keyword,schemaCode:schemaCode})=>codegen_1._`{comparison: ${KWDs[keyword].okStr}, limit: ${schemaCode}}`};const def={keyword:Object.keys(KWDs),type:"number",schemaType:"number",$data:true,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt;cxt.fail$data(codegen_1._`${data} ${KWDs[keyword].fail} ${schemaCode} || isNaN(${data})`)}};exports.default=def},{"../../compile/codegen":12}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const error={message({keyword:keyword,schemaCode:schemaCode}){const comp=keyword==="maxProperties"?"more":"fewer";return codegen_1.str`should NOT have ${comp} than ${schemaCode} items`},params:({schemaCode:schemaCode})=>codegen_1._`{limit: ${schemaCode}}`};const def={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:true,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt;const op=keyword==="maxProperties"?codegen_1.operators.GT:codegen_1.operators.LT;cxt.fail$data(codegen_1._`Object.keys(${data}).length ${op} ${schemaCode}`)}};exports.default=def},{"../../compile/codegen":12}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const error={message:({schemaCode:schemaCode})=>codegen_1.str`should be multiple of ${schemaCode}`,params:({schemaCode:schemaCode})=>codegen_1._`{multipleOf: ${schemaCode}}`};const def={keyword:"multipleOf",type:"number",schemaType:"number",$data:true,error:error,code(cxt){const{gen:gen,data:data,schemaCode:schemaCode,it:it}=cxt;const prec=it.opts.multipleOfPrecision;const res=gen.let("res");const invalid=prec?codegen_1._`Math.abs(Math.round(${res}) - ${res}) > 1e-${prec}`:codegen_1._`${res} !== parseInt(${res})`;cxt.fail$data(codegen_1._`(${schemaCode} === 0 || (${res} = ${data}/${schemaCode}, ${invalid}))`)}};exports.default=def},{"../../compile/codegen":12}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const codegen_1=require("../../compile/codegen");const error={message:({schemaCode:schemaCode})=>codegen_1.str`should match pattern "${schemaCode}"`,params:({schemaCode:schemaCode})=>codegen_1._`{pattern: ${schemaCode}}`};const def={keyword:"pattern",type:"string",schemaType:"string",$data:true,error:error,code(cxt){const{gen:gen,data:data,$data:$data,schema:schema,schemaCode:schemaCode}=cxt;const regExp=$data?codegen_1._`(new RegExp(${schemaCode}, "u"))`:code_1.usePattern(gen,schema);cxt.fail$data(codegen_1._`!${regExp}.test(${data})`)}};exports.default=def},{"../../compile/codegen":12,"../code":49}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const codegen_1=require("../../compile/codegen");const validate_1=require("../../compile/validate");const error={message:({params:{missingProperty:missingProperty}})=>codegen_1.str`should have required property '${missingProperty}'`,params:({params:{missingProperty:missingProperty}})=>codegen_1._`{missingProperty: ${missingProperty}}`};const def={keyword:"required",type:"object",schemaType:"array",$data:true,error:error,code(cxt){const{gen:gen,schema:schema,schemaCode:schemaCode,data:data,$data:$data,it:it}=cxt;const{opts:opts}=it;if(!$data&&schema.length===0)return;const useLoop=schema.length>=opts.loopRequired;if(it.allErrors)allErrorsMode();else exitOnErrorMode();if(opts.strictRequired){const props=cxt.parentSchema.properties;const{definedProperties:definedProperties}=cxt.it;for(const requiredKey of schema){if((props===null||props===void 0?void 0:props[requiredKey])===undefined&&!definedProperties.has(requiredKey)){const schemaPath=it.schemaEnv.baseId+it.errSchemaPath;const msg=`required property "${requiredKey}" is not defined at "${schemaPath}" (strictRequired)`;validate_1.checkStrictMode(it,msg,it.opts.strictRequired)}}}function allErrorsMode(){if(useLoop||$data){cxt.block$data(codegen_1.nil,loopAllRequired)}else{for(const prop of schema){code_1.checkReportMissingProp(cxt,prop)}}}function exitOnErrorMode(){const missing=gen.let("missing");if(useLoop||$data){const valid=gen.let("valid",true);cxt.block$data(valid,(()=>loopUntilMissing(missing,valid)));cxt.ok(valid)}else{gen.if(code_1.checkMissingProp(cxt,schema,missing));code_1.reportMissingProp(cxt,missing);gen.else()}}function loopAllRequired(){gen.forOf("prop",schemaCode,(prop=>{cxt.setParams({missingProperty:prop});gen.if(code_1.noPropertyInData(gen,data,prop,opts.ownProperties),(()=>cxt.error()))}))}function loopUntilMissing(missing,valid){cxt.setParams({missingProperty:missing});gen.forOf(missing,schemaCode,(()=>{gen.assign(valid,code_1.propertyInData(gen,data,missing,opts.ownProperties));gen.if(codegen_1.not(valid),(()=>{cxt.error();gen.break()}))}),codegen_1.nil)}}};exports.default=def},{"../../compile/codegen":12,"../../compile/validate":28,"../code":49}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const dataType_1=require("../../compile/validate/dataType");const codegen_1=require("../../compile/codegen");const equal=require("fast-deep-equal");const error={message:({params:{i:i,j:j}})=>codegen_1.str`should NOT have duplicate items (items ## ${j} and ${i} are identical)`,params:({params:{i:i,j:j}})=>codegen_1._`{i: ${i}, j: ${j}}`};const def={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:true,error:error,code(cxt){const{gen:gen,data:data,$data:$data,schema:schema,parentSchema:parentSchema,schemaCode:schemaCode,it:it}=cxt;if(!$data&&!schema)return;const valid=gen.let("valid");const itemTypes=parentSchema.items?dataType_1.getSchemaTypes(parentSchema.items):[];cxt.block$data(valid,validateUniqueItems,codegen_1._`${schemaCode} === false`);cxt.ok(valid);function validateUniqueItems(){const i=gen.let("i",codegen_1._`${data}.length`);const j=gen.let("j");cxt.setParams({i:i,j:j});gen.assign(valid,true);gen.if(codegen_1._`${i} > 1`,(()=>(canOptimize()?loopN:loopN2)(i,j)))}function canOptimize(){return itemTypes.length>0&&!itemTypes.some((t=>t==="object"||t==="array"))}function loopN(i,j){const item=gen.name("item");const wrongType=dataType_1.checkDataTypes(itemTypes,item,it.opts.strict,dataType_1.DataType.Wrong);const indices=gen.const("indices",codegen_1._`{}`);gen.for(codegen_1._`;${i}--;`,(()=>{gen.let(item,codegen_1._`${data}[${i}]`);gen.if(wrongType,codegen_1._`continue`);if(itemTypes.length>1)gen.if(codegen_1._`typeof ${item} == "string"`,codegen_1._`${item} += "_"`);gen.if(codegen_1._`typeof ${indices}[${item}] == "number"`,(()=>{gen.assign(j,codegen_1._`${indices}[${item}]`);cxt.error();gen.assign(valid,false).break()})).code(codegen_1._`${indices}[${item}] = ${i}`)}))}function loopN2(i,j){const eql=cxt.gen.scopeValue("func",{ref:equal,code:codegen_1._`require("ajv/dist/compile/equal")`});const outer=gen.name("outer");gen.label(outer).for(codegen_1._`;${i}--;`,(()=>gen.for(codegen_1._`${j} = ${i}; ${j}--;`,(()=>gen.if(codegen_1._`${eql}(${data}[${i}], ${data}[${j}])`,(()=>{cxt.error();gen.assign(valid,false).break(outer)}))))))}}};exports.default=def},{"../../compile/codegen":12,"../../compile/validate/dataType":26,"fast-deep-equal":266}],68:[function(require,module,exports){module.exports=/^P(?!$)(\d+(?:\.\d+)?Y)?(\d+(?:\.\d+)?M)?(\d+(?:\.\d+)?W)?(\d+(?:\.\d+)?D)?(T(?=\d)(\d+(?:\.\d+)?H)?(\d+(?:\.\d+)?M)?(\d+(?:\.\d+)?S)?)?$/},{}],69:[function(require,module,exports){const{parse:parse}=require("smtp-address-parser");module.exports=value=>{try{parse(value);return true}catch(err){return false}}},{"smtp-address-parser":400}],70:[function(require,module,exports){const{toASCII:toASCII}=require("punycode");const hostnameRegex=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i;module.exports=value=>{const hostname=toASCII(value);return hostname.replace(/\.$/,"").length<=253&&hostnameRegex.test(hostname)}},{punycode:150}],71:[function(require,module,exports){module.exports.iri=require("./iri");module.exports.duration=require("./duration");module.exports["idn-email"]=require("./idn-email");module.exports["idn-hostname"]=require("./idn-hostname");module.exports["iri-reference"]=require("./iri-reference")},{"./duration":68,"./idn-email":69,"./idn-hostname":70,"./iri":73,"./iri-reference":72}],72:[function(require,module,exports){const{parse:parse}=require("uri-js");const AddressParser=require("smtp-address-parser").parse;const schemes=require("schemes");function validate(address){try{AddressParser(address);return true}catch(err){return false}}module.exports=value=>{const iri=parse(value);if(iri.scheme==="mailto"&&iri.to.every(validate)){return true}if((iri.reference==="absolute"||iri.reference==="uri")&&iri.path!==undefined&&schemes.allByName[iri.scheme]){return true}if(iri.scheme&&!schemes.allByName[iri.scheme]){return false}return iri.path!==undefined&&(iri.reference==="relative"||iri.reference==="same-document"||iri.reference==="uri")}},{schemes:392,"smtp-address-parser":400,"uri-js":435}],73:[function(require,module,exports){const{parse:parse}=require("uri-js");const{addressParser:addressParser}=require("smtp-address-parser");const schemes=require("schemes");function validate(address){try{addressParser(address);return true}catch(err){return false}}module.exports=value=>{const iri=parse(value);if(iri.scheme==="mailto"&&iri.to.every(validate)){return true}if((iri.reference==="absolute"||iri.reference==="uri")&&schemes.allByName[iri.scheme]){return true}return false}},{schemes:392,"smtp-address-parser":400,"uri-js":435}],74:[function(require,module,exports){const formats=require("./formats");module.exports=(ajv,options={})=>{const allFormats=Object.keys(formats);let formatsToInstall=allFormats;if(options.formats){if(!Array.isArray(options.formats))throw new Error("options.formats must be an array");formatsToInstall=options.formats}allFormats.filter((format=>formatsToInstall.includes(format))).forEach((key=>{ajv.addFormat(key,formats[key])}));return ajv}},{"./formats":71}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.formatNames=exports.fastFormats=exports.fullFormats=void 0;function fmtDef(validate,compare){return{validate:validate,compare:compare}}exports.fullFormats={date:fmtDef(date,compareDate),time:fmtDef(time,compareTime),"date-time":fmtDef(date_time,compareDateTime),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:uri,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:regex,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:byte,int32:{type:"number",validate:validateInt32},int64:{type:"number",validate:validateInt64},float:{type:"number",validate:validateNumber},double:{type:"number",validate:validateNumber},password:true,binary:true};exports.fastFormats={...exports.fullFormats,date:fmtDef(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,compareDate),time:fmtDef(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,compareTime),"date-time":fmtDef(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,compareDateTime),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};exports.formatNames=Object.keys(exports.fullFormats);function isLeapYear(year){return year%4===0&&(year%100!==0||year%400===0)}const DATE=/^(\d\d\d\d)-(\d\d)-(\d\d)$/;const DAYS=[0,31,28,31,30,31,30,31,31,30,31,30,31];function date(str){const matches=DATE.exec(str);if(!matches)return false;const year=+matches[1];const month=+matches[2];const day=+matches[3];return month>=1&&month<=12&&day>=1&&day<=(month===2&&isLeapYear(year)?29:DAYS[month])}function compareDate(d1,d2){if(!(d1&&d2))return undefined;if(d1>d2)return 1;if(d1<d2)return-1;return 0}const TIME=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function time(str,withTimeZone){const matches=TIME.exec(str);if(!matches)return false;const hour=+matches[1];const minute=+matches[2];const second=+matches[3];const timeZone=matches[5];return(hour<=23&&minute<=59&&second<=59||hour===23&&minute===59&&second===60)&&(!withTimeZone||timeZone!=="")}function compareTime(t1,t2){if(!(t1&&t2))return undefined;const a1=TIME.exec(t1);const a2=TIME.exec(t2);if(!(a1&&a2))return undefined;t1=a1[1]+a1[2]+a1[3]+(a1[4]||"");t2=a2[1]+a2[2]+a2[3]+(a2[4]||"");if(t1>t2)return 1;if(t1<t2)return-1;return 0}const DATE_TIME_SEPARATOR=/t|\s/i;function date_time(str){const dateTime=str.split(DATE_TIME_SEPARATOR);return dateTime.length===2&&date(dateTime[0])&&time(dateTime[1],true)}function compareDateTime(dt1,dt2){if(!(dt1&&dt2))return undefined;const[d1,t1]=dt1.split(DATE_TIME_SEPARATOR);const[d2,t2]=dt2.split(DATE_TIME_SEPARATOR);const res=compareDate(d1,d2);if(res===undefined)return undefined;return res||compareTime(t1,t2)}const NOT_URI_FRAGMENT=/\/|:/;const URI=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function uri(str){return NOT_URI_FRAGMENT.test(str)&&URI.test(str)}const BYTE=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function byte(str){BYTE.lastIndex=0;return BYTE.test(str)}const MIN_INT32=-(2**31);const MAX_INT32=2**31-1;function validateInt32(value){return Number.isInteger(value)&&value<=MAX_INT32&&value>=MIN_INT32}function validateInt64(value){return Number.isInteger(value)}function validateNumber(){return true}const Z_ANCHOR=/[^\\]\\Z/;function regex(str){if(Z_ANCHOR.test(str))return false;try{new RegExp(str);return true}catch(e){return false}}},{}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const formats_1=require("./formats");const limit_1=require("./limit");const codegen_1=require("ajv/dist/compile/codegen");const fullName=new codegen_1.Name("fullFormats");const fastName=new codegen_1.Name("fastFormats");const formatsPlugin=(ajv,opts={keywords:true})=>{if(Array.isArray(opts)){addFormats(ajv,opts,formats_1.fullFormats,fullName);return ajv}const[formats,exportName]=opts.mode==="fast"?[formats_1.fastFormats,fastName]:[formats_1.fullFormats,fullName];const list=opts.formats||formats_1.formatNames;addFormats(ajv,list,formats,exportName);if(opts.keywords)limit_1.default(ajv);return ajv};formatsPlugin.get=(name,mode="full")=>{const formats=mode==="fast"?formats_1.fastFormats:formats_1.fullFormats;const f=formats[name];if(!f)throw new Error(`Unknown format "${name}"`);return f};function addFormats(ajv,list,fs,exportName){var _a;var _b;(_a=(_b=ajv.opts.code).formats)!==null&&_a!==void 0?_a:_b.formats=codegen_1._`require("ajv-formats/dist/formats").${exportName}`;for(const f of list)ajv.addFormat(f,fs[f])}module.exports=exports=formatsPlugin;Object.defineProperty(exports,"__esModule",{value:true});exports.default=formatsPlugin},{"./formats":75,"./limit":77,"ajv/dist/compile/codegen":80}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.formatLimitDefinition=void 0;const ajv_1=require("ajv");const codegen_1=require("ajv/dist/compile/codegen");const ops=codegen_1.operators;const KWDs={formatMaximum:{okStr:"<=",ok:ops.LTE,fail:ops.GT},formatMinimum:{okStr:">=",ok:ops.GTE,fail:ops.LT},formatExclusiveMaximum:{okStr:"<",ok:ops.LT,fail:ops.GTE},formatExclusiveMinimum:{okStr:">",ok:ops.GT,fail:ops.LTE}};const error={message:({keyword:keyword,schemaCode:schemaCode})=>codegen_1.str`should be ${KWDs[keyword].okStr} ${schemaCode}`,params:({keyword:keyword,schemaCode:schemaCode})=>codegen_1._`{comparison: ${KWDs[keyword].okStr}, limit: ${schemaCode}}`};exports.formatLimitDefinition={keyword:Object.keys(KWDs),type:"string",schemaType:"string",$data:true,error:error,code(cxt){const{gen:gen,data:data,schemaCode:schemaCode,keyword:keyword,it:it}=cxt;const{opts:opts,self:self}=it;if(!opts.validateFormats)return;const fCxt=new ajv_1.KeywordCxt(it,self.RULES.all.format.definition,"format");if(fCxt.$data)validate$DataFormat();else validateFormat();function validate$DataFormat(){const fmts=gen.scopeValue("formats",{ref:self.formats,code:opts.code.formats});const fmt=gen.const("fmt",codegen_1._`${fmts}[${fCxt.schemaCode}]`);cxt.fail$data(codegen_1.or(codegen_1._`typeof ${fmt} != "object"`,codegen_1._`${fmt} instanceof RegExp`,codegen_1._`typeof ${fmt}.compare != "function"`,compareCode(fmt)))}function validateFormat(){const format=fCxt.schema;const fmtDef=self.formats[format];if(!fmtDef||fmtDef===true)return;if(typeof fmtDef!="object"||fmtDef instanceof RegExp||typeof fmtDef.compare!="function"){throw new Error(`"${keyword}": format "${format}" does not define "compare" function`)}const fmt=gen.scopeValue("formats",{key:format,ref:fmtDef,code:opts.code.formats?codegen_1._`${opts.code.formats}${codegen_1.getProperty(format)}`:undefined});cxt.fail$data(compareCode(fmt))}function compareCode(fmt){return codegen_1._`${fmt}.compare(${data}, ${schemaCode}) ${KWDs[keyword].fail} 0`}},dependencies:["format"]};const formatLimitPlugin=ajv=>{ajv.addKeyword(exports.formatLimitDefinition);return ajv};exports.default=formatLimitPlugin},{ajv:78,"ajv/dist/compile/codegen":80}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CodeGen=exports.Name=exports.nil=exports.stringify=exports.str=exports._=exports.KeywordCxt=void 0;const core_1=require("./core");const draft7_1=require("./vocabularies/draft7");const discriminator_1=require("./vocabularies/discriminator");const draft7MetaSchema=require("./refs/json-schema-draft-07.json");const META_SUPPORT_DATA=["/properties"];const META_SCHEMA_ID="http://json-schema.org/draft-07/schema";class Ajv extends core_1.default{_addVocabularies(){super._addVocabularies();draft7_1.default.forEach((v=>this.addVocabulary(v)));if(this.opts.discriminator)this.addKeyword(discriminator_1.default)}_addDefaultMetaSchema(){super._addDefaultMetaSchema();if(!this.opts.meta)return;const metaSchema=this.opts.$data?this.$dataMetaSchema(draft7MetaSchema,META_SUPPORT_DATA):draft7MetaSchema;this.addMetaSchema(metaSchema,META_SCHEMA_ID,false);this.refs["http://json-schema.org/schema"]=META_SCHEMA_ID}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(META_SCHEMA_ID)?META_SCHEMA_ID:undefined)}}module.exports=exports=Ajv;Object.defineProperty(exports,"__esModule",{value:true});exports.default=Ajv;var validate_1=require("./compile/validate");Object.defineProperty(exports,"KeywordCxt",{enumerable:true,get:function(){return validate_1.KeywordCxt}});var codegen_1=require("./compile/codegen");Object.defineProperty(exports,"_",{enumerable:true,get:function(){return codegen_1._}});Object.defineProperty(exports,"str",{enumerable:true,get:function(){return codegen_1.str}});Object.defineProperty(exports,"stringify",{enumerable:true,get:function(){return codegen_1.stringify}});Object.defineProperty(exports,"nil",{enumerable:true,get:function(){return codegen_1.nil}});Object.defineProperty(exports,"Name",{enumerable:true,get:function(){return codegen_1.Name}});Object.defineProperty(exports,"CodeGen",{enumerable:true,get:function(){return codegen_1.CodeGen}})},{"./compile/codegen":80,"./compile/validate":93,"./core":96,"./refs/json-schema-draft-07.json":98,"./vocabularies/discriminator":124,"./vocabularies/draft7":126}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.regexpCode=exports.getEsmExportName=exports.getProperty=exports.safeStringify=exports.stringify=exports.strConcat=exports.addCodeArg=exports.str=exports._=exports.nil=exports._Code=exports.Name=exports.IDENTIFIER=exports._CodeOrName=void 0;class _CodeOrName{}exports._CodeOrName=_CodeOrName;exports.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class Name extends _CodeOrName{constructor(s){super();if(!exports.IDENTIFIER.test(s))throw new Error("CodeGen: name must be a valid identifier");this.str=s}toString(){return this.str}emptyStr(){return false}get names(){return{[this.str]:1}}}exports.Name=Name;class _Code extends _CodeOrName{constructor(code){super();this._items=typeof code==="string"?[code]:code}toString(){return this.str}emptyStr(){if(this._items.length>1)return false;const item=this._items[0];return item===""||item==='""'}get str(){var _a;return(_a=this._str)!==null&&_a!==void 0?_a:this._str=this._items.reduce(((s,c)=>`${s}${c}`),"")}get names(){var _a;return(_a=this._names)!==null&&_a!==void 0?_a:this._names=this._items.reduce(((names,c)=>{if(c instanceof Name)names[c.str]=(names[c.str]||0)+1;return names}),{})}}exports._Code=_Code;exports.nil=new _Code("");function _(strs,...args){const code=[strs[0]];let i=0;while(i<args.length){addCodeArg(code,args[i]);code.push(strs[++i])}return new _Code(code)}exports._=_;const plus=new _Code("+");function str(strs,...args){const expr=[safeStringify(strs[0])];let i=0;while(i<args.length){expr.push(plus);addCodeArg(expr,args[i]);expr.push(plus,safeStringify(strs[++i]))}optimize(expr);return new _Code(expr)}exports.str=str;function addCodeArg(code,arg){if(arg instanceof _Code)code.push(...arg._items);else if(arg instanceof Name)code.push(arg);else code.push(interpolate(arg))}exports.addCodeArg=addCodeArg;function optimize(expr){let i=1;while(i<expr.length-1){if(expr[i]===plus){const res=mergeExprItems(expr[i-1],expr[i+1]);if(res!==undefined){expr.splice(i-1,3,res);continue}expr[i++]="+"}i++}}function mergeExprItems(a,b){if(b==='""')return a;if(a==='""')return b;if(typeof a=="string"){if(b instanceof Name||a[a.length-1]!=='"')return;if(typeof b!="string")return`${a.slice(0,-1)}${b}"`;if(b[0]==='"')return a.slice(0,-1)+b.slice(1);return}if(typeof b=="string"&&b[0]==='"'&&!(a instanceof Name))return`"${a}${b.slice(1)}`;return}function strConcat(c1,c2){return c2.emptyStr()?c1:c1.emptyStr()?c2:str`${c1}${c2}`}exports.strConcat=strConcat;function interpolate(x){return typeof x=="number"||typeof x=="boolean"||x===null?x:safeStringify(Array.isArray(x)?x.join(","):x)}function stringify(x){return new _Code(safeStringify(x))}exports.stringify=stringify;function safeStringify(x){return JSON.stringify(x).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}exports.safeStringify=safeStringify;function getProperty(key){return typeof key=="string"&&exports.IDENTIFIER.test(key)?new _Code(`.${key}`):_`[${key}]`}exports.getProperty=getProperty;function getEsmExportName(key){if(typeof key=="string"&&exports.IDENTIFIER.test(key)){return new _Code(`${key}`)}throw new Error(`CodeGen: invalid export name: ${key}, use explicit $id name mapping`)}exports.getEsmExportName=getEsmExportName;function regexpCode(rx){return new _Code(rx.toString())}exports.regexpCode=regexpCode},{}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.or=exports.and=exports.not=exports.CodeGen=exports.operators=exports.varKinds=exports.ValueScopeName=exports.ValueScope=exports.Scope=exports.Name=exports.regexpCode=exports.stringify=exports.getProperty=exports.nil=exports.strConcat=exports.str=exports._=void 0;const code_1=require("./code");const scope_1=require("./scope");var code_2=require("./code");Object.defineProperty(exports,"_",{enumerable:true,get:function(){return code_2._}});Object.defineProperty(exports,"str",{enumerable:true,get:function(){return code_2.str}});Object.defineProperty(exports,"strConcat",{enumerable:true,get:function(){return code_2.strConcat}});Object.defineProperty(exports,"nil",{enumerable:true,get:function(){return code_2.nil}});Object.defineProperty(exports,"getProperty",{enumerable:true,get:function(){return code_2.getProperty}});Object.defineProperty(exports,"stringify",{enumerable:true,get:function(){return code_2.stringify}});Object.defineProperty(exports,"regexpCode",{enumerable:true,get:function(){return code_2.regexpCode}});Object.defineProperty(exports,"Name",{enumerable:true,get:function(){return code_2.Name}});var scope_2=require("./scope");Object.defineProperty(exports,"Scope",{enumerable:true,get:function(){return scope_2.Scope}});Object.defineProperty(exports,"ValueScope",{enumerable:true,get:function(){return scope_2.ValueScope}});Object.defineProperty(exports,"ValueScopeName",{enumerable:true,get:function(){return scope_2.ValueScopeName}});Object.defineProperty(exports,"varKinds",{enumerable:true,get:function(){return scope_2.varKinds}});exports.operators={GT:new code_1._Code(">"),GTE:new code_1._Code(">="),LT:new code_1._Code("<"),LTE:new code_1._Code("<="),EQ:new code_1._Code("==="),NEQ:new code_1._Code("!=="),NOT:new code_1._Code("!"),OR:new code_1._Code("||"),AND:new code_1._Code("&&"),ADD:new code_1._Code("+")};class Node{optimizeNodes(){return this}optimizeNames(_names,_constants){return this}}class Def extends Node{constructor(varKind,name,rhs){super();this.varKind=varKind;this.name=name;this.rhs=rhs}render({es5:es5,_n:_n}){const varKind=es5?scope_1.varKinds.var:this.varKind;const rhs=this.rhs===undefined?"":` = ${this.rhs}`;return`${varKind} ${this.name}${rhs};`+_n}optimizeNames(names,constants){if(!names[this.name.str])return;if(this.rhs)this.rhs=optimizeExpr(this.rhs,names,constants);return this}get names(){return this.rhs instanceof code_1._CodeOrName?this.rhs.names:{}}}class Assign extends Node{constructor(lhs,rhs,sideEffects){super();this.lhs=lhs;this.rhs=rhs;this.sideEffects=sideEffects}render({_n:_n}){return`${this.lhs} = ${this.rhs};`+_n}optimizeNames(names,constants){if(this.lhs instanceof code_1.Name&&!names[this.lhs.str]&&!this.sideEffects)return;this.rhs=optimizeExpr(this.rhs,names,constants);return this}get names(){const names=this.lhs instanceof code_1.Name?{}:{...this.lhs.names};return addExprNames(names,this.rhs)}}class AssignOp extends Assign{constructor(lhs,op,rhs,sideEffects){super(lhs,rhs,sideEffects);this.op=op}render({_n:_n}){return`${this.lhs} ${this.op}= ${this.rhs};`+_n}}class Label extends Node{constructor(label){super();this.label=label;this.names={}}render({_n:_n}){return`${this.label}:`+_n}}class Break extends Node{constructor(label){super();this.label=label;this.names={}}render({_n:_n}){const label=this.label?` ${this.label}`:"";return`break${label};`+_n}}class Throw extends Node{constructor(error){super();this.error=error}render({_n:_n}){return`throw ${this.error};`+_n}get names(){return this.error.names}}class AnyCode extends Node{constructor(code){super();this.code=code}render({_n:_n}){return`${this.code};`+_n}optimizeNodes(){return`${this.code}`?this:undefined}optimizeNames(names,constants){this.code=optimizeExpr(this.code,names,constants);return this}get names(){return this.code instanceof code_1._CodeOrName?this.code.names:{}}}class ParentNode extends Node{constructor(nodes=[]){super();this.nodes=nodes}render(opts){return this.nodes.reduce(((code,n)=>code+n.render(opts)),"")}optimizeNodes(){const{nodes:nodes}=this;let i=nodes.length;while(i--){const n=nodes[i].optimizeNodes();if(Array.isArray(n))nodes.splice(i,1,...n);else if(n)nodes[i]=n;else nodes.splice(i,1)}return nodes.length>0?this:undefined}optimizeNames(names,constants){const{nodes:nodes}=this;let i=nodes.length;while(i--){const n=nodes[i];if(n.optimizeNames(names,constants))continue;subtractNames(names,n.names);nodes.splice(i,1)}return nodes.length>0?this:undefined}get names(){return this.nodes.reduce(((names,n)=>addNames(names,n.names)),{})}}class BlockNode extends ParentNode{render(opts){return"{"+opts._n+super.render(opts)+"}"+opts._n}}class Root extends ParentNode{}class Else extends BlockNode{}Else.kind="else";class If extends BlockNode{constructor(condition,nodes){super(nodes);this.condition=condition}render(opts){let code=`if(${this.condition})`+super.render(opts);if(this.else)code+="else "+this.else.render(opts);return code}optimizeNodes(){super.optimizeNodes();const cond=this.condition;if(cond===true)return this.nodes;let e=this.else;if(e){const ns=e.optimizeNodes();e=this.else=Array.isArray(ns)?new Else(ns):ns}if(e){if(cond===false)return e instanceof If?e:e.nodes;if(this.nodes.length)return this;return new If(not(cond),e instanceof If?[e]:e.nodes)}if(cond===false||!this.nodes.length)return undefined;return this}optimizeNames(names,constants){var _a;this.else=(_a=this.else)===null||_a===void 0?void 0:_a.optimizeNames(names,constants);if(!(super.optimizeNames(names,constants)||this.else))return;this.condition=optimizeExpr(this.condition,names,constants);return this}get names(){const names=super.names;addExprNames(names,this.condition);if(this.else)addNames(names,this.else.names);return names}}If.kind="if";class For extends BlockNode{}For.kind="for";class ForLoop extends For{constructor(iteration){super();this.iteration=iteration}render(opts){return`for(${this.iteration})`+super.render(opts)}optimizeNames(names,constants){if(!super.optimizeNames(names,constants))return;this.iteration=optimizeExpr(this.iteration,names,constants);return this}get names(){return addNames(super.names,this.iteration.names)}}class ForRange extends For{constructor(varKind,name,from,to){super();this.varKind=varKind;this.name=name;this.from=from;this.to=to}render(opts){const varKind=opts.es5?scope_1.varKinds.var:this.varKind;const{name:name,from:from,to:to}=this;return`for(${varKind} ${name}=${from}; ${name}<${to}; ${name}++)`+super.render(opts)}get names(){const names=addExprNames(super.names,this.from);return addExprNames(names,this.to)}}class ForIter extends For{constructor(loop,varKind,name,iterable){super();this.loop=loop;this.varKind=varKind;this.name=name;this.iterable=iterable}render(opts){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(opts)}optimizeNames(names,constants){if(!super.optimizeNames(names,constants))return;this.iterable=optimizeExpr(this.iterable,names,constants);return this}get names(){return addNames(super.names,this.iterable.names)}}class Func extends BlockNode{constructor(name,args,async){super();this.name=name;this.args=args;this.async=async}render(opts){const _async=this.async?"async ":"";return`${_async}function ${this.name}(${this.args})`+super.render(opts)}}Func.kind="func";class Return extends ParentNode{render(opts){return"return "+super.render(opts)}}Return.kind="return";class Try extends BlockNode{render(opts){let code="try"+super.render(opts);if(this.catch)code+=this.catch.render(opts);if(this.finally)code+=this.finally.render(opts);return code}optimizeNodes(){var _a,_b;super.optimizeNodes();(_a=this.catch)===null||_a===void 0?void 0:_a.optimizeNodes();(_b=this.finally)===null||_b===void 0?void 0:_b.optimizeNodes();return this}optimizeNames(names,constants){var _a,_b;super.optimizeNames(names,constants);(_a=this.catch)===null||_a===void 0?void 0:_a.optimizeNames(names,constants);(_b=this.finally)===null||_b===void 0?void 0:_b.optimizeNames(names,constants);return this}get names(){const names=super.names;if(this.catch)addNames(names,this.catch.names);if(this.finally)addNames(names,this.finally.names);return names}}class Catch extends BlockNode{constructor(error){super();this.error=error}render(opts){return`catch(${this.error})`+super.render(opts)}}Catch.kind="catch";class Finally extends BlockNode{render(opts){return"finally"+super.render(opts)}}Finally.kind="finally";class CodeGen{constructor(extScope,opts={}){this._values={};this._blockStarts=[];this._constants={};this.opts={...opts,_n:opts.lines?"\n":""};this._extScope=extScope;this._scope=new scope_1.Scope({parent:extScope});this._nodes=[new Root]}toString(){return this._root.render(this.opts)}name(prefix){return this._scope.name(prefix)}scopeName(prefix){return this._extScope.name(prefix)}scopeValue(prefixOrName,value){const name=this._extScope.value(prefixOrName,value);const vs=this._values[name.prefix]||(this._values[name.prefix]=new Set);vs.add(name);return name}getScopeValue(prefix,keyOrRef){return this._extScope.getValue(prefix,keyOrRef)}scopeRefs(scopeName){return this._extScope.scopeRefs(scopeName,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(varKind,nameOrPrefix,rhs,constant){const name=this._scope.toName(nameOrPrefix);if(rhs!==undefined&&constant)this._constants[name.str]=rhs;this._leafNode(new Def(varKind,name,rhs));return name}const(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.const,nameOrPrefix,rhs,_constant)}let(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.let,nameOrPrefix,rhs,_constant)}var(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.var,nameOrPrefix,rhs,_constant)}assign(lhs,rhs,sideEffects){return this._leafNode(new Assign(lhs,rhs,sideEffects))}add(lhs,rhs){return this._leafNode(new AssignOp(lhs,exports.operators.ADD,rhs))}code(c){if(typeof c=="function")c();else if(c!==code_1.nil)this._leafNode(new AnyCode(c));return this}object(...keyValues){const code=["{"];for(const[key,value]of keyValues){if(code.length>1)code.push(",");code.push(key);if(key!==value||this.opts.es5){code.push(":");(0,code_1.addCodeArg)(code,value)}}code.push("}");return new code_1._Code(code)}if(condition,thenBody,elseBody){this._blockNode(new If(condition));if(thenBody&&elseBody){this.code(thenBody).else().code(elseBody).endIf()}else if(thenBody){this.code(thenBody).endIf()}else if(elseBody){throw new Error('CodeGen: "else" body without "then" body')}return this}elseIf(condition){return this._elseNode(new If(condition))}else(){return this._elseNode(new Else)}endIf(){return this._endBlockNode(If,Else)}_for(node,forBody){this._blockNode(node);if(forBody)this.code(forBody).endFor();return this}for(iteration,forBody){return this._for(new ForLoop(iteration),forBody)}forRange(nameOrPrefix,from,to,forBody,varKind=(this.opts.es5?scope_1.varKinds.var:scope_1.varKinds.let)){const name=this._scope.toName(nameOrPrefix);return this._for(new ForRange(varKind,name,from,to),(()=>forBody(name)))}forOf(nameOrPrefix,iterable,forBody,varKind=scope_1.varKinds.const){const name=this._scope.toName(nameOrPrefix);if(this.opts.es5){const arr=iterable instanceof code_1.Name?iterable:this.var("_arr",iterable);return this.forRange("_i",0,(0,code_1._)`${arr}.length`,(i=>{this.var(name,(0,code_1._)`${arr}[${i}]`);forBody(name)}))}return this._for(new ForIter("of",varKind,name,iterable),(()=>forBody(name)))}forIn(nameOrPrefix,obj,forBody,varKind=(this.opts.es5?scope_1.varKinds.var:scope_1.varKinds.const)){if(this.opts.ownProperties){return this.forOf(nameOrPrefix,(0,code_1._)`Object.keys(${obj})`,forBody)}const name=this._scope.toName(nameOrPrefix);return this._for(new ForIter("in",varKind,name,obj),(()=>forBody(name)))}endFor(){return this._endBlockNode(For)}label(label){return this._leafNode(new Label(label))}break(label){return this._leafNode(new Break(label))}return(value){const node=new Return;this._blockNode(node);this.code(value);if(node.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Return)}try(tryBody,catchCode,finallyCode){if(!catchCode&&!finallyCode)throw new Error('CodeGen: "try" without "catch" and "finally"');const node=new Try;this._blockNode(node);this.code(tryBody);if(catchCode){const error=this.name("e");this._currNode=node.catch=new Catch(error);catchCode(error)}if(finallyCode){this._currNode=node.finally=new Finally;this.code(finallyCode)}return this._endBlockNode(Catch,Finally)}throw(error){return this._leafNode(new Throw(error))}block(body,nodeCount){this._blockStarts.push(this._nodes.length);if(body)this.code(body).endBlock(nodeCount);return this}endBlock(nodeCount){const len=this._blockStarts.pop();if(len===undefined)throw new Error("CodeGen: not in self-balancing block");const toClose=this._nodes.length-len;if(toClose<0||nodeCount!==undefined&&toClose!==nodeCount){throw new Error(`CodeGen: wrong number of nodes: ${toClose} vs ${nodeCount} expected`)}this._nodes.length=len;return this}func(name,args=code_1.nil,async,funcBody){this._blockNode(new Func(name,args,async));if(funcBody)this.code(funcBody).endFunc();return this}endFunc(){return this._endBlockNode(Func)}optimize(n=1){while(n-- >0){this._root.optimizeNodes();this._root.optimizeNames(this._root.names,this._constants)}}_leafNode(node){this._currNode.nodes.push(node);return this}_blockNode(node){this._currNode.nodes.push(node);this._nodes.push(node)}_endBlockNode(N1,N2){const n=this._currNode;if(n instanceof N1||N2&&n instanceof N2){this._nodes.pop();return this}throw new Error(`CodeGen: not in block "${N2?`${N1.kind}/${N2.kind}`:N1.kind}"`)}_elseNode(node){const n=this._currNode;if(!(n instanceof If)){throw new Error('CodeGen: "else" without "if"')}this._currNode=n.else=node;return this}get _root(){return this._nodes[0]}get _currNode(){const ns=this._nodes;return ns[ns.length-1]}set _currNode(node){const ns=this._nodes;ns[ns.length-1]=node}}exports.CodeGen=CodeGen;function addNames(names,from){for(const n in from)names[n]=(names[n]||0)+(from[n]||0);return names}function addExprNames(names,from){return from instanceof code_1._CodeOrName?addNames(names,from.names):names}function optimizeExpr(expr,names,constants){if(expr instanceof code_1.Name)return replaceName(expr);if(!canOptimize(expr))return expr;return new code_1._Code(expr._items.reduce(((items,c)=>{if(c instanceof code_1.Name)c=replaceName(c);if(c instanceof code_1._Code)items.push(...c._items);else items.push(c);return items}),[]));function replaceName(n){const c=constants[n.str];if(c===undefined||names[n.str]!==1)return n;delete names[n.str];return c}function canOptimize(e){return e instanceof code_1._Code&&e._items.some((c=>c instanceof code_1.Name&&names[c.str]===1&&constants[c.str]!==undefined))}}function subtractNames(names,from){for(const n in from)names[n]=(names[n]||0)-(from[n]||0)}function not(x){return typeof x=="boolean"||typeof x=="number"||x===null?!x:(0,code_1._)`!${par(x)}`}exports.not=not;const andCode=mappend(exports.operators.AND);function and(...args){return args.reduce(andCode)}exports.and=and;const orCode=mappend(exports.operators.OR);function or(...args){return args.reduce(orCode)}exports.or=or;function mappend(op){return(x,y)=>x===code_1.nil?y:y===code_1.nil?x:(0,code_1._)`${par(x)} ${op} ${par(y)}`}function par(x){return x instanceof code_1.Name?x:(0,code_1._)`(${x})`}},{"./code":79,"./scope":81}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ValueScope=exports.ValueScopeName=exports.Scope=exports.varKinds=exports.UsedValueState=void 0;const code_1=require("./code");class ValueError extends Error{constructor(name){super(`CodeGen: "code" for ${name} not defined`);this.value=name.value}}var UsedValueState;(function(UsedValueState){UsedValueState[UsedValueState["Started"]=0]="Started";UsedValueState[UsedValueState["Completed"]=1]="Completed"})(UsedValueState=exports.UsedValueState||(exports.UsedValueState={}));exports.varKinds={const:new code_1.Name("const"),let:new code_1.Name("let"),var:new code_1.Name("var")};class Scope{constructor({prefixes:prefixes,parent:parent}={}){this._names={};this._prefixes=prefixes;this._parent=parent}toName(nameOrPrefix){return nameOrPrefix instanceof code_1.Name?nameOrPrefix:this.name(nameOrPrefix)}name(prefix){return new code_1.Name(this._newName(prefix))}_newName(prefix){const ng=this._names[prefix]||this._nameGroup(prefix);return`${prefix}${ng.index++}`}_nameGroup(prefix){var _a,_b;if(((_b=(_a=this._parent)===null||_a===void 0?void 0:_a._prefixes)===null||_b===void 0?void 0:_b.has(prefix))||this._prefixes&&!this._prefixes.has(prefix)){throw new Error(`CodeGen: prefix "${prefix}" is not allowed in this scope`)}return this._names[prefix]={prefix:prefix,index:0}}}exports.Scope=Scope;class ValueScopeName extends code_1.Name{constructor(prefix,nameStr){super(nameStr);this.prefix=prefix}setValue(value,{property:property,itemIndex:itemIndex}){this.value=value;this.scopePath=(0,code_1._)`.${new code_1.Name(property)}[${itemIndex}]`}}exports.ValueScopeName=ValueScopeName;const line=(0,code_1._)`\n`;class ValueScope extends Scope{constructor(opts){super(opts);this._values={};this._scope=opts.scope;this.opts={...opts,_n:opts.lines?line:code_1.nil}}get(){return this._scope}name(prefix){return new ValueScopeName(prefix,this._newName(prefix))}value(nameOrPrefix,value){var _a;if(value.ref===undefined)throw new Error("CodeGen: ref must be passed in value");const name=this.toName(nameOrPrefix);const{prefix:prefix}=name;const valueKey=(_a=value.key)!==null&&_a!==void 0?_a:value.ref;let vs=this._values[prefix];if(vs){const _name=vs.get(valueKey);if(_name)return _name}else{vs=this._values[prefix]=new Map}vs.set(valueKey,name);const s=this._scope[prefix]||(this._scope[prefix]=[]);const itemIndex=s.length;s[itemIndex]=value.ref;name.setValue(value,{property:prefix,itemIndex:itemIndex});return name}getValue(prefix,keyOrRef){const vs=this._values[prefix];if(!vs)return;return vs.get(keyOrRef)}scopeRefs(scopeName,values=this._values){return this._reduceValues(values,(name=>{if(name.scopePath===undefined)throw new Error(`CodeGen: name "${name}" has no value`);return(0,code_1._)`${scopeName}${name.scopePath}`}))}scopeCode(values=this._values,usedValues,getCode){return this._reduceValues(values,(name=>{if(name.value===undefined)throw new Error(`CodeGen: name "${name}" has no value`);return name.value.code}),usedValues,getCode)}_reduceValues(values,valueCode,usedValues={},getCode){let code=code_1.nil;for(const prefix in values){const vs=values[prefix];if(!vs)continue;const nameSet=usedValues[prefix]=usedValues[prefix]||new Map;vs.forEach((name=>{if(nameSet.has(name))return;nameSet.set(name,UsedValueState.Started);let c=valueCode(name);if(c){const def=this.opts.es5?exports.varKinds.var:exports.varKinds.const;code=(0,code_1._)`${code}${def} ${name} = ${c};${this.opts._n}`}else if(c=getCode===null||getCode===void 0?void 0:getCode(name)){code=(0,code_1._)`${code}${c}${this.opts._n}`}else{throw new ValueError(name)}nameSet.set(name,UsedValueState.Completed)}))}return code}}exports.ValueScope=ValueScope},{"./code":79}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.extendErrors=exports.resetErrorsCount=exports.reportExtraError=exports.reportError=exports.keyword$DataError=exports.keywordError=void 0;const codegen_1=require("./codegen");const util_1=require("./util");const names_1=require("./names");exports.keywordError={message:({keyword:keyword})=>(0,codegen_1.str)`must pass "${keyword}" keyword validation`};exports.keyword$DataError={message:({keyword:keyword,schemaType:schemaType})=>schemaType?(0,codegen_1.str)`"${keyword}" keyword must be ${schemaType} ($data)`:(0,codegen_1.str)`"${keyword}" keyword is invalid ($data)`};function reportError(cxt,error=exports.keywordError,errorPaths,overrideAllErrors){const{it:it}=cxt;const{gen:gen,compositeRule:compositeRule,allErrors:allErrors}=it;const errObj=errorObjectCode(cxt,error,errorPaths);if(overrideAllErrors!==null&&overrideAllErrors!==void 0?overrideAllErrors:compositeRule||allErrors){addError(gen,errObj)}else{returnErrors(it,(0,codegen_1._)`[${errObj}]`)}}exports.reportError=reportError;function reportExtraError(cxt,error=exports.keywordError,errorPaths){const{it:it}=cxt;const{gen:gen,compositeRule:compositeRule,allErrors:allErrors}=it;const errObj=errorObjectCode(cxt,error,errorPaths);addError(gen,errObj);if(!(compositeRule||allErrors)){returnErrors(it,names_1.default.vErrors)}}exports.reportExtraError=reportExtraError;function resetErrorsCount(gen,errsCount){gen.assign(names_1.default.errors,errsCount);gen.if((0,codegen_1._)`${names_1.default.vErrors} !== null`,(()=>gen.if(errsCount,(()=>gen.assign((0,codegen_1._)`${names_1.default.vErrors}.length`,errsCount)),(()=>gen.assign(names_1.default.vErrors,null)))))}exports.resetErrorsCount=resetErrorsCount;function extendErrors({gen:gen,keyword:keyword,schemaValue:schemaValue,data:data,errsCount:errsCount,it:it}){if(errsCount===undefined)throw new Error("ajv implementation error");const err=gen.name("err");gen.forRange("i",errsCount,names_1.default.errors,(i=>{gen.const(err,(0,codegen_1._)`${names_1.default.vErrors}[${i}]`);gen.if((0,codegen_1._)`${err}.instancePath === undefined`,(()=>gen.assign((0,codegen_1._)`${err}.instancePath`,(0,codegen_1.strConcat)(names_1.default.instancePath,it.errorPath))));gen.assign((0,codegen_1._)`${err}.schemaPath`,(0,codegen_1.str)`${it.errSchemaPath}/${keyword}`);if(it.opts.verbose){gen.assign((0,codegen_1._)`${err}.schema`,schemaValue);gen.assign((0,codegen_1._)`${err}.data`,data)}}))}exports.extendErrors=extendErrors;function addError(gen,errObj){const err=gen.const("err",errObj);gen.if((0,codegen_1._)`${names_1.default.vErrors} === null`,(()=>gen.assign(names_1.default.vErrors,(0,codegen_1._)`[${err}]`)),(0,codegen_1._)`${names_1.default.vErrors}.push(${err})`);gen.code((0,codegen_1._)`${names_1.default.errors}++`)}function returnErrors(it,errs){const{gen:gen,validateName:validateName,schemaEnv:schemaEnv}=it;if(schemaEnv.$async){gen.throw((0,codegen_1._)`new ${it.ValidationError}(${errs})`)}else{gen.assign((0,codegen_1._)`${validateName}.errors`,errs);gen.return(false)}}const E={keyword:new codegen_1.Name("keyword"),schemaPath:new codegen_1.Name("schemaPath"),params:new codegen_1.Name("params"),propertyName:new codegen_1.Name("propertyName"),message:new codegen_1.Name("message"),schema:new codegen_1.Name("schema"),parentSchema:new codegen_1.Name("parentSchema")};function errorObjectCode(cxt,error,errorPaths){const{createErrors:createErrors}=cxt.it;if(createErrors===false)return(0,codegen_1._)`{}`;return errorObject(cxt,error,errorPaths)}function errorObject(cxt,error,errorPaths={}){const{gen:gen,it:it}=cxt;const keyValues=[errorInstancePath(it,errorPaths),errorSchemaPath(cxt,errorPaths)];extraErrorProps(cxt,error,keyValues);return gen.object(...keyValues)}function errorInstancePath({errorPath:errorPath},{instancePath:instancePath}){const instPath=instancePath?(0,codegen_1.str)`${errorPath}${(0,util_1.getErrorPath)(instancePath,util_1.Type.Str)}`:errorPath;return[names_1.default.instancePath,(0,codegen_1.strConcat)(names_1.default.instancePath,instPath)]}function errorSchemaPath({keyword:keyword,it:{errSchemaPath:errSchemaPath}},{schemaPath:schemaPath,parentSchema:parentSchema}){let schPath=parentSchema?errSchemaPath:(0,codegen_1.str)`${errSchemaPath}/${keyword}`;if(schemaPath){schPath=(0,codegen_1.str)`${schPath}${(0,util_1.getErrorPath)(schemaPath,util_1.Type.Str)}`}return[E.schemaPath,schPath]}function extraErrorProps(cxt,{params:params,message:message},keyValues){const{keyword:keyword,data:data,schemaValue:schemaValue,it:it}=cxt;const{opts:opts,propertyName:propertyName,topSchemaRef:topSchemaRef,schemaPath:schemaPath}=it;keyValues.push([E.keyword,keyword],[E.params,typeof params=="function"?params(cxt):params||(0,codegen_1._)`{}`]);if(opts.messages){keyValues.push([E.message,typeof message=="function"?message(cxt):message])}if(opts.verbose){keyValues.push([E.schema,schemaValue],[E.parentSchema,(0,codegen_1._)`${topSchemaRef}${schemaPath}`],[names_1.default.data,data])}if(propertyName)keyValues.push([E.propertyName,propertyName])}},{"./codegen":80,"./names":84,"./util":88}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.resolveSchema=exports.getCompilingSchema=exports.resolveRef=exports.compileSchema=exports.SchemaEnv=void 0;const codegen_1=require("./codegen");const validation_error_1=require("../runtime/validation_error");const names_1=require("./names");const resolve_1=require("./resolve");const util_1=require("./util");const validate_1=require("./validate");class SchemaEnv{constructor(env){var _a;this.refs={};this.dynamicAnchors={};let schema;if(typeof env.schema=="object")schema=env.schema;this.schema=env.schema;this.schemaId=env.schemaId;this.root=env.root||this;this.baseId=(_a=env.baseId)!==null&&_a!==void 0?_a:(0,resolve_1.normalizeId)(schema===null||schema===void 0?void 0:schema[env.schemaId||"$id"]);this.schemaPath=env.schemaPath;this.localRefs=env.localRefs;this.meta=env.meta;this.$async=schema===null||schema===void 0?void 0:schema.$async;this.refs={}}}exports.SchemaEnv=SchemaEnv;function compileSchema(sch){const _sch=getCompilingSchema.call(this,sch);if(_sch)return _sch;const rootId=(0,resolve_1.getFullPath)(this.opts.uriResolver,sch.root.baseId);const{es5:es5,lines:lines}=this.opts.code;const{ownProperties:ownProperties}=this.opts;const gen=new codegen_1.CodeGen(this.scope,{es5:es5,lines:lines,ownProperties:ownProperties});let _ValidationError;if(sch.$async){_ValidationError=gen.scopeValue("Error",{ref:validation_error_1.default,code:(0,codegen_1._)`require("ajv/dist/runtime/validation_error").default`})}const validateName=gen.scopeName("validate");sch.validateName=validateName;const schemaCxt={gen:gen,allErrors:this.opts.allErrors,data:names_1.default.data,parentData:names_1.default.parentData,parentDataProperty:names_1.default.parentDataProperty,dataNames:[names_1.default.data],dataPathArr:[codegen_1.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:gen.scopeValue("schema",this.opts.code.source===true?{ref:sch.schema,code:(0,codegen_1.stringify)(sch.schema)}:{ref:sch.schema}),validateName:validateName,ValidationError:_ValidationError,schema:sch.schema,schemaEnv:sch,rootId:rootId,baseId:sch.baseId||rootId,schemaPath:codegen_1.nil,errSchemaPath:sch.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,codegen_1._)`""`,opts:this.opts,self:this};let sourceCode;try{this._compilations.add(sch);(0,validate_1.validateFunctionCode)(schemaCxt);gen.optimize(this.opts.code.optimize);const validateCode=gen.toString();sourceCode=`${gen.scopeRefs(names_1.default.scope)}return ${validateCode}`;if(this.opts.code.process)sourceCode=this.opts.code.process(sourceCode,sch);const makeValidate=new Function(`${names_1.default.self}`,`${names_1.default.scope}`,sourceCode);const validate=makeValidate(this,this.scope.get());this.scope.value(validateName,{ref:validate});validate.errors=null;validate.schema=sch.schema;validate.schemaEnv=sch;if(sch.$async)validate.$async=true;if(this.opts.code.source===true){validate.source={validateName:validateName,validateCode:validateCode,scopeValues:gen._values}}if(this.opts.unevaluated){const{props:props,items:items}=schemaCxt;validate.evaluated={props:props instanceof codegen_1.Name?undefined:props,items:items instanceof codegen_1.Name?undefined:items,dynamicProps:props instanceof codegen_1.Name,dynamicItems:items instanceof codegen_1.Name};if(validate.source)validate.source.evaluated=(0,codegen_1.stringify)(validate.evaluated)}sch.validate=validate;return sch}catch(e){delete sch.validate;delete sch.validateName;if(sourceCode)this.logger.error("Error compiling schema, function code:",sourceCode);throw e}finally{this._compilations.delete(sch)}}exports.compileSchema=compileSchema;function resolveRef(root,baseId,ref){var _a;ref=(0,resolve_1.resolveUrl)(this.opts.uriResolver,baseId,ref);const schOrFunc=root.refs[ref];if(schOrFunc)return schOrFunc;let _sch=resolve.call(this,root,ref);if(_sch===undefined){const schema=(_a=root.localRefs)===null||_a===void 0?void 0:_a[ref];const{schemaId:schemaId}=this.opts;if(schema)_sch=new SchemaEnv({schema:schema,schemaId:schemaId,root:root,baseId:baseId})}if(_sch===undefined)return;return root.refs[ref]=inlineOrCompile.call(this,_sch)}exports.resolveRef=resolveRef;function inlineOrCompile(sch){if((0,resolve_1.inlineRef)(sch.schema,this.opts.inlineRefs))return sch.schema;return sch.validate?sch:compileSchema.call(this,sch)}function getCompilingSchema(schEnv){for(const sch of this._compilations){if(sameSchemaEnv(sch,schEnv))return sch}}exports.getCompilingSchema=getCompilingSchema;function sameSchemaEnv(s1,s2){return s1.schema===s2.schema&&s1.root===s2.root&&s1.baseId===s2.baseId}function resolve(root,ref){let sch;while(typeof(sch=this.refs[ref])=="string")ref=sch;return sch||this.schemas[ref]||resolveSchema.call(this,root,ref)}function resolveSchema(root,ref){const p=this.opts.uriResolver.parse(ref);const refPath=(0,resolve_1._getFullPath)(this.opts.uriResolver,p);let baseId=(0,resolve_1.getFullPath)(this.opts.uriResolver,root.baseId,undefined);if(Object.keys(root.schema).length>0&&refPath===baseId){return getJsonPointer.call(this,p,root)}const id=(0,resolve_1.normalizeId)(refPath);const schOrRef=this.refs[id]||this.schemas[id];if(typeof schOrRef=="string"){const sch=resolveSchema.call(this,root,schOrRef);if(typeof(sch===null||sch===void 0?void 0:sch.schema)!=="object")return;return getJsonPointer.call(this,p,sch)}if(typeof(schOrRef===null||schOrRef===void 0?void 0:schOrRef.schema)!=="object")return;if(!schOrRef.validate)compileSchema.call(this,schOrRef);if(id===(0,resolve_1.normalizeId)(ref)){const{schema:schema}=schOrRef;const{schemaId:schemaId}=this.opts;const schId=schema[schemaId];if(schId)baseId=(0,resolve_1.resolveUrl)(this.opts.uriResolver,baseId,schId);return new SchemaEnv({schema:schema,schemaId:schemaId,root:root,baseId:baseId})}return getJsonPointer.call(this,p,schOrRef)}exports.resolveSchema=resolveSchema;const PREVENT_SCOPE_CHANGE=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function getJsonPointer(parsedRef,{baseId:baseId,schema:schema,root:root}){var _a;if(((_a=parsedRef.fragment)===null||_a===void 0?void 0:_a[0])!=="/")return;for(const part of parsedRef.fragment.slice(1).split("/")){if(typeof schema==="boolean")return;const partSchema=schema[(0,util_1.unescapeFragment)(part)];if(partSchema===undefined)return;schema=partSchema;const schId=typeof schema==="object"&&schema[this.opts.schemaId];if(!PREVENT_SCOPE_CHANGE.has(part)&&schId){baseId=(0,resolve_1.resolveUrl)(this.opts.uriResolver,baseId,schId)}}let env;if(typeof schema!="boolean"&&schema.$ref&&!(0,util_1.schemaHasRulesButRef)(schema,this.RULES)){const $ref=(0,resolve_1.resolveUrl)(this.opts.uriResolver,baseId,schema.$ref);env=resolveSchema.call(this,root,$ref)}const{schemaId:schemaId}=this.opts;env=env||new SchemaEnv({schema:schema,schemaId:schemaId,root:root,baseId:baseId});if(env.schema!==env.root.schema)return env;return undefined}},{"../runtime/validation_error":102,"./codegen":80,"./names":84,"./resolve":86,"./util":88,"./validate":93}],84:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("./codegen");const names={data:new codegen_1.Name("data"),valCxt:new codegen_1.Name("valCxt"),instancePath:new codegen_1.Name("instancePath"),parentData:new codegen_1.Name("parentData"),parentDataProperty:new codegen_1.Name("parentDataProperty"),rootData:new codegen_1.Name("rootData"),dynamicAnchors:new codegen_1.Name("dynamicAnchors"),vErrors:new codegen_1.Name("vErrors"),errors:new codegen_1.Name("errors"),this:new codegen_1.Name("this"),self:new codegen_1.Name("self"),scope:new codegen_1.Name("scope"),json:new codegen_1.Name("json"),jsonPos:new codegen_1.Name("jsonPos"),jsonLen:new codegen_1.Name("jsonLen"),jsonPart:new codegen_1.Name("jsonPart")};exports.default=names},{"./codegen":80}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const resolve_1=require("./resolve");class MissingRefError extends Error{constructor(resolver,baseId,ref,msg){super(msg||`can't resolve reference ${ref} from id ${baseId}`);this.missingRef=(0,resolve_1.resolveUrl)(resolver,baseId,ref);this.missingSchema=(0,resolve_1.normalizeId)((0,resolve_1.getFullPath)(resolver,this.missingRef))}}exports.default=MissingRefError},{"./resolve":86}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSchemaRefs=exports.resolveUrl=exports.normalizeId=exports._getFullPath=exports.getFullPath=exports.inlineRef=void 0;const util_1=require("./util");const equal=require("fast-deep-equal");const traverse=require("json-schema-traverse");const SIMPLE_INLINED=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function inlineRef(schema,limit=true){if(typeof schema=="boolean")return true;if(limit===true)return!hasRef(schema);if(!limit)return false;return countKeys(schema)<=limit}exports.inlineRef=inlineRef;const REF_KEYWORDS=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function hasRef(schema){for(const key in schema){if(REF_KEYWORDS.has(key))return true;const sch=schema[key];if(Array.isArray(sch)&&sch.some(hasRef))return true;if(typeof sch=="object"&&hasRef(sch))return true}return false}function countKeys(schema){let count=0;for(const key in schema){if(key==="$ref")return Infinity;count++;if(SIMPLE_INLINED.has(key))continue;if(typeof schema[key]=="object"){(0,util_1.eachItem)(schema[key],(sch=>count+=countKeys(sch)))}if(count===Infinity)return Infinity}return count}function getFullPath(resolver,id="",normalize){if(normalize!==false)id=normalizeId(id);const p=resolver.parse(id);return _getFullPath(resolver,p)}exports.getFullPath=getFullPath;function _getFullPath(resolver,p){const serialized=resolver.serialize(p);return serialized.split("#")[0]+"#"}exports._getFullPath=_getFullPath;const TRAILING_SLASH_HASH=/#\/?$/;function normalizeId(id){return id?id.replace(TRAILING_SLASH_HASH,""):""}exports.normalizeId=normalizeId;function resolveUrl(resolver,baseId,id){id=normalizeId(id);return resolver.resolve(baseId,id)}exports.resolveUrl=resolveUrl;const ANCHOR=/^[a-z_][-a-z0-9._]*$/i;function getSchemaRefs(schema,baseId){if(typeof schema=="boolean")return{};const{schemaId:schemaId,uriResolver:uriResolver}=this.opts;const schId=normalizeId(schema[schemaId]||baseId);const baseIds={"":schId};const pathPrefix=getFullPath(uriResolver,schId,false);const localRefs={};const schemaRefs=new Set;traverse(schema,{allKeys:true},((sch,jsonPtr,_,parentJsonPtr)=>{if(parentJsonPtr===undefined)return;const fullPath=pathPrefix+jsonPtr;let baseId=baseIds[parentJsonPtr];if(typeof sch[schemaId]=="string")baseId=addRef.call(this,sch[schemaId]);addAnchor.call(this,sch.$anchor);addAnchor.call(this,sch.$dynamicAnchor);baseIds[jsonPtr]=baseId;function addRef(ref){const _resolve=this.opts.uriResolver.resolve;ref=normalizeId(baseId?_resolve(baseId,ref):ref);if(schemaRefs.has(ref))throw ambiguos(ref);schemaRefs.add(ref);let schOrRef=this.refs[ref];if(typeof schOrRef=="string")schOrRef=this.refs[schOrRef];if(typeof schOrRef=="object"){checkAmbiguosRef(sch,schOrRef.schema,ref)}else if(ref!==normalizeId(fullPath)){if(ref[0]==="#"){checkAmbiguosRef(sch,localRefs[ref],ref);localRefs[ref]=sch}else{this.refs[ref]=fullPath}}return ref}function addAnchor(anchor){if(typeof anchor=="string"){if(!ANCHOR.test(anchor))throw new Error(`invalid anchor "${anchor}"`);addRef.call(this,`#${anchor}`)}}}));return localRefs;function checkAmbiguosRef(sch1,sch2,ref){if(sch2!==undefined&&!equal(sch1,sch2))throw ambiguos(ref)}function ambiguos(ref){return new Error(`reference "${ref}" resolves to more than one schema`)}}exports.getSchemaRefs=getSchemaRefs},{"./util":88,"fast-deep-equal":266,"json-schema-traverse":317}],87:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments)},{dup:20}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkStrictMode=exports.getErrorPath=exports.Type=exports.useFunc=exports.setEvaluated=exports.evaluatedPropsToName=exports.mergeEvaluated=exports.eachItem=exports.unescapeJsonPointer=exports.escapeJsonPointer=exports.escapeFragment=exports.unescapeFragment=exports.schemaRefOrVal=exports.schemaHasRulesButRef=exports.schemaHasRules=exports.checkUnknownRules=exports.alwaysValidSchema=exports.toHash=void 0;const codegen_1=require("./codegen");const code_1=require("./codegen/code");function toHash(arr){const hash={};for(const item of arr)hash[item]=true;return hash}exports.toHash=toHash;function alwaysValidSchema(it,schema){if(typeof schema=="boolean")return schema;if(Object.keys(schema).length===0)return true;checkUnknownRules(it,schema);return!schemaHasRules(schema,it.self.RULES.all)}exports.alwaysValidSchema=alwaysValidSchema;function checkUnknownRules(it,schema=it.schema){const{opts:opts,self:self}=it;if(!opts.strictSchema)return;if(typeof schema==="boolean")return;const rules=self.RULES.keywords;for(const key in schema){if(!rules[key])checkStrictMode(it,`unknown keyword: "${key}"`)}}exports.checkUnknownRules=checkUnknownRules;function schemaHasRules(schema,rules){if(typeof schema=="boolean")return!schema;for(const key in schema)if(rules[key])return true;return false}exports.schemaHasRules=schemaHasRules;function schemaHasRulesButRef(schema,RULES){if(typeof schema=="boolean")return!schema;for(const key in schema)if(key!=="$ref"&&RULES.all[key])return true;return false}exports.schemaHasRulesButRef=schemaHasRulesButRef;function schemaRefOrVal({topSchemaRef:topSchemaRef,schemaPath:schemaPath},schema,keyword,$data){if(!$data){if(typeof schema=="number"||typeof schema=="boolean")return schema;if(typeof schema=="string")return(0,codegen_1._)`${schema}`}return(0,codegen_1._)`${topSchemaRef}${schemaPath}${(0,codegen_1.getProperty)(keyword)}`}exports.schemaRefOrVal=schemaRefOrVal;function unescapeFragment(str){return unescapeJsonPointer(decodeURIComponent(str))}exports.unescapeFragment=unescapeFragment;function escapeFragment(str){return encodeURIComponent(escapeJsonPointer(str))}exports.escapeFragment=escapeFragment;function escapeJsonPointer(str){if(typeof str=="number")return`${str}`;return str.replace(/~/g,"~0").replace(/\//g,"~1")}exports.escapeJsonPointer=escapeJsonPointer;function unescapeJsonPointer(str){return str.replace(/~1/g,"/").replace(/~0/g,"~")}exports.unescapeJsonPointer=unescapeJsonPointer;function eachItem(xs,f){if(Array.isArray(xs)){for(const x of xs)f(x)}else{f(xs)}}exports.eachItem=eachItem;function makeMergeEvaluated({mergeNames:mergeNames,mergeToName:mergeToName,mergeValues:mergeValues,resultToName:resultToName}){return(gen,from,to,toName)=>{const res=to===undefined?from:to instanceof codegen_1.Name?(from instanceof codegen_1.Name?mergeNames(gen,from,to):mergeToName(gen,from,to),to):from instanceof codegen_1.Name?(mergeToName(gen,to,from),from):mergeValues(from,to);return toName===codegen_1.Name&&!(res instanceof codegen_1.Name)?resultToName(gen,res):res}}exports.mergeEvaluated={props:makeMergeEvaluated({mergeNames:(gen,from,to)=>gen.if((0,codegen_1._)`${to} !== true && ${from} !== undefined`,(()=>{gen.if((0,codegen_1._)`${from} === true`,(()=>gen.assign(to,true)),(()=>gen.assign(to,(0,codegen_1._)`${to} || {}`).code((0,codegen_1._)`Object.assign(${to}, ${from})`)))})),mergeToName:(gen,from,to)=>gen.if((0,codegen_1._)`${to} !== true`,(()=>{if(from===true){gen.assign(to,true)}else{gen.assign(to,(0,codegen_1._)`${to} || {}`);setEvaluated(gen,to,from)}})),mergeValues:(from,to)=>from===true?true:{...from,...to},resultToName:evaluatedPropsToName}),items:makeMergeEvaluated({mergeNames:(gen,from,to)=>gen.if((0,codegen_1._)`${to} !== true && ${from} !== undefined`,(()=>gen.assign(to,(0,codegen_1._)`${from} === true ? true : ${to} > ${from} ? ${to} : ${from}`))),mergeToName:(gen,from,to)=>gen.if((0,codegen_1._)`${to} !== true`,(()=>gen.assign(to,from===true?true:(0,codegen_1._)`${to} > ${from} ? ${to} : ${from}`))),mergeValues:(from,to)=>from===true?true:Math.max(from,to),resultToName:(gen,items)=>gen.var("items",items)})};function evaluatedPropsToName(gen,ps){if(ps===true)return gen.var("props",true);const props=gen.var("props",(0,codegen_1._)`{}`);if(ps!==undefined)setEvaluated(gen,props,ps);return props}exports.evaluatedPropsToName=evaluatedPropsToName;function setEvaluated(gen,props,ps){Object.keys(ps).forEach((p=>gen.assign((0,codegen_1._)`${props}${(0,codegen_1.getProperty)(p)}`,true)))}exports.setEvaluated=setEvaluated;const snippets={};function useFunc(gen,f){return gen.scopeValue("func",{ref:f,code:snippets[f.code]||(snippets[f.code]=new code_1._Code(f.code))})}exports.useFunc=useFunc;var Type;(function(Type){Type[Type["Num"]=0]="Num";Type[Type["Str"]=1]="Str"})(Type=exports.Type||(exports.Type={}));function getErrorPath(dataProp,dataPropType,jsPropertySyntax){if(dataProp instanceof codegen_1.Name){const isNumber=dataPropType===Type.Num;return jsPropertySyntax?isNumber?(0,codegen_1._)`"[" + ${dataProp} + "]"`:(0,codegen_1._)`"['" + ${dataProp} + "']"`:isNumber?(0,codegen_1._)`"/" + ${dataProp}`:(0,codegen_1._)`"/" + ${dataProp}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return jsPropertySyntax?(0,codegen_1.getProperty)(dataProp).toString():"/"+escapeJsonPointer(dataProp)}exports.getErrorPath=getErrorPath;function checkStrictMode(it,msg,mode=it.opts.strictSchema){if(!mode)return;msg=`strict mode: ${msg}`;if(mode===true)throw new Error(msg);it.self.logger.warn(msg)}exports.checkStrictMode=checkStrictMode},{"./codegen":80,"./codegen/code":79}],89:[function(require,module,exports){arguments[4][24][0].apply(exports,arguments)},{dup:24}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.boolOrEmptySchema=exports.topBoolOrEmptySchema=void 0;const errors_1=require("../errors");const codegen_1=require("../codegen");const names_1=require("../names");const boolError={message:"boolean schema is false"};function topBoolOrEmptySchema(it){const{gen:gen,schema:schema,validateName:validateName}=it;if(schema===false){falseSchemaError(it,false)}else if(typeof schema=="object"&&schema.$async===true){gen.return(names_1.default.data)}else{gen.assign((0,codegen_1._)`${validateName}.errors`,null);gen.return(true)}}exports.topBoolOrEmptySchema=topBoolOrEmptySchema;function boolOrEmptySchema(it,valid){const{gen:gen,schema:schema}=it;if(schema===false){gen.var(valid,false);falseSchemaError(it)}else{gen.var(valid,true)}}exports.boolOrEmptySchema=boolOrEmptySchema;function falseSchemaError(it,overrideAllErrors){const{gen:gen,data:data}=it;const cxt={gen:gen,keyword:"false schema",data:data,schema:false,schemaCode:false,schemaValue:false,params:{},it:it};(0,errors_1.reportError)(cxt,boolError,undefined,overrideAllErrors)}},{"../codegen":80,"../errors":82,"../names":84}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.reportTypeError=exports.checkDataTypes=exports.checkDataType=exports.coerceAndCheckDataType=exports.getJSONTypes=exports.getSchemaTypes=exports.DataType=void 0;const rules_1=require("../rules");const applicability_1=require("./applicability");const errors_1=require("../errors");const codegen_1=require("../codegen");const util_1=require("../util");var DataType;(function(DataType){DataType[DataType["Correct"]=0]="Correct";DataType[DataType["Wrong"]=1]="Wrong"})(DataType=exports.DataType||(exports.DataType={}));function getSchemaTypes(schema){const types=getJSONTypes(schema.type);const hasNull=types.includes("null");if(hasNull){if(schema.nullable===false)throw new Error("type: null contradicts nullable: false")}else{if(!types.length&&schema.nullable!==undefined){throw new Error('"nullable" cannot be used without "type"')}if(schema.nullable===true)types.push("null")}return types}exports.getSchemaTypes=getSchemaTypes;function getJSONTypes(ts){const types=Array.isArray(ts)?ts:ts?[ts]:[];if(types.every(rules_1.isJSONType))return types;throw new Error("type must be JSONType or JSONType[]: "+types.join(","))}exports.getJSONTypes=getJSONTypes;function coerceAndCheckDataType(it,types){const{gen:gen,data:data,opts:opts}=it;const coerceTo=coerceToTypes(types,opts.coerceTypes);const checkTypes=types.length>0&&!(coerceTo.length===0&&types.length===1&&(0,applicability_1.schemaHasRulesForType)(it,types[0]));if(checkTypes){const wrongType=checkDataTypes(types,data,opts.strictNumbers,DataType.Wrong);gen.if(wrongType,(()=>{if(coerceTo.length)coerceData(it,types,coerceTo);else reportTypeError(it)}))}return checkTypes}exports.coerceAndCheckDataType=coerceAndCheckDataType;const COERCIBLE=new Set(["string","number","integer","boolean","null"]);function coerceToTypes(types,coerceTypes){return coerceTypes?types.filter((t=>COERCIBLE.has(t)||coerceTypes==="array"&&t==="array")):[]}function coerceData(it,types,coerceTo){const{gen:gen,data:data,opts:opts}=it;const dataType=gen.let("dataType",(0,codegen_1._)`typeof ${data}`);const coerced=gen.let("coerced",(0,codegen_1._)`undefined`);if(opts.coerceTypes==="array"){gen.if((0,codegen_1._)`${dataType} == 'object' && Array.isArray(${data}) && ${data}.length == 1`,(()=>gen.assign(data,(0,codegen_1._)`${data}[0]`).assign(dataType,(0,codegen_1._)`typeof ${data}`).if(checkDataTypes(types,data,opts.strictNumbers),(()=>gen.assign(coerced,data)))))}gen.if((0,codegen_1._)`${coerced} !== undefined`);for(const t of coerceTo){if(COERCIBLE.has(t)||t==="array"&&opts.coerceTypes==="array"){coerceSpecificType(t)}}gen.else();reportTypeError(it);gen.endIf();gen.if((0,codegen_1._)`${coerced} !== undefined`,(()=>{gen.assign(data,coerced);assignParentData(it,coerced)}));function coerceSpecificType(t){switch(t){case"string":gen.elseIf((0,codegen_1._)`${dataType} == "number" || ${dataType} == "boolean"`).assign(coerced,(0,codegen_1._)`"" + ${data}`).elseIf((0,codegen_1._)`${data} === null`).assign(coerced,(0,codegen_1._)`""`);return;case"number":gen.elseIf((0,codegen_1._)`${dataType} == "boolean" || ${data} === null
              || (${dataType} == "string" && ${data} && ${data} == +${data})`).assign(coerced,(0,codegen_1._)`+${data}`);return;case"integer":gen.elseIf((0,codegen_1._)`${dataType} === "boolean" || ${data} === null
              || (${dataType} === "string" && ${data} && ${data} == +${data} && !(${data} % 1))`).assign(coerced,(0,codegen_1._)`+${data}`);return;case"boolean":gen.elseIf((0,codegen_1._)`${data} === "false" || ${data} === 0 || ${data} === null`).assign(coerced,false).elseIf((0,codegen_1._)`${data} === "true" || ${data} === 1`).assign(coerced,true);return;case"null":gen.elseIf((0,codegen_1._)`${data} === "" || ${data} === 0 || ${data} === false`);gen.assign(coerced,null);return;case"array":gen.elseIf((0,codegen_1._)`${dataType} === "string" || ${dataType} === "number"
              || ${dataType} === "boolean" || ${data} === null`).assign(coerced,(0,codegen_1._)`[${data}]`)}}}function assignParentData({gen:gen,parentData:parentData,parentDataProperty:parentDataProperty},expr){gen.if((0,codegen_1._)`${parentData} !== undefined`,(()=>gen.assign((0,codegen_1._)`${parentData}[${parentDataProperty}]`,expr)))}function checkDataType(dataType,data,strictNums,correct=DataType.Correct){const EQ=correct===DataType.Correct?codegen_1.operators.EQ:codegen_1.operators.NEQ;let cond;switch(dataType){case"null":return(0,codegen_1._)`${data} ${EQ} null`;case"array":cond=(0,codegen_1._)`Array.isArray(${data})`;break;case"object":cond=(0,codegen_1._)`${data} && typeof ${data} == "object" && !Array.isArray(${data})`;break;case"integer":cond=numCond((0,codegen_1._)`!(${data} % 1) && !isNaN(${data})`);break;case"number":cond=numCond();break;default:return(0,codegen_1._)`typeof ${data} ${EQ} ${dataType}`}return correct===DataType.Correct?cond:(0,codegen_1.not)(cond);function numCond(_cond=codegen_1.nil){return(0,codegen_1.and)((0,codegen_1._)`typeof ${data} == "number"`,_cond,strictNums?(0,codegen_1._)`isFinite(${data})`:codegen_1.nil)}}exports.checkDataType=checkDataType;function checkDataTypes(dataTypes,data,strictNums,correct){if(dataTypes.length===1){return checkDataType(dataTypes[0],data,strictNums,correct)}let cond;const types=(0,util_1.toHash)(dataTypes);if(types.array&&types.object){const notObj=(0,codegen_1._)`typeof ${data} != "object"`;cond=types.null?notObj:(0,codegen_1._)`!${data} || ${notObj}`;delete types.null;delete types.array;delete types.object}else{cond=codegen_1.nil}if(types.number)delete types.integer;for(const t in types)cond=(0,codegen_1.and)(cond,checkDataType(t,data,strictNums,correct));return cond}exports.checkDataTypes=checkDataTypes;const typeError={message:({schema:schema})=>`must be ${schema}`,params:({schema:schema,schemaValue:schemaValue})=>typeof schema=="string"?(0,codegen_1._)`{type: ${schema}}`:(0,codegen_1._)`{type: ${schemaValue}}`};function reportTypeError(it){const cxt=getTypeErrorContext(it);(0,errors_1.reportError)(cxt,typeError)}exports.reportTypeError=reportTypeError;function getTypeErrorContext(it){const{gen:gen,data:data,schema:schema}=it;const schemaCode=(0,util_1.schemaRefOrVal)(it,schema,"type");return{gen:gen,keyword:"type",data:data,schema:schema.type,schemaCode:schemaCode,schemaValue:schemaCode,parentSchema:schema,params:{},it:it}}},{"../codegen":80,"../errors":82,"../rules":87,"../util":88,"./applicability":89}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.assignDefaults=void 0;const codegen_1=require("../codegen");const util_1=require("../util");function assignDefaults(it,ty){const{properties:properties,items:items}=it.schema;if(ty==="object"&&properties){for(const key in properties){assignDefault(it,key,properties[key].default)}}else if(ty==="array"&&Array.isArray(items)){items.forEach(((sch,i)=>assignDefault(it,i,sch.default)))}}exports.assignDefaults=assignDefaults;function assignDefault(it,prop,defaultValue){const{gen:gen,compositeRule:compositeRule,data:data,opts:opts}=it;if(defaultValue===undefined)return;const childData=(0,codegen_1._)`${data}${(0,codegen_1.getProperty)(prop)}`;if(compositeRule){(0,util_1.checkStrictMode)(it,`default is ignored for: ${childData}`);return}let condition=(0,codegen_1._)`${childData} === undefined`;if(opts.useDefaults==="empty"){condition=(0,codegen_1._)`${condition} || ${childData} === null || ${childData} === ""`}gen.if(condition,(0,codegen_1._)`${childData} = ${(0,codegen_1.stringify)(defaultValue)}`)}},{"../codegen":80,"../util":88}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getData=exports.KeywordCxt=exports.validateFunctionCode=void 0;const boolSchema_1=require("./boolSchema");const dataType_1=require("./dataType");const applicability_1=require("./applicability");const dataType_2=require("./dataType");const defaults_1=require("./defaults");const keyword_1=require("./keyword");const subschema_1=require("./subschema");const codegen_1=require("../codegen");const names_1=require("../names");const resolve_1=require("../resolve");const util_1=require("../util");const errors_1=require("../errors");function validateFunctionCode(it){if(isSchemaObj(it)){checkKeywords(it);if(schemaCxtHasRules(it)){topSchemaObjCode(it);return}}validateFunction(it,(()=>(0,boolSchema_1.topBoolOrEmptySchema)(it)))}exports.validateFunctionCode=validateFunctionCode;function validateFunction({gen:gen,validateName:validateName,schema:schema,schemaEnv:schemaEnv,opts:opts},body){if(opts.code.es5){gen.func(validateName,(0,codegen_1._)`${names_1.default.data}, ${names_1.default.valCxt}`,schemaEnv.$async,(()=>{gen.code((0,codegen_1._)`"use strict"; ${funcSourceUrl(schema,opts)}`);destructureValCxtES5(gen,opts);gen.code(body)}))}else{gen.func(validateName,(0,codegen_1._)`${names_1.default.data}, ${destructureValCxt(opts)}`,schemaEnv.$async,(()=>gen.code(funcSourceUrl(schema,opts)).code(body)))}}function destructureValCxt(opts){return(0,codegen_1._)`{${names_1.default.instancePath}="", ${names_1.default.parentData}, ${names_1.default.parentDataProperty}, ${names_1.default.rootData}=${names_1.default.data}${opts.dynamicRef?(0,codegen_1._)`, ${names_1.default.dynamicAnchors}={}`:codegen_1.nil}}={}`}function destructureValCxtES5(gen,opts){gen.if(names_1.default.valCxt,(()=>{gen.var(names_1.default.instancePath,(0,codegen_1._)`${names_1.default.valCxt}.${names_1.default.instancePath}`);gen.var(names_1.default.parentData,(0,codegen_1._)`${names_1.default.valCxt}.${names_1.default.parentData}`);gen.var(names_1.default.parentDataProperty,(0,codegen_1._)`${names_1.default.valCxt}.${names_1.default.parentDataProperty}`);gen.var(names_1.default.rootData,(0,codegen_1._)`${names_1.default.valCxt}.${names_1.default.rootData}`);if(opts.dynamicRef)gen.var(names_1.default.dynamicAnchors,(0,codegen_1._)`${names_1.default.valCxt}.${names_1.default.dynamicAnchors}`)}),(()=>{gen.var(names_1.default.instancePath,(0,codegen_1._)`""`);gen.var(names_1.default.parentData,(0,codegen_1._)`undefined`);gen.var(names_1.default.parentDataProperty,(0,codegen_1._)`undefined`);gen.var(names_1.default.rootData,names_1.default.data);if(opts.dynamicRef)gen.var(names_1.default.dynamicAnchors,(0,codegen_1._)`{}`)}))}function topSchemaObjCode(it){const{schema:schema,opts:opts,gen:gen}=it;validateFunction(it,(()=>{if(opts.$comment&&schema.$comment)commentKeyword(it);checkNoDefault(it);gen.let(names_1.default.vErrors,null);gen.let(names_1.default.errors,0);if(opts.unevaluated)resetEvaluated(it);typeAndKeywords(it);returnResults(it)}));return}function resetEvaluated(it){const{gen:gen,validateName:validateName}=it;it.evaluated=gen.const("evaluated",(0,codegen_1._)`${validateName}.evaluated`);gen.if((0,codegen_1._)`${it.evaluated}.dynamicProps`,(()=>gen.assign((0,codegen_1._)`${it.evaluated}.props`,(0,codegen_1._)`undefined`)));gen.if((0,codegen_1._)`${it.evaluated}.dynamicItems`,(()=>gen.assign((0,codegen_1._)`${it.evaluated}.items`,(0,codegen_1._)`undefined`)))}function funcSourceUrl(schema,opts){const schId=typeof schema=="object"&&schema[opts.schemaId];return schId&&(opts.code.source||opts.code.process)?(0,codegen_1._)`/*# sourceURL=${schId} */`:codegen_1.nil}function subschemaCode(it,valid){if(isSchemaObj(it)){checkKeywords(it);if(schemaCxtHasRules(it)){subSchemaObjCode(it,valid);return}}(0,boolSchema_1.boolOrEmptySchema)(it,valid)}function schemaCxtHasRules({schema:schema,self:self}){if(typeof schema=="boolean")return!schema;for(const key in schema)if(self.RULES.all[key])return true;return false}function isSchemaObj(it){return typeof it.schema!="boolean"}function subSchemaObjCode(it,valid){const{schema:schema,gen:gen,opts:opts}=it;if(opts.$comment&&schema.$comment)commentKeyword(it);updateContext(it);checkAsyncSchema(it);const errsCount=gen.const("_errs",names_1.default.errors);typeAndKeywords(it,errsCount);gen.var(valid,(0,codegen_1._)`${errsCount} === ${names_1.default.errors}`)}function checkKeywords(it){(0,util_1.checkUnknownRules)(it);checkRefsAndKeywords(it)}function typeAndKeywords(it,errsCount){if(it.opts.jtd)return schemaKeywords(it,[],false,errsCount);const types=(0,dataType_1.getSchemaTypes)(it.schema);const checkedTypes=(0,dataType_1.coerceAndCheckDataType)(it,types);schemaKeywords(it,types,!checkedTypes,errsCount)}function checkRefsAndKeywords(it){const{schema:schema,errSchemaPath:errSchemaPath,opts:opts,self:self}=it;if(schema.$ref&&opts.ignoreKeywordsWithRef&&(0,util_1.schemaHasRulesButRef)(schema,self.RULES)){self.logger.warn(`$ref: keywords ignored in schema at path "${errSchemaPath}"`)}}function checkNoDefault(it){const{schema:schema,opts:opts}=it;if(schema.default!==undefined&&opts.useDefaults&&opts.strictSchema){(0,util_1.checkStrictMode)(it,"default is ignored in the schema root")}}function updateContext(it){const schId=it.schema[it.opts.schemaId];if(schId)it.baseId=(0,resolve_1.resolveUrl)(it.opts.uriResolver,it.baseId,schId)}function checkAsyncSchema(it){if(it.schema.$async&&!it.schemaEnv.$async)throw new Error("async schema in sync schema")}function commentKeyword({gen:gen,schemaEnv:schemaEnv,schema:schema,errSchemaPath:errSchemaPath,opts:opts}){const msg=schema.$comment;if(opts.$comment===true){gen.code((0,codegen_1._)`${names_1.default.self}.logger.log(${msg})`)}else if(typeof opts.$comment=="function"){const schemaPath=(0,codegen_1.str)`${errSchemaPath}/$comment`;const rootName=gen.scopeValue("root",{ref:schemaEnv.root});gen.code((0,codegen_1._)`${names_1.default.self}.opts.$comment(${msg}, ${schemaPath}, ${rootName}.schema)`)}}function returnResults(it){const{gen:gen,schemaEnv:schemaEnv,validateName:validateName,ValidationError:ValidationError,opts:opts}=it;if(schemaEnv.$async){gen.if((0,codegen_1._)`${names_1.default.errors} === 0`,(()=>gen.return(names_1.default.data)),(()=>gen.throw((0,codegen_1._)`new ${ValidationError}(${names_1.default.vErrors})`)))}else{gen.assign((0,codegen_1._)`${validateName}.errors`,names_1.default.vErrors);if(opts.unevaluated)assignEvaluated(it);gen.return((0,codegen_1._)`${names_1.default.errors} === 0`)}}function assignEvaluated({gen:gen,evaluated:evaluated,props:props,items:items}){if(props instanceof codegen_1.Name)gen.assign((0,codegen_1._)`${evaluated}.props`,props);if(items instanceof codegen_1.Name)gen.assign((0,codegen_1._)`${evaluated}.items`,items)}function schemaKeywords(it,types,typeErrors,errsCount){const{gen:gen,schema:schema,data:data,allErrors:allErrors,opts:opts,self:self}=it;const{RULES:RULES}=self;if(schema.$ref&&(opts.ignoreKeywordsWithRef||!(0,util_1.schemaHasRulesButRef)(schema,RULES))){gen.block((()=>keywordCode(it,"$ref",RULES.all.$ref.definition)));return}if(!opts.jtd)checkStrictTypes(it,types);gen.block((()=>{for(const group of RULES.rules)groupKeywords(group);groupKeywords(RULES.post)}));function groupKeywords(group){if(!(0,applicability_1.shouldUseGroup)(schema,group))return;if(group.type){gen.if((0,dataType_2.checkDataType)(group.type,data,opts.strictNumbers));iterateKeywords(it,group);if(types.length===1&&types[0]===group.type&&typeErrors){gen.else();(0,dataType_2.reportTypeError)(it)}gen.endIf()}else{iterateKeywords(it,group)}if(!allErrors)gen.if((0,codegen_1._)`${names_1.default.errors} === ${errsCount||0}`)}}function iterateKeywords(it,group){const{gen:gen,schema:schema,opts:{useDefaults:useDefaults}}=it;if(useDefaults)(0,defaults_1.assignDefaults)(it,group.type);gen.block((()=>{for(const rule of group.rules){if((0,applicability_1.shouldUseRule)(schema,rule)){keywordCode(it,rule.keyword,rule.definition,group.type)}}}))}function checkStrictTypes(it,types){if(it.schemaEnv.meta||!it.opts.strictTypes)return;checkContextTypes(it,types);if(!it.opts.allowUnionTypes)checkMultipleTypes(it,types);checkKeywordTypes(it,it.dataTypes)}function checkContextTypes(it,types){if(!types.length)return;if(!it.dataTypes.length){it.dataTypes=types;return}types.forEach((t=>{if(!includesType(it.dataTypes,t)){strictTypesError(it,`type "${t}" not allowed by context "${it.dataTypes.join(",")}"`)}}));it.dataTypes=it.dataTypes.filter((t=>includesType(types,t)))}function checkMultipleTypes(it,ts){if(ts.length>1&&!(ts.length===2&&ts.includes("null"))){strictTypesError(it,"use allowUnionTypes to allow union type keyword")}}function checkKeywordTypes(it,ts){const rules=it.self.RULES.all;for(const keyword in rules){const rule=rules[keyword];if(typeof rule=="object"&&(0,applicability_1.shouldUseRule)(it.schema,rule)){const{type:type}=rule.definition;if(type.length&&!type.some((t=>hasApplicableType(ts,t)))){strictTypesError(it,`missing type "${type.join(",")}" for keyword "${keyword}"`)}}}}function hasApplicableType(schTs,kwdT){return schTs.includes(kwdT)||kwdT==="number"&&schTs.includes("integer")}function includesType(ts,t){return ts.includes(t)||t==="integer"&&ts.includes("number")}function strictTypesError(it,msg){const schemaPath=it.schemaEnv.baseId+it.errSchemaPath;msg+=` at "${schemaPath}" (strictTypes)`;(0,util_1.checkStrictMode)(it,msg,it.opts.strictTypes)}class KeywordCxt{constructor(it,def,keyword){(0,keyword_1.validateKeywordUsage)(it,def,keyword);this.gen=it.gen;this.allErrors=it.allErrors;this.keyword=keyword;this.data=it.data;this.schema=it.schema[keyword];this.$data=def.$data&&it.opts.$data&&this.schema&&this.schema.$data;this.schemaValue=(0,util_1.schemaRefOrVal)(it,this.schema,keyword,this.$data);this.schemaType=def.schemaType;this.parentSchema=it.schema;this.params={};this.it=it;this.def=def;if(this.$data){this.schemaCode=it.gen.const("vSchema",getData(this.$data,it))}else{this.schemaCode=this.schemaValue;if(!(0,keyword_1.validSchemaType)(this.schema,def.schemaType,def.allowUndefined)){throw new Error(`${keyword} value must be ${JSON.stringify(def.schemaType)}`)}}if("code"in def?def.trackErrors:def.errors!==false){this.errsCount=it.gen.const("_errs",names_1.default.errors)}}result(condition,successAction,failAction){this.failResult((0,codegen_1.not)(condition),successAction,failAction)}failResult(condition,successAction,failAction){this.gen.if(condition);if(failAction)failAction();else this.error();if(successAction){this.gen.else();successAction();if(this.allErrors)this.gen.endIf()}else{if(this.allErrors)this.gen.endIf();else this.gen.else()}}pass(condition,failAction){this.failResult((0,codegen_1.not)(condition),undefined,failAction)}fail(condition){if(condition===undefined){this.error();if(!this.allErrors)this.gen.if(false);return}this.gen.if(condition);this.error();if(this.allErrors)this.gen.endIf();else this.gen.else()}fail$data(condition){if(!this.$data)return this.fail(condition);const{schemaCode:schemaCode}=this;this.fail((0,codegen_1._)`${schemaCode} !== undefined && (${(0,codegen_1.or)(this.invalid$data(),condition)})`)}error(append,errorParams,errorPaths){if(errorParams){this.setParams(errorParams);this._error(append,errorPaths);this.setParams({});return}this._error(append,errorPaths)}_error(append,errorPaths){(append?errors_1.reportExtraError:errors_1.reportError)(this,this.def.error,errorPaths)}$dataError(){(0,errors_1.reportError)(this,this.def.$dataError||errors_1.keyword$DataError)}reset(){if(this.errsCount===undefined)throw new Error('add "trackErrors" to keyword definition');(0,errors_1.resetErrorsCount)(this.gen,this.errsCount)}ok(cond){if(!this.allErrors)this.gen.if(cond)}setParams(obj,assign){if(assign)Object.assign(this.params,obj);else this.params=obj}block$data(valid,codeBlock,$dataValid=codegen_1.nil){this.gen.block((()=>{this.check$data(valid,$dataValid);codeBlock()}))}check$data(valid=codegen_1.nil,$dataValid=codegen_1.nil){if(!this.$data)return;const{gen:gen,schemaCode:schemaCode,schemaType:schemaType,def:def}=this;gen.if((0,codegen_1.or)((0,codegen_1._)`${schemaCode} === undefined`,$dataValid));if(valid!==codegen_1.nil)gen.assign(valid,true);if(schemaType.length||def.validateSchema){gen.elseIf(this.invalid$data());this.$dataError();if(valid!==codegen_1.nil)gen.assign(valid,false)}gen.else()}invalid$data(){const{gen:gen,schemaCode:schemaCode,schemaType:schemaType,def:def,it:it}=this;return(0,codegen_1.or)(wrong$DataType(),invalid$DataSchema());function wrong$DataType(){if(schemaType.length){if(!(schemaCode instanceof codegen_1.Name))throw new Error("ajv implementation error");const st=Array.isArray(schemaType)?schemaType:[schemaType];return(0,codegen_1._)`${(0,dataType_2.checkDataTypes)(st,schemaCode,it.opts.strictNumbers,dataType_2.DataType.Wrong)}`}return codegen_1.nil}function invalid$DataSchema(){if(def.validateSchema){const validateSchemaRef=gen.scopeValue("validate$data",{ref:def.validateSchema});return(0,codegen_1._)`!${validateSchemaRef}(${schemaCode})`}return codegen_1.nil}}subschema(appl,valid){const subschema=(0,subschema_1.getSubschema)(this.it,appl);(0,subschema_1.extendSubschemaData)(subschema,this.it,appl);(0,subschema_1.extendSubschemaMode)(subschema,appl);const nextContext={...this.it,...subschema,items:undefined,props:undefined};subschemaCode(nextContext,valid);return nextContext}mergeEvaluated(schemaCxt,toName){const{it:it,gen:gen}=this;if(!it.opts.unevaluated)return;if(it.props!==true&&schemaCxt.props!==undefined){it.props=util_1.mergeEvaluated.props(gen,schemaCxt.props,it.props,toName)}if(it.items!==true&&schemaCxt.items!==undefined){it.items=util_1.mergeEvaluated.items(gen,schemaCxt.items,it.items,toName)}}mergeValidEvaluated(schemaCxt,valid){const{it:it,gen:gen}=this;if(it.opts.unevaluated&&(it.props!==true||it.items!==true)){gen.if(valid,(()=>this.mergeEvaluated(schemaCxt,codegen_1.Name)));return true}}}exports.KeywordCxt=KeywordCxt;function keywordCode(it,keyword,def,ruleType){const cxt=new KeywordCxt(it,def,keyword);if("code"in def){def.code(cxt,ruleType)}else if(cxt.$data&&def.validate){(0,keyword_1.funcKeywordCode)(cxt,def)}else if("macro"in def){(0,keyword_1.macroKeywordCode)(cxt,def)}else if(def.compile||def.validate){(0,keyword_1.funcKeywordCode)(cxt,def)}}const JSON_POINTER=/^\/(?:[^~]|~0|~1)*$/;const RELATIVE_JSON_POINTER=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function getData($data,{dataLevel:dataLevel,dataNames:dataNames,dataPathArr:dataPathArr}){let jsonPointer;let data;if($data==="")return names_1.default.rootData;if($data[0]==="/"){if(!JSON_POINTER.test($data))throw new Error(`Invalid JSON-pointer: ${$data}`);jsonPointer=$data;data=names_1.default.rootData}else{const matches=RELATIVE_JSON_POINTER.exec($data);if(!matches)throw new Error(`Invalid JSON-pointer: ${$data}`);const up=+matches[1];jsonPointer=matches[2];if(jsonPointer==="#"){if(up>=dataLevel)throw new Error(errorMsg("property/index",up));return dataPathArr[dataLevel-up]}if(up>dataLevel)throw new Error(errorMsg("data",up));data=dataNames[dataLevel-up];if(!jsonPointer)return data}let expr=data;const segments=jsonPointer.split("/");for(const segment of segments){if(segment){data=(0,codegen_1._)`${data}${(0,codegen_1.getProperty)((0,util_1.unescapeJsonPointer)(segment))}`;expr=(0,codegen_1._)`${expr} && ${data}`}}return expr;function errorMsg(pointerType,up){return`Cannot access ${pointerType} ${up} levels up, current level is ${dataLevel}`}}exports.getData=getData},{"../codegen":80,"../errors":82,"../names":84,"../resolve":86,"../util":88,"./applicability":89,"./boolSchema":90,"./dataType":91,"./defaults":92,"./keyword":94,"./subschema":95}],94:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateKeywordUsage=exports.validSchemaType=exports.funcKeywordCode=exports.macroKeywordCode=void 0;const codegen_1=require("../codegen");const names_1=require("../names");const code_1=require("../../vocabularies/code");const errors_1=require("../errors");function macroKeywordCode(cxt,def){const{gen:gen,keyword:keyword,schema:schema,parentSchema:parentSchema,it:it}=cxt;const macroSchema=def.macro.call(it.self,schema,parentSchema,it);const schemaRef=useKeyword(gen,keyword,macroSchema);if(it.opts.validateSchema!==false)it.self.validateSchema(macroSchema,true);const valid=gen.name("valid");cxt.subschema({schema:macroSchema,schemaPath:codegen_1.nil,errSchemaPath:`${it.errSchemaPath}/${keyword}`,topSchemaRef:schemaRef,compositeRule:true},valid);cxt.pass(valid,(()=>cxt.error(true)))}exports.macroKeywordCode=macroKeywordCode;function funcKeywordCode(cxt,def){var _a;const{gen:gen,keyword:keyword,schema:schema,parentSchema:parentSchema,$data:$data,it:it}=cxt;checkAsyncKeyword(it,def);const validate=!$data&&def.compile?def.compile.call(it.self,schema,parentSchema,it):def.validate;const validateRef=useKeyword(gen,keyword,validate);const valid=gen.let("valid");cxt.block$data(valid,validateKeyword);cxt.ok((_a=def.valid)!==null&&_a!==void 0?_a:valid);function validateKeyword(){if(def.errors===false){assignValid();if(def.modifying)modifyData(cxt);reportErrs((()=>cxt.error()))}else{const ruleErrs=def.async?validateAsync():validateSync();if(def.modifying)modifyData(cxt);reportErrs((()=>addErrs(cxt,ruleErrs)))}}function validateAsync(){const ruleErrs=gen.let("ruleErrs",null);gen.try((()=>assignValid((0,codegen_1._)`await `)),(e=>gen.assign(valid,false).if((0,codegen_1._)`${e} instanceof ${it.ValidationError}`,(()=>gen.assign(ruleErrs,(0,codegen_1._)`${e}.errors`)),(()=>gen.throw(e)))));return ruleErrs}function validateSync(){const validateErrs=(0,codegen_1._)`${validateRef}.errors`;gen.assign(validateErrs,null);assignValid(codegen_1.nil);return validateErrs}function assignValid(_await=(def.async?(0,codegen_1._)`await `:codegen_1.nil)){const passCxt=it.opts.passContext?names_1.default.this:names_1.default.self;const passSchema=!("compile"in def&&!$data||def.schema===false);gen.assign(valid,(0,codegen_1._)`${_await}${(0,code_1.callValidateCode)(cxt,validateRef,passCxt,passSchema)}`,def.modifying)}function reportErrs(errors){var _a;gen.if((0,codegen_1.not)((_a=def.valid)!==null&&_a!==void 0?_a:valid),errors)}}exports.funcKeywordCode=funcKeywordCode;function modifyData(cxt){const{gen:gen,data:data,it:it}=cxt;gen.if(it.parentData,(()=>gen.assign(data,(0,codegen_1._)`${it.parentData}[${it.parentDataProperty}]`)))}function addErrs(cxt,errs){const{gen:gen}=cxt;gen.if((0,codegen_1._)`Array.isArray(${errs})`,(()=>{gen.assign(names_1.default.vErrors,(0,codegen_1._)`${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`).assign(names_1.default.errors,(0,codegen_1._)`${names_1.default.vErrors}.length`);(0,errors_1.extendErrors)(cxt)}),(()=>cxt.error()))}function checkAsyncKeyword({schemaEnv:schemaEnv},def){if(def.async&&!schemaEnv.$async)throw new Error("async keyword in sync schema")}function useKeyword(gen,keyword,result){if(result===undefined)throw new Error(`keyword "${keyword}" failed to compile`);return gen.scopeValue("keyword",typeof result=="function"?{ref:result}:{ref:result,code:(0,codegen_1.stringify)(result)})}function validSchemaType(schema,schemaType,allowUndefined=false){return!schemaType.length||schemaType.some((st=>st==="array"?Array.isArray(schema):st==="object"?schema&&typeof schema=="object"&&!Array.isArray(schema):typeof schema==st||allowUndefined&&typeof schema=="undefined"))}exports.validSchemaType=validSchemaType;function validateKeywordUsage({schema:schema,opts:opts,self:self,errSchemaPath:errSchemaPath},def,keyword){if(Array.isArray(def.keyword)?!def.keyword.includes(keyword):def.keyword!==keyword){throw new Error("ajv implementation error")}const deps=def.dependencies;if(deps===null||deps===void 0?void 0:deps.some((kwd=>!Object.prototype.hasOwnProperty.call(schema,kwd)))){throw new Error(`parent schema must have dependencies of ${keyword}: ${deps.join(",")}`)}if(def.validateSchema){const valid=def.validateSchema(schema[keyword]);if(!valid){const msg=`keyword "${keyword}" value is invalid at path "${errSchemaPath}": `+self.errorsText(def.validateSchema.errors);if(opts.validateSchema==="log")self.logger.error(msg);else throw new Error(msg)}}}exports.validateKeywordUsage=validateKeywordUsage},{"../../vocabularies/code":120,"../codegen":80,"../errors":82,"../names":84}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.extendSubschemaMode=exports.extendSubschemaData=exports.getSubschema=void 0;const codegen_1=require("../codegen");const util_1=require("../util");function getSubschema(it,{keyword:keyword,schemaProp:schemaProp,schema:schema,schemaPath:schemaPath,errSchemaPath:errSchemaPath,topSchemaRef:topSchemaRef}){if(keyword!==undefined&&schema!==undefined){throw new Error('both "keyword" and "schema" passed, only one allowed')}if(keyword!==undefined){const sch=it.schema[keyword];return schemaProp===undefined?{schema:sch,schemaPath:(0,codegen_1._)`${it.schemaPath}${(0,codegen_1.getProperty)(keyword)}`,errSchemaPath:`${it.errSchemaPath}/${keyword}`}:{schema:sch[schemaProp],schemaPath:(0,codegen_1._)`${it.schemaPath}${(0,codegen_1.getProperty)(keyword)}${(0,codegen_1.getProperty)(schemaProp)}`,errSchemaPath:`${it.errSchemaPath}/${keyword}/${(0,util_1.escapeFragment)(schemaProp)}`}}if(schema!==undefined){if(schemaPath===undefined||errSchemaPath===undefined||topSchemaRef===undefined){throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"')}return{schema:schema,schemaPath:schemaPath,topSchemaRef:topSchemaRef,errSchemaPath:errSchemaPath}}throw new Error('either "keyword" or "schema" must be passed')}exports.getSubschema=getSubschema;function extendSubschemaData(subschema,it,{dataProp:dataProp,dataPropType:dpType,data:data,dataTypes:dataTypes,propertyName:propertyName}){if(data!==undefined&&dataProp!==undefined){throw new Error('both "data" and "dataProp" passed, only one allowed')}const{gen:gen}=it;if(dataProp!==undefined){const{errorPath:errorPath,dataPathArr:dataPathArr,opts:opts}=it;const nextData=gen.let("data",(0,codegen_1._)`${it.data}${(0,codegen_1.getProperty)(dataProp)}`,true);dataContextProps(nextData);subschema.errorPath=(0,codegen_1.str)`${errorPath}${(0,util_1.getErrorPath)(dataProp,dpType,opts.jsPropertySyntax)}`;subschema.parentDataProperty=(0,codegen_1._)`${dataProp}`;subschema.dataPathArr=[...dataPathArr,subschema.parentDataProperty]}if(data!==undefined){const nextData=data instanceof codegen_1.Name?data:gen.let("data",data,true);dataContextProps(nextData);if(propertyName!==undefined)subschema.propertyName=propertyName}if(dataTypes)subschema.dataTypes=dataTypes;function dataContextProps(_nextData){subschema.data=_nextData;subschema.dataLevel=it.dataLevel+1;subschema.dataTypes=[];it.definedProperties=new Set;subschema.parentData=it.data;subschema.dataNames=[...it.dataNames,_nextData]}}exports.extendSubschemaData=extendSubschemaData;function extendSubschemaMode(subschema,{jtdDiscriminator:jtdDiscriminator,jtdMetadata:jtdMetadata,compositeRule:compositeRule,createErrors:createErrors,allErrors:allErrors}){if(compositeRule!==undefined)subschema.compositeRule=compositeRule;if(createErrors!==undefined)subschema.createErrors=createErrors;if(allErrors!==undefined)subschema.allErrors=allErrors;subschema.jtdDiscriminator=jtdDiscriminator;subschema.jtdMetadata=jtdMetadata}exports.extendSubschemaMode=extendSubschemaMode},{"../codegen":80,"../util":88}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CodeGen=exports.Name=exports.nil=exports.stringify=exports.str=exports._=exports.KeywordCxt=void 0;var validate_1=require("./compile/validate");Object.defineProperty(exports,"KeywordCxt",{enumerable:true,get:function(){return validate_1.KeywordCxt}});var codegen_1=require("./compile/codegen");Object.defineProperty(exports,"_",{enumerable:true,get:function(){return codegen_1._}});Object.defineProperty(exports,"str",{enumerable:true,get:function(){return codegen_1.str}});Object.defineProperty(exports,"stringify",{enumerable:true,get:function(){return codegen_1.stringify}});Object.defineProperty(exports,"nil",{enumerable:true,get:function(){return codegen_1.nil}});Object.defineProperty(exports,"Name",{enumerable:true,get:function(){return codegen_1.Name}});Object.defineProperty(exports,"CodeGen",{enumerable:true,get:function(){return codegen_1.CodeGen}});const validation_error_1=require("./runtime/validation_error");const ref_error_1=require("./compile/ref_error");const rules_1=require("./compile/rules");const compile_1=require("./compile");const codegen_2=require("./compile/codegen");const resolve_1=require("./compile/resolve");const dataType_1=require("./compile/validate/dataType");const util_1=require("./compile/util");const $dataRefSchema=require("./refs/data.json");const uri_1=require("./runtime/uri");const defaultRegExp=(str,flags)=>new RegExp(str,flags);defaultRegExp.code="new RegExp";const META_IGNORE_OPTIONS=["removeAdditional","useDefaults","coerceTypes"];const EXT_SCOPE_NAMES=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]);const removedOptions={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."};const deprecatedOptions={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};const MAX_EXPRESSION=200;function requiredOptions(o){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0;const s=o.strict;const _optz=(_a=o.code)===null||_a===void 0?void 0:_a.optimize;const optimize=_optz===true||_optz===undefined?1:_optz||0;const regExp=(_c=(_b=o.code)===null||_b===void 0?void 0:_b.regExp)!==null&&_c!==void 0?_c:defaultRegExp;const uriResolver=(_d=o.uriResolver)!==null&&_d!==void 0?_d:uri_1.default;return{strictSchema:(_f=(_e=o.strictSchema)!==null&&_e!==void 0?_e:s)!==null&&_f!==void 0?_f:true,strictNumbers:(_h=(_g=o.strictNumbers)!==null&&_g!==void 0?_g:s)!==null&&_h!==void 0?_h:true,strictTypes:(_k=(_j=o.strictTypes)!==null&&_j!==void 0?_j:s)!==null&&_k!==void 0?_k:"log",strictTuples:(_m=(_l=o.strictTuples)!==null&&_l!==void 0?_l:s)!==null&&_m!==void 0?_m:"log",strictRequired:(_p=(_o=o.strictRequired)!==null&&_o!==void 0?_o:s)!==null&&_p!==void 0?_p:false,code:o.code?{...o.code,optimize:optimize,regExp:regExp}:{optimize:optimize,regExp:regExp},loopRequired:(_q=o.loopRequired)!==null&&_q!==void 0?_q:MAX_EXPRESSION,loopEnum:(_r=o.loopEnum)!==null&&_r!==void 0?_r:MAX_EXPRESSION,meta:(_s=o.meta)!==null&&_s!==void 0?_s:true,messages:(_t=o.messages)!==null&&_t!==void 0?_t:true,inlineRefs:(_u=o.inlineRefs)!==null&&_u!==void 0?_u:true,schemaId:(_v=o.schemaId)!==null&&_v!==void 0?_v:"$id",addUsedSchema:(_w=o.addUsedSchema)!==null&&_w!==void 0?_w:true,validateSchema:(_x=o.validateSchema)!==null&&_x!==void 0?_x:true,validateFormats:(_y=o.validateFormats)!==null&&_y!==void 0?_y:true,unicodeRegExp:(_z=o.unicodeRegExp)!==null&&_z!==void 0?_z:true,int32range:(_0=o.int32range)!==null&&_0!==void 0?_0:true,uriResolver:uriResolver}}class Ajv{constructor(opts={}){this.schemas={};this.refs={};this.formats={};this._compilations=new Set;this._loading={};this._cache=new Map;opts=this.opts={...opts,...requiredOptions(opts)};const{es5:es5,lines:lines}=this.opts.code;this.scope=new codegen_2.ValueScope({scope:{},prefixes:EXT_SCOPE_NAMES,es5:es5,lines:lines});this.logger=getLogger(opts.logger);const formatOpt=opts.validateFormats;opts.validateFormats=false;this.RULES=(0,rules_1.getRules)();checkOptions.call(this,removedOptions,opts,"NOT SUPPORTED");checkOptions.call(this,deprecatedOptions,opts,"DEPRECATED","warn");this._metaOpts=getMetaSchemaOptions.call(this);if(opts.formats)addInitialFormats.call(this);this._addVocabularies();this._addDefaultMetaSchema();if(opts.keywords)addInitialKeywords.call(this,opts.keywords);if(typeof opts.meta=="object")this.addMetaSchema(opts.meta);addInitialSchemas.call(this);opts.validateFormats=formatOpt}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:$data,meta:meta,schemaId:schemaId}=this.opts;let _dataRefSchema=$dataRefSchema;if(schemaId==="id"){_dataRefSchema={...$dataRefSchema};_dataRefSchema.id=_dataRefSchema.$id;delete _dataRefSchema.$id}if(meta&&$data)this.addMetaSchema(_dataRefSchema,_dataRefSchema[schemaId],false)}defaultMeta(){const{meta:meta,schemaId:schemaId}=this.opts;return this.opts.defaultMeta=typeof meta=="object"?meta[schemaId]||meta:undefined}validate(schemaKeyRef,data){let v;if(typeof schemaKeyRef=="string"){v=this.getSchema(schemaKeyRef);if(!v)throw new Error(`no schema with key or ref "${schemaKeyRef}"`)}else{v=this.compile(schemaKeyRef)}const valid=v(data);if(!("$async"in v))this.errors=v.errors;return valid}compile(schema,_meta){const sch=this._addSchema(schema,_meta);return sch.validate||this._compileSchemaEnv(sch)}compileAsync(schema,meta){if(typeof this.opts.loadSchema!="function"){throw new Error("options.loadSchema should be a function")}const{loadSchema:loadSchema}=this.opts;return runCompileAsync.call(this,schema,meta);async function runCompileAsync(_schema,_meta){await loadMetaSchema.call(this,_schema.$schema);const sch=this._addSchema(_schema,_meta);return sch.validate||_compileAsync.call(this,sch)}async function loadMetaSchema($ref){if($ref&&!this.getSchema($ref)){await runCompileAsync.call(this,{$ref:$ref},true)}}async function _compileAsync(sch){try{return this._compileSchemaEnv(sch)}catch(e){if(!(e instanceof ref_error_1.default))throw e;checkLoaded.call(this,e);await loadMissingSchema.call(this,e.missingSchema);return _compileAsync.call(this,sch)}}function checkLoaded({missingSchema:ref,missingRef:missingRef}){if(this.refs[ref]){throw new Error(`AnySchema ${ref} is loaded but ${missingRef} cannot be resolved`)}}async function loadMissingSchema(ref){const _schema=await _loadSchema.call(this,ref);if(!this.refs[ref])await loadMetaSchema.call(this,_schema.$schema);if(!this.refs[ref])this.addSchema(_schema,ref,meta)}async function _loadSchema(ref){const p=this._loading[ref];if(p)return p;try{return await(this._loading[ref]=loadSchema(ref))}finally{delete this._loading[ref]}}}addSchema(schema,key,_meta,_validateSchema=this.opts.validateSchema){if(Array.isArray(schema)){for(const sch of schema)this.addSchema(sch,undefined,_meta,_validateSchema);return this}let id;if(typeof schema==="object"){const{schemaId:schemaId}=this.opts;id=schema[schemaId];if(id!==undefined&&typeof id!="string"){throw new Error(`schema ${schemaId} must be string`)}}key=(0,resolve_1.normalizeId)(key||id);this._checkUnique(key);this.schemas[key]=this._addSchema(schema,_meta,key,_validateSchema,true);return this}addMetaSchema(schema,key,_validateSchema=this.opts.validateSchema){this.addSchema(schema,key,true,_validateSchema);return this}validateSchema(schema,throwOrLogError){if(typeof schema=="boolean")return true;let $schema;$schema=schema.$schema;if($schema!==undefined&&typeof $schema!="string"){throw new Error("$schema must be a string")}$schema=$schema||this.opts.defaultMeta||this.defaultMeta();if(!$schema){this.logger.warn("meta-schema not available");this.errors=null;return true}const valid=this.validate($schema,schema);if(!valid&&throwOrLogError){const message="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(message);else throw new Error(message)}return valid}getSchema(keyRef){let sch;while(typeof(sch=getSchEnv.call(this,keyRef))=="string")keyRef=sch;if(sch===undefined){const{schemaId:schemaId}=this.opts;const root=new compile_1.SchemaEnv({schema:{},schemaId:schemaId});sch=compile_1.resolveSchema.call(this,root,keyRef);if(!sch)return;this.refs[keyRef]=sch}return sch.validate||this._compileSchemaEnv(sch)}removeSchema(schemaKeyRef){if(schemaKeyRef instanceof RegExp){this._removeAllSchemas(this.schemas,schemaKeyRef);this._removeAllSchemas(this.refs,schemaKeyRef);return this}switch(typeof schemaKeyRef){case"undefined":this._removeAllSchemas(this.schemas);this._removeAllSchemas(this.refs);this._cache.clear();return this;case"string":{const sch=getSchEnv.call(this,schemaKeyRef);if(typeof sch=="object")this._cache.delete(sch.schema);delete this.schemas[schemaKeyRef];delete this.refs[schemaKeyRef];return this}case"object":{const cacheKey=schemaKeyRef;this._cache.delete(cacheKey);let id=schemaKeyRef[this.opts.schemaId];if(id){id=(0,resolve_1.normalizeId)(id);delete this.schemas[id];delete this.refs[id]}return this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(definitions){for(const def of definitions)this.addKeyword(def);return this}addKeyword(kwdOrDef,def){let keyword;if(typeof kwdOrDef=="string"){keyword=kwdOrDef;if(typeof def=="object"){this.logger.warn("these parameters are deprecated, see docs for addKeyword");def.keyword=keyword}}else if(typeof kwdOrDef=="object"&&def===undefined){def=kwdOrDef;keyword=def.keyword;if(Array.isArray(keyword)&&!keyword.length){throw new Error("addKeywords: keyword must be string or non-empty array")}}else{throw new Error("invalid addKeywords parameters")}checkKeyword.call(this,keyword,def);if(!def){(0,util_1.eachItem)(keyword,(kwd=>addRule.call(this,kwd)));return this}keywordMetaschema.call(this,def);const definition={...def,type:(0,dataType_1.getJSONTypes)(def.type),schemaType:(0,dataType_1.getJSONTypes)(def.schemaType)};(0,util_1.eachItem)(keyword,definition.type.length===0?k=>addRule.call(this,k,definition):k=>definition.type.forEach((t=>addRule.call(this,k,definition,t))));return this}getKeyword(keyword){const rule=this.RULES.all[keyword];return typeof rule=="object"?rule.definition:!!rule}removeKeyword(keyword){const{RULES:RULES}=this;delete RULES.keywords[keyword];delete RULES.all[keyword];for(const group of RULES.rules){const i=group.rules.findIndex((rule=>rule.keyword===keyword));if(i>=0)group.rules.splice(i,1)}return this}addFormat(name,format){if(typeof format=="string")format=new RegExp(format);this.formats[name]=format;return this}errorsText(errors=this.errors,{separator:separator=", ",dataVar:dataVar="data"}={}){if(!errors||errors.length===0)return"No errors";return errors.map((e=>`${dataVar}${e.instancePath} ${e.message}`)).reduce(((text,msg)=>text+separator+msg))}$dataMetaSchema(metaSchema,keywordsJsonPointers){const rules=this.RULES.all;metaSchema=JSON.parse(JSON.stringify(metaSchema));for(const jsonPointer of keywordsJsonPointers){const segments=jsonPointer.split("/").slice(1);let keywords=metaSchema;for(const seg of segments)keywords=keywords[seg];for(const key in rules){const rule=rules[key];if(typeof rule!="object")continue;const{$data:$data}=rule.definition;const schema=keywords[key];if($data&&schema)keywords[key]=schemaOrData(schema)}}return metaSchema}_removeAllSchemas(schemas,regex){for(const keyRef in schemas){const sch=schemas[keyRef];if(!regex||regex.test(keyRef)){if(typeof sch=="string"){delete schemas[keyRef]}else if(sch&&!sch.meta){this._cache.delete(sch.schema);delete schemas[keyRef]}}}}_addSchema(schema,meta,baseId,validateSchema=this.opts.validateSchema,addSchema=this.opts.addUsedSchema){let id;const{schemaId:schemaId}=this.opts;if(typeof schema=="object"){id=schema[schemaId]}else{if(this.opts.jtd)throw new Error("schema must be object");else if(typeof schema!="boolean")throw new Error("schema must be object or boolean")}let sch=this._cache.get(schema);if(sch!==undefined)return sch;baseId=(0,resolve_1.normalizeId)(id||baseId);const localRefs=resolve_1.getSchemaRefs.call(this,schema,baseId);sch=new compile_1.SchemaEnv({schema:schema,schemaId:schemaId,meta:meta,baseId:baseId,localRefs:localRefs});this._cache.set(sch.schema,sch);if(addSchema&&!baseId.startsWith("#")){if(baseId)this._checkUnique(baseId);this.refs[baseId]=sch}if(validateSchema)this.validateSchema(schema,true);return sch}_checkUnique(id){if(this.schemas[id]||this.refs[id]){throw new Error(`schema with key or id "${id}" already exists`)}}_compileSchemaEnv(sch){if(sch.meta)this._compileMetaSchema(sch);else compile_1.compileSchema.call(this,sch);if(!sch.validate)throw new Error("ajv implementation error");return sch.validate}_compileMetaSchema(sch){const currentOpts=this.opts;this.opts=this._metaOpts;try{compile_1.compileSchema.call(this,sch)}finally{this.opts=currentOpts}}}exports.default=Ajv;Ajv.ValidationError=validation_error_1.default;Ajv.MissingRefError=ref_error_1.default;function checkOptions(checkOpts,options,msg,log="error"){for(const key in checkOpts){const opt=key;if(opt in options)this.logger[log](`${msg}: option ${key}. ${checkOpts[opt]}`)}}function getSchEnv(keyRef){keyRef=(0,resolve_1.normalizeId)(keyRef);return this.schemas[keyRef]||this.refs[keyRef]}function addInitialSchemas(){const optsSchemas=this.opts.schemas;if(!optsSchemas)return;if(Array.isArray(optsSchemas))this.addSchema(optsSchemas);else for(const key in optsSchemas)this.addSchema(optsSchemas[key],key)}function addInitialFormats(){for(const name in this.opts.formats){const format=this.opts.formats[name];if(format)this.addFormat(name,format)}}function addInitialKeywords(defs){if(Array.isArray(defs)){this.addVocabulary(defs);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const keyword in defs){const def=defs[keyword];if(!def.keyword)def.keyword=keyword;this.addKeyword(def)}}function getMetaSchemaOptions(){const metaOpts={...this.opts};for(const opt of META_IGNORE_OPTIONS)delete metaOpts[opt];return metaOpts}const noLogs={log(){},warn(){},error(){}};function getLogger(logger){if(logger===false)return noLogs;if(logger===undefined)return console;if(logger.log&&logger.warn&&logger.error)return logger;throw new Error("logger must implement log, warn and error methods")}const KEYWORD_NAME=/^[a-z_$][a-z0-9_$:-]*$/i;function checkKeyword(keyword,def){const{RULES:RULES}=this;(0,util_1.eachItem)(keyword,(kwd=>{if(RULES.keywords[kwd])throw new Error(`Keyword ${kwd} is already defined`);if(!KEYWORD_NAME.test(kwd))throw new Error(`Keyword ${kwd} has invalid name`)}));if(!def)return;if(def.$data&&!("code"in def||"validate"in def)){throw new Error('$data keyword must have "code" or "validate" function')}}function addRule(keyword,definition,dataType){var _a;const post=definition===null||definition===void 0?void 0:definition.post;if(dataType&&post)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:RULES}=this;let ruleGroup=post?RULES.post:RULES.rules.find((({type:t})=>t===dataType));if(!ruleGroup){ruleGroup={type:dataType,rules:[]};RULES.rules.push(ruleGroup)}RULES.keywords[keyword]=true;if(!definition)return;const rule={keyword:keyword,definition:{...definition,type:(0,dataType_1.getJSONTypes)(definition.type),schemaType:(0,dataType_1.getJSONTypes)(definition.schemaType)}};if(definition.before)addBeforeRule.call(this,ruleGroup,rule,definition.before);else ruleGroup.rules.push(rule);RULES.all[keyword]=rule;(_a=definition.implements)===null||_a===void 0?void 0:_a.forEach((kwd=>this.addKeyword(kwd)))}function addBeforeRule(ruleGroup,rule,before){const i=ruleGroup.rules.findIndex((_rule=>_rule.keyword===before));if(i>=0){ruleGroup.rules.splice(i,0,rule)}else{ruleGroup.rules.push(rule);this.logger.warn(`rule ${before} is not defined`)}}function keywordMetaschema(def){let{metaSchema:metaSchema}=def;if(metaSchema===undefined)return;if(def.$data&&this.opts.$data)metaSchema=schemaOrData(metaSchema);def.validateSchema=this.compile(metaSchema,true)}const $dataRef={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function schemaOrData(schema){return{anyOf:[schema,$dataRef]}}},{"./compile":83,"./compile/codegen":80,"./compile/ref_error":85,"./compile/resolve":86,"./compile/rules":87,"./compile/util":88,"./compile/validate":93,"./compile/validate/dataType":91,"./refs/data.json":97,"./runtime/uri":101,"./runtime/validation_error":102}],97:[function(require,module,exports){arguments[4][32][0].apply(exports,arguments)},{dup:32}],98:[function(require,module,exports){arguments[4][33][0].apply(exports,arguments)},{dup:33}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const equal=require("fast-deep-equal");equal.code='require("ajv/dist/runtime/equal").default';exports.default=equal},{"fast-deep-equal":266}],100:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function ucs2length(str){const len=str.length;let length=0;let pos=0;let value;while(pos<len){length++;value=str.charCodeAt(pos++);if(value>=55296&&value<=56319&&pos<len){value=str.charCodeAt(pos);if((value&64512)===56320)pos++}}return length}exports.default=ucs2length;ucs2length.code='require("ajv/dist/runtime/ucs2length").default'},{}],101:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const uri=require("uri-js");uri.code='require("ajv/dist/runtime/uri").default';exports.default=uri},{"uri-js":435}],102:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});class ValidationError extends Error{constructor(errors){super("validation failed");this.errors=errors;this.ajv=this.validation=true}}exports.default=ValidationError},{}],103:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateAdditionalItems=void 0;const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const error={message:({params:{len:len}})=>(0,codegen_1.str)`must NOT have more than ${len} items`,params:({params:{len:len}})=>(0,codegen_1._)`{limit: ${len}}`};const def={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:error,code(cxt){const{parentSchema:parentSchema,it:it}=cxt;const{items:items}=parentSchema;if(!Array.isArray(items)){(0,util_1.checkStrictMode)(it,'"additionalItems" is ignored when "items" is not an array of schemas');return}validateAdditionalItems(cxt,items)}};function validateAdditionalItems(cxt,items){const{gen:gen,schema:schema,data:data,keyword:keyword,it:it}=cxt;it.items=true;const len=gen.const("len",(0,codegen_1._)`${data}.length`);if(schema===false){cxt.setParams({len:items.length});cxt.pass((0,codegen_1._)`${len} <= ${items.length}`)}else if(typeof schema=="object"&&!(0,util_1.alwaysValidSchema)(it,schema)){const valid=gen.var("valid",(0,codegen_1._)`${len} <= ${items.length}`);gen.if((0,codegen_1.not)(valid),(()=>validateItems(valid)));cxt.ok(valid)}function validateItems(valid){gen.forRange("i",items.length,len,(i=>{cxt.subschema({keyword:keyword,dataProp:i,dataPropType:util_1.Type.Num},valid);if(!it.allErrors)gen.if((0,codegen_1.not)(valid),(()=>gen.break()))}))}}exports.validateAdditionalItems=validateAdditionalItems;exports.default=def},{"../../compile/codegen":80,"../../compile/util":88}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const codegen_1=require("../../compile/codegen");const names_1=require("../../compile/names");const util_1=require("../../compile/util");const error={message:"must NOT have additional properties",params:({params:params})=>(0,codegen_1._)`{additionalProperty: ${params.additionalProperty}}`};const def={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:true,trackErrors:true,error:error,code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,errsCount:errsCount,it:it}=cxt;if(!errsCount)throw new Error("ajv implementation error");const{allErrors:allErrors,opts:opts}=it;it.props=true;if(opts.removeAdditional!=="all"&&(0,util_1.alwaysValidSchema)(it,schema))return;const props=(0,code_1.allSchemaProperties)(parentSchema.properties);const patProps=(0,code_1.allSchemaProperties)(parentSchema.patternProperties);checkAdditionalProperties();cxt.ok((0,codegen_1._)`${errsCount} === ${names_1.default.errors}`);function checkAdditionalProperties(){gen.forIn("key",data,(key=>{if(!props.length&&!patProps.length)additionalPropertyCode(key);else gen.if(isAdditional(key),(()=>additionalPropertyCode(key)))}))}function isAdditional(key){let definedProp;if(props.length>8){const propsSchema=(0,util_1.schemaRefOrVal)(it,parentSchema.properties,"properties");definedProp=(0,code_1.isOwnProperty)(gen,propsSchema,key)}else if(props.length){definedProp=(0,codegen_1.or)(...props.map((p=>(0,codegen_1._)`${key} === ${p}`)))}else{definedProp=codegen_1.nil}if(patProps.length){definedProp=(0,codegen_1.or)(definedProp,...patProps.map((p=>(0,codegen_1._)`${(0,code_1.usePattern)(cxt,p)}.test(${key})`)))}return(0,codegen_1.not)(definedProp)}function deleteAdditional(key){gen.code((0,codegen_1._)`delete ${data}[${key}]`)}function additionalPropertyCode(key){if(opts.removeAdditional==="all"||opts.removeAdditional&&schema===false){deleteAdditional(key);return}if(schema===false){cxt.setParams({additionalProperty:key});cxt.error();if(!allErrors)gen.break();return}if(typeof schema=="object"&&!(0,util_1.alwaysValidSchema)(it,schema)){const valid=gen.name("valid");if(opts.removeAdditional==="failing"){applyAdditionalSchema(key,valid,false);gen.if((0,codegen_1.not)(valid),(()=>{cxt.reset();deleteAdditional(key)}))}else{applyAdditionalSchema(key,valid);if(!allErrors)gen.if((0,codegen_1.not)(valid),(()=>gen.break()))}}}function applyAdditionalSchema(key,valid,errors){const subschema={keyword:"additionalProperties",dataProp:key,dataPropType:util_1.Type.Str};if(errors===false){Object.assign(subschema,{compositeRule:true,createErrors:false,allErrors:false})}cxt.subschema(subschema,valid)}}};exports.default=def},{"../../compile/codegen":80,"../../compile/names":84,"../../compile/util":88,"../code":120}],105:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const util_1=require("../../compile/util");const def={keyword:"allOf",schemaType:"array",code(cxt){const{gen:gen,schema:schema,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");const valid=gen.name("valid");schema.forEach(((sch,i)=>{if((0,util_1.alwaysValidSchema)(it,sch))return;const schCxt=cxt.subschema({keyword:"allOf",schemaProp:i},valid);cxt.ok(valid);cxt.mergeEvaluated(schCxt)}))}};exports.default=def},{"../../compile/util":88}],106:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const def={keyword:"anyOf",schemaType:"array",trackErrors:true,code:code_1.validateUnion,error:{message:"must match a schema in anyOf"}};exports.default=def},{"../code":120}],107:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const error={message:({params:{min:min,max:max}})=>max===undefined?(0,codegen_1.str)`must contain at least ${min} valid item(s)`:(0,codegen_1.str)`must contain at least ${min} and no more than ${max} valid item(s)`,params:({params:{min:min,max:max}})=>max===undefined?(0,codegen_1._)`{minContains: ${min}}`:(0,codegen_1._)`{minContains: ${min}, maxContains: ${max}}`};const def={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:true,error:error,code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,it:it}=cxt;let min;let max;const{minContains:minContains,maxContains:maxContains}=parentSchema;if(it.opts.next){min=minContains===undefined?1:minContains;max=maxContains}else{min=1}const len=gen.const("len",(0,codegen_1._)`${data}.length`);cxt.setParams({min:min,max:max});if(max===undefined&&min===0){(0,util_1.checkStrictMode)(it,`"minContains" == 0 without "maxContains": "contains" keyword ignored`);return}if(max!==undefined&&min>max){(0,util_1.checkStrictMode)(it,`"minContains" > "maxContains" is always invalid`);cxt.fail();return}if((0,util_1.alwaysValidSchema)(it,schema)){let cond=(0,codegen_1._)`${len} >= ${min}`;if(max!==undefined)cond=(0,codegen_1._)`${cond} && ${len} <= ${max}`;cxt.pass(cond);return}it.items=true;const valid=gen.name("valid");if(max===undefined&&min===1){validateItems(valid,(()=>gen.if(valid,(()=>gen.break()))))}else if(min===0){gen.let(valid,true);if(max!==undefined)gen.if((0,codegen_1._)`${data}.length > 0`,validateItemsWithCount)}else{gen.let(valid,false);validateItemsWithCount()}cxt.result(valid,(()=>cxt.reset()));function validateItemsWithCount(){const schValid=gen.name("_valid");const count=gen.let("count",0);validateItems(schValid,(()=>gen.if(schValid,(()=>checkLimits(count)))))}function validateItems(_valid,block){gen.forRange("i",0,len,(i=>{cxt.subschema({keyword:"contains",dataProp:i,dataPropType:util_1.Type.Num,compositeRule:true},_valid);block()}))}function checkLimits(count){gen.code((0,codegen_1._)`${count}++`);if(max===undefined){gen.if((0,codegen_1._)`${count} >= ${min}`,(()=>gen.assign(valid,true).break()))}else{gen.if((0,codegen_1._)`${count} > ${max}`,(()=>gen.assign(valid,false).break()));if(min===1)gen.assign(valid,true);else gen.if((0,codegen_1._)`${count} >= ${min}`,(()=>gen.assign(valid,true)))}}}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88}],108:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateSchemaDeps=exports.validatePropertyDeps=exports.error=void 0;const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const code_1=require("../code");exports.error={message:({params:{property:property,depsCount:depsCount,deps:deps}})=>{const property_ies=depsCount===1?"property":"properties";return(0,codegen_1.str)`must have ${property_ies} ${deps} when property ${property} is present`},params:({params:{property:property,depsCount:depsCount,deps:deps,missingProperty:missingProperty}})=>(0,codegen_1._)`{property: ${property},
    missingProperty: ${missingProperty},
    depsCount: ${depsCount},
    deps: ${deps}}`};const def={keyword:"dependencies",type:"object",schemaType:"object",error:exports.error,code(cxt){const[propDeps,schDeps]=splitDependencies(cxt);validatePropertyDeps(cxt,propDeps);validateSchemaDeps(cxt,schDeps)}};function splitDependencies({schema:schema}){const propertyDeps={};const schemaDeps={};for(const key in schema){if(key==="__proto__")continue;const deps=Array.isArray(schema[key])?propertyDeps:schemaDeps;deps[key]=schema[key]}return[propertyDeps,schemaDeps]}function validatePropertyDeps(cxt,propertyDeps=cxt.schema){const{gen:gen,data:data,it:it}=cxt;if(Object.keys(propertyDeps).length===0)return;const missing=gen.let("missing");for(const prop in propertyDeps){const deps=propertyDeps[prop];if(deps.length===0)continue;const hasProperty=(0,code_1.propertyInData)(gen,data,prop,it.opts.ownProperties);cxt.setParams({property:prop,depsCount:deps.length,deps:deps.join(", ")});if(it.allErrors){gen.if(hasProperty,(()=>{for(const depProp of deps){(0,code_1.checkReportMissingProp)(cxt,depProp)}}))}else{gen.if((0,codegen_1._)`${hasProperty} && (${(0,code_1.checkMissingProp)(cxt,deps,missing)})`);(0,code_1.reportMissingProp)(cxt,missing);gen.else()}}}exports.validatePropertyDeps=validatePropertyDeps;function validateSchemaDeps(cxt,schemaDeps=cxt.schema){const{gen:gen,data:data,keyword:keyword,it:it}=cxt;const valid=gen.name("valid");for(const prop in schemaDeps){if((0,util_1.alwaysValidSchema)(it,schemaDeps[prop]))continue;gen.if((0,code_1.propertyInData)(gen,data,prop,it.opts.ownProperties),(()=>{const schCxt=cxt.subschema({keyword:keyword,schemaProp:prop},valid);cxt.mergeValidEvaluated(schCxt,valid)}),(()=>gen.var(valid,true)));cxt.ok(valid)}}exports.validateSchemaDeps=validateSchemaDeps;exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../code":120}],109:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const error={message:({params:params})=>(0,codegen_1.str)`must match "${params.ifClause}" schema`,params:({params:params})=>(0,codegen_1._)`{failingKeyword: ${params.ifClause}}`};const def={keyword:"if",schemaType:["object","boolean"],trackErrors:true,error:error,code(cxt){const{gen:gen,parentSchema:parentSchema,it:it}=cxt;if(parentSchema.then===undefined&&parentSchema.else===undefined){(0,util_1.checkStrictMode)(it,'"if" without "then" and "else" is ignored')}const hasThen=hasSchema(it,"then");const hasElse=hasSchema(it,"else");if(!hasThen&&!hasElse)return;const valid=gen.let("valid",true);const schValid=gen.name("_valid");validateIf();cxt.reset();if(hasThen&&hasElse){const ifClause=gen.let("ifClause");cxt.setParams({ifClause:ifClause});gen.if(schValid,validateClause("then",ifClause),validateClause("else",ifClause))}else if(hasThen){gen.if(schValid,validateClause("then"))}else{gen.if((0,codegen_1.not)(schValid),validateClause("else"))}cxt.pass(valid,(()=>cxt.error(true)));function validateIf(){const schCxt=cxt.subschema({keyword:"if",compositeRule:true,createErrors:false,allErrors:false},schValid);cxt.mergeEvaluated(schCxt)}function validateClause(keyword,ifClause){return()=>{const schCxt=cxt.subschema({keyword:keyword},schValid);gen.assign(valid,schValid);cxt.mergeValidEvaluated(schCxt,valid);if(ifClause)gen.assign(ifClause,(0,codegen_1._)`${keyword}`);else cxt.setParams({ifClause:keyword})}}}};function hasSchema(it,keyword){const schema=it.schema[keyword];return schema!==undefined&&!(0,util_1.alwaysValidSchema)(it,schema)}exports.default=def},{"../../compile/codegen":80,"../../compile/util":88}],110:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const additionalItems_1=require("./additionalItems");const prefixItems_1=require("./prefixItems");const items_1=require("./items");const items2020_1=require("./items2020");const contains_1=require("./contains");const dependencies_1=require("./dependencies");const propertyNames_1=require("./propertyNames");const additionalProperties_1=require("./additionalProperties");const properties_1=require("./properties");const patternProperties_1=require("./patternProperties");const not_1=require("./not");const anyOf_1=require("./anyOf");const oneOf_1=require("./oneOf");const allOf_1=require("./allOf");const if_1=require("./if");const thenElse_1=require("./thenElse");function getApplicator(draft2020=false){const applicator=[not_1.default,anyOf_1.default,oneOf_1.default,allOf_1.default,if_1.default,thenElse_1.default,propertyNames_1.default,additionalProperties_1.default,dependencies_1.default,properties_1.default,patternProperties_1.default];if(draft2020)applicator.push(prefixItems_1.default,items2020_1.default);else applicator.push(additionalItems_1.default,items_1.default);applicator.push(contains_1.default);return applicator}exports.default=getApplicator},{"./additionalItems":103,"./additionalProperties":104,"./allOf":105,"./anyOf":106,"./contains":107,"./dependencies":108,"./if":109,"./items":111,"./items2020":112,"./not":113,"./oneOf":114,"./patternProperties":115,"./prefixItems":116,"./properties":117,"./propertyNames":118,"./thenElse":119}],111:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateTuple=void 0;const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const code_1=require("../code");const def={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(cxt){const{schema:schema,it:it}=cxt;if(Array.isArray(schema))return validateTuple(cxt,"additionalItems",schema);it.items=true;if((0,util_1.alwaysValidSchema)(it,schema))return;cxt.ok((0,code_1.validateArray)(cxt))}};function validateTuple(cxt,extraItems,schArr=cxt.schema){const{gen:gen,parentSchema:parentSchema,data:data,keyword:keyword,it:it}=cxt;checkStrictTuple(parentSchema);if(it.opts.unevaluated&&schArr.length&&it.items!==true){it.items=util_1.mergeEvaluated.items(gen,schArr.length,it.items)}const valid=gen.name("valid");const len=gen.const("len",(0,codegen_1._)`${data}.length`);schArr.forEach(((sch,i)=>{if((0,util_1.alwaysValidSchema)(it,sch))return;gen.if((0,codegen_1._)`${len} > ${i}`,(()=>cxt.subschema({keyword:keyword,schemaProp:i,dataProp:i},valid)));cxt.ok(valid)}));function checkStrictTuple(sch){const{opts:opts,errSchemaPath:errSchemaPath}=it;const l=schArr.length;const fullTuple=l===sch.minItems&&(l===sch.maxItems||sch[extraItems]===false);if(opts.strictTuples&&!fullTuple){const msg=`"${keyword}" is ${l}-tuple, but minItems or maxItems/${extraItems} are not specified or different at path "${errSchemaPath}"`;(0,util_1.checkStrictMode)(it,msg,opts.strictTuples)}}}exports.validateTuple=validateTuple;exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../code":120}],112:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const code_1=require("../code");const additionalItems_1=require("./additionalItems");const error={message:({params:{len:len}})=>(0,codegen_1.str)`must NOT have more than ${len} items`,params:({params:{len:len}})=>(0,codegen_1._)`{limit: ${len}}`};const def={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:error,code(cxt){const{schema:schema,parentSchema:parentSchema,it:it}=cxt;const{prefixItems:prefixItems}=parentSchema;it.items=true;if((0,util_1.alwaysValidSchema)(it,schema))return;if(prefixItems)(0,additionalItems_1.validateAdditionalItems)(cxt,prefixItems);else cxt.ok((0,code_1.validateArray)(cxt))}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../code":120,"./additionalItems":103}],113:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const util_1=require("../../compile/util");const def={keyword:"not",schemaType:["object","boolean"],trackErrors:true,code(cxt){const{gen:gen,schema:schema,it:it}=cxt;if((0,util_1.alwaysValidSchema)(it,schema)){cxt.fail();return}const valid=gen.name("valid");cxt.subschema({keyword:"not",compositeRule:true,createErrors:false,allErrors:false},valid);cxt.failResult(valid,(()=>cxt.reset()),(()=>cxt.error()))},error:{message:"must NOT be valid"}};exports.default=def},{"../../compile/util":88}],114:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const error={message:"must match exactly one schema in oneOf",params:({params:params})=>(0,codegen_1._)`{passingSchemas: ${params.passing}}`};const def={keyword:"oneOf",schemaType:"array",trackErrors:true,error:error,code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");if(it.opts.discriminator&&parentSchema.discriminator)return;const schArr=schema;const valid=gen.let("valid",false);const passing=gen.let("passing",null);const schValid=gen.name("_valid");cxt.setParams({passing:passing});gen.block(validateOneOf);cxt.result(valid,(()=>cxt.reset()),(()=>cxt.error(true)));function validateOneOf(){schArr.forEach(((sch,i)=>{let schCxt;if((0,util_1.alwaysValidSchema)(it,sch)){gen.var(schValid,true)}else{schCxt=cxt.subschema({keyword:"oneOf",schemaProp:i,compositeRule:true},schValid)}if(i>0){gen.if((0,codegen_1._)`${schValid} && ${valid}`).assign(valid,false).assign(passing,(0,codegen_1._)`[${passing}, ${i}]`).else()}gen.if(schValid,(()=>{gen.assign(valid,true);gen.assign(passing,i);if(schCxt)cxt.mergeEvaluated(schCxt,codegen_1.Name)}))}))}}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88}],115:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const util_2=require("../../compile/util");const def={keyword:"patternProperties",type:"object",schemaType:"object",code(cxt){const{gen:gen,schema:schema,data:data,parentSchema:parentSchema,it:it}=cxt;const{opts:opts}=it;const patterns=(0,code_1.allSchemaProperties)(schema);const alwaysValidPatterns=patterns.filter((p=>(0,util_1.alwaysValidSchema)(it,schema[p])));if(patterns.length===0||alwaysValidPatterns.length===patterns.length&&(!it.opts.unevaluated||it.props===true)){return}const checkProperties=opts.strictSchema&&!opts.allowMatchingProperties&&parentSchema.properties;const valid=gen.name("valid");if(it.props!==true&&!(it.props instanceof codegen_1.Name)){it.props=(0,util_2.evaluatedPropsToName)(gen,it.props)}const{props:props}=it;validatePatternProperties();function validatePatternProperties(){for(const pat of patterns){if(checkProperties)checkMatchingProperties(pat);if(it.allErrors){validateProperties(pat)}else{gen.var(valid,true);validateProperties(pat);gen.if(valid)}}}function checkMatchingProperties(pat){for(const prop in checkProperties){if(new RegExp(pat).test(prop)){(0,util_1.checkStrictMode)(it,`property ${prop} matches pattern ${pat} (use allowMatchingProperties)`)}}}function validateProperties(pat){gen.forIn("key",data,(key=>{gen.if((0,codegen_1._)`${(0,code_1.usePattern)(cxt,pat)}.test(${key})`,(()=>{const alwaysValid=alwaysValidPatterns.includes(pat);if(!alwaysValid){cxt.subschema({keyword:"patternProperties",schemaProp:pat,dataProp:key,dataPropType:util_2.Type.Str},valid)}if(it.opts.unevaluated&&props!==true){gen.assign((0,codegen_1._)`${props}[${key}]`,true)}else if(!alwaysValid&&!it.allErrors){gen.if((0,codegen_1.not)(valid),(()=>gen.break()))}}))}))}}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../code":120}],116:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const items_1=require("./items");const def={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:cxt=>(0,items_1.validateTuple)(cxt,"items")};exports.default=def},{"./items":111}],117:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const validate_1=require("../../compile/validate");const code_1=require("../code");const util_1=require("../../compile/util");const additionalProperties_1=require("./additionalProperties");const def={keyword:"properties",type:"object",schemaType:"object",code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,it:it}=cxt;if(it.opts.removeAdditional==="all"&&parentSchema.additionalProperties===undefined){additionalProperties_1.default.code(new validate_1.KeywordCxt(it,additionalProperties_1.default,"additionalProperties"))}const allProps=(0,code_1.allSchemaProperties)(schema);for(const prop of allProps){it.definedProperties.add(prop)}if(it.opts.unevaluated&&allProps.length&&it.props!==true){it.props=util_1.mergeEvaluated.props(gen,(0,util_1.toHash)(allProps),it.props)}const properties=allProps.filter((p=>!(0,util_1.alwaysValidSchema)(it,schema[p])));if(properties.length===0)return;const valid=gen.name("valid");for(const prop of properties){if(hasDefault(prop)){applyPropertySchema(prop)}else{gen.if((0,code_1.propertyInData)(gen,data,prop,it.opts.ownProperties));applyPropertySchema(prop);if(!it.allErrors)gen.else().var(valid,true);gen.endIf()}cxt.it.definedProperties.add(prop);cxt.ok(valid)}function hasDefault(prop){return it.opts.useDefaults&&!it.compositeRule&&schema[prop].default!==undefined}function applyPropertySchema(prop){cxt.subschema({keyword:"properties",schemaProp:prop,dataProp:prop},valid)}}};exports.default=def},{"../../compile/util":88,"../../compile/validate":93,"../code":120,"./additionalProperties":104}],118:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const error={message:"property name must be valid",params:({params:params})=>(0,codegen_1._)`{propertyName: ${params.propertyName}}`};const def={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:error,code(cxt){const{gen:gen,schema:schema,data:data,it:it}=cxt;if((0,util_1.alwaysValidSchema)(it,schema))return;const valid=gen.name("valid");gen.forIn("key",data,(key=>{cxt.setParams({propertyName:key});cxt.subschema({keyword:"propertyNames",data:key,dataTypes:["string"],propertyName:key,compositeRule:true},valid);gen.if((0,codegen_1.not)(valid),(()=>{cxt.error(true);if(!it.allErrors)gen.break()}))}));cxt.ok(valid)}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88}],119:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const util_1=require("../../compile/util");const def={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:keyword,parentSchema:parentSchema,it:it}){if(parentSchema.if===undefined)(0,util_1.checkStrictMode)(it,`"${keyword}" without "if" is ignored`)}};exports.default=def},{"../../compile/util":88}],120:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateUnion=exports.validateArray=exports.usePattern=exports.callValidateCode=exports.schemaProperties=exports.allSchemaProperties=exports.noPropertyInData=exports.propertyInData=exports.isOwnProperty=exports.hasPropFunc=exports.reportMissingProp=exports.checkMissingProp=exports.checkReportMissingProp=void 0;const codegen_1=require("../compile/codegen");const util_1=require("../compile/util");const names_1=require("../compile/names");const util_2=require("../compile/util");function checkReportMissingProp(cxt,prop){const{gen:gen,data:data,it:it}=cxt;gen.if(noPropertyInData(gen,data,prop,it.opts.ownProperties),(()=>{cxt.setParams({missingProperty:(0,codegen_1._)`${prop}`},true);cxt.error()}))}exports.checkReportMissingProp=checkReportMissingProp;function checkMissingProp({gen:gen,data:data,it:{opts:opts}},properties,missing){return(0,codegen_1.or)(...properties.map((prop=>(0,codegen_1.and)(noPropertyInData(gen,data,prop,opts.ownProperties),(0,codegen_1._)`${missing} = ${prop}`))))}exports.checkMissingProp=checkMissingProp;function reportMissingProp(cxt,missing){cxt.setParams({missingProperty:missing},true);cxt.error()}exports.reportMissingProp=reportMissingProp;function hasPropFunc(gen){return gen.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,codegen_1._)`Object.prototype.hasOwnProperty`})}exports.hasPropFunc=hasPropFunc;function isOwnProperty(gen,data,property){return(0,codegen_1._)`${hasPropFunc(gen)}.call(${data}, ${property})`}exports.isOwnProperty=isOwnProperty;function propertyInData(gen,data,property,ownProperties){const cond=(0,codegen_1._)`${data}${(0,codegen_1.getProperty)(property)} !== undefined`;return ownProperties?(0,codegen_1._)`${cond} && ${isOwnProperty(gen,data,property)}`:cond}exports.propertyInData=propertyInData;function noPropertyInData(gen,data,property,ownProperties){const cond=(0,codegen_1._)`${data}${(0,codegen_1.getProperty)(property)} === undefined`;return ownProperties?(0,codegen_1.or)(cond,(0,codegen_1.not)(isOwnProperty(gen,data,property))):cond}exports.noPropertyInData=noPropertyInData;function allSchemaProperties(schemaMap){return schemaMap?Object.keys(schemaMap).filter((p=>p!=="__proto__")):[]}exports.allSchemaProperties=allSchemaProperties;function schemaProperties(it,schemaMap){return allSchemaProperties(schemaMap).filter((p=>!(0,util_1.alwaysValidSchema)(it,schemaMap[p])))}exports.schemaProperties=schemaProperties;function callValidateCode({schemaCode:schemaCode,data:data,it:{gen:gen,topSchemaRef:topSchemaRef,schemaPath:schemaPath,errorPath:errorPath},it:it},func,context,passSchema){const dataAndSchema=passSchema?(0,codegen_1._)`${schemaCode}, ${data}, ${topSchemaRef}${schemaPath}`:data;const valCxt=[[names_1.default.instancePath,(0,codegen_1.strConcat)(names_1.default.instancePath,errorPath)],[names_1.default.parentData,it.parentData],[names_1.default.parentDataProperty,it.parentDataProperty],[names_1.default.rootData,names_1.default.rootData]];if(it.opts.dynamicRef)valCxt.push([names_1.default.dynamicAnchors,names_1.default.dynamicAnchors]);const args=(0,codegen_1._)`${dataAndSchema}, ${gen.object(...valCxt)}`;return context!==codegen_1.nil?(0,codegen_1._)`${func}.call(${context}, ${args})`:(0,codegen_1._)`${func}(${args})`}exports.callValidateCode=callValidateCode;const newRegExp=(0,codegen_1._)`new RegExp`;function usePattern({gen:gen,it:{opts:opts}},pattern){const u=opts.unicodeRegExp?"u":"";const{regExp:regExp}=opts.code;const rx=regExp(pattern,u);return gen.scopeValue("pattern",{key:rx.toString(),ref:rx,code:(0,codegen_1._)`${regExp.code==="new RegExp"?newRegExp:(0,util_2.useFunc)(gen,regExp)}(${pattern}, ${u})`})}exports.usePattern=usePattern;function validateArray(cxt){const{gen:gen,data:data,keyword:keyword,it:it}=cxt;const valid=gen.name("valid");if(it.allErrors){const validArr=gen.let("valid",true);validateItems((()=>gen.assign(validArr,false)));return validArr}gen.var(valid,true);validateItems((()=>gen.break()));return valid;function validateItems(notValid){const len=gen.const("len",(0,codegen_1._)`${data}.length`);gen.forRange("i",0,len,(i=>{cxt.subschema({keyword:keyword,dataProp:i,dataPropType:util_1.Type.Num},valid);gen.if((0,codegen_1.not)(valid),notValid)}))}}exports.validateArray=validateArray;function validateUnion(cxt){const{gen:gen,schema:schema,keyword:keyword,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");const alwaysValid=schema.some((sch=>(0,util_1.alwaysValidSchema)(it,sch)));if(alwaysValid&&!it.opts.unevaluated)return;const valid=gen.let("valid",false);const schValid=gen.name("_valid");gen.block((()=>schema.forEach(((_sch,i)=>{const schCxt=cxt.subschema({keyword:keyword,schemaProp:i,compositeRule:true},schValid);gen.assign(valid,(0,codegen_1._)`${valid} || ${schValid}`);const merged=cxt.mergeValidEvaluated(schCxt,schValid);if(!merged)gen.if((0,codegen_1.not)(valid))}))));cxt.result(valid,(()=>cxt.reset()),(()=>cxt.error(true)))}exports.validateUnion=validateUnion},{"../compile/codegen":80,"../compile/names":84,"../compile/util":88}],121:[function(require,module,exports){arguments[4][50][0].apply(exports,arguments)},{dup:50}],122:[function(require,module,exports){arguments[4][51][0].apply(exports,arguments)},{"./id":121,"./ref":123,dup:51}],123:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.callRef=exports.getValidate=void 0;const ref_error_1=require("../../compile/ref_error");const code_1=require("../code");const codegen_1=require("../../compile/codegen");const names_1=require("../../compile/names");const compile_1=require("../../compile");const util_1=require("../../compile/util");const def={keyword:"$ref",schemaType:"string",code(cxt){const{gen:gen,schema:$ref,it:it}=cxt;const{baseId:baseId,schemaEnv:env,validateName:validateName,opts:opts,self:self}=it;const{root:root}=env;if(($ref==="#"||$ref==="#/")&&baseId===root.baseId)return callRootRef();const schOrEnv=compile_1.resolveRef.call(self,root,baseId,$ref);if(schOrEnv===undefined)throw new ref_error_1.default(it.opts.uriResolver,baseId,$ref);if(schOrEnv instanceof compile_1.SchemaEnv)return callValidate(schOrEnv);return inlineRefSchema(schOrEnv);function callRootRef(){if(env===root)return callRef(cxt,validateName,env,env.$async);const rootName=gen.scopeValue("root",{ref:root});return callRef(cxt,(0,codegen_1._)`${rootName}.validate`,root,root.$async)}function callValidate(sch){const v=getValidate(cxt,sch);callRef(cxt,v,sch,sch.$async)}function inlineRefSchema(sch){const schName=gen.scopeValue("schema",opts.code.source===true?{ref:sch,code:(0,codegen_1.stringify)(sch)}:{ref:sch});const valid=gen.name("valid");const schCxt=cxt.subschema({schema:sch,dataTypes:[],schemaPath:codegen_1.nil,topSchemaRef:schName,errSchemaPath:$ref},valid);cxt.mergeEvaluated(schCxt);cxt.ok(valid)}}};function getValidate(cxt,sch){const{gen:gen}=cxt;return sch.validate?gen.scopeValue("validate",{ref:sch.validate}):(0,codegen_1._)`${gen.scopeValue("wrapper",{ref:sch})}.validate`}exports.getValidate=getValidate;function callRef(cxt,v,sch,$async){const{gen:gen,it:it}=cxt;const{allErrors:allErrors,schemaEnv:env,opts:opts}=it;const passCxt=opts.passContext?names_1.default.this:codegen_1.nil;if($async)callAsyncRef();else callSyncRef();function callAsyncRef(){if(!env.$async)throw new Error("async schema referenced by sync schema");const valid=gen.let("valid");gen.try((()=>{gen.code((0,codegen_1._)`await ${(0,code_1.callValidateCode)(cxt,v,passCxt)}`);addEvaluatedFrom(v);if(!allErrors)gen.assign(valid,true)}),(e=>{gen.if((0,codegen_1._)`!(${e} instanceof ${it.ValidationError})`,(()=>gen.throw(e)));addErrorsFrom(e);if(!allErrors)gen.assign(valid,false)}));cxt.ok(valid)}function callSyncRef(){cxt.result((0,code_1.callValidateCode)(cxt,v,passCxt),(()=>addEvaluatedFrom(v)),(()=>addErrorsFrom(v)))}function addErrorsFrom(source){const errs=(0,codegen_1._)`${source}.errors`;gen.assign(names_1.default.vErrors,(0,codegen_1._)`${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`);gen.assign(names_1.default.errors,(0,codegen_1._)`${names_1.default.vErrors}.length`)}function addEvaluatedFrom(source){var _a;if(!it.opts.unevaluated)return;const schEvaluated=(_a=sch===null||sch===void 0?void 0:sch.validate)===null||_a===void 0?void 0:_a.evaluated;if(it.props!==true){if(schEvaluated&&!schEvaluated.dynamicProps){if(schEvaluated.props!==undefined){it.props=util_1.mergeEvaluated.props(gen,schEvaluated.props,it.props)}}else{const props=gen.var("props",(0,codegen_1._)`${source}.evaluated.props`);it.props=util_1.mergeEvaluated.props(gen,props,it.props,codegen_1.Name)}}if(it.items!==true){if(schEvaluated&&!schEvaluated.dynamicItems){if(schEvaluated.items!==undefined){it.items=util_1.mergeEvaluated.items(gen,schEvaluated.items,it.items)}}else{const items=gen.var("items",(0,codegen_1._)`${source}.evaluated.items`);it.items=util_1.mergeEvaluated.items(gen,items,it.items,codegen_1.Name)}}}}exports.callRef=callRef;exports.default=def},{"../../compile":83,"../../compile/codegen":80,"../../compile/names":84,"../../compile/ref_error":85,"../../compile/util":88,"../code":120}],124:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const types_1=require("../discriminator/types");const compile_1=require("../../compile");const util_1=require("../../compile/util");const error={message:({params:{discrError:discrError,tagName:tagName}})=>discrError===types_1.DiscrError.Tag?`tag "${tagName}" must be string`:`value of tag "${tagName}" must be in oneOf`,params:({params:{discrError:discrError,tag:tag,tagName:tagName}})=>(0,codegen_1._)`{error: ${discrError}, tag: ${tagName}, tagValue: ${tag}}`};const def={keyword:"discriminator",type:"object",schemaType:"object",error:error,code(cxt){const{gen:gen,data:data,schema:schema,parentSchema:parentSchema,it:it}=cxt;const{oneOf:oneOf}=parentSchema;if(!it.opts.discriminator){throw new Error("discriminator: requires discriminator option")}const tagName=schema.propertyName;if(typeof tagName!="string")throw new Error("discriminator: requires propertyName");if(schema.mapping)throw new Error("discriminator: mapping is not supported");if(!oneOf)throw new Error("discriminator: requires oneOf keyword");const valid=gen.let("valid",false);const tag=gen.const("tag",(0,codegen_1._)`${data}${(0,codegen_1.getProperty)(tagName)}`);gen.if((0,codegen_1._)`typeof ${tag} == "string"`,(()=>validateMapping()),(()=>cxt.error(false,{discrError:types_1.DiscrError.Tag,tag:tag,tagName:tagName})));cxt.ok(valid);function validateMapping(){const mapping=getMapping();gen.if(false);for(const tagValue in mapping){gen.elseIf((0,codegen_1._)`${tag} === ${tagValue}`);gen.assign(valid,applyTagSchema(mapping[tagValue]))}gen.else();cxt.error(false,{discrError:types_1.DiscrError.Mapping,tag:tag,tagName:tagName});gen.endIf()}function applyTagSchema(schemaProp){const _valid=gen.name("valid");const schCxt=cxt.subschema({keyword:"oneOf",schemaProp:schemaProp},_valid);cxt.mergeEvaluated(schCxt,codegen_1.Name);return _valid}function getMapping(){var _a;const oneOfMapping={};const topRequired=hasRequired(parentSchema);let tagRequired=true;for(let i=0;i<oneOf.length;i++){let sch=oneOf[i];if((sch===null||sch===void 0?void 0:sch.$ref)&&!(0,util_1.schemaHasRulesButRef)(sch,it.self.RULES)){sch=compile_1.resolveRef.call(it.self,it.schemaEnv.root,it.baseId,sch===null||sch===void 0?void 0:sch.$ref);if(sch instanceof compile_1.SchemaEnv)sch=sch.schema}const propSch=(_a=sch===null||sch===void 0?void 0:sch.properties)===null||_a===void 0?void 0:_a[tagName];if(typeof propSch!="object"){throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${tagName}"`)}tagRequired=tagRequired&&(topRequired||hasRequired(sch));addMappings(propSch,i)}if(!tagRequired)throw new Error(`discriminator: "${tagName}" must be required`);return oneOfMapping;function hasRequired({required:required}){return Array.isArray(required)&&required.includes(tagName)}function addMappings(sch,i){if(sch.const){addMapping(sch.const,i)}else if(sch.enum){for(const tagValue of sch.enum){addMapping(tagValue,i)}}else{throw new Error(`discriminator: "properties/${tagName}" must have "const" or "enum"`)}}function addMapping(tagValue,i){if(typeof tagValue!="string"||tagValue in oneOfMapping){throw new Error(`discriminator: "${tagName}" values must be unique strings`)}oneOfMapping[tagValue]=i}}}};exports.default=def},{"../../compile":83,"../../compile/codegen":80,"../../compile/util":88,"../discriminator/types":125}],125:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DiscrError=void 0;var DiscrError;(function(DiscrError){DiscrError["Tag"]="tag";DiscrError["Mapping"]="mapping"})(DiscrError=exports.DiscrError||(exports.DiscrError={}))},{}],126:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const core_1=require("./core");const validation_1=require("./validation");const applicator_1=require("./applicator");const format_1=require("./format");const metadata_1=require("./metadata");const draft7Vocabularies=[core_1.default,validation_1.default,(0,applicator_1.default)(),format_1.default,metadata_1.metadataVocabulary,metadata_1.contentVocabulary];exports.default=draft7Vocabularies},{"./applicator":110,"./core":122,"./format":128,"./metadata":129,"./validation":132}],127:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const error={message:({schemaCode:schemaCode})=>(0,codegen_1.str)`must match format "${schemaCode}"`,params:({schemaCode:schemaCode})=>(0,codegen_1._)`{format: ${schemaCode}}`};const def={keyword:"format",type:["number","string"],schemaType:"string",$data:true,error:error,code(cxt,ruleType){const{gen:gen,data:data,$data:$data,schema:schema,schemaCode:schemaCode,it:it}=cxt;const{opts:opts,errSchemaPath:errSchemaPath,schemaEnv:schemaEnv,self:self}=it;if(!opts.validateFormats)return;if($data)validate$DataFormat();else validateFormat();function validate$DataFormat(){const fmts=gen.scopeValue("formats",{ref:self.formats,code:opts.code.formats});const fDef=gen.const("fDef",(0,codegen_1._)`${fmts}[${schemaCode}]`);const fType=gen.let("fType");const format=gen.let("format");gen.if((0,codegen_1._)`typeof ${fDef} == "object" && !(${fDef} instanceof RegExp)`,(()=>gen.assign(fType,(0,codegen_1._)`${fDef}.type || "string"`).assign(format,(0,codegen_1._)`${fDef}.validate`)),(()=>gen.assign(fType,(0,codegen_1._)`"string"`).assign(format,fDef)));cxt.fail$data((0,codegen_1.or)(unknownFmt(),invalidFmt()));function unknownFmt(){if(opts.strictSchema===false)return codegen_1.nil;return(0,codegen_1._)`${schemaCode} && !${format}`}function invalidFmt(){const callFormat=schemaEnv.$async?(0,codegen_1._)`(${fDef}.async ? await ${format}(${data}) : ${format}(${data}))`:(0,codegen_1._)`${format}(${data})`;const validData=(0,codegen_1._)`(typeof ${format} == "function" ? ${callFormat} : ${format}.test(${data}))`;return(0,codegen_1._)`${format} && ${format} !== true && ${fType} === ${ruleType} && !${validData}`}}function validateFormat(){const formatDef=self.formats[schema];if(!formatDef){unknownFormat();return}if(formatDef===true)return;const[fmtType,format,fmtRef]=getFormat(formatDef);if(fmtType===ruleType)cxt.pass(validCondition());function unknownFormat(){if(opts.strictSchema===false){self.logger.warn(unknownMsg());return}throw new Error(unknownMsg());function unknownMsg(){return`unknown format "${schema}" ignored in schema at path "${errSchemaPath}"`}}function getFormat(fmtDef){const code=fmtDef instanceof RegExp?(0,codegen_1.regexpCode)(fmtDef):opts.code.formats?(0,codegen_1._)`${opts.code.formats}${(0,codegen_1.getProperty)(schema)}`:undefined;const fmt=gen.scopeValue("formats",{key:schema,ref:fmtDef,code:code});if(typeof fmtDef=="object"&&!(fmtDef instanceof RegExp)){return[fmtDef.type||"string",fmtDef.validate,(0,codegen_1._)`${fmt}.validate`]}return["string",fmtDef,fmt]}function validCondition(){if(typeof formatDef=="object"&&!(formatDef instanceof RegExp)&&formatDef.async){if(!schemaEnv.$async)throw new Error("async format in sync schema");return(0,codegen_1._)`await ${fmtRef}(${data})`}return typeof format=="function"?(0,codegen_1._)`${fmtRef}(${data})`:(0,codegen_1._)`${fmtRef}.test(${data})`}}}};exports.default=def},{"../../compile/codegen":80}],128:[function(require,module,exports){arguments[4][55][0].apply(exports,arguments)},{"./format":127,dup:55}],129:[function(require,module,exports){arguments[4][56][0].apply(exports,arguments)},{dup:56}],130:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const equal_1=require("../../runtime/equal");const error={message:"must be equal to constant",params:({schemaCode:schemaCode})=>(0,codegen_1._)`{allowedValue: ${schemaCode}}`};const def={keyword:"const",$data:true,error:error,code(cxt){const{gen:gen,data:data,$data:$data,schemaCode:schemaCode,schema:schema}=cxt;if($data||schema&&typeof schema=="object"){cxt.fail$data((0,codegen_1._)`!${(0,util_1.useFunc)(gen,equal_1.default)}(${data}, ${schemaCode})`)}else{cxt.fail((0,codegen_1._)`${schema} !== ${data}`)}}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../../runtime/equal":99}],131:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const equal_1=require("../../runtime/equal");const error={message:"must be equal to one of the allowed values",params:({schemaCode:schemaCode})=>(0,codegen_1._)`{allowedValues: ${schemaCode}}`};const def={keyword:"enum",schemaType:"array",$data:true,error:error,code(cxt){const{gen:gen,data:data,$data:$data,schema:schema,schemaCode:schemaCode,it:it}=cxt;if(!$data&&schema.length===0)throw new Error("enum must have non-empty array");const useLoop=schema.length>=it.opts.loopEnum;let eql;const getEql=()=>eql!==null&&eql!==void 0?eql:eql=(0,util_1.useFunc)(gen,equal_1.default);let valid;if(useLoop||$data){valid=gen.let("valid");cxt.block$data(valid,loopEnum)}else{if(!Array.isArray(schema))throw new Error("ajv implementation error");const vSchema=gen.const("vSchema",schemaCode);valid=(0,codegen_1.or)(...schema.map(((_x,i)=>equalCode(vSchema,i))))}cxt.pass(valid);function loopEnum(){gen.assign(valid,false);gen.forOf("v",schemaCode,(v=>gen.if((0,codegen_1._)`${getEql()}(${data}, ${v})`,(()=>gen.assign(valid,true).break()))))}function equalCode(vSchema,i){const sch=schema[i];return typeof sch==="object"&&sch!==null?(0,codegen_1._)`${getEql()}(${data}, ${vSchema}[${i}])`:(0,codegen_1._)`${data} === ${sch}`}}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../../runtime/equal":99}],132:[function(require,module,exports){arguments[4][59][0].apply(exports,arguments)},{"./const":130,"./enum":131,"./limitItems":133,"./limitLength":134,"./limitNumber":135,"./limitProperties":136,"./multipleOf":137,"./pattern":138,"./required":139,"./uniqueItems":140,dup:59}],133:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const error={message({keyword:keyword,schemaCode:schemaCode}){const comp=keyword==="maxItems"?"more":"fewer";return(0,codegen_1.str)`must NOT have ${comp} than ${schemaCode} items`},params:({schemaCode:schemaCode})=>(0,codegen_1._)`{limit: ${schemaCode}}`};const def={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:true,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt;const op=keyword==="maxItems"?codegen_1.operators.GT:codegen_1.operators.LT;cxt.fail$data((0,codegen_1._)`${data}.length ${op} ${schemaCode}`)}};exports.default=def},{"../../compile/codegen":80}],134:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const ucs2length_1=require("../../runtime/ucs2length");const error={message({keyword:keyword,schemaCode:schemaCode}){const comp=keyword==="maxLength"?"more":"fewer";return(0,codegen_1.str)`must NOT have ${comp} than ${schemaCode} characters`},params:({schemaCode:schemaCode})=>(0,codegen_1._)`{limit: ${schemaCode}}`};const def={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:true,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode,it:it}=cxt;const op=keyword==="maxLength"?codegen_1.operators.GT:codegen_1.operators.LT;const len=it.opts.unicode===false?(0,codegen_1._)`${data}.length`:(0,codegen_1._)`${(0,util_1.useFunc)(cxt.gen,ucs2length_1.default)}(${data})`;cxt.fail$data((0,codegen_1._)`${len} ${op} ${schemaCode}`)}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../../runtime/ucs2length":100}],135:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const ops=codegen_1.operators;const KWDs={maximum:{okStr:"<=",ok:ops.LTE,fail:ops.GT},minimum:{okStr:">=",ok:ops.GTE,fail:ops.LT},exclusiveMaximum:{okStr:"<",ok:ops.LT,fail:ops.GTE},exclusiveMinimum:{okStr:">",ok:ops.GT,fail:ops.LTE}};const error={message:({keyword:keyword,schemaCode:schemaCode})=>(0,codegen_1.str)`must be ${KWDs[keyword].okStr} ${schemaCode}`,params:({keyword:keyword,schemaCode:schemaCode})=>(0,codegen_1._)`{comparison: ${KWDs[keyword].okStr}, limit: ${schemaCode}}`};const def={keyword:Object.keys(KWDs),type:"number",schemaType:"number",$data:true,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt;cxt.fail$data((0,codegen_1._)`${data} ${KWDs[keyword].fail} ${schemaCode} || isNaN(${data})`)}};exports.default=def},{"../../compile/codegen":80}],136:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const error={message({keyword:keyword,schemaCode:schemaCode}){const comp=keyword==="maxProperties"?"more":"fewer";return(0,codegen_1.str)`must NOT have ${comp} than ${schemaCode} properties`},params:({schemaCode:schemaCode})=>(0,codegen_1._)`{limit: ${schemaCode}}`};const def={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:true,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt;const op=keyword==="maxProperties"?codegen_1.operators.GT:codegen_1.operators.LT;cxt.fail$data((0,codegen_1._)`Object.keys(${data}).length ${op} ${schemaCode}`)}};exports.default=def},{"../../compile/codegen":80}],137:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const codegen_1=require("../../compile/codegen");const error={message:({schemaCode:schemaCode})=>(0,codegen_1.str)`must be multiple of ${schemaCode}`,params:({schemaCode:schemaCode})=>(0,codegen_1._)`{multipleOf: ${schemaCode}}`};const def={keyword:"multipleOf",type:"number",schemaType:"number",$data:true,error:error,code(cxt){const{gen:gen,data:data,schemaCode:schemaCode,it:it}=cxt;const prec=it.opts.multipleOfPrecision;const res=gen.let("res");const invalid=prec?(0,codegen_1._)`Math.abs(Math.round(${res}) - ${res}) > 1e-${prec}`:(0,codegen_1._)`${res} !== parseInt(${res})`;cxt.fail$data((0,codegen_1._)`(${schemaCode} === 0 || (${res} = ${data}/${schemaCode}, ${invalid}))`)}};exports.default=def},{"../../compile/codegen":80}],138:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const codegen_1=require("../../compile/codegen");const error={message:({schemaCode:schemaCode})=>(0,codegen_1.str)`must match pattern "${schemaCode}"`,params:({schemaCode:schemaCode})=>(0,codegen_1._)`{pattern: ${schemaCode}}`};const def={keyword:"pattern",type:"string",schemaType:"string",$data:true,error:error,code(cxt){const{data:data,$data:$data,schema:schema,schemaCode:schemaCode,it:it}=cxt;const u=it.opts.unicodeRegExp?"u":"";const regExp=$data?(0,codegen_1._)`(new RegExp(${schemaCode}, ${u}))`:(0,code_1.usePattern)(cxt,schema);cxt.fail$data((0,codegen_1._)`!${regExp}.test(${data})`)}};exports.default=def},{"../../compile/codegen":80,"../code":120}],139:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const code_1=require("../code");const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const error={message:({params:{missingProperty:missingProperty}})=>(0,codegen_1.str)`must have required property '${missingProperty}'`,params:({params:{missingProperty:missingProperty}})=>(0,codegen_1._)`{missingProperty: ${missingProperty}}`};const def={keyword:"required",type:"object",schemaType:"array",$data:true,error:error,code(cxt){const{gen:gen,schema:schema,schemaCode:schemaCode,data:data,$data:$data,it:it}=cxt;const{opts:opts}=it;if(!$data&&schema.length===0)return;const useLoop=schema.length>=opts.loopRequired;if(it.allErrors)allErrorsMode();else exitOnErrorMode();if(opts.strictRequired){const props=cxt.parentSchema.properties;const{definedProperties:definedProperties}=cxt.it;for(const requiredKey of schema){if((props===null||props===void 0?void 0:props[requiredKey])===undefined&&!definedProperties.has(requiredKey)){const schemaPath=it.schemaEnv.baseId+it.errSchemaPath;const msg=`required property "${requiredKey}" is not defined at "${schemaPath}" (strictRequired)`;(0,util_1.checkStrictMode)(it,msg,it.opts.strictRequired)}}}function allErrorsMode(){if(useLoop||$data){cxt.block$data(codegen_1.nil,loopAllRequired)}else{for(const prop of schema){(0,code_1.checkReportMissingProp)(cxt,prop)}}}function exitOnErrorMode(){const missing=gen.let("missing");if(useLoop||$data){const valid=gen.let("valid",true);cxt.block$data(valid,(()=>loopUntilMissing(missing,valid)));cxt.ok(valid)}else{gen.if((0,code_1.checkMissingProp)(cxt,schema,missing));(0,code_1.reportMissingProp)(cxt,missing);gen.else()}}function loopAllRequired(){gen.forOf("prop",schemaCode,(prop=>{cxt.setParams({missingProperty:prop});gen.if((0,code_1.noPropertyInData)(gen,data,prop,opts.ownProperties),(()=>cxt.error()))}))}function loopUntilMissing(missing,valid){cxt.setParams({missingProperty:missing});gen.forOf(missing,schemaCode,(()=>{gen.assign(valid,(0,code_1.propertyInData)(gen,data,missing,opts.ownProperties));gen.if((0,codegen_1.not)(valid),(()=>{cxt.error();gen.break()}))}),codegen_1.nil)}}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../code":120}],140:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const dataType_1=require("../../compile/validate/dataType");const codegen_1=require("../../compile/codegen");const util_1=require("../../compile/util");const equal_1=require("../../runtime/equal");const error={message:({params:{i:i,j:j}})=>(0,codegen_1.str)`must NOT have duplicate items (items ## ${j} and ${i} are identical)`,params:({params:{i:i,j:j}})=>(0,codegen_1._)`{i: ${i}, j: ${j}}`};const def={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:true,error:error,code(cxt){const{gen:gen,data:data,$data:$data,schema:schema,parentSchema:parentSchema,schemaCode:schemaCode,it:it}=cxt;if(!$data&&!schema)return;const valid=gen.let("valid");const itemTypes=parentSchema.items?(0,dataType_1.getSchemaTypes)(parentSchema.items):[];cxt.block$data(valid,validateUniqueItems,(0,codegen_1._)`${schemaCode} === false`);cxt.ok(valid);function validateUniqueItems(){const i=gen.let("i",(0,codegen_1._)`${data}.length`);const j=gen.let("j");cxt.setParams({i:i,j:j});gen.assign(valid,true);gen.if((0,codegen_1._)`${i} > 1`,(()=>(canOptimize()?loopN:loopN2)(i,j)))}function canOptimize(){return itemTypes.length>0&&!itemTypes.some((t=>t==="object"||t==="array"))}function loopN(i,j){const item=gen.name("item");const wrongType=(0,dataType_1.checkDataTypes)(itemTypes,item,it.opts.strictNumbers,dataType_1.DataType.Wrong);const indices=gen.const("indices",(0,codegen_1._)`{}`);gen.for((0,codegen_1._)`;${i}--;`,(()=>{gen.let(item,(0,codegen_1._)`${data}[${i}]`);gen.if(wrongType,(0,codegen_1._)`continue`);if(itemTypes.length>1)gen.if((0,codegen_1._)`typeof ${item} == "string"`,(0,codegen_1._)`${item} += "_"`);gen.if((0,codegen_1._)`typeof ${indices}[${item}] == "number"`,(()=>{gen.assign(j,(0,codegen_1._)`${indices}[${item}]`);cxt.error();gen.assign(valid,false).break()})).code((0,codegen_1._)`${indices}[${item}] = ${i}`)}))}function loopN2(i,j){const eql=(0,util_1.useFunc)(gen,equal_1.default);const outer=gen.name("outer");gen.label(outer).for((0,codegen_1._)`;${i}--;`,(()=>gen.for((0,codegen_1._)`${j} = ${i}; ${j}--;`,(()=>gen.if((0,codegen_1._)`${eql}(${data}[${i}], ${data}[${j}])`,(()=>{cxt.error();gen.assign(valid,false).break(outer)}))))))}}};exports.default=def},{"../../compile/codegen":80,"../../compile/util":88,"../../compile/validate/dataType":91,"../../runtime/equal":99}],141:[function(require,module,exports){(function(global){(function(){"use strict";var objectAssign=require("object-assign");
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function compare(a,b){if(a===b){return 0}var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y){return-1}if(y<x){return 1}return 0}function isBuffer(b){if(global.Buffer&&typeof global.Buffer.isBuffer==="function"){return global.Buffer.isBuffer(b)}return!!(b!=null&&b._isBuffer)}var util=require("util/");var hasOwn=Object.prototype.hasOwnProperty;var pSlice=Array.prototype.slice;var functionsHaveNames=function(){return function foo(){}.name==="foo"}();function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){if(isBuffer(arrbuf)){return false}if(typeof global.ArrayBuffer!=="function"){return false}if(typeof ArrayBuffer.isView==="function"){return ArrayBuffer.isView(arrbuf)}if(!arrbuf){return false}if(arrbuf instanceof DataView){return true}if(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer){return true}return false}var assert=module.exports=ok;var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(!util.isFunction(func)){return}if(functionsHaveNames){return func.name}var str=func.toString();var match=str.match(regex);return match&&match[1]}assert.AssertionError=function AssertionError(options){this.name="AssertionError";this.actual=options.actual;this.expected=options.expected;this.operator=options.operator;if(options.message){this.message=options.message;this.generatedMessage=false}else{this.message=getMessage(this);this.generatedMessage=true}var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace){Error.captureStackTrace(this,stackStartFunction)}else{var err=new Error;if(err.stack){var out=err.stack;var fn_name=getName(stackStartFunction);var idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}};util.inherits(assert.AssertionError,Error);function truncate(s,n){if(typeof s==="string"){return s.length<n?s:s.slice(0,n)}else{return s}}function inspect(something){if(functionsHaveNames||!util.isFunction(something)){return util.inspect(something)}var rawname=getName(something);var name=rawname?": "+rawname:"";return"[Function"+name+"]"}function getMessage(self){return truncate(inspect(self.actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128)}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}assert.fail=fail;function ok(value,message){if(!value)fail(value,true,message,"==",assert.ok)}assert.ok=ok;assert.equal=function equal(actual,expected,message){if(actual!=expected)fail(actual,expected,message,"==",assert.equal)};assert.notEqual=function notEqual(actual,expected,message){if(actual==expected){fail(actual,expected,message,"!=",assert.notEqual)}};assert.deepEqual=function deepEqual(actual,expected,message){if(!_deepEqual(actual,expected,false)){fail(actual,expected,message,"deepEqual",assert.deepEqual)}};assert.deepStrictEqual=function deepStrictEqual(actual,expected,message){if(!_deepEqual(actual,expected,true)){fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)}};function _deepEqual(actual,expected,strict,memos){if(actual===expected){return true}else if(isBuffer(actual)&&isBuffer(expected)){return compare(actual,expected)===0}else if(util.isDate(actual)&&util.isDate(expected)){return actual.getTime()===expected.getTime()}else if(util.isRegExp(actual)&&util.isRegExp(expected)){return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase}else if((actual===null||typeof actual!=="object")&&(expected===null||typeof expected!=="object")){return strict?actual===expected:actual==expected}else if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array)){return compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer))===0}else if(isBuffer(actual)!==isBuffer(expected)){return false}else{memos=memos||{actual:[],expected:[]};var actualIndex=memos.actual.indexOf(actual);if(actualIndex!==-1){if(actualIndex===memos.expected.indexOf(expected)){return true}}memos.actual.push(actual);memos.expected.push(expected);return objEquiv(actual,expected,strict,memos)}}function isArguments(object){return Object.prototype.toString.call(object)=="[object Arguments]"}function objEquiv(a,b,strict,actualVisitedObjects){if(a===null||a===undefined||b===null||b===undefined)return false;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return false;var aIsArgs=isArguments(a);var bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return false;if(aIsArgs){a=pSlice.call(a);b=pSlice.call(b);return _deepEqual(a,b,strict)}var ka=objectKeys(a);var kb=objectKeys(b);var key,i;if(ka.length!==kb.length)return false;ka.sort();kb.sort();for(i=ka.length-1;i>=0;i--){if(ka[i]!==kb[i])return false}for(i=ka.length-1;i>=0;i--){key=ka[i];if(!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return false}return true}assert.notDeepEqual=function notDeepEqual(actual,expected,message){if(_deepEqual(actual,expected,false)){fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)}};assert.notDeepStrictEqual=notDeepStrictEqual;function notDeepStrictEqual(actual,expected,message){if(_deepEqual(actual,expected,true)){fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)}}assert.strictEqual=function strictEqual(actual,expected,message){if(actual!==expected){fail(actual,expected,message,"===",assert.strictEqual)}};assert.notStrictEqual=function notStrictEqual(actual,expected,message){if(actual===expected){fail(actual,expected,message,"!==",assert.notStrictEqual)}};function expectedException(actual,expected){if(!actual||!expected){return false}if(Object.prototype.toString.call(expected)=="[object RegExp]"){return expected.test(actual)}try{if(actual instanceof expected){return true}}catch(e){}if(Error.isPrototypeOf(expected)){return false}return expected.call({},actual)===true}function _tryBlock(block){var error;try{block()}catch(e){error=e}return error}function _throws(shouldThrow,block,expected,message){var actual;if(typeof block!=="function"){throw new TypeError('"block" argument must be a function')}if(typeof expected==="string"){message=expected;expected=null}actual=_tryBlock(block);message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:".");if(shouldThrow&&!actual){fail(actual,expected,"Missing expected exception"+message)}var userProvidedMessage=typeof message==="string";var isUnwantedException=!shouldThrow&&util.isError(actual);var isUnexpectedException=!shouldThrow&&actual&&!expected;if(isUnwantedException&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException){fail(actual,expected,"Got unwanted exception"+message)}if(shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual){throw actual}}assert.throws=function(block,error,message){_throws(true,block,error,message)};assert.doesNotThrow=function(block,error,message){_throws(false,block,error,message)};assert.ifError=function(err){if(err)throw err};function strict(value,message){if(!value)fail(value,true,message,"==",strict)}assert.strict=objectAssign(strict,assert,{equal:assert.strictEqual,deepEqual:assert.deepStrictEqual,notEqual:assert.notStrictEqual,notDeepEqual:assert.notDeepStrictEqual});assert.strict.strict=assert.strict;var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj){if(hasOwn.call(obj,key))keys.push(key)}return keys}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"object-assign":376,"util/":144}],142:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},{}],143:[function(require,module,exports){module.exports=function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.readUInt8==="function"}},{}],144:[function(require,module,exports){(function(process,global){(function(){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,(function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}));for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};exports.deprecate=function(fn,msg){if(isUndefined(global.process)){return function(){return exports.deprecate(fn,msg).apply(this,arguments)}}if(process.noDeprecation===true){return fn}var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg)}else if(process.traceDeprecation){console.trace(msg)}else{console.error(msg)}warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnviron;exports.debuglog=function(set){if(isUndefined(debugEnviron))debugEnviron=process.env.NODE_DEBUG||"";set=set.toUpperCase();if(!debugs[set]){if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else{debugs[set]=function(){}}}return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach((function(val,idx){hash[val]=true}));return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value)}if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0)){return formatError(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}))}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}keys.forEach((function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}}));return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map((function(line){return"  "+line})).join("\n").substr(2)}else{str="\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce((function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=require("./support/isBuffer");function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=require("inherits");exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":143,_process:378,inherits:142}],145:[function(require,module,exports){(function(global){(function(){"use strict";var possibleNames=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];var g=typeof globalThis==="undefined"?global:globalThis;module.exports=function availableTypedArrays(){var out=[];for(var i=0;i<possibleNames.length;i++){if(typeof g[possibleNames[i]]==="function"){out[out.length]=possibleNames[i]}}return out}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],146:[function(require,module,exports){"use strict";var punycode=require("punycode");function BackslashError(offset,err){this.__proto__=new Error(err);this.__proto__.name="BackslashError";this.offset=offset}function isOctalDigit(c){return c>="0"&&c<="7"}function isHexDigit(c){return c>="0"&&c<="9"||c>="a"&&c<="f"||c>="A"&&c<="F"}function parseHex(u){u=parseInt(u,16);return punycode.ucs2.encode([u])}function process(arr,pos,stopChar){var escaped=false;var ret=[];function assertHexDigit(pos){var c=arr[pos];if(!isHexDigit(c)){throw new BackslashError(pos,"Unexpected token ILLEGAL")}return c}while(pos<arr.length){var c=arr[pos];pos++;if(escaped){escaped=false;switch(c){case"n":ret.push("\n");continue;case"r":ret.push("\r");continue;case"f":ret.push("\f");continue;case"b":ret.push("\b");continue;case"t":ret.push("\t");continue;case"v":ret.push("\v");continue;case"\\":ret.push("\\");continue}if(c==="x"){ret.push(parseHex(assertHexDigit(pos)+assertHexDigit(pos+1)));pos+=2;continue}if(c==="u"){ret.push(parseHex(assertHexDigit(pos)+assertHexDigit(pos+1)+assertHexDigit(pos+2)+assertHexDigit(pos+3)));pos+=4;continue}if(isOctalDigit(c)){var o;if(isOctalDigit(o=arr[pos])){pos++;c+=o;if(isOctalDigit(o=arr[pos])&&c[0]<="3"){pos++;c+=o}}ret.push(punycode.ucs2.encode([parseInt(c,8)]));continue}ret.push(c)}else if(c==="\\"){escaped=true}else if(c===stopChar){pos--;break}else{ret.push(c)}}return arguments.length===3?{end:pos,value:ret.join("")}:ret.join("")}module.exports=function backslash(str){return process(str,0)};module.exports.parseUntil=function parseUntil(str,pos,stopChar){return process(str,pos,stopChar)}},{punycode:150}],147:[function(require,module,exports){"use strict";exports.byteLength=byteLength;exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(b64){var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var validLen=b64.indexOf("=");if(validLen===-1)validLen=len;var placeHoldersLen=validLen===len?0:4-validLen%4;return[validLen,placeHoldersLen]}function byteLength(b64){var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function _byteLength(b64,validLen,placeHoldersLen){return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function toByteArray(b64){var tmp;var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];var arr=new Arr(_byteLength(b64,validLen,placeHoldersLen));var curByte=0;var len=placeHoldersLen>0?validLen-4:validLen;var i;for(i=0;i<len;i+=4){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[curByte++]=tmp>>16&255;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}if(placeHoldersLen===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[curByte++]=tmp&255}if(placeHoldersLen===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(uint8[i+2]&255);output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len=uint8.length;var extraBytes=len%3;var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength))}if(extraBytes===1){tmp=uint8[len-1];parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"=")}return parts.join("")}},{}],148:[function(require,module,exports){},{}],149:[function(require,module,exports){arguments[4][148][0].apply(exports,arguments)},{dup:148}],150:[function(require,module,exports){(function(global){(function(){(function(root){var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=typeof module=="object"&&module&&!module.nodeType&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw new RangeError(errors[type])}function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length])}return result}function mapDomain(string,fn){var parts=string.split("@");var result="";if(parts.length>1){result=parts[0]+"@";string=parts[1]}string=string.replace(regexSeparators,".");var labels=string.split(".");var encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){return map(array,(function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value);return output})).join("")}function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22}if(codePoint-65<26){return codePoint-65}if(codePoint-97<26){return codePoint-97}return base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0){basic=0}for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error("not-basic")}output.push(input.charCodeAt(j))}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength){error("invalid-input")}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error("overflow")}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error("overflow")}w*=baseMinusT}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error("overflow")}n+=floor(i/out);i%=out;output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128){output.push(stringFromCharCode(currentValue))}}handledCPCount=basicLength=output.length;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue}}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error("overflow")}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error("overflow")}if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;++n}return output.join("")}function toUnicode(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}function toASCII(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",(function(){return punycode}))}else if(freeExports&&freeModule){if(module.exports==freeExports){freeModule.exports=punycode}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key])}}}else{root.punycode=punycode}})(this)}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],151:[function(require,module,exports){(function(Buffer){(function(){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
"use strict";var base64=require("base64-js");var ieee754=require("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,"parent",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,"offset",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError('The value "'+length+'" is invalid for option "size"')}var buf=new Uint8Array(length);buf.__proto__=Buffer.prototype;return buf}function Buffer(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="string"){return fromString(value,encodingOrOffset)}if(ArrayBuffer.isView(value)){return fromArrayLike(value)}if(value==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var valueOf=value.valueOf&&value.valueOf();if(valueOf!=null&&valueOf!==value){return Buffer.from(valueOf,encodingOrOffset,length)}var b=fromObject(value);if(b)return b;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof value[Symbol.toPrimitive]==="function"){return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be of type number')}else if(size<0){throw new RangeError('The value "'+size+'" is invalid for option "size"')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==undefined){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer.allocUnsafe=function(size){return allocUnsafe(size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i=0;i<length;i+=1){buf[i]=array[i]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError('"offset" is outside of buffer bounds')}if(array.byteLength<byteOffset+(length||0)){throw new RangeError('"length" is outside of buffer bounds')}var buf;if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array)}else if(length===undefined){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}buf.__proto__=Buffer.prototype;return buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj.length!==undefined){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer.alloc(+length)}Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true&&b!==Buffer.prototype};Buffer.compare=function compare(a,b){if(isInstance(a,Uint8Array))a=Buffer.from(a,a.offset,a.byteLength);if(isInstance(b,Uint8Array))b=Buffer.from(b,b.offset,b.byteLength);if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}if(list.length===0){return Buffer.alloc(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)){buf=Buffer.from(buf)}if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer)){return string.byteLength}if(typeof string!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof string)}var len=string.length;var mustMatch=arguments.length>2&&arguments[2]===true;if(!mustMatch&&len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase){return mustMatch?-1:utf8ToBytes(string).length}encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0}if(start>this.length){return""}if(end===undefined||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<len;i+=2){swap(this,i,i+1)}return this};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2)}return this};Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i=0;i<len;i+=8){swap(this,i,i+7);swap(this,i+1,i+6);swap(this,i+2,i+5);swap(this,i+3,i+4)}return this};Buffer.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();if(this.length>max)str+=" ... ";return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)){target=Buffer.from(target,target.offset,target.byteLength)}if(!Buffer.isBuffer(target)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof target)}if(start===undefined){start=0}if(end===undefined){end=target?target.length:0}if(thisStart===undefined){thisStart=0}if(thisEnd===undefined){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer.from(val,encoding)}if(Buffer.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i=byteOffset;i>=0;i--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=false;break}}if(found)return i}}return-1}Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(length>strLen/2){length=strLen/2}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;if(this===target&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(targetStart,start,end)}else if(this===target&&start<targetStart&&targetStart<end){for(var i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart)}return len};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}if(val.length===1){var code=val.charCodeAt(0);if(encoding==="utf8"&&code<128||encoding==="latin1"){val=code}}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding);var len=bytes.length;if(len===0){throw new TypeError('The value "'+val+'" is invalid for argument "value"')}for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){str=str.split("=")[0];str=str.trim().replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function isInstance(obj,type){return obj instanceof type||obj!=null&&obj.constructor!=null&&obj.constructor.name!=null&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!==obj}}).call(this)}).call(this,require("buffer").Buffer)},{"base64-js":147,buffer:151,ieee754:278}],152:[function(require,module,exports){module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],153:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBind=require("./");var $indexOf=callBind(GetIntrinsic("String.prototype.indexOf"));module.exports=function callBoundIntrinsic(name,allowMissing){var intrinsic=GetIntrinsic(name,!!allowMissing);if(typeof intrinsic==="function"&&$indexOf(name,".prototype.")>-1){return callBind(intrinsic)}return intrinsic}},{"./":154,"get-intrinsic":270}],154:[function(require,module,exports){"use strict";var bind=require("function-bind");var GetIntrinsic=require("get-intrinsic");var $apply=GetIntrinsic("%Function.prototype.apply%");var $call=GetIntrinsic("%Function.prototype.call%");var $reflectApply=GetIntrinsic("%Reflect.apply%",true)||bind.call($call,$apply);var $gOPD=GetIntrinsic("%Object.getOwnPropertyDescriptor%",true);var $defineProperty=GetIntrinsic("%Object.defineProperty%",true);var $max=GetIntrinsic("%Math.max%");if($defineProperty){try{$defineProperty({},"a",{value:1})}catch(e){$defineProperty=null}}module.exports=function callBind(originalFunction){var func=$reflectApply(bind,$call,arguments);if($gOPD&&$defineProperty){var desc=$gOPD(func,"length");if(desc.configurable){$defineProperty(func,"length",{value:1+$max(0,originalFunction.length-(arguments.length-1))})}}return func};var applyBind=function applyBind(){return $reflectApply(bind,$apply,arguments)};if($defineProperty){$defineProperty(module.exports,"apply",{value:applyBind})}else{module.exports.apply=applyBind}},{"function-bind":269,"get-intrinsic":270}],155:[function(require,module,exports){"use strict";module.exports=function serialize(object){if(object===null||typeof object!=="object"||object.toJSON!=null){return JSON.stringify(object)}if(Array.isArray(object)){return"["+object.reduce(((t,cv,ci)=>{const comma=ci===0?"":",";const value=cv===undefined||typeof cv==="symbol"?null:cv;return t+comma+serialize(value)}),"")+"]"}return"{"+Object.keys(object).sort().reduce(((t,cv,ci)=>{if(object[cv]===undefined||typeof object[cv]==="symbol"){return t}const comma=t.length===0?"":",";return t+comma+serialize(cv)+":"+serialize(object[cv])}),"")+"}"}},{}],156:[function(require,module,exports){"use strict";var object=require("es5-ext/object/valid-object"),stringifiable=require("es5-ext/object/validate-stringifiable-value"),forOf=require("es6-iterator/for-of");module.exports=function(text,style){var result="";text=stringifiable(text);object(style);forOf(text,(function(char){result+=style[char]||char}));return result}},{"es5-ext/object/valid-object":232,"es5-ext/object/validate-stringifiable-value":234,"es6-iterator/for-of":246}],157:[function(require,module,exports){(function(process){(function(){"use strict";var d=require("d"),assign=require("es5-ext/object/assign"),forEach=require("es5-ext/object/for-each"),map=require("es5-ext/object/map"),primitiveSet=require("es5-ext/object/primitive-set"),setPrototypeOf=require("es5-ext/object/set-prototype-of"),memoize=require("memoizee"),memoizeMethods=require("memoizee/methods"),sgr=require("./lib/sgr"),supportsColor=require("./lib/supports-color");var mods=sgr.mods,join=Array.prototype.join,defineProperty=Object.defineProperty,max=Math.max,min=Math.min,variantModes=primitiveSet("_fg","_bg"),xtermMatch=process.platform==="win32"?require("./lib/xterm-match"):null;var getFn;var memoized=memoize((function(scope,mod){return defineProperty(getFn(),"_cliColorData",d(assign({},scope._cliColorData,mod)))}));var proto=Object.create(Function.prototype,assign(map(mods,(function(mod){return d.gs((function(){return memoized(this,mod)}))})),memoizeMethods({xterm:d((function(code){code=isNaN(code)?255:min(max(code,0),255);return defineProperty(getFn(),"_cliColorData",d(assign({},this._cliColorData,{_fg:[xtermMatch?xtermMatch[code]:"38;5;"+code,39]})))})),bgXterm:d((function(code){code=isNaN(code)?255:min(max(code,0),255);return defineProperty(getFn(),"_cliColorData",d(assign({},this._cliColorData,{_bg:[xtermMatch?xtermMatch[code]+10:"48;5;"+code,49]})))}))})));var getEndRe=memoize((function(code){return new RegExp("\\["+code+"m","g")}),{primitive:true});getFn=function(){return setPrototypeOf((function self(){var start="",end="",msg=join.call(arguments," "),conf=self._cliColorData,hasAnsi=sgr.hasCSI(msg);forEach(conf,(function(mod,key){end=sgr(mod[1])+end;start+=sgr(mod[0]);if(hasAnsi){msg=msg.replace(getEndRe(mod[1]),variantModes[key]?sgr(mod[0]):"")}}),null,true);if(!supportsColor.isColorSupported())return msg;return start+msg+end}),proto)};module.exports=Object.defineProperties(getFn(),{xtermSupported:d(!xtermMatch),_cliColorData:d("",{})})}).call(this)}).call(this,require("_process"))},{"./lib/sgr":163,"./lib/supports-color":164,"./lib/xterm-match":166,_process:378,d:175,"es5-ext/object/assign":210,"es5-ext/object/for-each":216,"es5-ext/object/map":224,"es5-ext/object/primitive-set":227,"es5-ext/object/set-prototype-of":228,memoizee:358,"memoizee/methods":365}],158:[function(require,module,exports){"use strict";module.exports=""},{}],159:[function(require,module,exports){"use strict";var generate=require("es5-ext/array/generate"),from=require("es5-ext/array/from"),iterable=require("es5-ext/iterable/validate-object"),isValue=require("es5-ext/object/is-value"),stringifiable=require("es5-ext/object/validate-stringifiable"),repeat=require("es5-ext/string/#/repeat"),getStrippedLength=require("./get-stripped-length");var push=Array.prototype.push;module.exports=function(inputRows){var options=Object(arguments[1]),colsMeta=[],colsOptions=options.columns||[],rows=[];from(iterable(inputRows),(function(row){var rowRows=[[]];from(iterable(row),(function(cellStr,columnIndex){var cellRows=stringifiable(cellStr).split("\n");while(cellRows.length>rowRows.length)rowRows.push(generate(columnIndex,""));cellRows.forEach((function(cellRow,rowRowIndex){rowRows[rowRowIndex][columnIndex]=cellRow}))}));push.apply(rows,rowRows)}));return rows.map((function(row){return from(iterable(row),(function(str,index){var col=colsMeta[index],strLength;if(!col)col=colsMeta[index]={width:0};str=stringifiable(str);strLength=getStrippedLength(str);if(strLength>col.width)col.width=strLength;return{str:str,length:strLength}}))})).map((function(row){return row.map((function(item,index){var pad,align="left",colOptions=colsOptions&&colsOptions[index];align=colOptions&&colOptions.align==="right"?"right":"left";pad=repeat.call(" ",colsMeta[index].width-item.length);if(align==="left")return item.str+pad;return pad+item.str})).join(isValue(options.sep)?options.sep:" | ")})).join("\n")+"\n"}},{"./get-stripped-length":161,"es5-ext/array/from":185,"es5-ext/array/generate":188,"es5-ext/iterable/validate-object":197,"es5-ext/object/is-value":220,"es5-ext/object/validate-stringifiable":235,"es5-ext/string/#/repeat":240}],160:[function(require,module,exports){"use strict";module.exports={screen:"[2J",screenLeft:"[1J",screenRight:"[J",line:"[2K",lineLeft:"[1K",lineRight:"[K"}},{}],161:[function(require,module,exports){"use strict";var strip=require("./strip");module.exports=function(str){return strip(str).length}},{"./strip":171}],162:[function(require,module,exports){"use strict";var d=require("d");module.exports=Object.defineProperties(require("./bare"),{windowSize:d(require("./window-size")),erase:d(require("./erase")),move:d(require("./move")),beep:d(require("./beep")),columns:d(require("./columns")),strip:d(require("./strip")),getStrippedLength:d(require("./get-stripped-length")),slice:d(require("./slice")),throbber:d(require("./throbber")),reset:d(require("./reset")),art:d(require("./art"))})},{"./art":156,"./bare":157,"./beep":158,"./columns":159,"./erase":160,"./get-stripped-length":161,"./move":167,"./reset":169,"./slice":170,"./strip":171,"./throbber":172,"./window-size":173,d:175}],163:[function(require,module,exports){"use strict";var assign=require("es5-ext/object/assign"),includes=require("es5-ext/string/#/contains"),forOwn=require("es5-ext/object/for-each"),onlyKey=require("es5-ext/object/first-key"),forEachRight=require("es5-ext/array/#/for-each-right"),uniq=require("es5-ext/array/#/uniq.js");var CSI="[";var sgr=function(code){return CSI+code+"m"};sgr.CSI=CSI;var mods=assign({bold:{_bold:[1,22]},italic:{_italic:[3,23]},underline:{_underline:[4,24]},blink:{_blink:[5,25]},inverse:{_inverse:[7,27]},strike:{_strike:[9,29]}},["black","red","green","yellow","blue","magenta","cyan","white"].reduce((function(obj,color,index){obj[color]={_fg:[30+index,39]};obj[color+"Bright"]={_fg:[90+index,39]};obj["bg"+color[0].toUpperCase()+color.slice(1)]={_bg:[40+index,49]};obj["bg"+color[0].toUpperCase()+color.slice(1)+"Bright"]={_bg:[100+index,49]};return obj}),{}));sgr.mods=mods;sgr.openers={};sgr.closers={};forOwn(mods,(function(mod){var modPair=mod[onlyKey(mod)];sgr.openers[modPair[0]]=modPair;sgr.closers[modPair[1]]=modPair}));sgr.openStyle=function(openedMods,code){openedMods.push(sgr.openers[code])};sgr.closeStyle=function(openedMods,code){forEachRight.call(openedMods,(function(modPair,index){if(modPair[1]===code){openedMods.splice(index,1)}}))};sgr.prepend=function(currentMods){return currentMods.map((function(modPair){return sgr(modPair[0])}))};sgr.complete=function(openedMods,closerCodes){closerCodes.forEach((function(code){sgr.closeStyle(openedMods,code)}));openedMods=openedMods.reverse();openedMods=openedMods.map((function(modPair){return modPair[1]}));openedMods=uniq.call(openedMods);return openedMods.map(sgr)};var hasCSI=function(str){return includes.call(str,CSI)};sgr.hasCSI=hasCSI;var extractCode=function(csi){var code=csi.slice(2,-1);code=Number(code);return code};sgr.extractCode=extractCode;module.exports=sgr},{"es5-ext/array/#/for-each-right":183,"es5-ext/array/#/uniq.js":184,"es5-ext/object/assign":210,"es5-ext/object/first-key":215,"es5-ext/object/for-each":216,"es5-ext/string/#/contains":237}],164:[function(require,module,exports){(function(process){(function(){"use strict";var state=null;var enableColor=function(){state=true};var disableColor=function(){state=false};var autoDetectSupport=function(){state=null};var isColorSupported=function(){return state===null?!process.env.NO_COLOR:state};module.exports={enableColor:enableColor,disableColor:disableColor,autoDetectSupport:autoDetectSupport,isColorSupported:isColorSupported}}).call(this)}).call(this,require("_process"))},{_process:378}],165:[function(require,module,exports){"use strict";module.exports=["000000","800000","008000","808000","000080","800080","008080","c0c0c0","808080","ff0000","00ff00","ffff00","0000ff","ff00ff","00ffff","ffffff","000000","00005f","000087","0000af","0000d7","0000ff","005f00","005f5f","005f87","005faf","005fd7","005fff","008700","00875f","008787","0087af","0087d7","0087ff","00af00","00af5f","00af87","00afaf","00afd7","00afff","00d700","00d75f","00d787","00d7af","00d7d7","00d7ff","00ff00","00ff5f","00ff87","00ffaf","00ffd7","00ffff","5f0000","5f005f","5f0087","5f00af","5f00d7","5f00ff","5f5f00","5f5f5f","5f5f87","5f5faf","5f5fd7","5f5fff","5f8700","5f875f","5f8787","5f87af","5f87d7","5f87ff","5faf00","5faf5f","5faf87","5fafaf","5fafd7","5fafff","5fd700","5fd75f","5fd787","5fd7af","5fd7d7","5fd7ff","5fff00","5fff5f","5fff87","5fffaf","5fffd7","5fffff","870000","87005f","870087","8700af","8700d7","8700ff","875f00","875f5f","875f87","875faf","875fd7","875fff","878700","87875f","878787","8787af","8787d7","8787ff","87af00","87af5f","87af87","87afaf","87afd7","87afff","87d700","87d75f","87d787","87d7af","87d7d7","87d7ff","87ff00","87ff5f","87ff87","87ffaf","87ffd7","87ffff","af0000","af005f","af0087","af00af","af00d7","af00ff","af5f00","af5f5f","af5f87","af5faf","af5fd7","af5fff","af8700","af875f","af8787","af87af","af87d7","af87ff","afaf00","afaf5f","afaf87","afafaf","afafd7","afafff","afd700","afd75f","afd787","afd7af","afd7d7","afd7ff","afff00","afff5f","afff87","afffaf","afffd7","afffff","d70000","d7005f","d70087","d700af","d700d7","d700ff","d75f00","d75f5f","d75f87","d75faf","d75fd7","d75fff","d78700","d7875f","d78787","d787af","d787d7","d787ff","d7af00","d7af5f","d7af87","d7afaf","d7afd7","d7afff","d7d700","d7d75f","d7d787","d7d7af","d7d7d7","d7d7ff","d7ff00","d7ff5f","d7ff87","d7ffaf","d7ffd7","d7ffff","ff0000","ff005f","ff0087","ff00af","ff00d7","ff00ff","ff5f00","ff5f5f","ff5f87","ff5faf","ff5fd7","ff5fff","ff8700","ff875f","ff8787","ff87af","ff87d7","ff87ff","ffaf00","ffaf5f","ffaf87","ffafaf","ffafd7","ffafff","ffd700","ffd75f","ffd787","ffd7af","ffd7d7","ffd7ff","ffff00","ffff5f","ffff87","ffffaf","ffffd7","ffffff","080808","121212","1c1c1c","262626","303030","3a3a3a","444444","4e4e4e","585858","626262","6c6c6c","767676","808080","8a8a8a","949494","9e9e9e","a8a8a8","b2b2b2","bcbcbc","c6c6c6","d0d0d0","dadada","e4e4e4","eeeeee"]},{}],166:[function(require,module,exports){"use strict";var push=Array.prototype.push,reduce=Array.prototype.reduce,abs=Math.abs,colors,match,result,i;colors=require("./xterm-colors").map((function(color){return{r:parseInt(color.slice(0,2),16),g:parseInt(color.slice(2,4),16),b:parseInt(color.slice(4),16)}}));match=colors.slice(0,16);module.exports=result=[];i=0;while(i<8){result.push(30+i++)}i=0;while(i<8){result.push(90+i++)}push.apply(result,colors.slice(16).map((function(data){var index,diff=Infinity;match.every((function(innerMatch,currentIndex){var ndiff=reduce.call("rgb",(function(currentDiff,channel){currentDiff+=abs(innerMatch[channel]-data[channel]);return currentDiff}),0);if(ndiff<diff){index=currentIndex;diff=ndiff}return ndiff}));return result[index]})))},{"./xterm-colors":165}],167:[function(require,module,exports){"use strict";var d=require("d"),trunc=require("es5-ext/math/trunc");var up,down,right,left,abs=Math.abs,floor=Math.floor,max=Math.max;var getMove=function(control){return function(num){num=isNaN(num)?0:max(floor(num),0);return num?"["+num+control:""}};module.exports=Object.defineProperties((function(x,y){x=isNaN(x)?0:floor(x);y=isNaN(y)?0:floor(y);return(x>0?right(x):left(-x))+(y>0?down(y):up(-y))}),{up:d(up=getMove("A")),down:d(down=getMove("B")),right:d(right=getMove("C")),left:d(left=getMove("D")),to:d((function(x,y){x=isNaN(x)?1:max(floor(x),0)+1;y=isNaN(y)?1:max(floor(y),0)+1;return"["+y+";"+x+"H"})),lines:d((function(n){var dir;n=trunc(n)||0;dir=n>=0?"B":"A";n=floor(abs(n));return"["+n+dir+"[1G"})),top:d("[5000F"),bottom:d("[5000B"),lineBegin:d("[5000D"),lineEnd:d("[5000C")})},{d:175,"es5-ext/math/trunc":201}],168:[function(require,module,exports){"use strict";module.exports=function(){return new RegExp("[\\u001B\\u009B][[\\]()#;?]"+"*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]"+"+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)"+"|"+"(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))","g")}},{}],169:[function(require,module,exports){"use strict";module.exports="[2J[0;0H"},{}],170:[function(require,module,exports){"use strict";var reAnsi=require("./regex-ansi"),stringifiable=require("es5-ext/object/validate-stringifiable-value"),length=require("./get-stripped-length"),sgr=require("./lib/sgr"),max=Math.max;var Token=function(token){this.token=token};var tokenize=function(str){var match=reAnsi().exec(str);if(!match){return[str]}var index=match.index,head,prehead,tail;if(index===0){head=match[0];tail=str.slice(head.length);return[new Token(head)].concat(tokenize(tail))}prehead=str.slice(0,index);head=match[0];tail=str.slice(index+head.length);return[prehead,new Token(head)].concat(tokenize(tail))};var isChunkInSlice=function(chunk,index,begin,end){var endIndex=chunk.length+index;if(begin>endIndex)return false;if(end<index)return false;return true};var sliceSeq=function(seq,begin,end){var sliced=seq.reduce((function(state,chunk){var index=state.index;if(chunk instanceof Token){var code=sgr.extractCode(chunk.token);if(index<=begin){if(code in sgr.openers){sgr.openStyle(state.preOpeners,code)}if(code in sgr.closers){sgr.closeStyle(state.preOpeners,code)}}else if(index<end){if(code in sgr.openers){sgr.openStyle(state.inOpeners,code);state.seq.push(chunk)}else if(code in sgr.closers){state.inClosers.push(code);state.seq.push(chunk)}}}else{var nextChunk="";if(isChunkInSlice(chunk,index,begin,end)){var relBegin=Math.max(begin-index,0),relEnd=Math.min(end-index,chunk.length);nextChunk=chunk.slice(relBegin,relEnd)}state.seq.push(nextChunk);state.index=index+chunk.length}return state}),{index:0,seq:[],preOpeners:[],inOpeners:[],inClosers:[]});sliced.seq=[].concat(sgr.prepend(sliced.preOpeners),sliced.seq,sgr.complete([].concat(sliced.preOpeners,sliced.inOpeners),sliced.inClosers));return sliced.seq};module.exports=function(str){var seq,begin=Number(arguments[1]),end=Number(arguments[2]),len;str=stringifiable(str);len=length(str);if(isNaN(begin)){begin=0}if(isNaN(end)){end=len}if(begin<0){begin=max(len+begin,0)}if(end<0){end=max(len+end,0)}seq=tokenize(str);seq=sliceSeq(seq,begin,end);return seq.map((function(chunk){if(chunk instanceof Token){return chunk.token}return chunk})).join("")}},{"./get-stripped-length":161,"./lib/sgr":163,"./regex-ansi":168,"es5-ext/object/validate-stringifiable-value":234}],171:[function(require,module,exports){"use strict";var stringifiable=require("es5-ext/object/validate-stringifiable"),r=require("./regex-ansi")();module.exports=function(str){return stringifiable(str).replace(r,"")}},{"./regex-ansi":168,"es5-ext/object/validate-stringifiable":235}],172:[function(require,module,exports){"use strict";var compose=require("es5-ext/function/#/compose"),callable=require("es5-ext/object/valid-callable"),d=require("d"),validTimeout=require("timers-ext/valid-timeout");var chars="-\\|/",l=chars.length,ThrobberIterator;ThrobberIterator=function(){};Object.defineProperties(ThrobberIterator.prototype,{index:d(-1),running:d(false),next:d((function(){var str=this.running?"\b":"";if(!this.running)this.running=true;return str+chars[this.index=(this.index+1)%l]})),reset:d((function(){if(!this.running)return"";this.index=-1;this.running=false;return"\b"}))});module.exports=exports=function(write,interval){var format=arguments[2],token,iterator=new ThrobberIterator;callable(write);interval=validTimeout(interval);if(format!==undefined)write=compose.call(write,callable(format));return{start:function(){if(token)return;token=setInterval((function(){write(iterator.next())}),interval)},restart:function(){this.stop();this.start()},stop:function(){if(!token)return;clearInterval(token);token=null;write(iterator.reset())}}};Object.defineProperty(exports,"Iterator",d(ThrobberIterator))},{d:175,"es5-ext/function/#/compose":191,"es5-ext/object/valid-callable":231,"timers-ext/valid-timeout":423}],173:[function(require,module,exports){(function(process){(function(){"use strict";var d=require("d");Object.defineProperties(exports,{width:d.gs("ce",(function(){return process.stdout.columns||0})),height:d.gs("ce",(function(){return process.stdout.rows||0}))})}).call(this)}).call(this,require("_process"))},{_process:378,d:175}],174:[function(require,module,exports){"use strict";var isValue=require("type/value/is"),ensureValue=require("type/value/ensure"),ensurePlainFunction=require("type/plain-function/ensure"),copy=require("es5-ext/object/copy"),normalizeOptions=require("es5-ext/object/normalize-options"),map=require("es5-ext/object/map");var bind=Function.prototype.bind,defineProperty=Object.defineProperty,hasOwnProperty=Object.prototype.hasOwnProperty,define;define=function(name,desc,options){var value=ensureValue(desc)&&ensurePlainFunction(desc.value),dgs;dgs=copy(desc);delete dgs.writable;delete dgs.value;dgs.get=function(){if(!options.overwriteDefinition&&hasOwnProperty.call(this,name))return value;desc.value=bind.call(value,options.resolveContext?options.resolveContext(this):this);defineProperty(this,name,desc);return this[name]};return dgs};module.exports=function(props){var options=normalizeOptions(arguments[1]);if(isValue(options.resolveContext))ensurePlainFunction(options.resolveContext);return map(props,(function(desc,name){return define(name,desc,options)}))}},{"es5-ext/object/copy":213,"es5-ext/object/map":224,"es5-ext/object/normalize-options":226,"type/plain-function/ensure":429,"type/value/ensure":433,"type/value/is":434}],175:[function(require,module,exports){"use strict";var isValue=require("type/value/is"),isPlainFunction=require("type/plain-function/is"),assign=require("es5-ext/object/assign"),normalizeOpts=require("es5-ext/object/normalize-options"),contains=require("es5-ext/string/#/contains");var d=module.exports=function(dscr,value){var c,e,w,options,desc;if(arguments.length<2||typeof dscr!=="string"){options=value;value=dscr;dscr=null}else{options=arguments[2]}if(isValue(dscr)){c=contains.call(dscr,"c");e=contains.call(dscr,"e");w=contains.call(dscr,"w")}else{c=w=true;e=false}desc={value:value,configurable:c,enumerable:e,writable:w};return!options?desc:assign(normalizeOpts(options),desc)};d.gs=function(dscr,get,set){var c,e,options,desc;if(typeof dscr!=="string"){options=set;set=get;get=dscr;dscr=null}else{options=arguments[3]}if(!isValue(get)){get=undefined}else if(!isPlainFunction(get)){options=get;get=set=undefined}else if(!isValue(set)){set=undefined}else if(!isPlainFunction(set)){options=set;set=undefined}if(isValue(dscr)){c=contains.call(dscr,"c");e=contains.call(dscr,"e")}else{c=true;e=false}desc={get:get,set:set,configurable:c,enumerable:e};return!options?desc:assign(normalizeOpts(options),desc)}},{"es5-ext/object/assign":210,"es5-ext/object/normalize-options":226,"es5-ext/string/#/contains":237,"type/plain-function/is":430,"type/value/is":434}],176:[function(require,module,exports){"use strict";var isPlainFunction=require("type/plain-function/is"),ensureValue=require("type/value/ensure"),isValue=require("type/value/is"),map=require("es5-ext/object/map"),contains=require("es5-ext/string/#/contains");var call=Function.prototype.call,defineProperty=Object.defineProperty,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,getPrototypeOf=Object.getPrototypeOf,hasOwnProperty=Object.prototype.hasOwnProperty,cacheDesc={configurable:false,enumerable:false,writable:false,value:null},define;define=function(name,options){var value,dgs,cacheName,desc,writable=false,resolvable,flat;options=Object(ensureValue(options));cacheName=options.cacheName;flat=options.flat;if(!isValue(cacheName))cacheName=name;delete options.cacheName;value=options.value;resolvable=isPlainFunction(value);delete options.value;dgs={configurable:Boolean(options.configurable),enumerable:Boolean(options.enumerable)};if(name!==cacheName){dgs.get=function(){if(hasOwnProperty.call(this,cacheName))return this[cacheName];cacheDesc.value=resolvable?call.call(value,this,options):value;cacheDesc.writable=writable;defineProperty(this,cacheName,cacheDesc);cacheDesc.value=null;if(desc)defineProperty(this,name,desc);return this[cacheName]}}else if(!flat){dgs.get=function self(){var ownDesc;if(hasOwnProperty.call(this,name)){ownDesc=getOwnPropertyDescriptor(this,name);if(ownDesc){if(ownDesc.hasOwnProperty("value"))return ownDesc.value;if(typeof ownDesc.get==="function"&&ownDesc.get!==self){return ownDesc.get.call(this)}return value}}desc.value=resolvable?call.call(value,this,options):value;defineProperty(this,name,desc);desc.value=null;return this[name]}}else{dgs.get=function self(){var base=this,ownDesc;if(hasOwnProperty.call(this,name)){ownDesc=getOwnPropertyDescriptor(this,name);if(ownDesc.hasOwnProperty("value"))return ownDesc.value;if(typeof ownDesc.get==="function"&&ownDesc.get!==self){return ownDesc.get.call(this)}}while(!hasOwnProperty.call(base,name))base=getPrototypeOf(base);desc.value=resolvable?call.call(value,base,options):value;defineProperty(base,name,desc);desc.value=null;return base[name]}}dgs.set=function(value){if(hasOwnProperty.call(this,name)){throw new TypeError("Cannot assign to lazy defined '"+name+"' property of "+this)}dgs.get.call(this);this[cacheName]=value};if(options.desc){desc={configurable:contains.call(options.desc,"c"),enumerable:contains.call(options.desc,"e")};if(cacheName===name){desc.writable=contains.call(options.desc,"w");desc.value=null}else{writable=contains.call(options.desc,"w");desc.get=dgs.get;desc.set=dgs.set}delete options.desc}else if(cacheName===name){desc={configurable:Boolean(options.configurable),enumerable:Boolean(options.enumerable),writable:Boolean(options.writable),value:null}}delete options.configurable;delete options.enumerable;delete options.writable;return dgs};module.exports=function(props){return map(props,(function(desc,name){return define(name,desc)}))}},{"es5-ext/object/map":224,"es5-ext/string/#/contains":237,"type/plain-function/is":430,"type/value/ensure":433,"type/value/is":434}],177:[function(require,module,exports){"use strict";function padWithZeros(vNumber,width){var numAsString=vNumber.toString();while(numAsString.length<width){numAsString="0"+numAsString}return numAsString}function addZero(vNumber){return padWithZeros(vNumber,2)}function offset(timezoneOffset){var os=Math.abs(timezoneOffset);var h=String(Math.floor(os/60));var m=String(os%60);h=("0"+h).slice(-2);m=("0"+m).slice(-2);return timezoneOffset===0?"Z":(timezoneOffset<0?"+":"-")+h+":"+m}function asString(format,date){if(typeof format!=="string"){date=format;format=module.exports.ISO8601_FORMAT}if(!date){date=module.exports.now()}var vDay=addZero(date.getDate());var vMonth=addZero(date.getMonth()+1);var vYearLong=addZero(date.getFullYear());var vYearShort=addZero(vYearLong.substring(2,4));var vYear=format.indexOf("yyyy")>-1?vYearLong:vYearShort;var vHour=addZero(date.getHours());var vMinute=addZero(date.getMinutes());var vSecond=addZero(date.getSeconds());var vMillisecond=padWithZeros(date.getMilliseconds(),3);var vTimeZone=offset(date.getTimezoneOffset());var formatted=format.replace(/dd/g,vDay).replace(/MM/g,vMonth).replace(/y{1,4}/g,vYear).replace(/hh/g,vHour).replace(/mm/g,vMinute).replace(/ss/g,vSecond).replace(/SSS/g,vMillisecond).replace(/O/g,vTimeZone);return formatted}function setDatePart(date,part,value,local){date["set"+(local?"":"UTC")+part](value)}function extractDateParts(pattern,str,missingValuesDate){var local=pattern.indexOf("O")<0;var matchers=[{pattern:/y{1,4}/,regexp:"\\d{1,4}",fn:function(date,value){setDatePart(date,"FullYear",value,local)}},{pattern:/MM/,regexp:"\\d{1,2}",fn:function(date,value){setDatePart(date,"Month",value-1,local)}},{pattern:/dd/,regexp:"\\d{1,2}",fn:function(date,value){setDatePart(date,"Date",value,local)}},{pattern:/hh/,regexp:"\\d{1,2}",fn:function(date,value){setDatePart(date,"Hours",value,local)}},{pattern:/mm/,regexp:"\\d\\d",fn:function(date,value){setDatePart(date,"Minutes",value,local)}},{pattern:/ss/,regexp:"\\d\\d",fn:function(date,value){setDatePart(date,"Seconds",value,local)}},{pattern:/SSS/,regexp:"\\d\\d\\d",fn:function(date,value){setDatePart(date,"Milliseconds",value,local)}},{pattern:/O/,regexp:"[+-]\\d{1,2}:?\\d{2}?|Z",fn:function(date,value){if(value==="Z"){value=0}else{value=value.replace(":","")}var offset=Math.abs(value);var timezoneOffset=(value>0?-1:1)*(offset%100+Math.floor(offset/100)*60);date.setUTCMinutes(date.getUTCMinutes()+timezoneOffset)}}];var parsedPattern=matchers.reduce((function(p,m){if(m.pattern.test(p.regexp)){m.index=p.regexp.match(m.pattern).index;p.regexp=p.regexp.replace(m.pattern,"("+m.regexp+")")}else{m.index=-1}return p}),{regexp:pattern,index:[]});var dateFns=matchers.filter((function(m){return m.index>-1}));dateFns.sort((function(a,b){return a.index-b.index}));var matcher=new RegExp(parsedPattern.regexp);var matches=matcher.exec(str);if(matches){var date=missingValuesDate||module.exports.now();dateFns.forEach((function(f,i){f.fn(date,matches[i+1])}));return date}throw new Error("String '"+str+"' could not be parsed as '"+pattern+"'")}function parse(pattern,str,missingValuesDate){if(!pattern){throw new Error("pattern must be supplied")}return extractDateParts(pattern,str,missingValuesDate)}function now(){return new Date}module.exports=asString;module.exports.asString=asString;module.exports.parse=parse;module.exports.now=now;module.exports.ISO8601_FORMAT="yyyy-MM-ddThh:mm:ss.SSS";module.exports.ISO8601_WITH_TZ_OFFSET_FORMAT="yyyy-MM-ddThh:mm:ss.SSSO";module.exports.DATETIME_FORMAT="dd MM yyyy hh:mm:ss.SSS";module.exports.ABSOLUTETIME_FORMAT="hh:mm:ss.SSS"},{}],178:[function(require,module,exports){(function(process){(function(){exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage=localstorage();exports.destroy=(()=>{let warned=false;return()=>{if(!warned){warned=true;console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}}})();exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function useColors(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)){return true}if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return false}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function formatArgs(args){args[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+args[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff);if(!this.useColors){return}const c="color: "+this.color;args.splice(1,0,c,"color: inherit");let index=0;let lastC=0;args[0].replace(/%[a-zA-Z%]/g,(match=>{if(match==="%%"){return}index++;if(match==="%c"){lastC=index}}));args.splice(lastC,0,c)}exports.log=console.debug||console.log||(()=>{});function save(namespaces){try{if(namespaces){exports.storage.setItem("debug",namespaces)}else{exports.storage.removeItem("debug")}}catch(error){}}function load(){let r;try{r=exports.storage.getItem("debug")}catch(error){}if(!r&&typeof process!=="undefined"&&"env"in process){r=process.env.DEBUG}return r}function localstorage(){try{return localStorage}catch(error){}}module.exports=require("./common")(exports);const{formatters:formatters}=module.exports;formatters.j=function(v){try{return JSON.stringify(v)}catch(error){return"[UnexpectedJSONParseError]: "+error.message}}}).call(this)}).call(this,require("_process"))},{"./common":179,_process:378}],179:[function(require,module,exports){function setup(env){createDebug.debug=createDebug;createDebug.default=createDebug;createDebug.coerce=coerce;createDebug.disable=disable;createDebug.enable=enable;createDebug.enabled=enabled;createDebug.humanize=require("ms");createDebug.destroy=destroy;Object.keys(env).forEach((key=>{createDebug[key]=env[key]}));createDebug.names=[];createDebug.skips=[];createDebug.formatters={};function selectColor(namespace){let hash=0;for(let i=0;i<namespace.length;i++){hash=(hash<<5)-hash+namespace.charCodeAt(i);hash|=0}return createDebug.colors[Math.abs(hash)%createDebug.colors.length]}createDebug.selectColor=selectColor;function createDebug(namespace){let prevTime;let enableOverride=null;let namespacesCache;let enabledCache;function debug(...args){if(!debug.enabled){return}const self=debug;const curr=Number(new Date);const ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;args[0]=createDebug.coerce(args[0]);if(typeof args[0]!=="string"){args.unshift("%O")}let index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,((match,format)=>{if(match==="%%"){return"%"}index++;const formatter=createDebug.formatters[format];if(typeof formatter==="function"){const val=args[index];match=formatter.call(self,val);args.splice(index,1);index--}return match}));createDebug.formatArgs.call(self,args);const logFn=self.log||createDebug.log;logFn.apply(self,args)}debug.namespace=namespace;debug.useColors=createDebug.useColors();debug.color=createDebug.selectColor(namespace);debug.extend=extend;debug.destroy=createDebug.destroy;Object.defineProperty(debug,"enabled",{enumerable:true,configurable:false,get:()=>{if(enableOverride!==null){return enableOverride}if(namespacesCache!==createDebug.namespaces){namespacesCache=createDebug.namespaces;enabledCache=createDebug.enabled(namespace)}return enabledCache},set:v=>{enableOverride=v}});if(typeof createDebug.init==="function"){createDebug.init(debug)}return debug}function extend(namespace,delimiter){const newDebug=createDebug(this.namespace+(typeof delimiter==="undefined"?":":delimiter)+namespace);newDebug.log=this.log;return newDebug}function enable(namespaces){createDebug.save(namespaces);createDebug.namespaces=namespaces;createDebug.names=[];createDebug.skips=[];let i;const split=(typeof namespaces==="string"?namespaces:"").split(/[\s,]+/);const len=split.length;for(i=0;i<len;i++){if(!split[i]){continue}namespaces=split[i].replace(/\*/g,".*?");if(namespaces[0]==="-"){createDebug.skips.push(new RegExp("^"+namespaces.slice(1)+"$"))}else{createDebug.names.push(new RegExp("^"+namespaces+"$"))}}}function disable(){const namespaces=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map((namespace=>"-"+namespace))].join(",");createDebug.enable("");return namespaces}function enabled(name){if(name[name.length-1]==="*"){return true}let i;let len;for(i=0,len=createDebug.skips.length;i<len;i++){if(createDebug.skips[i].test(name)){return false}}for(i=0,len=createDebug.names.length;i<len;i++){if(createDebug.names[i].test(name)){return true}}return false}function toNamespace(regexp){return regexp.toString().substring(2,regexp.toString().length-2).replace(/\.\*\?$/,"*")}function coerce(val){if(val instanceof Error){return val.stack||val.message}return val}function destroy(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}createDebug.enable(createDebug.load());return createDebug}module.exports=setup},{ms:372}],180:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var $gOPD=GetIntrinsic("%Object.getOwnPropertyDescriptor%",true);if($gOPD){try{$gOPD([],"length")}catch(e){$gOPD=null}}module.exports=$gOPD},{"get-intrinsic":270}],181:[function(require,module,exports){"use strict";var value=require("../../object/valid-value");module.exports=function(){value(this).length=0;return this}},{"../../object/valid-value":233}],182:[function(require,module,exports){"use strict";var numberIsNaN=require("../../number/is-nan"),toPosInt=require("../../number/to-pos-integer"),value=require("../../object/valid-value"),indexOf=Array.prototype.indexOf,objHasOwnProperty=Object.prototype.hasOwnProperty,abs=Math.abs,floor=Math.floor;module.exports=function(searchElement){var i,length,fromIndex,val;if(!numberIsNaN(searchElement))return indexOf.apply(this,arguments);length=toPosInt(value(this).length);fromIndex=arguments[1];if(isNaN(fromIndex))fromIndex=0;else if(fromIndex>=0)fromIndex=floor(fromIndex);else fromIndex=toPosInt(this.length)-floor(abs(fromIndex));for(i=fromIndex;i<length;++i){if(objHasOwnProperty.call(this,i)){val=this[i];if(numberIsNaN(val))return i}}return-1}},{"../../number/is-nan":204,"../../number/to-pos-integer":208,"../../object/valid-value":233}],183:[function(require,module,exports){"use strict";var toPosInt=require("../../number/to-pos-integer"),callable=require("../../object/valid-callable"),value=require("../../object/valid-value"),objHasOwnProperty=Object.prototype.hasOwnProperty,call=Function.prototype.call;module.exports=function(cb){var i,self,thisArg;self=Object(value(this));callable(cb);thisArg=arguments[1];for(i=toPosInt(self.length)-1;i>=0;--i){if(objHasOwnProperty.call(self,i))call.call(cb,thisArg,self[i],i,self)}}},{"../../number/to-pos-integer":208,"../../object/valid-callable":231,"../../object/valid-value":233}],184:[function(require,module,exports){"use strict";var indexOf=require("./e-index-of"),filter=Array.prototype.filter,isFirst;isFirst=function(value,index){return indexOf.call(this,value)===index};module.exports=function(){return filter.call(this,isFirst,this)}},{"./e-index-of":182}],185:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Array.from:require("./shim")},{"./is-implemented":186,"./shim":187}],186:[function(require,module,exports){"use strict";module.exports=function(){var from=Array.from,arr,result;if(typeof from!=="function")return false;arr=["raz","dwa"];result=from(arr);return Boolean(result&&result!==arr&&result[1]==="dwa")}},{}],187:[function(require,module,exports){"use strict";var iteratorSymbol=require("es6-symbol").iterator,isArguments=require("../../function/is-arguments"),isFunction=require("../../function/is-function"),toPosInt=require("../../number/to-pos-integer"),callable=require("../../object/valid-callable"),validValue=require("../../object/valid-value"),isValue=require("../../object/is-value"),isString=require("../../string/is-string"),isArray=Array.isArray,call=Function.prototype.call,desc={configurable:true,enumerable:true,writable:true,value:null},defineProperty=Object.defineProperty;module.exports=function(arrayLike){var mapFn=arguments[1],thisArg=arguments[2],Context,i,j,arr,length,code,iterator,result,getIterator,value;arrayLike=Object(validValue(arrayLike));if(isValue(mapFn))callable(mapFn);if(!this||this===Array||!isFunction(this)){if(!mapFn){if(isArguments(arrayLike)){length=arrayLike.length;if(length!==1)return Array.apply(null,arrayLike);arr=new Array(1);arr[0]=arrayLike[0];return arr}if(isArray(arrayLike)){arr=new Array(length=arrayLike.length);for(i=0;i<length;++i)arr[i]=arrayLike[i];return arr}}arr=[]}else{Context=this}if(!isArray(arrayLike)){if((getIterator=arrayLike[iteratorSymbol])!==undefined){iterator=callable(getIterator).call(arrayLike);if(Context)arr=new Context;result=iterator.next();i=0;while(!result.done){value=mapFn?call.call(mapFn,thisArg,result.value,i):result.value;if(Context){desc.value=value;defineProperty(arr,i,desc)}else{arr[i]=value}result=iterator.next();++i}length=i}else if(isString(arrayLike)){length=arrayLike.length;if(Context)arr=new Context;for(i=0,j=0;i<length;++i){value=arrayLike[i];if(i+1<length){code=value.charCodeAt(0);if(code>=55296&&code<=56319)value+=arrayLike[++i]}value=mapFn?call.call(mapFn,thisArg,value,j):value;if(Context){desc.value=value;defineProperty(arr,j,desc)}else{arr[j]=value}++j}length=j}}if(length===undefined){length=toPosInt(arrayLike.length);if(Context)arr=new Context(length);for(i=0;i<length;++i){value=mapFn?call.call(mapFn,thisArg,arrayLike[i],i):arrayLike[i];if(Context){desc.value=value;defineProperty(arr,i,desc)}else{arr[i]=value}}}if(Context){desc.value=null;arr.length=length}return arr}},{"../../function/is-arguments":193,"../../function/is-function":194,"../../number/to-pos-integer":208,"../../object/is-value":220,"../../object/valid-callable":231,"../../object/valid-value":233,"../../string/is-string":243,"es6-symbol":252}],188:[function(require,module,exports){"use strict";var toPosInt=require("../number/to-pos-integer"),value=require("../object/valid-value"),slice=Array.prototype.slice;module.exports=function(length){var arr,currentLength;length=toPosInt(value(length));if(length===0)return[];arr=arguments.length<2?[undefined]:slice.call(arguments,1,1+length);while((currentLength=arr.length)<length){arr=arr.concat(arr.slice(0,length-currentLength))}return arr}},{"../number/to-pos-integer":208,"../object/valid-value":233}],189:[function(require,module,exports){"use strict";var from=require("./from"),isArray=Array.isArray;module.exports=function(arrayLike){return isArray(arrayLike)?arrayLike:from(arrayLike)}},{"./from":185}],190:[function(require,module,exports){"use strict";var assign=require("../object/assign"),isObject=require("../object/is-object"),isValue=require("../object/is-value"),captureStackTrace=Error.captureStackTrace;module.exports=function(message){var err=new Error(message),code=arguments[1],ext=arguments[2];if(!isValue(ext)){if(isObject(code)){ext=code;code=null}}if(isValue(ext))assign(err,ext);if(isValue(code))err.code=code;if(captureStackTrace)captureStackTrace(err,module.exports);return err}},{"../object/assign":210,"../object/is-object":219,"../object/is-value":220}],191:[function(require,module,exports){"use strict";var isValue=require("../../object/is-value"),callable=require("../../object/valid-callable"),aFrom=require("../../array/from");var apply=Function.prototype.apply,call=Function.prototype.call,callFn=function(arg,fn){return call.call(fn,this,arg)};module.exports=function(fnIgnored){var fns,first;var args=aFrom(arguments);fns=isValue(this)?[this].concat(args):args;fns.forEach(callable);fns=fns.reverse();first=fns[0];fns=fns.slice(1);return function(argIgnored){return fns.reduce(callFn,apply.call(first,this,arguments))}}},{"../../array/from":185,"../../object/is-value":220,"../../object/valid-callable":231}],192:[function(require,module,exports){"use strict";var toPosInt=require("../number/to-pos-integer");var test=function(arg1,arg2){return arg2};var desc,defineProperty,generate,mixin;try{Object.defineProperty(test,"length",{configurable:true,writable:false,enumerable:false,value:1})}catch(ignore){}if(test.length===1){desc={configurable:true,writable:false,enumerable:false};defineProperty=Object.defineProperty;module.exports=function(fn,length){length=toPosInt(length);if(fn.length===length)return fn;desc.value=length;return defineProperty(fn,"length",desc)}}else{mixin=require("../object/mixin");generate=function(){var cache=[];return function(length){var args,i=0;if(cache[length])return cache[length];args=[];while(length--)args.push("a"+(++i).toString(36));return new Function("fn","return function ("+args.join(", ")+") { return fn.apply(this, arguments); };")}}();module.exports=function(src,length){var target;length=toPosInt(length);if(src.length===length)return src;target=generate(length)(src);try{mixin(target,src)}catch(ignore){}return target}}},{"../number/to-pos-integer":208,"../object/mixin":225}],193:[function(require,module,exports){"use strict";var objToString=Object.prototype.toString,id=objToString.call(function(){return arguments}());module.exports=function(value){return objToString.call(value)===id}},{}],194:[function(require,module,exports){"use strict";var objToString=Object.prototype.toString,isFunctionStringTag=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);module.exports=function(value){return typeof value==="function"&&isFunctionStringTag(objToString.call(value))}},{}],195:[function(require,module,exports){"use strict";module.exports=function(){}},{}],196:[function(require,module,exports){"use strict";var iteratorSymbol=require("es6-symbol").iterator,isValue=require("../object/is-value"),isArrayLike=require("../object/is-array-like");module.exports=function(value){if(!isValue(value))return false;if(typeof value[iteratorSymbol]==="function")return true;return isArrayLike(value)}},{"../object/is-array-like":217,"../object/is-value":220,"es6-symbol":252}],197:[function(require,module,exports){"use strict";var isObject=require("../object/is-object"),is=require("./is");module.exports=function(value){if(is(value)&&isObject(value))return value;throw new TypeError(value+" is not an iterable or array-like object")}},{"../object/is-object":219,"./is":196}],198:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Math.sign:require("./shim")},{"./is-implemented":199,"./shim":200}],199:[function(require,module,exports){"use strict";module.exports=function(){var sign=Math.sign;if(typeof sign!=="function")return false;return sign(10)===1&&sign(-20)===-1}},{}],200:[function(require,module,exports){"use strict";module.exports=function(value){value=Number(value);if(isNaN(value)||value===0)return value;return value>0?1:-1}},{}],201:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Math.trunc:require("./shim")},{"./is-implemented":202,"./shim":203}],202:[function(require,module,exports){"use strict";module.exports=function(){var trunc=Math.trunc;if(typeof trunc!=="function")return false;return trunc(13.67)===13&&trunc(-13.67)===-13}},{}],203:[function(require,module,exports){"use strict";var floor=Math.floor;module.exports=function(value){if(isNaN(value))return NaN;value=Number(value);if(value===0)return value;if(value===Infinity)return Infinity;if(value===-Infinity)return-Infinity;if(value>0)return floor(value);return-floor(-value)}},{}],204:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Number.isNaN:require("./shim")},{"./is-implemented":205,"./shim":206}],205:[function(require,module,exports){"use strict";module.exports=function(){var numberIsNaN=Number.isNaN;if(typeof numberIsNaN!=="function")return false;return!numberIsNaN({})&&numberIsNaN(NaN)&&!numberIsNaN(34)}},{}],206:[function(require,module,exports){"use strict";module.exports=function(value){return value!==value}},{}],207:[function(require,module,exports){"use strict";var sign=require("../math/sign"),abs=Math.abs,floor=Math.floor;module.exports=function(value){if(isNaN(value))return 0;value=Number(value);if(value===0||!isFinite(value))return value;return sign(value)*floor(abs(value))}},{"../math/sign":198}],208:[function(require,module,exports){"use strict";var toInteger=require("./to-integer"),max=Math.max;module.exports=function(value){return max(0,toInteger(value))}},{"./to-integer":207}],209:[function(require,module,exports){"use strict";var callable=require("./valid-callable"),value=require("./valid-value"),bind=Function.prototype.bind,call=Function.prototype.call,keys=Object.keys,objPropertyIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=function(method,defVal){return function(obj,cb){var list,thisArg=arguments[2],compareFn=arguments[3];obj=Object(value(obj));callable(cb);list=keys(obj);if(compareFn){list.sort(typeof compareFn==="function"?bind.call(compareFn,obj):undefined)}if(typeof method!=="function")method=list[method];return call.call(method,list,(function(key,index){if(!objPropertyIsEnumerable.call(obj,key))return defVal;return call.call(cb,thisArg,obj[key],key,obj,index)}))}}},{"./valid-callable":231,"./valid-value":233}],210:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Object.assign:require("./shim")},{"./is-implemented":211,"./shim":212}],211:[function(require,module,exports){"use strict";module.exports=function(){var assign=Object.assign,obj;if(typeof assign!=="function")return false;obj={foo:"raz"};assign(obj,{bar:"dwa"},{trzy:"trzy"});return obj.foo+obj.bar+obj.trzy==="razdwatrzy"}},{}],212:[function(require,module,exports){"use strict";var keys=require("../keys"),value=require("../valid-value"),max=Math.max;module.exports=function(dest,src){var error,i,length=max(arguments.length,2),assign;dest=Object(value(dest));assign=function(key){try{dest[key]=src[key]}catch(e){if(!error)error=e}};for(i=1;i<length;++i){src=arguments[i];keys(src).forEach(assign)}if(error!==undefined)throw error;return dest}},{"../keys":221,"../valid-value":233}],213:[function(require,module,exports){"use strict";var aFrom=require("../array/from"),assign=require("./assign"),value=require("./valid-value");module.exports=function(obj){var copy=Object(value(obj)),propertyNames=arguments[1],options=Object(arguments[2]);if(copy!==obj&&!propertyNames)return copy;var result={};if(propertyNames){aFrom(propertyNames,(function(propertyName){if(options.ensure||propertyName in obj)result[propertyName]=obj[propertyName]}))}else{assign(result,obj)}return result}},{"../array/from":185,"./assign":210,"./valid-value":233}],214:[function(require,module,exports){"use strict";var create=Object.create,shim;if(!require("./set-prototype-of/is-implemented")()){shim=require("./set-prototype-of/shim")}module.exports=function(){var nullObject,polyProps,desc;if(!shim)return create;if(shim.level!==1)return create;nullObject={};polyProps={};desc={configurable:false,enumerable:false,writable:true,value:undefined};Object.getOwnPropertyNames(Object.prototype).forEach((function(name){if(name==="__proto__"){polyProps[name]={configurable:true,enumerable:false,writable:true,value:undefined};return}polyProps[name]=desc}));Object.defineProperties(nullObject,polyProps);Object.defineProperty(shim,"nullPolyfill",{configurable:false,enumerable:false,writable:false,value:nullObject});return function(prototype,props){return create(prototype===null?nullObject:prototype,props)}}()},{"./set-prototype-of/is-implemented":229,"./set-prototype-of/shim":230}],215:[function(require,module,exports){"use strict";var value=require("./valid-value"),objPropertyIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=function(obj){var i;value(obj);for(i in obj){if(objPropertyIsEnumerable.call(obj,i))return i}return null}},{"./valid-value":233}],216:[function(require,module,exports){"use strict";module.exports=require("./_iterate")("forEach")},{"./_iterate":209}],217:[function(require,module,exports){"use strict";var isFunction=require("../function/is-function"),isObject=require("./is-object"),isValue=require("./is-value");module.exports=function(value){return isValue(value)&&typeof value.length==="number"&&(isObject(value)&&!isFunction(value)||typeof value==="string")||false}},{"../function/is-function":194,"./is-object":219,"./is-value":220}],218:[function(require,module,exports){"use strict";module.exports=function(obj){return typeof obj==="function"}},{}],219:[function(require,module,exports){"use strict";var isValue=require("./is-value");var map={function:true,object:true};module.exports=function(value){return isValue(value)&&map[typeof value]||false}},{"./is-value":220}],220:[function(require,module,exports){"use strict";var _undefined=require("../function/noop")();module.exports=function(val){return val!==_undefined&&val!==null}},{"../function/noop":195}],221:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Object.keys:require("./shim")},{"./is-implemented":222,"./shim":223}],222:[function(require,module,exports){"use strict";module.exports=function(){try{Object.keys("primitive");return true}catch(e){return false}}},{}],223:[function(require,module,exports){"use strict";var isValue=require("../is-value");var keys=Object.keys;module.exports=function(object){return keys(isValue(object)?Object(object):object)}},{"../is-value":220}],224:[function(require,module,exports){"use strict";var callable=require("./valid-callable"),forEach=require("./for-each"),call=Function.prototype.call;module.exports=function(obj,cb){var result={},thisArg=arguments[2];callable(cb);forEach(obj,(function(value,key,targetObj,index){result[key]=call.call(cb,thisArg,value,key,targetObj,index)}));return result}},{"./for-each":216,"./valid-callable":231}],225:[function(require,module,exports){"use strict";var value=require("./valid-value"),defineProperty=Object.defineProperty,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,getOwnPropertyNames=Object.getOwnPropertyNames,getOwnPropertySymbols=Object.getOwnPropertySymbols;module.exports=function(target,source){var error,sourceObject=Object(value(source));target=Object(value(target));getOwnPropertyNames(sourceObject).forEach((function(name){try{defineProperty(target,name,getOwnPropertyDescriptor(source,name))}catch(e){error=e}}));if(typeof getOwnPropertySymbols==="function"){getOwnPropertySymbols(sourceObject).forEach((function(symbol){try{defineProperty(target,symbol,getOwnPropertyDescriptor(source,symbol))}catch(e){error=e}}))}if(error!==undefined)throw error;return target}},{"./valid-value":233}],226:[function(require,module,exports){"use strict";var isValue=require("./is-value");var forEach=Array.prototype.forEach,create=Object.create;var process=function(src,obj){var key;for(key in src)obj[key]=src[key]};module.exports=function(opts1){var result=create(null);forEach.call(arguments,(function(options){if(!isValue(options))return;process(Object(options),result)}));return result}},{"./is-value":220}],227:[function(require,module,exports){"use strict";var forEach=Array.prototype.forEach,create=Object.create;module.exports=function(arg){var set=create(null);forEach.call(arguments,(function(name){set[name]=true}));return set}},{}],228:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Object.setPrototypeOf:require("./shim")},{"./is-implemented":229,"./shim":230}],229:[function(require,module,exports){"use strict";var create=Object.create,getPrototypeOf=Object.getPrototypeOf,plainObject={};module.exports=function(){var setPrototypeOf=Object.setPrototypeOf,customCreate=arguments[0]||create;if(typeof setPrototypeOf!=="function")return false;return getPrototypeOf(setPrototypeOf(customCreate(null),plainObject))===plainObject}},{}],230:[function(require,module,exports){"use strict";var isObject=require("../is-object"),value=require("../valid-value"),objIsPrototypeOf=Object.prototype.isPrototypeOf,defineProperty=Object.defineProperty,nullDesc={configurable:true,enumerable:false,writable:true,value:undefined},validate;validate=function(obj,prototype){value(obj);if(prototype===null||isObject(prototype))return obj;throw new TypeError("Prototype must be null or an object")};module.exports=function(status){var fn,set;if(!status)return null;if(status.level===2){if(status.set){set=status.set;fn=function(obj,prototype){set.call(validate(obj,prototype),prototype);return obj}}else{fn=function(obj,prototype){validate(obj,prototype).__proto__=prototype;return obj}}}else{fn=function self(obj,prototype){var isNullBase;validate(obj,prototype);isNullBase=objIsPrototypeOf.call(self.nullPolyfill,obj);if(isNullBase)delete self.nullPolyfill.__proto__;if(prototype===null)prototype=self.nullPolyfill;obj.__proto__=prototype;if(isNullBase)defineProperty(self.nullPolyfill,"__proto__",nullDesc);return obj}}return Object.defineProperty(fn,"level",{configurable:false,enumerable:false,writable:false,value:status.level})}(function(){var tmpObj1=Object.create(null),tmpObj2={},set,desc=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(desc){try{set=desc.set;set.call(tmpObj1,tmpObj2)}catch(ignore){}if(Object.getPrototypeOf(tmpObj1)===tmpObj2)return{set:set,level:2}}tmpObj1.__proto__=tmpObj2;if(Object.getPrototypeOf(tmpObj1)===tmpObj2)return{level:2};tmpObj1={};tmpObj1.__proto__=tmpObj2;if(Object.getPrototypeOf(tmpObj1)===tmpObj2)return{level:1};return false}());require("../create")},{"../create":214,"../is-object":219,"../valid-value":233}],231:[function(require,module,exports){"use strict";module.exports=function(fn){if(typeof fn!=="function")throw new TypeError(fn+" is not a function");return fn}},{}],232:[function(require,module,exports){"use strict";var isObject=require("./is-object");module.exports=function(value){if(!isObject(value))throw new TypeError(value+" is not an Object");return value}},{"./is-object":219}],233:[function(require,module,exports){"use strict";var isValue=require("./is-value");module.exports=function(value){if(!isValue(value))throw new TypeError("Cannot use null or undefined");return value}},{"./is-value":220}],234:[function(require,module,exports){"use strict";var ensureValue=require("./valid-value"),stringifiable=require("./validate-stringifiable");module.exports=function(value){return stringifiable(ensureValue(value))}},{"./valid-value":233,"./validate-stringifiable":235}],235:[function(require,module,exports){"use strict";var isCallable=require("./is-callable");module.exports=function(stringifiable){try{if(stringifiable&&isCallable(stringifiable.toString))return stringifiable.toString();return String(stringifiable)}catch(e){throw new TypeError("Passed argument cannot be stringifed")}}},{"./is-callable":218}],236:[function(require,module,exports){"use strict";var isCallable=require("./object/is-callable");module.exports=function(value){try{if(value&&isCallable(value.toString))return value.toString();return String(value)}catch(e){return"<Non-coercible to string value>"}}},{"./object/is-callable":218}],237:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?String.prototype.contains:require("./shim")},{"./is-implemented":238,"./shim":239}],238:[function(require,module,exports){"use strict";var str="razdwatrzy";module.exports=function(){if(typeof str.contains!=="function")return false;return str.contains("dwa")===true&&str.contains("foo")===false}},{}],239:[function(require,module,exports){"use strict";var indexOf=String.prototype.indexOf;module.exports=function(searchString){return indexOf.call(this,searchString,arguments[1])>-1}},{}],240:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?String.prototype.repeat:require("./shim")},{"./is-implemented":241,"./shim":242}],241:[function(require,module,exports){"use strict";var str="foo";module.exports=function(){if(typeof str.repeat!=="function")return false;return str.repeat(2)==="foofoo"}},{}],242:[function(require,module,exports){"use strict";var value=require("../../../object/valid-value"),toInteger=require("../../../number/to-integer");module.exports=function(count){var str=String(value(this)),result;count=toInteger(count);if(count<0)throw new RangeError("Count must be >= 0");if(!isFinite(count))throw new RangeError("Count must be < ∞");result="";while(count){if(count%2)result+=str;if(count>1)str+=str;count>>=1}return result}},{"../../../number/to-integer":207,"../../../object/valid-value":233}],243:[function(require,module,exports){"use strict";var objToString=Object.prototype.toString,id=objToString.call("");module.exports=function(value){return typeof value==="string"||value&&typeof value==="object"&&(value instanceof String||objToString.call(value)===id)||false}},{}],244:[function(require,module,exports){"use strict";var safeToString=require("./safe-to-string");var reNewLine=/[\n\r\u2028\u2029]/g;module.exports=function(value){var string=safeToString(value);if(string.length>100)string=string.slice(0,99)+"…";string=string.replace(reNewLine,(function(char){return JSON.stringify(char).slice(1,-1)}));return string}},{"./safe-to-string":236}],245:[function(require,module,exports){"use strict";var setPrototypeOf=require("es5-ext/object/set-prototype-of"),contains=require("es5-ext/string/#/contains"),d=require("d"),Symbol=require("es6-symbol"),Iterator=require("./");var defineProperty=Object.defineProperty,ArrayIterator;ArrayIterator=module.exports=function(arr,kind){if(!(this instanceof ArrayIterator))throw new TypeError("Constructor requires 'new'");Iterator.call(this,arr);if(!kind)kind="value";else if(contains.call(kind,"key+value"))kind="key+value";else if(contains.call(kind,"key"))kind="key";else kind="value";defineProperty(this,"__kind__",d("",kind))};if(setPrototypeOf)setPrototypeOf(ArrayIterator,Iterator);delete ArrayIterator.prototype.constructor;ArrayIterator.prototype=Object.create(Iterator.prototype,{_resolve:d((function(i){if(this.__kind__==="value")return this.__list__[i];if(this.__kind__==="key+value")return[i,this.__list__[i]];return i}))});defineProperty(ArrayIterator.prototype,Symbol.toStringTag,d("c","Array Iterator"))},{"./":248,d:175,"es5-ext/object/set-prototype-of":228,"es5-ext/string/#/contains":237,"es6-symbol":252}],246:[function(require,module,exports){"use strict";var isArguments=require("es5-ext/function/is-arguments"),callable=require("es5-ext/object/valid-callable"),isString=require("es5-ext/string/is-string"),get=require("./get");var isArray=Array.isArray,call=Function.prototype.call,some=Array.prototype.some;module.exports=function(iterable,cb){var mode,thisArg=arguments[2],result,doBreak,broken,i,length,char,code;if(isArray(iterable)||isArguments(iterable))mode="array";else if(isString(iterable))mode="string";else iterable=get(iterable);callable(cb);doBreak=function(){broken=true};if(mode==="array"){some.call(iterable,(function(value){call.call(cb,thisArg,value,doBreak);return broken}));return}if(mode==="string"){length=iterable.length;for(i=0;i<length;++i){char=iterable[i];if(i+1<length){code=char.charCodeAt(0);if(code>=55296&&code<=56319)char+=iterable[++i]}call.call(cb,thisArg,char,doBreak);if(broken)break}return}result=iterable.next();while(!result.done){call.call(cb,thisArg,result.value,doBreak);if(broken)return;result=iterable.next()}}},{"./get":247,"es5-ext/function/is-arguments":193,"es5-ext/object/valid-callable":231,"es5-ext/string/is-string":243}],247:[function(require,module,exports){"use strict";var isArguments=require("es5-ext/function/is-arguments"),isString=require("es5-ext/string/is-string"),ArrayIterator=require("./array"),StringIterator=require("./string"),iterable=require("./valid-iterable"),iteratorSymbol=require("es6-symbol").iterator;module.exports=function(obj){if(typeof iterable(obj)[iteratorSymbol]==="function")return obj[iteratorSymbol]();if(isArguments(obj))return new ArrayIterator(obj);if(isString(obj))return new StringIterator(obj);return new ArrayIterator(obj)}},{"./array":245,"./string":250,"./valid-iterable":251,"es5-ext/function/is-arguments":193,"es5-ext/string/is-string":243,"es6-symbol":252}],248:[function(require,module,exports){"use strict";var clear=require("es5-ext/array/#/clear"),assign=require("es5-ext/object/assign"),callable=require("es5-ext/object/valid-callable"),value=require("es5-ext/object/valid-value"),d=require("d"),autoBind=require("d/auto-bind"),Symbol=require("es6-symbol");var defineProperty=Object.defineProperty,defineProperties=Object.defineProperties,Iterator;module.exports=Iterator=function(list,context){if(!(this instanceof Iterator))throw new TypeError("Constructor requires 'new'");defineProperties(this,{__list__:d("w",value(list)),__context__:d("w",context),__nextIndex__:d("w",0)});if(!context)return;callable(context.on);context.on("_add",this._onAdd);context.on("_delete",this._onDelete);context.on("_clear",this._onClear)};delete Iterator.prototype.constructor;defineProperties(Iterator.prototype,assign({_next:d((function(){var i;if(!this.__list__)return undefined;if(this.__redo__){i=this.__redo__.shift();if(i!==undefined)return i}if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind();return undefined})),next:d((function(){return this._createResult(this._next())})),_createResult:d((function(i){if(i===undefined)return{done:true,value:undefined};return{done:false,value:this._resolve(i)}})),_resolve:d((function(i){return this.__list__[i]})),_unBind:d((function(){this.__list__=null;delete this.__redo__;if(!this.__context__)return;this.__context__.off("_add",this._onAdd);this.__context__.off("_delete",this._onDelete);this.__context__.off("_clear",this._onClear);this.__context__=null})),toString:d((function(){return"[object "+(this[Symbol.toStringTag]||"Object")+"]"}))},autoBind({_onAdd:d((function(index){if(index>=this.__nextIndex__)return;++this.__nextIndex__;if(!this.__redo__){defineProperty(this,"__redo__",d("c",[index]));return}this.__redo__.forEach((function(redo,i){if(redo>=index)this.__redo__[i]=++redo}),this);this.__redo__.push(index)})),_onDelete:d((function(index){var i;if(index>=this.__nextIndex__)return;--this.__nextIndex__;if(!this.__redo__)return;i=this.__redo__.indexOf(index);if(i!==-1)this.__redo__.splice(i,1);this.__redo__.forEach((function(redo,j){if(redo>index)this.__redo__[j]=--redo}),this)})),_onClear:d((function(){if(this.__redo__)clear.call(this.__redo__);this.__nextIndex__=0}))})));defineProperty(Iterator.prototype,Symbol.iterator,d((function(){return this})))},{d:175,"d/auto-bind":174,"es5-ext/array/#/clear":181,"es5-ext/object/assign":210,"es5-ext/object/valid-callable":231,"es5-ext/object/valid-value":233,"es6-symbol":252}],249:[function(require,module,exports){"use strict";var isArguments=require("es5-ext/function/is-arguments"),isValue=require("es5-ext/object/is-value"),isString=require("es5-ext/string/is-string");var iteratorSymbol=require("es6-symbol").iterator,isArray=Array.isArray;module.exports=function(value){if(!isValue(value))return false;if(isArray(value))return true;if(isString(value))return true;if(isArguments(value))return true;return typeof value[iteratorSymbol]==="function"}},{"es5-ext/function/is-arguments":193,"es5-ext/object/is-value":220,"es5-ext/string/is-string":243,"es6-symbol":252}],250:[function(require,module,exports){"use strict";var setPrototypeOf=require("es5-ext/object/set-prototype-of"),d=require("d"),Symbol=require("es6-symbol"),Iterator=require("./");var defineProperty=Object.defineProperty,StringIterator;StringIterator=module.exports=function(str){if(!(this instanceof StringIterator))throw new TypeError("Constructor requires 'new'");str=String(str);Iterator.call(this,str);defineProperty(this,"__length__",d("",str.length))};if(setPrototypeOf)setPrototypeOf(StringIterator,Iterator);delete StringIterator.prototype.constructor;StringIterator.prototype=Object.create(Iterator.prototype,{_next:d((function(){if(!this.__list__)return undefined;if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind();return undefined})),_resolve:d((function(i){var char=this.__list__[i],code;if(this.__nextIndex__===this.__length__)return char;code=char.charCodeAt(0);if(code>=55296&&code<=56319)return char+this.__list__[this.__nextIndex__++];return char}))});defineProperty(StringIterator.prototype,Symbol.toStringTag,d("c","String Iterator"))},{"./":248,d:175,"es5-ext/object/set-prototype-of":228,"es6-symbol":252}],251:[function(require,module,exports){"use strict";var isIterable=require("./is-iterable");module.exports=function(value){if(!isIterable(value))throw new TypeError(value+" is not iterable");return value}},{"./is-iterable":249}],252:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?require("ext/global-this").Symbol:require("./polyfill")},{"./is-implemented":253,"./polyfill":258,"ext/global-this":263}],253:[function(require,module,exports){"use strict";var global=require("ext/global-this"),validTypes={object:true,symbol:true};module.exports=function(){var Symbol=global.Symbol;var symbol;if(typeof Symbol!=="function")return false;symbol=Symbol("test symbol");try{String(symbol)}catch(e){return false}if(!validTypes[typeof Symbol.iterator])return false;if(!validTypes[typeof Symbol.toPrimitive])return false;if(!validTypes[typeof Symbol.toStringTag])return false;return true}},{"ext/global-this":263}],254:[function(require,module,exports){"use strict";module.exports=function(value){if(!value)return false;if(typeof value==="symbol")return true;if(!value.constructor)return false;if(value.constructor.name!=="Symbol")return false;return value[value.constructor.toStringTag]==="Symbol"}},{}],255:[function(require,module,exports){"use strict";var d=require("d");var create=Object.create,defineProperty=Object.defineProperty,objPrototype=Object.prototype;var created=create(null);module.exports=function(desc){var postfix=0,name,ie11BugWorkaround;while(created[desc+(postfix||"")])++postfix;desc+=postfix||"";created[desc]=true;name="@@"+desc;defineProperty(objPrototype,name,d.gs(null,(function(value){if(ie11BugWorkaround)return;ie11BugWorkaround=true;defineProperty(this,name,d(value));ie11BugWorkaround=false})));return name}},{d:175}],256:[function(require,module,exports){"use strict";var d=require("d"),NativeSymbol=require("ext/global-this").Symbol;module.exports=function(SymbolPolyfill){return Object.defineProperties(SymbolPolyfill,{hasInstance:d("",NativeSymbol&&NativeSymbol.hasInstance||SymbolPolyfill("hasInstance")),isConcatSpreadable:d("",NativeSymbol&&NativeSymbol.isConcatSpreadable||SymbolPolyfill("isConcatSpreadable")),iterator:d("",NativeSymbol&&NativeSymbol.iterator||SymbolPolyfill("iterator")),match:d("",NativeSymbol&&NativeSymbol.match||SymbolPolyfill("match")),replace:d("",NativeSymbol&&NativeSymbol.replace||SymbolPolyfill("replace")),search:d("",NativeSymbol&&NativeSymbol.search||SymbolPolyfill("search")),species:d("",NativeSymbol&&NativeSymbol.species||SymbolPolyfill("species")),split:d("",NativeSymbol&&NativeSymbol.split||SymbolPolyfill("split")),toPrimitive:d("",NativeSymbol&&NativeSymbol.toPrimitive||SymbolPolyfill("toPrimitive")),toStringTag:d("",NativeSymbol&&NativeSymbol.toStringTag||SymbolPolyfill("toStringTag")),unscopables:d("",NativeSymbol&&NativeSymbol.unscopables||SymbolPolyfill("unscopables"))})}},{d:175,"ext/global-this":263}],257:[function(require,module,exports){"use strict";var d=require("d"),validateSymbol=require("../../../validate-symbol");var registry=Object.create(null);module.exports=function(SymbolPolyfill){return Object.defineProperties(SymbolPolyfill,{for:d((function(key){if(registry[key])return registry[key];return registry[key]=SymbolPolyfill(String(key))})),keyFor:d((function(symbol){var key;validateSymbol(symbol);for(key in registry){if(registry[key]===symbol)return key}return undefined}))})}},{"../../../validate-symbol":259,d:175}],258:[function(require,module,exports){"use strict";var d=require("d"),validateSymbol=require("./validate-symbol"),NativeSymbol=require("ext/global-this").Symbol,generateName=require("./lib/private/generate-name"),setupStandardSymbols=require("./lib/private/setup/standard-symbols"),setupSymbolRegistry=require("./lib/private/setup/symbol-registry");var create=Object.create,defineProperties=Object.defineProperties,defineProperty=Object.defineProperty;var SymbolPolyfill,HiddenSymbol,isNativeSafe;if(typeof NativeSymbol==="function"){try{String(NativeSymbol());isNativeSafe=true}catch(ignore){}}else{NativeSymbol=null}HiddenSymbol=function Symbol(description){if(this instanceof HiddenSymbol)throw new TypeError("Symbol is not a constructor");return SymbolPolyfill(description)};module.exports=SymbolPolyfill=function Symbol(description){var symbol;if(this instanceof Symbol)throw new TypeError("Symbol is not a constructor");if(isNativeSafe)return NativeSymbol(description);symbol=create(HiddenSymbol.prototype);description=description===undefined?"":String(description);return defineProperties(symbol,{__description__:d("",description),__name__:d("",generateName(description))})};setupStandardSymbols(SymbolPolyfill);setupSymbolRegistry(SymbolPolyfill);defineProperties(HiddenSymbol.prototype,{constructor:d(SymbolPolyfill),toString:d("",(function(){return this.__name__}))});defineProperties(SymbolPolyfill.prototype,{toString:d((function(){return"Symbol ("+validateSymbol(this).__description__+")"})),valueOf:d((function(){return validateSymbol(this)}))});defineProperty(SymbolPolyfill.prototype,SymbolPolyfill.toPrimitive,d("",(function(){var symbol=validateSymbol(this);if(typeof symbol==="symbol")return symbol;return symbol.toString()})));defineProperty(SymbolPolyfill.prototype,SymbolPolyfill.toStringTag,d("c","Symbol"));defineProperty(HiddenSymbol.prototype,SymbolPolyfill.toStringTag,d("c",SymbolPolyfill.prototype[SymbolPolyfill.toStringTag]));defineProperty(HiddenSymbol.prototype,SymbolPolyfill.toPrimitive,d("c",SymbolPolyfill.prototype[SymbolPolyfill.toPrimitive]))},{"./lib/private/generate-name":255,"./lib/private/setup/standard-symbols":256,"./lib/private/setup/symbol-registry":257,"./validate-symbol":259,d:175,"ext/global-this":263}],259:[function(require,module,exports){"use strict";var isSymbol=require("./is-symbol");module.exports=function(value){if(!isSymbol(value))throw new TypeError(value+" is not a symbol");return value}},{"./is-symbol":254}],260:[function(require,module,exports){"use strict";var d=require("d"),callable=require("es5-ext/object/valid-callable"),apply=Function.prototype.apply,call=Function.prototype.call,create=Object.create,defineProperty=Object.defineProperty,defineProperties=Object.defineProperties,hasOwnProperty=Object.prototype.hasOwnProperty,descriptor={configurable:true,enumerable:false,writable:true},on,once,off,emit,methods,descriptors,base;on=function(type,listener){var data;callable(listener);if(!hasOwnProperty.call(this,"__ee__")){data=descriptor.value=create(null);defineProperty(this,"__ee__",descriptor);descriptor.value=null}else{data=this.__ee__}if(!data[type])data[type]=listener;else if(typeof data[type]==="object")data[type].push(listener);else data[type]=[data[type],listener];return this};once=function(type,listener){var once,self;callable(listener);self=this;on.call(this,type,once=function(){off.call(self,type,once);apply.call(listener,this,arguments)});once.__eeOnceListener__=listener;return this};off=function(type,listener){var data,listeners,candidate,i;callable(listener);if(!hasOwnProperty.call(this,"__ee__"))return this;data=this.__ee__;if(!data[type])return this;listeners=data[type];if(typeof listeners==="object"){for(i=0;candidate=listeners[i];++i){if(candidate===listener||candidate.__eeOnceListener__===listener){if(listeners.length===2)data[type]=listeners[i?0:1];else listeners.splice(i,1)}}}else{if(listeners===listener||listeners.__eeOnceListener__===listener){delete data[type]}}return this};emit=function(type){var i,l,listener,listeners,args;if(!hasOwnProperty.call(this,"__ee__"))return;listeners=this.__ee__[type];if(!listeners)return;if(typeof listeners==="object"){l=arguments.length;args=new Array(l-1);for(i=1;i<l;++i)args[i-1]=arguments[i];listeners=listeners.slice();for(i=0;listener=listeners[i];++i){apply.call(listener,this,args)}}else{switch(arguments.length){case 1:call.call(listeners,this);break;case 2:call.call(listeners,this,arguments[1]);break;case 3:call.call(listeners,this,arguments[1],arguments[2]);break;default:l=arguments.length;args=new Array(l-1);for(i=1;i<l;++i){args[i-1]=arguments[i]}apply.call(listeners,this,args)}}};methods={on:on,once:once,off:off,emit:emit};descriptors={on:d(on),once:d(once),off:d(off),emit:d(emit)};base=defineProperties({},descriptors);module.exports=exports=function(o){return o==null?create(base):defineProperties(Object(o),descriptors)};exports.methods=methods},{d:175,"es5-ext/object/valid-callable":231}],261:[function(require,module,exports){"use strict";var R=typeof Reflect==="object"?Reflect:null;var ReflectApply=R&&typeof R.apply==="function"?R.apply:function ReflectApply(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)};var ReflectOwnKeys;if(R&&typeof R.ownKeys==="function"){ReflectOwnKeys=R.ownKeys}else if(Object.getOwnPropertySymbols){ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}}else{ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target)}}function ProcessEmitWarning(warning){if(console&&console.warn)console.warn(warning)}var NumberIsNaN=Number.isNaN||function NumberIsNaN(value){return value!==value};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter;module.exports.once=once;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=undefined;var defaultMaxListeners=10;function checkListener(listener){if(typeof listener!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:true,get:function(){return defaultMaxListeners},set:function(arg){if(typeof arg!=="number"||arg<0||NumberIsNaN(arg)){throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+".")}defaultMaxListeners=arg}});EventEmitter.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};EventEmitter.prototype.setMaxListeners=function setMaxListeners(n){if(typeof n!=="number"||n<0||NumberIsNaN(n)){throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".")}this._maxListeners=n;return this};function _getMaxListeners(that){if(that._maxListeners===undefined)return EventEmitter.defaultMaxListeners;return that._maxListeners}EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function emit(type){var args=[];for(var i=1;i<arguments.length;i++)args.push(arguments[i]);var doError=type==="error";var events=this._events;if(events!==undefined)doError=doError&&events.error===undefined;else if(!doError)return false;if(doError){var er;if(args.length>0)er=args[0];if(er instanceof Error){throw er}var err=new Error("Unhandled error."+(er?" ("+er.message+")":""));err.context=er;throw err}var handler=events[type];if(handler===undefined)return false;if(typeof handler==="function"){ReflectApply(handler,this,args)}else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)ReflectApply(listeners[i],this,args)}return true};function _addListener(target,type,listener,prepend){var m;var events;var existing;checkListener(listener);events=target._events;if(events===undefined){events=target._events=Object.create(null);target._eventsCount=0}else{if(events.newListener!==undefined){target.emit("newListener",type,listener.listener?listener.listener:listener);events=target._events}existing=events[type]}if(existing===undefined){existing=events[type]=listener;++target._eventsCount}else{if(typeof existing==="function"){existing=events[type]=prepend?[listener,existing]:[existing,listener]}else if(prepend){existing.unshift(listener)}else{existing.push(listener)}m=_getMaxListeners(target);if(m>0&&existing.length>m&&!existing.warned){existing.warned=true;var w=new Error("Possible EventEmitter memory leak detected. "+existing.length+" "+String(type)+" listeners "+"added. Use emitter.setMaxListeners() to "+"increase limit");w.name="MaxListenersExceededWarning";w.emitter=target;w.type=type;w.count=existing.length;ProcessEmitWarning(w)}}return target}EventEmitter.prototype.addListener=function addListener(type,listener){return _addListener(this,type,listener,false)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function prependListener(type,listener){return _addListener(this,type,listener,true)};function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;if(arguments.length===0)return this.listener.call(this.target);return this.listener.apply(this.target,arguments)}}function _onceWrap(target,type,listener){var state={fired:false,wrapFn:undefined,target:target,type:type,listener:listener};var wrapped=onceWrapper.bind(state);wrapped.listener=listener;state.wrapFn=wrapped;return wrapped}EventEmitter.prototype.once=function once(type,listener){checkListener(listener);this.on(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.prependOnceListener=function prependOnceListener(type,listener){checkListener(listener);this.prependListener(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.removeListener=function removeListener(type,listener){var list,events,position,i,originalListener;checkListener(listener);events=this._events;if(events===undefined)return this;list=events[type];if(list===undefined)return this;if(list===listener||list.listener===listener){if(--this._eventsCount===0)this._events=Object.create(null);else{delete events[type];if(events.removeListener)this.emit("removeListener",type,list.listener||listener)}}else if(typeof list!=="function"){position=-1;for(i=list.length-1;i>=0;i--){if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener;position=i;break}}if(position<0)return this;if(position===0)list.shift();else{spliceOne(list,position)}if(list.length===1)events[type]=list[0];if(events.removeListener!==undefined)this.emit("removeListener",type,originalListener||listener)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function removeAllListeners(type){var listeners,events,i;events=this._events;if(events===undefined)return this;if(events.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(events[type]!==undefined){if(--this._eventsCount===0)this._events=Object.create(null);else delete events[type]}return this}if(arguments.length===0){var keys=Object.keys(events);var key;for(i=0;i<keys.length;++i){key=keys[i];if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}listeners=events[type];if(typeof listeners==="function"){this.removeListener(type,listeners)}else if(listeners!==undefined){for(i=listeners.length-1;i>=0;i--){this.removeListener(type,listeners[i])}}return this};function _listeners(target,type,unwrap){var events=target._events;if(events===undefined)return[];var evlistener=events[type];if(evlistener===undefined)return[];if(typeof evlistener==="function")return unwrap?[evlistener.listener||evlistener]:[evlistener];return unwrap?unwrapListeners(evlistener):arrayClone(evlistener,evlistener.length)}EventEmitter.prototype.listeners=function listeners(type){return _listeners(this,type,true)};EventEmitter.prototype.rawListeners=function rawListeners(type){return _listeners(this,type,false)};EventEmitter.listenerCount=function(emitter,type){if(typeof emitter.listenerCount==="function"){return emitter.listenerCount(type)}else{return listenerCount.call(emitter,type)}};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(type){var events=this._events;if(events!==undefined){var evlistener=events[type];if(typeof evlistener==="function"){return 1}else if(evlistener!==undefined){return evlistener.length}}return 0}EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(arr,n){var copy=new Array(n);for(var i=0;i<n;++i)copy[i]=arr[i];return copy}function spliceOne(list,index){for(;index+1<list.length;index++)list[index]=list[index+1];list.pop()}function unwrapListeners(arr){var ret=new Array(arr.length);for(var i=0;i<ret.length;++i){ret[i]=arr[i].listener||arr[i]}return ret}function once(emitter,name){return new Promise((function(resolve,reject){function errorListener(err){emitter.removeListener(name,resolver);reject(err)}function resolver(){if(typeof emitter.removeListener==="function"){emitter.removeListener("error",errorListener)}resolve([].slice.call(arguments))}eventTargetAgnosticAddListener(emitter,name,resolver,{once:true});if(name!=="error"){addErrorHandlerIfEventEmitter(emitter,errorListener,{once:true})}}))}function addErrorHandlerIfEventEmitter(emitter,handler,flags){if(typeof emitter.on==="function"){eventTargetAgnosticAddListener(emitter,"error",handler,flags)}}function eventTargetAgnosticAddListener(emitter,name,listener,flags){if(typeof emitter.on==="function"){if(flags.once){emitter.once(name,listener)}else{emitter.on(name,listener)}}else if(typeof emitter.addEventListener==="function"){emitter.addEventListener(name,(function wrapListener(arg){if(flags.once){emitter.removeEventListener(name,wrapListener)}listener(arg)}))}else{throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof emitter)}}},{}],262:[function(require,module,exports){var naiveFallback=function(){if(typeof self==="object"&&self)return self;if(typeof window==="object"&&window)return window;throw new Error("Unable to resolve global `this`")};module.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:true})}catch(error){return naiveFallback()}try{if(!__global__)return naiveFallback();return __global__}finally{delete Object.prototype.__global__}}()},{}],263:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?globalThis:require("./implementation")},{"./implementation":262,"./is-implemented":264}],264:[function(require,module,exports){"use strict";module.exports=function(){if(typeof globalThis!=="object")return false;if(!globalThis)return false;return globalThis.Array===Array}},{}],265:[function(require,module,exports){"use strict";var hasOwn=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var defineProperty=Object.defineProperty;var gOPD=Object.getOwnPropertyDescriptor;var isArray=function isArray(arr){if(typeof Array.isArray==="function"){return Array.isArray(arr)}return toStr.call(arr)==="[object Array]"};var isPlainObject=function isPlainObject(obj){if(!obj||toStr.call(obj)!=="[object Object]"){return false}var hasOwnConstructor=hasOwn.call(obj,"constructor");var hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf){return false}var key;for(key in obj){}return typeof key==="undefined"||hasOwn.call(obj,key)};var setProperty=function setProperty(target,options){if(defineProperty&&options.name==="__proto__"){defineProperty(target,options.name,{enumerable:true,configurable:true,value:options.newValue,writable:true})}else{target[options.name]=options.newValue}};var getProperty=function getProperty(obj,name){if(name==="__proto__"){if(!hasOwn.call(obj,name)){return void 0}else if(gOPD){return gOPD(obj,name).value}}return obj[name]};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone;var target=arguments[0];var i=1;var length=arguments.length;var deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(target==null||typeof target!=="object"&&typeof target!=="function"){target={}}for(;i<length;++i){options=arguments[i];if(options!=null){for(name in options){src=getProperty(target,name);copy=getProperty(options,name);if(target!==copy){if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}setProperty(target,{name:name,newValue:extend(deep,clone,copy)})}else if(typeof copy!=="undefined"){setProperty(target,{name:name,newValue:copy})}}}}}return target}},{}],266:[function(require,module,exports){"use strict";module.exports=function equal(a,b){if(a===b)return true;if(a&&b&&typeof a=="object"&&typeof b=="object"){if(a.constructor!==b.constructor)return false;var length,i,keys;if(Array.isArray(a)){length=a.length;if(length!=b.length)return false;for(i=length;i--!==0;)if(!equal(a[i],b[i]))return false;return true}if(a.constructor===RegExp)return a.source===b.source&&a.flags===b.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===b.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===b.toString();keys=Object.keys(a);length=keys.length;if(length!==Object.keys(b).length)return false;for(i=length;i--!==0;)if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return false;for(i=length;i--!==0;){var key=keys[i];if(!equal(a[key],b[key]))return false}return true}return a!==a&&b!==b}},{}],267:[function(require,module,exports){"use strict";var isCallable=require("is-callable");var toStr=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;var forEachArray=function forEachArray(array,iterator,receiver){for(var i=0,len=array.length;i<len;i++){if(hasOwnProperty.call(array,i)){if(receiver==null){iterator(array[i],i,array)}else{iterator.call(receiver,array[i],i,array)}}}};var forEachString=function forEachString(string,iterator,receiver){for(var i=0,len=string.length;i<len;i++){if(receiver==null){iterator(string.charAt(i),i,string)}else{iterator.call(receiver,string.charAt(i),i,string)}}};var forEachObject=function forEachObject(object,iterator,receiver){for(var k in object){if(hasOwnProperty.call(object,k)){if(receiver==null){iterator(object[k],k,object)}else{iterator.call(receiver,object[k],k,object)}}}};var forEach=function forEach(list,iterator,thisArg){if(!isCallable(iterator)){throw new TypeError("iterator must be a function")}var receiver;if(arguments.length>=3){receiver=thisArg}if(toStr.call(list)==="[object Array]"){forEachArray(list,iterator,receiver)}else if(typeof list==="string"){forEachString(list,iterator,receiver)}else{forEachObject(list,iterator,receiver)}};module.exports=forEach},{"is-callable":282}],268:[function(require,module,exports){"use strict";var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var slice=Array.prototype.slice;var toStr=Object.prototype.toString;var funcType="[object Function]";module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.call(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target)}var args=slice.call(arguments,1);var bound;var binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));if(Object(result)===result){return result}return this}else{return target.apply(that,args.concat(slice.call(arguments)))}};var boundLength=Math.max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs.push("$"+i)}bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty;Empty.prototype=null}return bound}},{}],269:[function(require,module,exports){"use strict";var implementation=require("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":268}],270:[function(require,module,exports){"use strict";var undefined;var $SyntaxError=SyntaxError;var $Function=Function;var $TypeError=TypeError;var getEvalledConstructor=function(expressionSyntax){try{return $Function('"use strict"; return ('+expressionSyntax+").constructor;")()}catch(e){}};var $gOPD=Object.getOwnPropertyDescriptor;if($gOPD){try{$gOPD({},"")}catch(e){$gOPD=null}}var throwTypeError=function(){throw new $TypeError};var ThrowTypeError=$gOPD?function(){try{arguments.callee;return throwTypeError}catch(calleeThrows){try{return $gOPD(arguments,"callee").get}catch(gOPDthrows){return throwTypeError}}}():throwTypeError;var hasSymbols=require("has-symbols")();var getProto=Object.getPrototypeOf||function(x){return x.__proto__};var needsEval={};var TypedArray=typeof Uint8Array==="undefined"?undefined:getProto(Uint8Array);var INTRINSICS={"%AggregateError%":typeof AggregateError==="undefined"?undefined:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer==="undefined"?undefined:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols?getProto([][Symbol.iterator]()):undefined,"%AsyncFromSyncIteratorPrototype%":undefined,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics==="undefined"?undefined:Atomics,"%BigInt%":typeof BigInt==="undefined"?undefined:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView==="undefined"?undefined:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array==="undefined"?undefined:Float32Array,"%Float64Array%":typeof Float64Array==="undefined"?undefined:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry==="undefined"?undefined:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array==="undefined"?undefined:Int8Array,"%Int16Array%":typeof Int16Array==="undefined"?undefined:Int16Array,"%Int32Array%":typeof Int32Array==="undefined"?undefined:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols?getProto(getProto([][Symbol.iterator]())):undefined,"%JSON%":typeof JSON==="object"?JSON:undefined,"%Map%":typeof Map==="undefined"?undefined:Map,"%MapIteratorPrototype%":typeof Map==="undefined"||!hasSymbols?undefined:getProto((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise==="undefined"?undefined:Promise,"%Proxy%":typeof Proxy==="undefined"?undefined:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect==="undefined"?undefined:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set==="undefined"?undefined:Set,"%SetIteratorPrototype%":typeof Set==="undefined"||!hasSymbols?undefined:getProto((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer==="undefined"?undefined:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols?getProto(""[Symbol.iterator]()):undefined,"%Symbol%":hasSymbols?Symbol:undefined,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":typeof Uint8Array==="undefined"?undefined:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray==="undefined"?undefined:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array==="undefined"?undefined:Uint16Array,"%Uint32Array%":typeof Uint32Array==="undefined"?undefined:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap==="undefined"?undefined:WeakMap,"%WeakRef%":typeof WeakRef==="undefined"?undefined:WeakRef,"%WeakSet%":typeof WeakSet==="undefined"?undefined:WeakSet};var doEval=function doEval(name){var value;if(name==="%AsyncFunction%"){value=getEvalledConstructor("async function () {}")}else if(name==="%GeneratorFunction%"){value=getEvalledConstructor("function* () {}")}else if(name==="%AsyncGeneratorFunction%"){value=getEvalledConstructor("async function* () {}")}else if(name==="%AsyncGenerator%"){var fn=doEval("%AsyncGeneratorFunction%");if(fn){value=fn.prototype}}else if(name==="%AsyncIteratorPrototype%"){var gen=doEval("%AsyncGenerator%");if(gen){value=getProto(gen.prototype)}}INTRINSICS[name]=value;return value};var LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]};var bind=require("function-bind");var hasOwn=require("has");var $concat=bind.call(Function.call,Array.prototype.concat);var $spliceApply=bind.call(Function.apply,Array.prototype.splice);var $replace=bind.call(Function.call,String.prototype.replace);var $strSlice=bind.call(Function.call,String.prototype.slice);var $exec=bind.call(Function.call,RegExp.prototype.exec);var rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=function stringToPath(string){var first=$strSlice(string,0,1);var last=$strSlice(string,-1);if(first==="%"&&last!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`")}else if(last==="%"&&first!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`")}var result=[];$replace(string,rePropName,(function(match,number,quote,subString){result[result.length]=quote?$replace(subString,reEscapeChar,"$1"):number||match}));return result};var getBaseIntrinsic=function getBaseIntrinsic(name,allowMissing){var intrinsicName=name;var alias;if(hasOwn(LEGACY_ALIASES,intrinsicName)){alias=LEGACY_ALIASES[intrinsicName];intrinsicName="%"+alias[0]+"%"}if(hasOwn(INTRINSICS,intrinsicName)){var value=INTRINSICS[intrinsicName];if(value===needsEval){value=doEval(intrinsicName)}if(typeof value==="undefined"&&!allowMissing){throw new $TypeError("intrinsic "+name+" exists, but is not available. Please file an issue!")}return{alias:alias,name:intrinsicName,value:value}}throw new $SyntaxError("intrinsic "+name+" does not exist!")};module.exports=function GetIntrinsic(name,allowMissing){if(typeof name!=="string"||name.length===0){throw new $TypeError("intrinsic name must be a non-empty string")}if(arguments.length>1&&typeof allowMissing!=="boolean"){throw new $TypeError('"allowMissing" argument must be a boolean')}if($exec(/^%?[^%]*%?$/g,name)===null){throw new $SyntaxError("`%` may not be present anywhere but at the beginning and end of the intrinsic name")}var parts=stringToPath(name);var intrinsicBaseName=parts.length>0?parts[0]:"";var intrinsic=getBaseIntrinsic("%"+intrinsicBaseName+"%",allowMissing);var intrinsicRealName=intrinsic.name;var value=intrinsic.value;var skipFurtherCaching=false;var alias=intrinsic.alias;if(alias){intrinsicBaseName=alias[0];$spliceApply(parts,$concat([0,1],alias))}for(var i=1,isOwn=true;i<parts.length;i+=1){var part=parts[i];var first=$strSlice(part,0,1);var last=$strSlice(part,-1);if((first==='"'||first==="'"||first==="`"||(last==='"'||last==="'"||last==="`"))&&first!==last){throw new $SyntaxError("property names with quotes must have matching quotes")}if(part==="constructor"||!isOwn){skipFurtherCaching=true}intrinsicBaseName+="."+part;intrinsicRealName="%"+intrinsicBaseName+"%";if(hasOwn(INTRINSICS,intrinsicRealName)){value=INTRINSICS[intrinsicRealName]}else if(value!=null){if(!(part in value)){if(!allowMissing){throw new $TypeError("base intrinsic for "+name+" exists, but the property is not available.")}return void undefined}if($gOPD&&i+1>=parts.length){var desc=$gOPD(value,part);isOwn=!!desc;if(isOwn&&"get"in desc&&!("originalValue"in desc.get)){value=desc.get}else{value=value[part]}}else{isOwn=hasOwn(value,part);value=value[part]}if(isOwn&&!skipFurtherCaching){INTRINSICS[intrinsicRealName]=value}}}return value}},{"function-bind":269,has:274,"has-symbols":271}],271:[function(require,module,exports){"use strict";var origSymbol=typeof Symbol!=="undefined"&&Symbol;var hasSymbolSham=require("./shams");module.exports=function hasNativeSymbols(){if(typeof origSymbol!=="function"){return false}if(typeof Symbol!=="function"){return false}if(typeof origSymbol("foo")!=="symbol"){return false}if(typeof Symbol("bar")!=="symbol"){return false}return hasSymbolSham()}},{"./shams":272}],272:[function(require,module,exports){"use strict";module.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(typeof Symbol.iterator==="symbol"){return true}var obj={};var sym=Symbol("test");var symObj=Object(sym);if(typeof sym==="string"){return false}if(Object.prototype.toString.call(sym)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(symObj)!=="[object Symbol]"){return false}var symVal=42;obj[sym]=symVal;for(sym in obj){return false}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false}}return true}},{}],273:[function(require,module,exports){"use strict";var hasSymbols=require("has-symbols/shams");module.exports=function hasToStringTagShams(){return hasSymbols()&&!!Symbol.toStringTag}},{"has-symbols/shams":272}],274:[function(require,module,exports){"use strict";var bind=require("function-bind");module.exports=bind.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":269}],275:[function(require,module,exports){module.exports=require("./lib/heap")},{"./lib/heap":276}],276:[function(require,module,exports){(function(){var Heap,defaultCmp,floor,heapify,heappop,heappush,heappushpop,heapreplace,insort,min,nlargest,nsmallest,updateItem,_siftdown,_siftup;floor=Math.floor,min=Math.min;defaultCmp=function(x,y){if(x<y){return-1}if(x>y){return 1}return 0};insort=function(a,x,lo,hi,cmp){var mid;if(lo==null){lo=0}if(cmp==null){cmp=defaultCmp}if(lo<0){throw new Error("lo must be non-negative")}if(hi==null){hi=a.length}while(lo<hi){mid=floor((lo+hi)/2);if(cmp(x,a[mid])<0){hi=mid}else{lo=mid+1}}return[].splice.apply(a,[lo,lo-lo].concat(x)),x};heappush=function(array,item,cmp){if(cmp==null){cmp=defaultCmp}array.push(item);return _siftdown(array,0,array.length-1,cmp)};heappop=function(array,cmp){var lastelt,returnitem;if(cmp==null){cmp=defaultCmp}lastelt=array.pop();if(array.length){returnitem=array[0];array[0]=lastelt;_siftup(array,0,cmp)}else{returnitem=lastelt}return returnitem};heapreplace=function(array,item,cmp){var returnitem;if(cmp==null){cmp=defaultCmp}returnitem=array[0];array[0]=item;_siftup(array,0,cmp);return returnitem};heappushpop=function(array,item,cmp){var _ref;if(cmp==null){cmp=defaultCmp}if(array.length&&cmp(array[0],item)<0){_ref=[array[0],item],item=_ref[0],array[0]=_ref[1];_siftup(array,0,cmp)}return item};heapify=function(array,cmp){var i,_i,_j,_len,_ref,_ref1,_results,_results1;if(cmp==null){cmp=defaultCmp}_ref1=function(){_results1=[];for(var _j=0,_ref=floor(array.length/2);0<=_ref?_j<_ref:_j>_ref;0<=_ref?_j++:_j--){_results1.push(_j)}return _results1}.apply(this).reverse();_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){i=_ref1[_i];_results.push(_siftup(array,i,cmp))}return _results};updateItem=function(array,item,cmp){var pos;if(cmp==null){cmp=defaultCmp}pos=array.indexOf(item);if(pos===-1){return}_siftdown(array,0,pos,cmp);return _siftup(array,pos,cmp)};nlargest=function(array,n,cmp){var elem,result,_i,_len,_ref;if(cmp==null){cmp=defaultCmp}result=array.slice(0,n);if(!result.length){return result}heapify(result,cmp);_ref=array.slice(n);for(_i=0,_len=_ref.length;_i<_len;_i++){elem=_ref[_i];heappushpop(result,elem,cmp)}return result.sort(cmp).reverse()};nsmallest=function(array,n,cmp){var elem,i,los,result,_i,_j,_len,_ref,_ref1,_results;if(cmp==null){cmp=defaultCmp}if(n*10<=array.length){result=array.slice(0,n).sort(cmp);if(!result.length){return result}los=result[result.length-1];_ref=array.slice(n);for(_i=0,_len=_ref.length;_i<_len;_i++){elem=_ref[_i];if(cmp(elem,los)<0){insort(result,elem,0,null,cmp);result.pop();los=result[result.length-1]}}return result}heapify(array,cmp);_results=[];for(i=_j=0,_ref1=min(n,array.length);0<=_ref1?_j<_ref1:_j>_ref1;i=0<=_ref1?++_j:--_j){_results.push(heappop(array,cmp))}return _results};_siftdown=function(array,startpos,pos,cmp){var newitem,parent,parentpos;if(cmp==null){cmp=defaultCmp}newitem=array[pos];while(pos>startpos){parentpos=pos-1>>1;parent=array[parentpos];if(cmp(newitem,parent)<0){array[pos]=parent;pos=parentpos;continue}break}return array[pos]=newitem};_siftup=function(array,pos,cmp){var childpos,endpos,newitem,rightpos,startpos;if(cmp==null){cmp=defaultCmp}endpos=array.length;startpos=pos;newitem=array[pos];childpos=2*pos+1;while(childpos<endpos){rightpos=childpos+1;if(rightpos<endpos&&!(cmp(array[childpos],array[rightpos])<0)){childpos=rightpos}array[pos]=array[childpos];pos=childpos;childpos=2*pos+1}array[pos]=newitem;return _siftdown(array,startpos,pos,cmp)};Heap=function(){Heap.push=heappush;Heap.pop=heappop;Heap.replace=heapreplace;Heap.pushpop=heappushpop;Heap.heapify=heapify;Heap.updateItem=updateItem;Heap.nlargest=nlargest;Heap.nsmallest=nsmallest;function Heap(cmp){this.cmp=cmp!=null?cmp:defaultCmp;this.nodes=[]}Heap.prototype.push=function(x){return heappush(this.nodes,x,this.cmp)};Heap.prototype.pop=function(){return heappop(this.nodes,this.cmp)};Heap.prototype.peek=function(){return this.nodes[0]};Heap.prototype.contains=function(x){return this.nodes.indexOf(x)!==-1};Heap.prototype.replace=function(x){return heapreplace(this.nodes,x,this.cmp)};Heap.prototype.pushpop=function(x){return heappushpop(this.nodes,x,this.cmp)};Heap.prototype.heapify=function(){return heapify(this.nodes,this.cmp)};Heap.prototype.updateItem=function(x){return updateItem(this.nodes,x,this.cmp)};Heap.prototype.clear=function(){return this.nodes=[]};Heap.prototype.empty=function(){return this.nodes.length===0};Heap.prototype.size=function(){return this.nodes.length};Heap.prototype.clone=function(){var heap;heap=new Heap;heap.nodes=this.nodes.slice(0);return heap};Heap.prototype.toArray=function(){return this.nodes.slice(0)};Heap.prototype.insert=Heap.prototype.push;Heap.prototype.top=Heap.prototype.peek;Heap.prototype.front=Heap.prototype.peek;Heap.prototype.has=Heap.prototype.contains;Heap.prototype.copy=Heap.prototype.clone;return Heap}();(function(root,factory){if(typeof define==="function"&&define.amd){return define([],factory)}else if(typeof exports==="object"){return module.exports=factory()}else{return root.Heap=factory()}})(this,(function(){return Heap}))}).call(this)},{}],277:[function(require,module,exports){var http=require("http");var url=require("url");var https=module.exports;for(var key in http){if(http.hasOwnProperty(key))https[key]=http[key]}https.request=function(params,cb){params=validateParams(params);return http.request.call(this,params,cb)};https.get=function(params,cb){params=validateParams(params);return http.get.call(this,params,cb)};function validateParams(params){if(typeof params==="string"){params=url.parse(params)}if(!params.protocol){params.protocol="https:"}if(params.protocol!=="https:"){throw new Error('Protocol "'+params.protocol+'" not supported. Expected "https:"')}return params}},{http:401,url:437}],278:[function(require,module,exports){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],279:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}}else{module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}}},{}],280:[function(require,module,exports){"use strict";module.exports=url=>{if(typeof url!=="string"){throw new TypeError(`Expected a \`string\`, got \`${typeof url}\``)}if(/^[a-zA-Z]:\\/.test(url)){return false}return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(url)}},{}],281:[function(require,module,exports){"use strict";var hasToStringTag=require("has-tostringtag/shams")();var callBound=require("call-bind/callBound");var $toString=callBound("Object.prototype.toString");var isStandardArguments=function isArguments(value){if(hasToStringTag&&value&&typeof value==="object"&&Symbol.toStringTag in value){return false}return $toString(value)==="[object Arguments]"};var isLegacyArguments=function isArguments(value){if(isStandardArguments(value)){return true}return value!==null&&typeof value==="object"&&typeof value.length==="number"&&value.length>=0&&$toString(value)!=="[object Array]"&&$toString(value.callee)==="[object Function]"};var supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments;module.exports=supportsStandardArguments?isStandardArguments:isLegacyArguments},{"call-bind/callBound":153,"has-tostringtag/shams":273}],282:[function(require,module,exports){"use strict";var fnToStr=Function.prototype.toString;var reflectApply=typeof Reflect==="object"&&Reflect!==null&&Reflect.apply;var badArrayLike;var isCallableMarker;if(typeof reflectApply==="function"&&typeof Object.defineProperty==="function"){try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}});isCallableMarker={};reflectApply((function(){throw 42}),null,badArrayLike)}catch(_){if(_!==isCallableMarker){reflectApply=null}}}else{reflectApply=null}var constructorRegex=/^\s*class\b/;var isES6ClassFn=function isES6ClassFunction(value){try{var fnStr=fnToStr.call(value);return constructorRegex.test(fnStr)}catch(e){return false}};var tryFunctionObject=function tryFunctionToStr(value){try{if(isES6ClassFn(value)){return false}fnToStr.call(value);return true}catch(e){return false}};var toStr=Object.prototype.toString;var fnClass="[object Function]";var genClass="[object GeneratorFunction]";var hasToStringTag=typeof Symbol==="function"&&!!Symbol.toStringTag;var documentDotAll=typeof document==="object"&&typeof document.all==="undefined"&&document.all!==undefined?document.all:{};module.exports=reflectApply?function isCallable(value){if(value===documentDotAll){return true}if(!value){return false}if(typeof value!=="function"&&typeof value!=="object"){return false}if(typeof value==="function"&&!value.prototype){return true}try{reflectApply(value,null,badArrayLike)}catch(e){if(e!==isCallableMarker){return false}}return!isES6ClassFn(value)}:function isCallable(value){if(value===documentDotAll){return true}if(!value){return false}if(typeof value!=="function"&&typeof value!=="object"){return false}if(typeof value==="function"&&!value.prototype){return true}if(hasToStringTag){return tryFunctionObject(value)}if(isES6ClassFn(value)){return false}var strClass=toStr.call(value);return strClass===fnClass||strClass===genClass}},{}],283:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;var fnToStr=Function.prototype.toString;var isFnRegex=/^\s*(?:function)?\*/;var hasToStringTag=require("has-tostringtag/shams")();var getProto=Object.getPrototypeOf;var getGeneratorFunc=function(){if(!hasToStringTag){return false}try{return Function("return function*() {}")()}catch(e){}};var GeneratorFunction;module.exports=function isGeneratorFunction(fn){if(typeof fn!=="function"){return false}if(isFnRegex.test(fnToStr.call(fn))){return true}if(!hasToStringTag){var str=toStr.call(fn);return str==="[object GeneratorFunction]"}if(!getProto){return false}if(typeof GeneratorFunction==="undefined"){var generatorFunc=getGeneratorFunc();GeneratorFunction=generatorFunc?getProto(generatorFunc):false}return getProto(fn)===GeneratorFunction}},{"has-tostringtag/shams":273}],284:[function(require,module,exports){module.exports=isPromise;module.exports.default=isPromise;function isPromise(obj){return!!obj&&(typeof obj==="object"||typeof obj==="function")&&typeof obj.then==="function"}},{}],285:[function(require,module,exports){(function(global){(function(){"use strict";var forEach=require("for-each");var availableTypedArrays=require("available-typed-arrays");var callBound=require("call-bind/callBound");var $toString=callBound("Object.prototype.toString");var hasToStringTag=require("has-tostringtag/shams")();var g=typeof globalThis==="undefined"?global:globalThis;var typedArrays=availableTypedArrays();var $indexOf=callBound("Array.prototype.indexOf",true)||function indexOf(array,value){for(var i=0;i<array.length;i+=1){if(array[i]===value){return i}}return-1};var $slice=callBound("String.prototype.slice");var toStrTags={};var gOPD=require("es-abstract/helpers/getOwnPropertyDescriptor");var getPrototypeOf=Object.getPrototypeOf;if(hasToStringTag&&gOPD&&getPrototypeOf){forEach(typedArrays,(function(typedArray){var arr=new g[typedArray];if(Symbol.toStringTag in arr){var proto=getPrototypeOf(arr);var descriptor=gOPD(proto,Symbol.toStringTag);if(!descriptor){var superProto=getPrototypeOf(proto);descriptor=gOPD(superProto,Symbol.toStringTag)}toStrTags[typedArray]=descriptor.get}}))}var tryTypedArrays=function tryAllTypedArrays(value){var anyTrue=false;forEach(toStrTags,(function(getter,typedArray){if(!anyTrue){try{anyTrue=getter.call(value)===typedArray}catch(e){}}}));return anyTrue};module.exports=function isTypedArray(value){if(!value||typeof value!=="object"){return false}if(!hasToStringTag||!(Symbol.toStringTag in value)){var tag=$slice($toString(value),8,-1);return $indexOf(typedArrays,tag)>-1}if(!gOPD){return false}return tryTypedArrays(value)}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"available-typed-arrays":145,"call-bind/callBound":153,"es-abstract/helpers/getOwnPropertyDescriptor":180,"for-each":267,"has-tostringtag/shams":273}],286:[function(require,module,exports){"use strict";var loader=require("./lib/loader");var dumper=require("./lib/dumper");function renamed(from,to){return function(){throw new Error("Function yaml."+from+" is removed in js-yaml 4. "+"Use yaml."+to+" instead, which is now safe by default.")}}module.exports.Type=require("./lib/type");module.exports.Schema=require("./lib/schema");module.exports.FAILSAFE_SCHEMA=require("./lib/schema/failsafe");module.exports.JSON_SCHEMA=require("./lib/schema/json");module.exports.CORE_SCHEMA=require("./lib/schema/core");module.exports.DEFAULT_SCHEMA=require("./lib/schema/default");module.exports.load=loader.load;module.exports.loadAll=loader.loadAll;module.exports.dump=dumper.dump;module.exports.YAMLException=require("./lib/exception");module.exports.types={binary:require("./lib/type/binary"),float:require("./lib/type/float"),map:require("./lib/type/map"),null:require("./lib/type/null"),pairs:require("./lib/type/pairs"),set:require("./lib/type/set"),timestamp:require("./lib/type/timestamp"),bool:require("./lib/type/bool"),int:require("./lib/type/int"),merge:require("./lib/type/merge"),omap:require("./lib/type/omap"),seq:require("./lib/type/seq"),str:require("./lib/type/str")};module.exports.safeLoad=renamed("safeLoad","load");module.exports.safeLoadAll=renamed("safeLoadAll","loadAll");module.exports.safeDump=renamed("safeDump","dump")},{"./lib/dumper":288,"./lib/exception":289,"./lib/loader":290,"./lib/schema":291,"./lib/schema/core":292,"./lib/schema/default":293,"./lib/schema/failsafe":294,"./lib/schema/json":295,"./lib/type":297,"./lib/type/binary":298,"./lib/type/bool":299,"./lib/type/float":300,"./lib/type/int":301,"./lib/type/map":302,"./lib/type/merge":303,"./lib/type/null":304,"./lib/type/omap":305,"./lib/type/pairs":306,"./lib/type/seq":307,"./lib/type/set":308,"./lib/type/str":309,"./lib/type/timestamp":310}],287:[function(require,module,exports){"use strict";function isNothing(subject){return typeof subject==="undefined"||subject===null}function isObject(subject){return typeof subject==="object"&&subject!==null}function toArray(sequence){if(Array.isArray(sequence))return sequence;else if(isNothing(sequence))return[];return[sequence]}function extend(target,source){var index,length,key,sourceKeys;if(source){sourceKeys=Object.keys(source);for(index=0,length=sourceKeys.length;index<length;index+=1){key=sourceKeys[index];target[key]=source[key]}}return target}function repeat(string,count){var result="",cycle;for(cycle=0;cycle<count;cycle+=1){result+=string}return result}function isNegativeZero(number){return number===0&&Number.NEGATIVE_INFINITY===1/number}module.exports.isNothing=isNothing;module.exports.isObject=isObject;module.exports.toArray=toArray;module.exports.repeat=repeat;module.exports.isNegativeZero=isNegativeZero;module.exports.extend=extend},{}],288:[function(require,module,exports){"use strict";var common=require("./common");var YAMLException=require("./exception");var DEFAULT_SCHEMA=require("./schema/default");var _toString=Object.prototype.toString;var _hasOwnProperty=Object.prototype.hasOwnProperty;var CHAR_BOM=65279;var CHAR_TAB=9;var CHAR_LINE_FEED=10;var CHAR_CARRIAGE_RETURN=13;var CHAR_SPACE=32;var CHAR_EXCLAMATION=33;var CHAR_DOUBLE_QUOTE=34;var CHAR_SHARP=35;var CHAR_PERCENT=37;var CHAR_AMPERSAND=38;var CHAR_SINGLE_QUOTE=39;var CHAR_ASTERISK=42;var CHAR_COMMA=44;var CHAR_MINUS=45;var CHAR_COLON=58;var CHAR_EQUALS=61;var CHAR_GREATER_THAN=62;var CHAR_QUESTION=63;var CHAR_COMMERCIAL_AT=64;var CHAR_LEFT_SQUARE_BRACKET=91;var CHAR_RIGHT_SQUARE_BRACKET=93;var CHAR_GRAVE_ACCENT=96;var CHAR_LEFT_CURLY_BRACKET=123;var CHAR_VERTICAL_LINE=124;var CHAR_RIGHT_CURLY_BRACKET=125;var ESCAPE_SEQUENCES={};ESCAPE_SEQUENCES[0]="\\0";ESCAPE_SEQUENCES[7]="\\a";ESCAPE_SEQUENCES[8]="\\b";ESCAPE_SEQUENCES[9]="\\t";ESCAPE_SEQUENCES[10]="\\n";ESCAPE_SEQUENCES[11]="\\v";ESCAPE_SEQUENCES[12]="\\f";ESCAPE_SEQUENCES[13]="\\r";ESCAPE_SEQUENCES[27]="\\e";ESCAPE_SEQUENCES[34]='\\"';ESCAPE_SEQUENCES[92]="\\\\";ESCAPE_SEQUENCES[133]="\\N";ESCAPE_SEQUENCES[160]="\\_";ESCAPE_SEQUENCES[8232]="\\L";ESCAPE_SEQUENCES[8233]="\\P";var DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];var DEPRECATED_BASE60_SYNTAX=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function compileStyleMap(schema,map){var result,keys,index,length,tag,style,type;if(map===null)return{};result={};keys=Object.keys(map);for(index=0,length=keys.length;index<length;index+=1){tag=keys[index];style=String(map[tag]);if(tag.slice(0,2)==="!!"){tag="tag:yaml.org,2002:"+tag.slice(2)}type=schema.compiledTypeMap["fallback"][tag];if(type&&_hasOwnProperty.call(type.styleAliases,style)){style=type.styleAliases[style]}result[tag]=style}return result}function encodeHex(character){var string,handle,length;string=character.toString(16).toUpperCase();if(character<=255){handle="x";length=2}else if(character<=65535){handle="u";length=4}else if(character<=4294967295){handle="U";length=8}else{throw new YAMLException("code point within a string may not be greater than 0xFFFFFFFF")}return"\\"+handle+common.repeat("0",length-string.length)+string}var QUOTING_TYPE_SINGLE=1,QUOTING_TYPE_DOUBLE=2;function State(options){this.schema=options["schema"]||DEFAULT_SCHEMA;this.indent=Math.max(1,options["indent"]||2);this.noArrayIndent=options["noArrayIndent"]||false;this.skipInvalid=options["skipInvalid"]||false;this.flowLevel=common.isNothing(options["flowLevel"])?-1:options["flowLevel"];this.styleMap=compileStyleMap(this.schema,options["styles"]||null);this.sortKeys=options["sortKeys"]||false;this.lineWidth=options["lineWidth"]||80;this.noRefs=options["noRefs"]||false;this.noCompatMode=options["noCompatMode"]||false;this.condenseFlow=options["condenseFlow"]||false;this.quotingType=options["quotingType"]==='"'?QUOTING_TYPE_DOUBLE:QUOTING_TYPE_SINGLE;this.forceQuotes=options["forceQuotes"]||false;this.replacer=typeof options["replacer"]==="function"?options["replacer"]:null;this.implicitTypes=this.schema.compiledImplicit;this.explicitTypes=this.schema.compiledExplicit;this.tag=null;this.result="";this.duplicates=[];this.usedDuplicates=null}function indentString(string,spaces){var ind=common.repeat(" ",spaces),position=0,next=-1,result="",line,length=string.length;while(position<length){next=string.indexOf("\n",position);if(next===-1){line=string.slice(position);position=length}else{line=string.slice(position,next+1);position=next+1}if(line.length&&line!=="\n")result+=ind;result+=line}return result}function generateNextLine(state,level){return"\n"+common.repeat(" ",state.indent*level)}function testImplicitResolving(state,str){var index,length,type;for(index=0,length=state.implicitTypes.length;index<length;index+=1){type=state.implicitTypes[index];if(type.resolve(str)){return true}}return false}function isWhitespace(c){return c===CHAR_SPACE||c===CHAR_TAB}function isPrintable(c){return 32<=c&&c<=126||161<=c&&c<=55295&&c!==8232&&c!==8233||57344<=c&&c<=65533&&c!==CHAR_BOM||65536<=c&&c<=1114111}function isNsCharOrWhitespace(c){return isPrintable(c)&&c!==CHAR_BOM&&c!==CHAR_CARRIAGE_RETURN&&c!==CHAR_LINE_FEED}function isPlainSafe(c,prev,inblock){var cIsNsCharOrWhitespace=isNsCharOrWhitespace(c);var cIsNsChar=cIsNsCharOrWhitespace&&!isWhitespace(c);return(inblock?cIsNsCharOrWhitespace:cIsNsCharOrWhitespace&&c!==CHAR_COMMA&&c!==CHAR_LEFT_SQUARE_BRACKET&&c!==CHAR_RIGHT_SQUARE_BRACKET&&c!==CHAR_LEFT_CURLY_BRACKET&&c!==CHAR_RIGHT_CURLY_BRACKET)&&c!==CHAR_SHARP&&!(prev===CHAR_COLON&&!cIsNsChar)||isNsCharOrWhitespace(prev)&&!isWhitespace(prev)&&c===CHAR_SHARP||prev===CHAR_COLON&&cIsNsChar}function isPlainSafeFirst(c){return isPrintable(c)&&c!==CHAR_BOM&&!isWhitespace(c)&&c!==CHAR_MINUS&&c!==CHAR_QUESTION&&c!==CHAR_COLON&&c!==CHAR_COMMA&&c!==CHAR_LEFT_SQUARE_BRACKET&&c!==CHAR_RIGHT_SQUARE_BRACKET&&c!==CHAR_LEFT_CURLY_BRACKET&&c!==CHAR_RIGHT_CURLY_BRACKET&&c!==CHAR_SHARP&&c!==CHAR_AMPERSAND&&c!==CHAR_ASTERISK&&c!==CHAR_EXCLAMATION&&c!==CHAR_VERTICAL_LINE&&c!==CHAR_EQUALS&&c!==CHAR_GREATER_THAN&&c!==CHAR_SINGLE_QUOTE&&c!==CHAR_DOUBLE_QUOTE&&c!==CHAR_PERCENT&&c!==CHAR_COMMERCIAL_AT&&c!==CHAR_GRAVE_ACCENT}function isPlainSafeLast(c){return!isWhitespace(c)&&c!==CHAR_COLON}function codePointAt(string,pos){var first=string.charCodeAt(pos),second;if(first>=55296&&first<=56319&&pos+1<string.length){second=string.charCodeAt(pos+1);if(second>=56320&&second<=57343){return(first-55296)*1024+second-56320+65536}}return first}function needIndentIndicator(string){var leadingSpaceRe=/^\n* /;return leadingSpaceRe.test(string)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(string,singleLineOnly,indentPerLevel,lineWidth,testAmbiguousType,quotingType,forceQuotes,inblock){var i;var char=0;var prevChar=null;var hasLineBreak=false;var hasFoldableLine=false;var shouldTrackWidth=lineWidth!==-1;var previousLineBreak=-1;var plain=isPlainSafeFirst(codePointAt(string,0))&&isPlainSafeLast(codePointAt(string,string.length-1));if(singleLineOnly||forceQuotes){for(i=0;i<string.length;char>=65536?i+=2:i++){char=codePointAt(string,i);if(!isPrintable(char)){return STYLE_DOUBLE}plain=plain&&isPlainSafe(char,prevChar,inblock);prevChar=char}}else{for(i=0;i<string.length;char>=65536?i+=2:i++){char=codePointAt(string,i);if(char===CHAR_LINE_FEED){hasLineBreak=true;if(shouldTrackWidth){hasFoldableLine=hasFoldableLine||i-previousLineBreak-1>lineWidth&&string[previousLineBreak+1]!==" ";previousLineBreak=i}}else if(!isPrintable(char)){return STYLE_DOUBLE}plain=plain&&isPlainSafe(char,prevChar,inblock);prevChar=char}hasFoldableLine=hasFoldableLine||shouldTrackWidth&&(i-previousLineBreak-1>lineWidth&&string[previousLineBreak+1]!==" ")}if(!hasLineBreak&&!hasFoldableLine){if(plain&&!forceQuotes&&!testAmbiguousType(string)){return STYLE_PLAIN}return quotingType===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE}if(indentPerLevel>9&&needIndentIndicator(string)){return STYLE_DOUBLE}if(!forceQuotes){return hasFoldableLine?STYLE_FOLDED:STYLE_LITERAL}return quotingType===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE}function writeScalar(state,string,level,iskey,inblock){state.dump=function(){if(string.length===0){return state.quotingType===QUOTING_TYPE_DOUBLE?'""':"''"}if(!state.noCompatMode){if(DEPRECATED_BOOLEANS_SYNTAX.indexOf(string)!==-1||DEPRECATED_BASE60_SYNTAX.test(string)){return state.quotingType===QUOTING_TYPE_DOUBLE?'"'+string+'"':"'"+string+"'"}}var indent=state.indent*Math.max(1,level);var lineWidth=state.lineWidth===-1?-1:Math.max(Math.min(state.lineWidth,40),state.lineWidth-indent);var singleLineOnly=iskey||state.flowLevel>-1&&level>=state.flowLevel;function testAmbiguity(string){return testImplicitResolving(state,string)}switch(chooseScalarStyle(string,singleLineOnly,state.indent,lineWidth,testAmbiguity,state.quotingType,state.forceQuotes&&!iskey,inblock)){case STYLE_PLAIN:return string;case STYLE_SINGLE:return"'"+string.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(string,state.indent)+dropEndingNewline(indentString(string,indent));case STYLE_FOLDED:return">"+blockHeader(string,state.indent)+dropEndingNewline(indentString(foldString(string,lineWidth),indent));case STYLE_DOUBLE:return'"'+escapeString(string,lineWidth)+'"';default:throw new YAMLException("impossible error: invalid scalar style")}}()}function blockHeader(string,indentPerLevel){var indentIndicator=needIndentIndicator(string)?String(indentPerLevel):"";var clip=string[string.length-1]==="\n";var keep=clip&&(string[string.length-2]==="\n"||string==="\n");var chomp=keep?"+":clip?"":"-";return indentIndicator+chomp+"\n"}function dropEndingNewline(string){return string[string.length-1]==="\n"?string.slice(0,-1):string}function foldString(string,width){var lineRe=/(\n+)([^\n]*)/g;var result=function(){var nextLF=string.indexOf("\n");nextLF=nextLF!==-1?nextLF:string.length;lineRe.lastIndex=nextLF;return foldLine(string.slice(0,nextLF),width)}();var prevMoreIndented=string[0]==="\n"||string[0]===" ";var moreIndented;var match;while(match=lineRe.exec(string)){var prefix=match[1],line=match[2];moreIndented=line[0]===" ";result+=prefix+(!prevMoreIndented&&!moreIndented&&line!==""?"\n":"")+foldLine(line,width);prevMoreIndented=moreIndented}return result}function foldLine(line,width){if(line===""||line[0]===" ")return line;var breakRe=/ [^ ]/g;var match;var start=0,end,curr=0,next=0;var result="";while(match=breakRe.exec(line)){next=match.index;if(next-start>width){end=curr>start?curr:next;result+="\n"+line.slice(start,end);start=end+1}curr=next}result+="\n";if(line.length-start>width&&curr>start){result+=line.slice(start,curr)+"\n"+line.slice(curr+1)}else{result+=line.slice(start)}return result.slice(1)}function escapeString(string){var result="";var char=0;var escapeSeq;for(var i=0;i<string.length;char>=65536?i+=2:i++){char=codePointAt(string,i);escapeSeq=ESCAPE_SEQUENCES[char];if(!escapeSeq&&isPrintable(char)){result+=string[i];if(char>=65536)result+=string[i+1]}else{result+=escapeSeq||encodeHex(char)}}return result}function writeFlowSequence(state,level,object){var _result="",_tag=state.tag,index,length,value;for(index=0,length=object.length;index<length;index+=1){value=object[index];if(state.replacer){value=state.replacer.call(object,String(index),value)}if(writeNode(state,level,value,false,false)||typeof value==="undefined"&&writeNode(state,level,null,false,false)){if(_result!=="")_result+=","+(!state.condenseFlow?" ":"");_result+=state.dump}}state.tag=_tag;state.dump="["+_result+"]"}function writeBlockSequence(state,level,object,compact){var _result="",_tag=state.tag,index,length,value;for(index=0,length=object.length;index<length;index+=1){value=object[index];if(state.replacer){value=state.replacer.call(object,String(index),value)}if(writeNode(state,level+1,value,true,true,false,true)||typeof value==="undefined"&&writeNode(state,level+1,null,true,true,false,true)){if(!compact||_result!==""){_result+=generateNextLine(state,level)}if(state.dump&&CHAR_LINE_FEED===state.dump.charCodeAt(0)){_result+="-"}else{_result+="- "}_result+=state.dump}}state.tag=_tag;state.dump=_result||"[]"}function writeFlowMapping(state,level,object){var _result="",_tag=state.tag,objectKeyList=Object.keys(object),index,length,objectKey,objectValue,pairBuffer;for(index=0,length=objectKeyList.length;index<length;index+=1){pairBuffer="";if(_result!=="")pairBuffer+=", ";if(state.condenseFlow)pairBuffer+='"';objectKey=objectKeyList[index];objectValue=object[objectKey];if(state.replacer){objectValue=state.replacer.call(object,objectKey,objectValue)}if(!writeNode(state,level,objectKey,false,false)){continue}if(state.dump.length>1024)pairBuffer+="? ";pairBuffer+=state.dump+(state.condenseFlow?'"':"")+":"+(state.condenseFlow?"":" ");if(!writeNode(state,level,objectValue,false,false)){continue}pairBuffer+=state.dump;_result+=pairBuffer}state.tag=_tag;state.dump="{"+_result+"}"}function writeBlockMapping(state,level,object,compact){var _result="",_tag=state.tag,objectKeyList=Object.keys(object),index,length,objectKey,objectValue,explicitPair,pairBuffer;if(state.sortKeys===true){objectKeyList.sort()}else if(typeof state.sortKeys==="function"){objectKeyList.sort(state.sortKeys)}else if(state.sortKeys){throw new YAMLException("sortKeys must be a boolean or a function")}for(index=0,length=objectKeyList.length;index<length;index+=1){pairBuffer="";if(!compact||_result!==""){pairBuffer+=generateNextLine(state,level)}objectKey=objectKeyList[index];objectValue=object[objectKey];if(state.replacer){objectValue=state.replacer.call(object,objectKey,objectValue)}if(!writeNode(state,level+1,objectKey,true,true,true)){continue}explicitPair=state.tag!==null&&state.tag!=="?"||state.dump&&state.dump.length>1024;if(explicitPair){if(state.dump&&CHAR_LINE_FEED===state.dump.charCodeAt(0)){pairBuffer+="?"}else{pairBuffer+="? "}}pairBuffer+=state.dump;if(explicitPair){pairBuffer+=generateNextLine(state,level)}if(!writeNode(state,level+1,objectValue,true,explicitPair)){continue}if(state.dump&&CHAR_LINE_FEED===state.dump.charCodeAt(0)){pairBuffer+=":"}else{pairBuffer+=": "}pairBuffer+=state.dump;_result+=pairBuffer}state.tag=_tag;state.dump=_result||"{}"}function detectType(state,object,explicit){var _result,typeList,index,length,type,style;typeList=explicit?state.explicitTypes:state.implicitTypes;for(index=0,length=typeList.length;index<length;index+=1){type=typeList[index];if((type.instanceOf||type.predicate)&&(!type.instanceOf||typeof object==="object"&&object instanceof type.instanceOf)&&(!type.predicate||type.predicate(object))){if(explicit){if(type.multi&&type.representName){state.tag=type.representName(object)}else{state.tag=type.tag}}else{state.tag="?"}if(type.represent){style=state.styleMap[type.tag]||type.defaultStyle;if(_toString.call(type.represent)==="[object Function]"){_result=type.represent(object,style)}else if(_hasOwnProperty.call(type.represent,style)){_result=type.represent[style](object,style)}else{throw new YAMLException("!<"+type.tag+'> tag resolver accepts not "'+style+'" style')}state.dump=_result}return true}}return false}function writeNode(state,level,object,block,compact,iskey,isblockseq){state.tag=null;state.dump=object;if(!detectType(state,object,false)){detectType(state,object,true)}var type=_toString.call(state.dump);var inblock=block;var tagStr;if(block){block=state.flowLevel<0||state.flowLevel>level}var objectOrArray=type==="[object Object]"||type==="[object Array]",duplicateIndex,duplicate;if(objectOrArray){duplicateIndex=state.duplicates.indexOf(object);duplicate=duplicateIndex!==-1}if(state.tag!==null&&state.tag!=="?"||duplicate||state.indent!==2&&level>0){compact=false}if(duplicate&&state.usedDuplicates[duplicateIndex]){state.dump="*ref_"+duplicateIndex}else{if(objectOrArray&&duplicate&&!state.usedDuplicates[duplicateIndex]){state.usedDuplicates[duplicateIndex]=true}if(type==="[object Object]"){if(block&&Object.keys(state.dump).length!==0){writeBlockMapping(state,level,state.dump,compact);if(duplicate){state.dump="&ref_"+duplicateIndex+state.dump}}else{writeFlowMapping(state,level,state.dump);if(duplicate){state.dump="&ref_"+duplicateIndex+" "+state.dump}}}else if(type==="[object Array]"){if(block&&state.dump.length!==0){if(state.noArrayIndent&&!isblockseq&&level>0){writeBlockSequence(state,level-1,state.dump,compact)}else{writeBlockSequence(state,level,state.dump,compact)}if(duplicate){state.dump="&ref_"+duplicateIndex+state.dump}}else{writeFlowSequence(state,level,state.dump);if(duplicate){state.dump="&ref_"+duplicateIndex+" "+state.dump}}}else if(type==="[object String]"){if(state.tag!=="?"){writeScalar(state,state.dump,level,iskey,inblock)}}else if(type==="[object Undefined]"){return false}else{if(state.skipInvalid)return false;throw new YAMLException("unacceptable kind of an object to dump "+type)}if(state.tag!==null&&state.tag!=="?"){tagStr=encodeURI(state.tag[0]==="!"?state.tag.slice(1):state.tag).replace(/!/g,"%21");if(state.tag[0]==="!"){tagStr="!"+tagStr}else if(tagStr.slice(0,18)==="tag:yaml.org,2002:"){tagStr="!!"+tagStr.slice(18)}else{tagStr="!<"+tagStr+">"}state.dump=tagStr+" "+state.dump}}return true}function getDuplicateReferences(object,state){var objects=[],duplicatesIndexes=[],index,length;inspectNode(object,objects,duplicatesIndexes);for(index=0,length=duplicatesIndexes.length;index<length;index+=1){state.duplicates.push(objects[duplicatesIndexes[index]])}state.usedDuplicates=new Array(length)}function inspectNode(object,objects,duplicatesIndexes){var objectKeyList,index,length;if(object!==null&&typeof object==="object"){index=objects.indexOf(object);if(index!==-1){if(duplicatesIndexes.indexOf(index)===-1){duplicatesIndexes.push(index)}}else{objects.push(object);if(Array.isArray(object)){for(index=0,length=object.length;index<length;index+=1){inspectNode(object[index],objects,duplicatesIndexes)}}else{objectKeyList=Object.keys(object);for(index=0,length=objectKeyList.length;index<length;index+=1){inspectNode(object[objectKeyList[index]],objects,duplicatesIndexes)}}}}}function dump(input,options){options=options||{};var state=new State(options);if(!state.noRefs)getDuplicateReferences(input,state);var value=input;if(state.replacer){value=state.replacer.call({"":value},"",value)}if(writeNode(state,0,value,true,true))return state.dump+"\n";return""}module.exports.dump=dump},{"./common":287,"./exception":289,"./schema/default":293}],289:[function(require,module,exports){"use strict";function formatError(exception,compact){var where="",message=exception.reason||"(unknown reason)";if(!exception.mark)return message;if(exception.mark.name){where+='in "'+exception.mark.name+'" '}where+="("+(exception.mark.line+1)+":"+(exception.mark.column+1)+")";if(!compact&&exception.mark.snippet){where+="\n\n"+exception.mark.snippet}return message+" "+where}function YAMLException(reason,mark){Error.call(this);this.name="YAMLException";this.reason=reason;this.mark=mark;this.message=formatError(this,false);if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}else{this.stack=(new Error).stack||""}}YAMLException.prototype=Object.create(Error.prototype);YAMLException.prototype.constructor=YAMLException;YAMLException.prototype.toString=function toString(compact){return this.name+": "+formatError(this,compact)};module.exports=YAMLException},{}],290:[function(require,module,exports){"use strict";var common=require("./common");var YAMLException=require("./exception");var makeSnippet=require("./snippet");var DEFAULT_SCHEMA=require("./schema/default");var _hasOwnProperty=Object.prototype.hasOwnProperty;var CONTEXT_FLOW_IN=1;var CONTEXT_FLOW_OUT=2;var CONTEXT_BLOCK_IN=3;var CONTEXT_BLOCK_OUT=4;var CHOMPING_CLIP=1;var CHOMPING_STRIP=2;var CHOMPING_KEEP=3;var PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/;var PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/;var PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/;var PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i;var PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(obj){return Object.prototype.toString.call(obj)}function is_EOL(c){return c===10||c===13}function is_WHITE_SPACE(c){return c===9||c===32}function is_WS_OR_EOL(c){return c===9||c===32||c===10||c===13}function is_FLOW_INDICATOR(c){return c===44||c===91||c===93||c===123||c===125}function fromHexCode(c){var lc;if(48<=c&&c<=57){return c-48}lc=c|32;if(97<=lc&&lc<=102){return lc-97+10}return-1}function escapedHexLen(c){if(c===120){return 2}if(c===117){return 4}if(c===85){return 8}return 0}function fromDecimalCode(c){if(48<=c&&c<=57){return c-48}return-1}function simpleEscapeSequence(c){return c===48?"\0":c===97?"":c===98?"\b":c===116?"\t":c===9?"\t":c===110?"\n":c===118?"\v":c===102?"\f":c===114?"\r":c===101?"":c===32?" ":c===34?'"':c===47?"/":c===92?"\\":c===78?"":c===95?" ":c===76?"\u2028":c===80?"\u2029":""}function charFromCodepoint(c){if(c<=65535){return String.fromCharCode(c)}return String.fromCharCode((c-65536>>10)+55296,(c-65536&1023)+56320)}var simpleEscapeCheck=new Array(256);var simpleEscapeMap=new Array(256);for(var i=0;i<256;i++){simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0;simpleEscapeMap[i]=simpleEscapeSequence(i)}function State(input,options){this.input=input;this.filename=options["filename"]||null;this.schema=options["schema"]||DEFAULT_SCHEMA;this.onWarning=options["onWarning"]||null;this.legacy=options["legacy"]||false;this.json=options["json"]||false;this.listener=options["listener"]||null;this.implicitTypes=this.schema.compiledImplicit;this.typeMap=this.schema.compiledTypeMap;this.length=input.length;this.position=0;this.line=0;this.lineStart=0;this.lineIndent=0;this.firstTabInLine=-1;this.documents=[]}function generateError(state,message){var mark={name:state.filename,buffer:state.input.slice(0,-1),position:state.position,line:state.line,column:state.position-state.lineStart};mark.snippet=makeSnippet(mark);return new YAMLException(message,mark)}function throwError(state,message){throw generateError(state,message)}function throwWarning(state,message){if(state.onWarning){state.onWarning.call(null,generateError(state,message))}}var directiveHandlers={YAML:function handleYamlDirective(state,name,args){var match,major,minor;if(state.version!==null){throwError(state,"duplication of %YAML directive")}if(args.length!==1){throwError(state,"YAML directive accepts exactly one argument")}match=/^([0-9]+)\.([0-9]+)$/.exec(args[0]);if(match===null){throwError(state,"ill-formed argument of the YAML directive")}major=parseInt(match[1],10);minor=parseInt(match[2],10);if(major!==1){throwError(state,"unacceptable YAML version of the document")}state.version=args[0];state.checkLineBreaks=minor<2;if(minor!==1&&minor!==2){throwWarning(state,"unsupported YAML version of the document")}},TAG:function handleTagDirective(state,name,args){var handle,prefix;if(args.length!==2){throwError(state,"TAG directive accepts exactly two arguments")}handle=args[0];prefix=args[1];if(!PATTERN_TAG_HANDLE.test(handle)){throwError(state,"ill-formed tag handle (first argument) of the TAG directive")}if(_hasOwnProperty.call(state.tagMap,handle)){throwError(state,'there is a previously declared suffix for "'+handle+'" tag handle')}if(!PATTERN_TAG_URI.test(prefix)){throwError(state,"ill-formed tag prefix (second argument) of the TAG directive")}try{prefix=decodeURIComponent(prefix)}catch(err){throwError(state,"tag prefix is malformed: "+prefix)}state.tagMap[handle]=prefix}};function captureSegment(state,start,end,checkJson){var _position,_length,_character,_result;if(start<end){_result=state.input.slice(start,end);if(checkJson){for(_position=0,_length=_result.length;_position<_length;_position+=1){_character=_result.charCodeAt(_position);if(!(_character===9||32<=_character&&_character<=1114111)){throwError(state,"expected valid JSON character")}}}else if(PATTERN_NON_PRINTABLE.test(_result)){throwError(state,"the stream contains non-printable characters")}state.result+=_result}}function mergeMappings(state,destination,source,overridableKeys){var sourceKeys,key,index,quantity;if(!common.isObject(source)){throwError(state,"cannot merge mappings; the provided source object is unacceptable")}sourceKeys=Object.keys(source);for(index=0,quantity=sourceKeys.length;index<quantity;index+=1){key=sourceKeys[index];if(!_hasOwnProperty.call(destination,key)){destination[key]=source[key];overridableKeys[key]=true}}}function storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,valueNode,startLine,startLineStart,startPos){var index,quantity;if(Array.isArray(keyNode)){keyNode=Array.prototype.slice.call(keyNode);for(index=0,quantity=keyNode.length;index<quantity;index+=1){if(Array.isArray(keyNode[index])){throwError(state,"nested arrays are not supported inside keys")}if(typeof keyNode==="object"&&_class(keyNode[index])==="[object Object]"){keyNode[index]="[object Object]"}}}if(typeof keyNode==="object"&&_class(keyNode)==="[object Object]"){keyNode="[object Object]"}keyNode=String(keyNode);if(_result===null){_result={}}if(keyTag==="tag:yaml.org,2002:merge"){if(Array.isArray(valueNode)){for(index=0,quantity=valueNode.length;index<quantity;index+=1){mergeMappings(state,_result,valueNode[index],overridableKeys)}}else{mergeMappings(state,_result,valueNode,overridableKeys)}}else{if(!state.json&&!_hasOwnProperty.call(overridableKeys,keyNode)&&_hasOwnProperty.call(_result,keyNode)){state.line=startLine||state.line;state.lineStart=startLineStart||state.lineStart;state.position=startPos||state.position;throwError(state,"duplicated mapping key")}if(keyNode==="__proto__"){Object.defineProperty(_result,keyNode,{configurable:true,enumerable:true,writable:true,value:valueNode})}else{_result[keyNode]=valueNode}delete overridableKeys[keyNode]}return _result}function readLineBreak(state){var ch;ch=state.input.charCodeAt(state.position);if(ch===10){state.position++}else if(ch===13){state.position++;if(state.input.charCodeAt(state.position)===10){state.position++}}else{throwError(state,"a line break is expected")}state.line+=1;state.lineStart=state.position;state.firstTabInLine=-1}function skipSeparationSpace(state,allowComments,checkIndent){var lineBreaks=0,ch=state.input.charCodeAt(state.position);while(ch!==0){while(is_WHITE_SPACE(ch)){if(ch===9&&state.firstTabInLine===-1){state.firstTabInLine=state.position}ch=state.input.charCodeAt(++state.position)}if(allowComments&&ch===35){do{ch=state.input.charCodeAt(++state.position)}while(ch!==10&&ch!==13&&ch!==0)}if(is_EOL(ch)){readLineBreak(state);ch=state.input.charCodeAt(state.position);lineBreaks++;state.lineIndent=0;while(ch===32){state.lineIndent++;ch=state.input.charCodeAt(++state.position)}}else{break}}if(checkIndent!==-1&&lineBreaks!==0&&state.lineIndent<checkIndent){throwWarning(state,"deficient indentation")}return lineBreaks}function testDocumentSeparator(state){var _position=state.position,ch;ch=state.input.charCodeAt(_position);if((ch===45||ch===46)&&ch===state.input.charCodeAt(_position+1)&&ch===state.input.charCodeAt(_position+2)){_position+=3;ch=state.input.charCodeAt(_position);if(ch===0||is_WS_OR_EOL(ch)){return true}}return false}function writeFoldedLines(state,count){if(count===1){state.result+=" "}else if(count>1){state.result+=common.repeat("\n",count-1)}}function readPlainScalar(state,nodeIndent,withinFlowCollection){var preceding,following,captureStart,captureEnd,hasPendingContent,_line,_lineStart,_lineIndent,_kind=state.kind,_result=state.result,ch;ch=state.input.charCodeAt(state.position);if(is_WS_OR_EOL(ch)||is_FLOW_INDICATOR(ch)||ch===35||ch===38||ch===42||ch===33||ch===124||ch===62||ch===39||ch===34||ch===37||ch===64||ch===96){return false}if(ch===63||ch===45){following=state.input.charCodeAt(state.position+1);if(is_WS_OR_EOL(following)||withinFlowCollection&&is_FLOW_INDICATOR(following)){return false}}state.kind="scalar";state.result="";captureStart=captureEnd=state.position;hasPendingContent=false;while(ch!==0){if(ch===58){following=state.input.charCodeAt(state.position+1);if(is_WS_OR_EOL(following)||withinFlowCollection&&is_FLOW_INDICATOR(following)){break}}else if(ch===35){preceding=state.input.charCodeAt(state.position-1);if(is_WS_OR_EOL(preceding)){break}}else if(state.position===state.lineStart&&testDocumentSeparator(state)||withinFlowCollection&&is_FLOW_INDICATOR(ch)){break}else if(is_EOL(ch)){_line=state.line;_lineStart=state.lineStart;_lineIndent=state.lineIndent;skipSeparationSpace(state,false,-1);if(state.lineIndent>=nodeIndent){hasPendingContent=true;ch=state.input.charCodeAt(state.position);continue}else{state.position=captureEnd;state.line=_line;state.lineStart=_lineStart;state.lineIndent=_lineIndent;break}}if(hasPendingContent){captureSegment(state,captureStart,captureEnd,false);writeFoldedLines(state,state.line-_line);captureStart=captureEnd=state.position;hasPendingContent=false}if(!is_WHITE_SPACE(ch)){captureEnd=state.position+1}ch=state.input.charCodeAt(++state.position)}captureSegment(state,captureStart,captureEnd,false);if(state.result){return true}state.kind=_kind;state.result=_result;return false}function readSingleQuotedScalar(state,nodeIndent){var ch,captureStart,captureEnd;ch=state.input.charCodeAt(state.position);if(ch!==39){return false}state.kind="scalar";state.result="";state.position++;captureStart=captureEnd=state.position;while((ch=state.input.charCodeAt(state.position))!==0){if(ch===39){captureSegment(state,captureStart,state.position,true);ch=state.input.charCodeAt(++state.position);if(ch===39){captureStart=state.position;state.position++;captureEnd=state.position}else{return true}}else if(is_EOL(ch)){captureSegment(state,captureStart,captureEnd,true);writeFoldedLines(state,skipSeparationSpace(state,false,nodeIndent));captureStart=captureEnd=state.position}else if(state.position===state.lineStart&&testDocumentSeparator(state)){throwError(state,"unexpected end of the document within a single quoted scalar")}else{state.position++;captureEnd=state.position}}throwError(state,"unexpected end of the stream within a single quoted scalar")}function readDoubleQuotedScalar(state,nodeIndent){var captureStart,captureEnd,hexLength,hexResult,tmp,ch;ch=state.input.charCodeAt(state.position);if(ch!==34){return false}state.kind="scalar";state.result="";state.position++;captureStart=captureEnd=state.position;while((ch=state.input.charCodeAt(state.position))!==0){if(ch===34){captureSegment(state,captureStart,state.position,true);state.position++;return true}else if(ch===92){captureSegment(state,captureStart,state.position,true);ch=state.input.charCodeAt(++state.position);if(is_EOL(ch)){skipSeparationSpace(state,false,nodeIndent)}else if(ch<256&&simpleEscapeCheck[ch]){state.result+=simpleEscapeMap[ch];state.position++}else if((tmp=escapedHexLen(ch))>0){hexLength=tmp;hexResult=0;for(;hexLength>0;hexLength--){ch=state.input.charCodeAt(++state.position);if((tmp=fromHexCode(ch))>=0){hexResult=(hexResult<<4)+tmp}else{throwError(state,"expected hexadecimal character")}}state.result+=charFromCodepoint(hexResult);state.position++}else{throwError(state,"unknown escape sequence")}captureStart=captureEnd=state.position}else if(is_EOL(ch)){captureSegment(state,captureStart,captureEnd,true);writeFoldedLines(state,skipSeparationSpace(state,false,nodeIndent));captureStart=captureEnd=state.position}else if(state.position===state.lineStart&&testDocumentSeparator(state)){throwError(state,"unexpected end of the document within a double quoted scalar")}else{state.position++;captureEnd=state.position}}throwError(state,"unexpected end of the stream within a double quoted scalar")}function readFlowCollection(state,nodeIndent){var readNext=true,_line,_lineStart,_pos,_tag=state.tag,_result,_anchor=state.anchor,following,terminator,isPair,isExplicitPair,isMapping,overridableKeys=Object.create(null),keyNode,keyTag,valueNode,ch;ch=state.input.charCodeAt(state.position);if(ch===91){terminator=93;isMapping=false;_result=[]}else if(ch===123){terminator=125;isMapping=true;_result={}}else{return false}if(state.anchor!==null){state.anchorMap[state.anchor]=_result}ch=state.input.charCodeAt(++state.position);while(ch!==0){skipSeparationSpace(state,true,nodeIndent);ch=state.input.charCodeAt(state.position);if(ch===terminator){state.position++;state.tag=_tag;state.anchor=_anchor;state.kind=isMapping?"mapping":"sequence";state.result=_result;return true}else if(!readNext){throwError(state,"missed comma between flow collection entries")}else if(ch===44){throwError(state,"expected the node content, but found ','")}keyTag=keyNode=valueNode=null;isPair=isExplicitPair=false;if(ch===63){following=state.input.charCodeAt(state.position+1);if(is_WS_OR_EOL(following)){isPair=isExplicitPair=true;state.position++;skipSeparationSpace(state,true,nodeIndent)}}_line=state.line;_lineStart=state.lineStart;_pos=state.position;composeNode(state,nodeIndent,CONTEXT_FLOW_IN,false,true);keyTag=state.tag;keyNode=state.result;skipSeparationSpace(state,true,nodeIndent);ch=state.input.charCodeAt(state.position);if((isExplicitPair||state.line===_line)&&ch===58){isPair=true;ch=state.input.charCodeAt(++state.position);skipSeparationSpace(state,true,nodeIndent);composeNode(state,nodeIndent,CONTEXT_FLOW_IN,false,true);valueNode=state.result}if(isMapping){storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,valueNode,_line,_lineStart,_pos)}else if(isPair){_result.push(storeMappingPair(state,null,overridableKeys,keyTag,keyNode,valueNode,_line,_lineStart,_pos))}else{_result.push(keyNode)}skipSeparationSpace(state,true,nodeIndent);ch=state.input.charCodeAt(state.position);if(ch===44){readNext=true;ch=state.input.charCodeAt(++state.position)}else{readNext=false}}throwError(state,"unexpected end of the stream within a flow collection")}function readBlockScalar(state,nodeIndent){var captureStart,folding,chomping=CHOMPING_CLIP,didReadContent=false,detectedIndent=false,textIndent=nodeIndent,emptyLines=0,atMoreIndented=false,tmp,ch;ch=state.input.charCodeAt(state.position);if(ch===124){folding=false}else if(ch===62){folding=true}else{return false}state.kind="scalar";state.result="";while(ch!==0){ch=state.input.charCodeAt(++state.position);if(ch===43||ch===45){if(CHOMPING_CLIP===chomping){chomping=ch===43?CHOMPING_KEEP:CHOMPING_STRIP}else{throwError(state,"repeat of a chomping mode identifier")}}else if((tmp=fromDecimalCode(ch))>=0){if(tmp===0){throwError(state,"bad explicit indentation width of a block scalar; it cannot be less than one")}else if(!detectedIndent){textIndent=nodeIndent+tmp-1;detectedIndent=true}else{throwError(state,"repeat of an indentation width identifier")}}else{break}}if(is_WHITE_SPACE(ch)){do{ch=state.input.charCodeAt(++state.position)}while(is_WHITE_SPACE(ch));if(ch===35){do{ch=state.input.charCodeAt(++state.position)}while(!is_EOL(ch)&&ch!==0)}}while(ch!==0){readLineBreak(state);state.lineIndent=0;ch=state.input.charCodeAt(state.position);while((!detectedIndent||state.lineIndent<textIndent)&&ch===32){state.lineIndent++;ch=state.input.charCodeAt(++state.position)}if(!detectedIndent&&state.lineIndent>textIndent){textIndent=state.lineIndent}if(is_EOL(ch)){emptyLines++;continue}if(state.lineIndent<textIndent){if(chomping===CHOMPING_KEEP){state.result+=common.repeat("\n",didReadContent?1+emptyLines:emptyLines)}else if(chomping===CHOMPING_CLIP){if(didReadContent){state.result+="\n"}}break}if(folding){if(is_WHITE_SPACE(ch)){atMoreIndented=true;state.result+=common.repeat("\n",didReadContent?1+emptyLines:emptyLines)}else if(atMoreIndented){atMoreIndented=false;state.result+=common.repeat("\n",emptyLines+1)}else if(emptyLines===0){if(didReadContent){state.result+=" "}}else{state.result+=common.repeat("\n",emptyLines)}}else{state.result+=common.repeat("\n",didReadContent?1+emptyLines:emptyLines)}didReadContent=true;detectedIndent=true;emptyLines=0;captureStart=state.position;while(!is_EOL(ch)&&ch!==0){ch=state.input.charCodeAt(++state.position)}captureSegment(state,captureStart,state.position,false)}return true}function readBlockSequence(state,nodeIndent){var _line,_tag=state.tag,_anchor=state.anchor,_result=[],following,detected=false,ch;if(state.firstTabInLine!==-1)return false;if(state.anchor!==null){state.anchorMap[state.anchor]=_result}ch=state.input.charCodeAt(state.position);while(ch!==0){if(state.firstTabInLine!==-1){state.position=state.firstTabInLine;throwError(state,"tab characters must not be used in indentation")}if(ch!==45){break}following=state.input.charCodeAt(state.position+1);if(!is_WS_OR_EOL(following)){break}detected=true;state.position++;if(skipSeparationSpace(state,true,-1)){if(state.lineIndent<=nodeIndent){_result.push(null);ch=state.input.charCodeAt(state.position);continue}}_line=state.line;composeNode(state,nodeIndent,CONTEXT_BLOCK_IN,false,true);_result.push(state.result);skipSeparationSpace(state,true,-1);ch=state.input.charCodeAt(state.position);if((state.line===_line||state.lineIndent>nodeIndent)&&ch!==0){throwError(state,"bad indentation of a sequence entry")}else if(state.lineIndent<nodeIndent){break}}if(detected){state.tag=_tag;state.anchor=_anchor;state.kind="sequence";state.result=_result;return true}return false}function readBlockMapping(state,nodeIndent,flowIndent){var following,allowCompact,_line,_keyLine,_keyLineStart,_keyPos,_tag=state.tag,_anchor=state.anchor,_result={},overridableKeys=Object.create(null),keyTag=null,keyNode=null,valueNode=null,atExplicitKey=false,detected=false,ch;if(state.firstTabInLine!==-1)return false;if(state.anchor!==null){state.anchorMap[state.anchor]=_result}ch=state.input.charCodeAt(state.position);while(ch!==0){if(!atExplicitKey&&state.firstTabInLine!==-1){state.position=state.firstTabInLine;throwError(state,"tab characters must not be used in indentation")}following=state.input.charCodeAt(state.position+1);_line=state.line;if((ch===63||ch===58)&&is_WS_OR_EOL(following)){if(ch===63){if(atExplicitKey){storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,null,_keyLine,_keyLineStart,_keyPos);keyTag=keyNode=valueNode=null}detected=true;atExplicitKey=true;allowCompact=true}else if(atExplicitKey){atExplicitKey=false;allowCompact=true}else{throwError(state,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line")}state.position+=1;ch=following}else{_keyLine=state.line;_keyLineStart=state.lineStart;_keyPos=state.position;if(!composeNode(state,flowIndent,CONTEXT_FLOW_OUT,false,true)){break}if(state.line===_line){ch=state.input.charCodeAt(state.position);while(is_WHITE_SPACE(ch)){ch=state.input.charCodeAt(++state.position)}if(ch===58){ch=state.input.charCodeAt(++state.position);if(!is_WS_OR_EOL(ch)){throwError(state,"a whitespace character is expected after the key-value separator within a block mapping")}if(atExplicitKey){storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,null,_keyLine,_keyLineStart,_keyPos);keyTag=keyNode=valueNode=null}detected=true;atExplicitKey=false;allowCompact=false;keyTag=state.tag;keyNode=state.result}else if(detected){throwError(state,"can not read an implicit mapping pair; a colon is missed")}else{state.tag=_tag;state.anchor=_anchor;return true}}else if(detected){throwError(state,"can not read a block mapping entry; a multiline key may not be an implicit key")}else{state.tag=_tag;state.anchor=_anchor;return true}}if(state.line===_line||state.lineIndent>nodeIndent){if(atExplicitKey){_keyLine=state.line;_keyLineStart=state.lineStart;_keyPos=state.position}if(composeNode(state,nodeIndent,CONTEXT_BLOCK_OUT,true,allowCompact)){if(atExplicitKey){keyNode=state.result}else{valueNode=state.result}}if(!atExplicitKey){storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,valueNode,_keyLine,_keyLineStart,_keyPos);keyTag=keyNode=valueNode=null}skipSeparationSpace(state,true,-1);ch=state.input.charCodeAt(state.position)}if((state.line===_line||state.lineIndent>nodeIndent)&&ch!==0){throwError(state,"bad indentation of a mapping entry")}else if(state.lineIndent<nodeIndent){break}}if(atExplicitKey){storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,null,_keyLine,_keyLineStart,_keyPos)}if(detected){state.tag=_tag;state.anchor=_anchor;state.kind="mapping";state.result=_result}return detected}function readTagProperty(state){var _position,isVerbatim=false,isNamed=false,tagHandle,tagName,ch;ch=state.input.charCodeAt(state.position);if(ch!==33)return false;if(state.tag!==null){throwError(state,"duplication of a tag property")}ch=state.input.charCodeAt(++state.position);if(ch===60){isVerbatim=true;ch=state.input.charCodeAt(++state.position)}else if(ch===33){isNamed=true;tagHandle="!!";ch=state.input.charCodeAt(++state.position)}else{tagHandle="!"}_position=state.position;if(isVerbatim){do{ch=state.input.charCodeAt(++state.position)}while(ch!==0&&ch!==62);if(state.position<state.length){tagName=state.input.slice(_position,state.position);ch=state.input.charCodeAt(++state.position)}else{throwError(state,"unexpected end of the stream within a verbatim tag")}}else{while(ch!==0&&!is_WS_OR_EOL(ch)){if(ch===33){if(!isNamed){tagHandle=state.input.slice(_position-1,state.position+1);if(!PATTERN_TAG_HANDLE.test(tagHandle)){throwError(state,"named tag handle cannot contain such characters")}isNamed=true;_position=state.position+1}else{throwError(state,"tag suffix cannot contain exclamation marks")}}ch=state.input.charCodeAt(++state.position)}tagName=state.input.slice(_position,state.position);if(PATTERN_FLOW_INDICATORS.test(tagName)){throwError(state,"tag suffix cannot contain flow indicator characters")}}if(tagName&&!PATTERN_TAG_URI.test(tagName)){throwError(state,"tag name cannot contain such characters: "+tagName)}try{tagName=decodeURIComponent(tagName)}catch(err){throwError(state,"tag name is malformed: "+tagName)}if(isVerbatim){state.tag=tagName}else if(_hasOwnProperty.call(state.tagMap,tagHandle)){state.tag=state.tagMap[tagHandle]+tagName}else if(tagHandle==="!"){state.tag="!"+tagName}else if(tagHandle==="!!"){state.tag="tag:yaml.org,2002:"+tagName}else{throwError(state,'undeclared tag handle "'+tagHandle+'"')}return true}function readAnchorProperty(state){var _position,ch;ch=state.input.charCodeAt(state.position);if(ch!==38)return false;if(state.anchor!==null){throwError(state,"duplication of an anchor property")}ch=state.input.charCodeAt(++state.position);_position=state.position;while(ch!==0&&!is_WS_OR_EOL(ch)&&!is_FLOW_INDICATOR(ch)){ch=state.input.charCodeAt(++state.position)}if(state.position===_position){throwError(state,"name of an anchor node must contain at least one character")}state.anchor=state.input.slice(_position,state.position);return true}function readAlias(state){var _position,alias,ch;ch=state.input.charCodeAt(state.position);if(ch!==42)return false;ch=state.input.charCodeAt(++state.position);_position=state.position;while(ch!==0&&!is_WS_OR_EOL(ch)&&!is_FLOW_INDICATOR(ch)){ch=state.input.charCodeAt(++state.position)}if(state.position===_position){throwError(state,"name of an alias node must contain at least one character")}alias=state.input.slice(_position,state.position);if(!_hasOwnProperty.call(state.anchorMap,alias)){throwError(state,'unidentified alias "'+alias+'"')}state.result=state.anchorMap[alias];skipSeparationSpace(state,true,-1);return true}function composeNode(state,parentIndent,nodeContext,allowToSeek,allowCompact){var allowBlockStyles,allowBlockScalars,allowBlockCollections,indentStatus=1,atNewLine=false,hasContent=false,typeIndex,typeQuantity,typeList,type,flowIndent,blockIndent;if(state.listener!==null){state.listener("open",state)}state.tag=null;state.anchor=null;state.kind=null;state.result=null;allowBlockStyles=allowBlockScalars=allowBlockCollections=CONTEXT_BLOCK_OUT===nodeContext||CONTEXT_BLOCK_IN===nodeContext;if(allowToSeek){if(skipSeparationSpace(state,true,-1)){atNewLine=true;if(state.lineIndent>parentIndent){indentStatus=1}else if(state.lineIndent===parentIndent){indentStatus=0}else if(state.lineIndent<parentIndent){indentStatus=-1}}}if(indentStatus===1){while(readTagProperty(state)||readAnchorProperty(state)){if(skipSeparationSpace(state,true,-1)){atNewLine=true;allowBlockCollections=allowBlockStyles;if(state.lineIndent>parentIndent){indentStatus=1}else if(state.lineIndent===parentIndent){indentStatus=0}else if(state.lineIndent<parentIndent){indentStatus=-1}}else{allowBlockCollections=false}}}if(allowBlockCollections){allowBlockCollections=atNewLine||allowCompact}if(indentStatus===1||CONTEXT_BLOCK_OUT===nodeContext){if(CONTEXT_FLOW_IN===nodeContext||CONTEXT_FLOW_OUT===nodeContext){flowIndent=parentIndent}else{flowIndent=parentIndent+1}blockIndent=state.position-state.lineStart;if(indentStatus===1){if(allowBlockCollections&&(readBlockSequence(state,blockIndent)||readBlockMapping(state,blockIndent,flowIndent))||readFlowCollection(state,flowIndent)){hasContent=true}else{if(allowBlockScalars&&readBlockScalar(state,flowIndent)||readSingleQuotedScalar(state,flowIndent)||readDoubleQuotedScalar(state,flowIndent)){hasContent=true}else if(readAlias(state)){hasContent=true;if(state.tag!==null||state.anchor!==null){throwError(state,"alias node should not have any properties")}}else if(readPlainScalar(state,flowIndent,CONTEXT_FLOW_IN===nodeContext)){hasContent=true;if(state.tag===null){state.tag="?"}}if(state.anchor!==null){state.anchorMap[state.anchor]=state.result}}}else if(indentStatus===0){hasContent=allowBlockCollections&&readBlockSequence(state,blockIndent)}}if(state.tag===null){if(state.anchor!==null){state.anchorMap[state.anchor]=state.result}}else if(state.tag==="?"){if(state.result!==null&&state.kind!=="scalar"){throwError(state,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+state.kind+'"')}for(typeIndex=0,typeQuantity=state.implicitTypes.length;typeIndex<typeQuantity;typeIndex+=1){type=state.implicitTypes[typeIndex];if(type.resolve(state.result)){state.result=type.construct(state.result);state.tag=type.tag;if(state.anchor!==null){state.anchorMap[state.anchor]=state.result}break}}}else if(state.tag!=="!"){if(_hasOwnProperty.call(state.typeMap[state.kind||"fallback"],state.tag)){type=state.typeMap[state.kind||"fallback"][state.tag]}else{type=null;typeList=state.typeMap.multi[state.kind||"fallback"];for(typeIndex=0,typeQuantity=typeList.length;typeIndex<typeQuantity;typeIndex+=1){if(state.tag.slice(0,typeList[typeIndex].tag.length)===typeList[typeIndex].tag){type=typeList[typeIndex];break}}}if(!type){throwError(state,"unknown tag !<"+state.tag+">")}if(state.result!==null&&type.kind!==state.kind){throwError(state,"unacceptable node kind for !<"+state.tag+'> tag; it should be "'+type.kind+'", not "'+state.kind+'"')}if(!type.resolve(state.result,state.tag)){throwError(state,"cannot resolve a node with !<"+state.tag+"> explicit tag")}else{state.result=type.construct(state.result,state.tag);if(state.anchor!==null){state.anchorMap[state.anchor]=state.result}}}if(state.listener!==null){state.listener("close",state)}return state.tag!==null||state.anchor!==null||hasContent}function readDocument(state){var documentStart=state.position,_position,directiveName,directiveArgs,hasDirectives=false,ch;state.version=null;state.checkLineBreaks=state.legacy;state.tagMap=Object.create(null);state.anchorMap=Object.create(null);while((ch=state.input.charCodeAt(state.position))!==0){skipSeparationSpace(state,true,-1);ch=state.input.charCodeAt(state.position);if(state.lineIndent>0||ch!==37){break}hasDirectives=true;ch=state.input.charCodeAt(++state.position);_position=state.position;while(ch!==0&&!is_WS_OR_EOL(ch)){ch=state.input.charCodeAt(++state.position)}directiveName=state.input.slice(_position,state.position);directiveArgs=[];if(directiveName.length<1){throwError(state,"directive name must not be less than one character in length")}while(ch!==0){while(is_WHITE_SPACE(ch)){ch=state.input.charCodeAt(++state.position)}if(ch===35){do{ch=state.input.charCodeAt(++state.position)}while(ch!==0&&!is_EOL(ch));break}if(is_EOL(ch))break;_position=state.position;while(ch!==0&&!is_WS_OR_EOL(ch)){ch=state.input.charCodeAt(++state.position)}directiveArgs.push(state.input.slice(_position,state.position))}if(ch!==0)readLineBreak(state);if(_hasOwnProperty.call(directiveHandlers,directiveName)){directiveHandlers[directiveName](state,directiveName,directiveArgs)}else{throwWarning(state,'unknown document directive "'+directiveName+'"')}}skipSeparationSpace(state,true,-1);if(state.lineIndent===0&&state.input.charCodeAt(state.position)===45&&state.input.charCodeAt(state.position+1)===45&&state.input.charCodeAt(state.position+2)===45){state.position+=3;skipSeparationSpace(state,true,-1)}else if(hasDirectives){throwError(state,"directives end mark is expected")}composeNode(state,state.lineIndent-1,CONTEXT_BLOCK_OUT,false,true);skipSeparationSpace(state,true,-1);if(state.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart,state.position))){throwWarning(state,"non-ASCII line breaks are interpreted as content")}state.documents.push(state.result);if(state.position===state.lineStart&&testDocumentSeparator(state)){if(state.input.charCodeAt(state.position)===46){state.position+=3;skipSeparationSpace(state,true,-1)}return}if(state.position<state.length-1){throwError(state,"end of the stream or a document separator is expected")}else{return}}function loadDocuments(input,options){input=String(input);options=options||{};if(input.length!==0){if(input.charCodeAt(input.length-1)!==10&&input.charCodeAt(input.length-1)!==13){input+="\n"}if(input.charCodeAt(0)===65279){input=input.slice(1)}}var state=new State(input,options);var nullpos=input.indexOf("\0");if(nullpos!==-1){state.position=nullpos;throwError(state,"null byte is not allowed in input")}state.input+="\0";while(state.input.charCodeAt(state.position)===32){state.lineIndent+=1;state.position+=1}while(state.position<state.length-1){readDocument(state)}return state.documents}function loadAll(input,iterator,options){if(iterator!==null&&typeof iterator==="object"&&typeof options==="undefined"){options=iterator;iterator=null}var documents=loadDocuments(input,options);if(typeof iterator!=="function"){return documents}for(var index=0,length=documents.length;index<length;index+=1){iterator(documents[index])}}function load(input,options){var documents=loadDocuments(input,options);if(documents.length===0){return undefined}else if(documents.length===1){return documents[0]}throw new YAMLException("expected a single document in the stream, but found more")}module.exports.loadAll=loadAll;module.exports.load=load},{"./common":287,"./exception":289,"./schema/default":293,"./snippet":296}],291:[function(require,module,exports){"use strict";var YAMLException=require("./exception");var Type=require("./type");function compileList(schema,name){var result=[];schema[name].forEach((function(currentType){var newIndex=result.length;result.forEach((function(previousType,previousIndex){if(previousType.tag===currentType.tag&&previousType.kind===currentType.kind&&previousType.multi===currentType.multi){newIndex=previousIndex}}));result[newIndex]=currentType}));return result}function compileMap(){var result={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},index,length;function collectType(type){if(type.multi){result.multi[type.kind].push(type);result.multi["fallback"].push(type)}else{result[type.kind][type.tag]=result["fallback"][type.tag]=type}}for(index=0,length=arguments.length;index<length;index+=1){arguments[index].forEach(collectType)}return result}function Schema(definition){return this.extend(definition)}Schema.prototype.extend=function extend(definition){var implicit=[];var explicit=[];if(definition instanceof Type){explicit.push(definition)}else if(Array.isArray(definition)){explicit=explicit.concat(definition)}else if(definition&&(Array.isArray(definition.implicit)||Array.isArray(definition.explicit))){if(definition.implicit)implicit=implicit.concat(definition.implicit);if(definition.explicit)explicit=explicit.concat(definition.explicit)}else{throw new YAMLException("Schema.extend argument should be a Type, [ Type ], "+"or a schema definition ({ implicit: [...], explicit: [...] })")}implicit.forEach((function(type){if(!(type instanceof Type)){throw new YAMLException("Specified list of YAML types (or a single Type object) contains a non-Type object.")}if(type.loadKind&&type.loadKind!=="scalar"){throw new YAMLException("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}if(type.multi){throw new YAMLException("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}}));explicit.forEach((function(type){if(!(type instanceof Type)){throw new YAMLException("Specified list of YAML types (or a single Type object) contains a non-Type object.")}}));var result=Object.create(Schema.prototype);result.implicit=(this.implicit||[]).concat(implicit);result.explicit=(this.explicit||[]).concat(explicit);result.compiledImplicit=compileList(result,"implicit");result.compiledExplicit=compileList(result,"explicit");result.compiledTypeMap=compileMap(result.compiledImplicit,result.compiledExplicit);return result};module.exports=Schema},{"./exception":289,"./type":297}],292:[function(require,module,exports){"use strict";module.exports=require("./json")},{"./json":295}],293:[function(require,module,exports){"use strict";module.exports=require("./core").extend({implicit:[require("../type/timestamp"),require("../type/merge")],explicit:[require("../type/binary"),require("../type/omap"),require("../type/pairs"),require("../type/set")]})},{"../type/binary":298,"../type/merge":303,"../type/omap":305,"../type/pairs":306,"../type/set":308,"../type/timestamp":310,"./core":292}],294:[function(require,module,exports){"use strict";var Schema=require("../schema");module.exports=new Schema({explicit:[require("../type/str"),require("../type/seq"),require("../type/map")]})},{"../schema":291,"../type/map":302,"../type/seq":307,"../type/str":309}],295:[function(require,module,exports){"use strict";module.exports=require("./failsafe").extend({implicit:[require("../type/null"),require("../type/bool"),require("../type/int"),require("../type/float")]})},{"../type/bool":299,"../type/float":300,"../type/int":301,"../type/null":304,"./failsafe":294}],296:[function(require,module,exports){"use strict";var common=require("./common");function getLine(buffer,lineStart,lineEnd,position,maxLineLength){var head="";var tail="";var maxHalfLength=Math.floor(maxLineLength/2)-1;if(position-lineStart>maxHalfLength){head=" ... ";lineStart=position-maxHalfLength+head.length}if(lineEnd-position>maxHalfLength){tail=" ...";lineEnd=position+maxHalfLength-tail.length}return{str:head+buffer.slice(lineStart,lineEnd).replace(/\t/g,"→")+tail,pos:position-lineStart+head.length}}function padStart(string,max){return common.repeat(" ",max-string.length)+string}function makeSnippet(mark,options){options=Object.create(options||null);if(!mark.buffer)return null;if(!options.maxLength)options.maxLength=79;if(typeof options.indent!=="number")options.indent=1;if(typeof options.linesBefore!=="number")options.linesBefore=3;if(typeof options.linesAfter!=="number")options.linesAfter=2;var re=/\r?\n|\r|\0/g;var lineStarts=[0];var lineEnds=[];var match;var foundLineNo=-1;while(match=re.exec(mark.buffer)){lineEnds.push(match.index);lineStarts.push(match.index+match[0].length);if(mark.position<=match.index&&foundLineNo<0){foundLineNo=lineStarts.length-2}}if(foundLineNo<0)foundLineNo=lineStarts.length-1;var result="",i,line;var lineNoLength=Math.min(mark.line+options.linesAfter,lineEnds.length).toString().length;var maxLineLength=options.maxLength-(options.indent+lineNoLength+3);for(i=1;i<=options.linesBefore;i++){if(foundLineNo-i<0)break;line=getLine(mark.buffer,lineStarts[foundLineNo-i],lineEnds[foundLineNo-i],mark.position-(lineStarts[foundLineNo]-lineStarts[foundLineNo-i]),maxLineLength);result=common.repeat(" ",options.indent)+padStart((mark.line-i+1).toString(),lineNoLength)+" | "+line.str+"\n"+result}line=getLine(mark.buffer,lineStarts[foundLineNo],lineEnds[foundLineNo],mark.position,maxLineLength);result+=common.repeat(" ",options.indent)+padStart((mark.line+1).toString(),lineNoLength)+" | "+line.str+"\n";result+=common.repeat("-",options.indent+lineNoLength+3+line.pos)+"^"+"\n";for(i=1;i<=options.linesAfter;i++){if(foundLineNo+i>=lineEnds.length)break;line=getLine(mark.buffer,lineStarts[foundLineNo+i],lineEnds[foundLineNo+i],mark.position-(lineStarts[foundLineNo]-lineStarts[foundLineNo+i]),maxLineLength);result+=common.repeat(" ",options.indent)+padStart((mark.line+i+1).toString(),lineNoLength)+" | "+line.str+"\n"}return result.replace(/\n$/,"")}module.exports=makeSnippet},{"./common":287}],297:[function(require,module,exports){"use strict";var YAMLException=require("./exception");var TYPE_CONSTRUCTOR_OPTIONS=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"];var YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(map){var result={};if(map!==null){Object.keys(map).forEach((function(style){map[style].forEach((function(alias){result[String(alias)]=style}))}))}return result}function Type(tag,options){options=options||{};Object.keys(options).forEach((function(name){if(TYPE_CONSTRUCTOR_OPTIONS.indexOf(name)===-1){throw new YAMLException('Unknown option "'+name+'" is met in definition of "'+tag+'" YAML type.')}}));this.options=options;this.tag=tag;this.kind=options["kind"]||null;this.resolve=options["resolve"]||function(){return true};this.construct=options["construct"]||function(data){return data};this.instanceOf=options["instanceOf"]||null;this.predicate=options["predicate"]||null;this.represent=options["represent"]||null;this.representName=options["representName"]||null;this.defaultStyle=options["defaultStyle"]||null;this.multi=options["multi"]||false;this.styleAliases=compileStyleAliases(options["styleAliases"]||null);if(YAML_NODE_KINDS.indexOf(this.kind)===-1){throw new YAMLException('Unknown kind "'+this.kind+'" is specified for "'+tag+'" YAML type.')}}module.exports=Type},{"./exception":289}],298:[function(require,module,exports){"use strict";var Type=require("../type");var BASE64_MAP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";function resolveYamlBinary(data){if(data===null)return false;var code,idx,bitlen=0,max=data.length,map=BASE64_MAP;for(idx=0;idx<max;idx++){code=map.indexOf(data.charAt(idx));if(code>64)continue;if(code<0)return false;bitlen+=6}return bitlen%8===0}function constructYamlBinary(data){var idx,tailbits,input=data.replace(/[\r\n=]/g,""),max=input.length,map=BASE64_MAP,bits=0,result=[];for(idx=0;idx<max;idx++){if(idx%4===0&&idx){result.push(bits>>16&255);result.push(bits>>8&255);result.push(bits&255)}bits=bits<<6|map.indexOf(input.charAt(idx))}tailbits=max%4*6;if(tailbits===0){result.push(bits>>16&255);result.push(bits>>8&255);result.push(bits&255)}else if(tailbits===18){result.push(bits>>10&255);result.push(bits>>2&255)}else if(tailbits===12){result.push(bits>>4&255)}return new Uint8Array(result)}function representYamlBinary(object){var result="",bits=0,idx,tail,max=object.length,map=BASE64_MAP;for(idx=0;idx<max;idx++){if(idx%3===0&&idx){result+=map[bits>>18&63];result+=map[bits>>12&63];result+=map[bits>>6&63];result+=map[bits&63]}bits=(bits<<8)+object[idx]}tail=max%3;if(tail===0){result+=map[bits>>18&63];result+=map[bits>>12&63];result+=map[bits>>6&63];result+=map[bits&63]}else if(tail===2){result+=map[bits>>10&63];result+=map[bits>>4&63];result+=map[bits<<2&63];result+=map[64]}else if(tail===1){result+=map[bits>>2&63];result+=map[bits<<4&63];result+=map[64];result+=map[64]}return result}function isBinary(obj){return Object.prototype.toString.call(obj)==="[object Uint8Array]"}module.exports=new Type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary})},{"../type":297}],299:[function(require,module,exports){"use strict";var Type=require("../type");function resolveYamlBoolean(data){if(data===null)return false;var max=data.length;return max===4&&(data==="true"||data==="True"||data==="TRUE")||max===5&&(data==="false"||data==="False"||data==="FALSE")}function constructYamlBoolean(data){return data==="true"||data==="True"||data==="TRUE"}function isBoolean(object){return Object.prototype.toString.call(object)==="[object Boolean]"}module.exports=new Type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean,represent:{lowercase:function(object){return object?"true":"false"},uppercase:function(object){return object?"TRUE":"FALSE"},camelcase:function(object){return object?"True":"False"}},defaultStyle:"lowercase"})},{"../type":297}],300:[function(require,module,exports){"use strict";var common=require("../common");var Type=require("../type");var YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?"+"|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?"+"|[-+]?\\.(?:inf|Inf|INF)"+"|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(data){if(data===null)return false;if(!YAML_FLOAT_PATTERN.test(data)||data[data.length-1]==="_"){return false}return true}function constructYamlFloat(data){var value,sign;value=data.replace(/_/g,"").toLowerCase();sign=value[0]==="-"?-1:1;if("+-".indexOf(value[0])>=0){value=value.slice(1)}if(value===".inf"){return sign===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY}else if(value===".nan"){return NaN}return sign*parseFloat(value,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(object,style){var res;if(isNaN(object)){switch(style){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}}else if(Number.POSITIVE_INFINITY===object){switch(style){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}}else if(Number.NEGATIVE_INFINITY===object){switch(style){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}}else if(common.isNegativeZero(object)){return"-0.0"}res=object.toString(10);return SCIENTIFIC_WITHOUT_DOT.test(res)?res.replace("e",".e"):res}function isFloat(object){return Object.prototype.toString.call(object)==="[object Number]"&&(object%1!==0||common.isNegativeZero(object))}module.exports=new Type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"})},{"../common":287,"../type":297}],301:[function(require,module,exports){"use strict";var common=require("../common");var Type=require("../type");function isHexCode(c){return 48<=c&&c<=57||65<=c&&c<=70||97<=c&&c<=102}function isOctCode(c){return 48<=c&&c<=55}function isDecCode(c){return 48<=c&&c<=57}function resolveYamlInteger(data){if(data===null)return false;var max=data.length,index=0,hasDigits=false,ch;if(!max)return false;ch=data[index];if(ch==="-"||ch==="+"){ch=data[++index]}if(ch==="0"){if(index+1===max)return true;ch=data[++index];if(ch==="b"){index++;for(;index<max;index++){ch=data[index];if(ch==="_")continue;if(ch!=="0"&&ch!=="1")return false;hasDigits=true}return hasDigits&&ch!=="_"}if(ch==="x"){index++;for(;index<max;index++){ch=data[index];if(ch==="_")continue;if(!isHexCode(data.charCodeAt(index)))return false;hasDigits=true}return hasDigits&&ch!=="_"}if(ch==="o"){index++;for(;index<max;index++){ch=data[index];if(ch==="_")continue;if(!isOctCode(data.charCodeAt(index)))return false;hasDigits=true}return hasDigits&&ch!=="_"}}if(ch==="_")return false;for(;index<max;index++){ch=data[index];if(ch==="_")continue;if(!isDecCode(data.charCodeAt(index))){return false}hasDigits=true}if(!hasDigits||ch==="_")return false;return true}function constructYamlInteger(data){var value=data,sign=1,ch;if(value.indexOf("_")!==-1){value=value.replace(/_/g,"")}ch=value[0];if(ch==="-"||ch==="+"){if(ch==="-")sign=-1;value=value.slice(1);ch=value[0]}if(value==="0")return 0;if(ch==="0"){if(value[1]==="b")return sign*parseInt(value.slice(2),2);if(value[1]==="x")return sign*parseInt(value.slice(2),16);if(value[1]==="o")return sign*parseInt(value.slice(2),8)}return sign*parseInt(value,10)}function isInteger(object){return Object.prototype.toString.call(object)==="[object Number]"&&(object%1===0&&!common.isNegativeZero(object))}module.exports=new Type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(obj){return obj>=0?"0b"+obj.toString(2):"-0b"+obj.toString(2).slice(1)},octal:function(obj){return obj>=0?"0o"+obj.toString(8):"-0o"+obj.toString(8).slice(1)},decimal:function(obj){return obj.toString(10)},hexadecimal:function(obj){return obj>=0?"0x"+obj.toString(16).toUpperCase():"-0x"+obj.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},{"../common":287,"../type":297}],302:[function(require,module,exports){"use strict";var Type=require("../type");module.exports=new Type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(data){return data!==null?data:{}}})},{"../type":297}],303:[function(require,module,exports){"use strict";var Type=require("../type");function resolveYamlMerge(data){return data==="<<"||data===null}module.exports=new Type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge})},{"../type":297}],304:[function(require,module,exports){"use strict";var Type=require("../type");function resolveYamlNull(data){if(data===null)return true;var max=data.length;return max===1&&data==="~"||max===4&&(data==="null"||data==="Null"||data==="NULL")}function constructYamlNull(){return null}function isNull(object){return object===null}module.exports=new Type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"})},{"../type":297}],305:[function(require,module,exports){"use strict";var Type=require("../type");var _hasOwnProperty=Object.prototype.hasOwnProperty;var _toString=Object.prototype.toString;function resolveYamlOmap(data){if(data===null)return true;var objectKeys=[],index,length,pair,pairKey,pairHasKey,object=data;for(index=0,length=object.length;index<length;index+=1){pair=object[index];pairHasKey=false;if(_toString.call(pair)!=="[object Object]")return false;for(pairKey in pair){if(_hasOwnProperty.call(pair,pairKey)){if(!pairHasKey)pairHasKey=true;else return false}}if(!pairHasKey)return false;if(objectKeys.indexOf(pairKey)===-1)objectKeys.push(pairKey);else return false}return true}function constructYamlOmap(data){return data!==null?data:[]}module.exports=new Type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap})},{"../type":297}],306:[function(require,module,exports){"use strict";var Type=require("../type");var _toString=Object.prototype.toString;function resolveYamlPairs(data){if(data===null)return true;var index,length,pair,keys,result,object=data;result=new Array(object.length);for(index=0,length=object.length;index<length;index+=1){pair=object[index];if(_toString.call(pair)!=="[object Object]")return false;keys=Object.keys(pair);if(keys.length!==1)return false;result[index]=[keys[0],pair[keys[0]]]}return true}function constructYamlPairs(data){if(data===null)return[];var index,length,pair,keys,result,object=data;result=new Array(object.length);for(index=0,length=object.length;index<length;index+=1){pair=object[index];keys=Object.keys(pair);result[index]=[keys[0],pair[keys[0]]]}return result}module.exports=new Type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs})},{"../type":297}],307:[function(require,module,exports){"use strict";var Type=require("../type");module.exports=new Type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(data){return data!==null?data:[]}})},{"../type":297}],308:[function(require,module,exports){"use strict";var Type=require("../type");var _hasOwnProperty=Object.prototype.hasOwnProperty;function resolveYamlSet(data){if(data===null)return true;var key,object=data;for(key in object){if(_hasOwnProperty.call(object,key)){if(object[key]!==null)return false}}return true}function constructYamlSet(data){return data!==null?data:{}}module.exports=new Type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet})},{"../type":297}],309:[function(require,module,exports){"use strict";var Type=require("../type");module.exports=new Type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(data){return data!==null?data:""}})},{"../type":297}],310:[function(require,module,exports){"use strict";var Type=require("../type");var YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])"+"-([0-9][0-9])"+"-([0-9][0-9])$");var YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])"+"-([0-9][0-9]?)"+"-([0-9][0-9]?)"+"(?:[Tt]|[ \\t]+)"+"([0-9][0-9]?)"+":([0-9][0-9])"+":([0-9][0-9])"+"(?:\\.([0-9]*))?"+"(?:[ \\t]*(Z|([-+])([0-9][0-9]?)"+"(?::([0-9][0-9]))?))?$");function resolveYamlTimestamp(data){if(data===null)return false;if(YAML_DATE_REGEXP.exec(data)!==null)return true;if(YAML_TIMESTAMP_REGEXP.exec(data)!==null)return true;return false}function constructYamlTimestamp(data){var match,year,month,day,hour,minute,second,fraction=0,delta=null,tz_hour,tz_minute,date;match=YAML_DATE_REGEXP.exec(data);if(match===null)match=YAML_TIMESTAMP_REGEXP.exec(data);if(match===null)throw new Error("Date resolve error");year=+match[1];month=+match[2]-1;day=+match[3];if(!match[4]){return new Date(Date.UTC(year,month,day))}hour=+match[4];minute=+match[5];second=+match[6];if(match[7]){fraction=match[7].slice(0,3);while(fraction.length<3){fraction+="0"}fraction=+fraction}if(match[9]){tz_hour=+match[10];tz_minute=+(match[11]||0);delta=(tz_hour*60+tz_minute)*6e4;if(match[9]==="-")delta=-delta}date=new Date(Date.UTC(year,month,day,hour,minute,second,fraction));if(delta)date.setTime(date.getTime()-delta);return date}function representYamlTimestamp(object){return object.toISOString()}module.exports=new Type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp})},{"../type":297}],311:[function(require,module,exports){const color=require("cli-color");const{extendedTypeOf:extendedTypeOf}=require("./util");const Theme={" "(s){return s},"+":color.green,"-":color.red};const subcolorizeToCallback=function(options,key,diff,output,color,indent){let subvalue;const prefix=key?`${key}: `:"";const subindent=indent+"  ";const outputElisions=n=>{let maxElisions=options.maxElisions===undefined?Infinity:options.maxElisions;if(n<maxElisions){for(let i=0;i<n;i++){output(" ",subindent+"...")}}else{output(" ",subindent+`... (${n} entries)`)}};switch(extendedTypeOf(diff)){case"object":if("__old"in diff&&"__new"in diff&&Object.keys(diff).length===2){subcolorizeToCallback(options,key,diff.__old,output,"-",indent);return subcolorizeToCallback(options,key,diff.__new,output,"+",indent)}else{output(color,`${indent}${prefix}{`);for(const subkey of Object.keys(diff)){let m;subvalue=diff[subkey];if(m=subkey.match(/^(.*)__deleted$/)){subcolorizeToCallback(options,m[1],subvalue,output,"-",subindent)}else if(m=subkey.match(/^(.*)__added$/)){subcolorizeToCallback(options,m[1],subvalue,output,"+",subindent)}else{subcolorizeToCallback(options,subkey,subvalue,output,color,subindent)}}return output(color,`${indent}}`)}case"array":{output(color,`${indent}${prefix}[`);let looksLikeDiff=true;for(const item of diff){if(extendedTypeOf(item)!=="array"||!(item.length===2||item.length===1&&item[0]===" ")||!(typeof item[0]==="string")||item[0].length!==1||![" ","-","+","~"].includes(item[0])){looksLikeDiff=false}}if(looksLikeDiff){let op;let elisionCount=0;for([op,subvalue]of diff){if(op===" "&&subvalue==null){elisionCount++}else{if(elisionCount>0){outputElisions(elisionCount)}elisionCount=0;if(![" ","~","+","-"].includes(op)){throw new Error(`Unexpected op '${op}' in ${JSON.stringify(diff,null,2)}`)}if(op==="~"){op=" "}subcolorizeToCallback(options,"",subvalue,output,op,subindent)}}if(elisionCount>0){outputElisions(elisionCount)}}else{for(subvalue of diff){subcolorizeToCallback(options,"",subvalue,output,color,subindent)}}return output(color,`${indent}]`)}default:if(diff===0||diff===null||diff===false||diff===""||diff){return output(color,indent+prefix+JSON.stringify(diff))}}};const colorizeToCallback=(diff,options,output)=>subcolorizeToCallback(options,"",diff,output," ","");const colorizeToArray=function(diff,options={}){const output=[];colorizeToCallback(diff,options,((color,line)=>output.push(`${color}${line}`)));return output};const colorize=function(diff,options={}){const output=[];colorizeToCallback(diff,options,(function(color,line){if(options.color!=null?options.color:true){return output.push(((options.theme!=null?options.theme[color]:undefined)!=null?options.theme!=null?options.theme[color]:undefined:Theme[color])(`${color}${line}`)+"\n")}else{return output.push(`${color}${line}\n`)}}));return output.join("")};module.exports={colorize:colorize,colorizeToArray:colorizeToArray,colorizeToCallback:colorizeToCallback}},{"./util":313,"cli-color":162}],312:[function(require,module,exports){const{SequenceMatcher:SequenceMatcher}=require("@ewoudenberg/difflib");const{extendedTypeOf:extendedTypeOf,roundObj:roundObj}=require("./util");const{colorize:colorize}=require("./colorize");class JsonDiff{constructor(options){options.outputKeys=options.outputKeys||[];options.excludeKeys=options.excludeKeys||[];this.options=options}isScalar(obj){return typeof obj!=="object"||obj===null}objectDiff(obj1,obj2){let result={};let score=0;let equal=true;for(const[key,value]of Object.entries(obj1)){if(!this.options.outputNewOnly){let postfix="__deleted";if(!(key in obj2)&&!this.options.excludeKeys.includes(key)){result[`${key}${postfix}`]=value;score-=30;equal=false}}}for(const[key,value]of Object.entries(obj2)){let postfix=!this.options.outputNewOnly?"__added":"";if(!(key in obj1)&&!this.options.excludeKeys.includes(key)){result[`${key}${postfix}`]=value;score-=30;equal=false}}for(const[key,value1]of Object.entries(obj1)){if(key in obj2){score+=20;const value2=obj2[key];const change=this.diff(value1,value2);if(!change.equal){result[key]=change.result;equal=false}else if(this.options.full||this.options.outputKeys.includes(key)){result[key]=value1}score+=Math.min(20,Math.max(-10,change.score/5))}}if(equal){score=100*Math.max(Object.keys(obj1).length,.5);if(!this.options.full){result=undefined}}else{score=Math.max(0,score)}return{score:score,result:result,equal:equal}}findMatchingObject(item,index,fuzzyOriginals){let bestMatch=null;for(const[key,{item:candidate,index:matchIndex}]of Object.entries(fuzzyOriginals)){if(key!=="__next"){const indexDistance=Math.abs(matchIndex-index);if(extendedTypeOf(item)===extendedTypeOf(candidate)){const{score:score}=this.diff(item,candidate);if(!bestMatch||score>bestMatch.score||score===bestMatch.score&&indexDistance<bestMatch.indexDistance){bestMatch={score:score,key:key,indexDistance:indexDistance}}}}}return bestMatch}scalarize(array,originals,fuzzyOriginals){const fuzzyMatches=[];if(fuzzyOriginals){const keyScores={};for(let index=0;index<array.length;index++){const item=array[index];if(this.isScalar(item)){continue}const bestMatch=this.findMatchingObject(item,index,fuzzyOriginals);if(bestMatch&&(!keyScores[bestMatch.key]||bestMatch.score>keyScores[bestMatch.key].score)){keyScores[bestMatch.key]={score:bestMatch.score,index:index}}}for(const[key,match]of Object.entries(keyScores)){fuzzyMatches[match.index]=key}}const result=[];for(let index=0;index<array.length;index++){const item=array[index];if(this.isScalar(item)){result.push(item)}else{const key=fuzzyMatches[index]||"__$!SCALAR"+originals.__next++;originals[key]={item:item,index:index};result.push(key)}}return result}isScalarized(item,originals){return typeof item==="string"&&item in originals}descalarize(item,originals){if(this.isScalarized(item,originals)){return originals[item].item}else{return item}}arrayDiff(obj1,obj2){const originals1={__next:1};const seq1=this.scalarize(obj1,originals1);const originals2={__next:originals1.__next};const seq2=this.scalarize(obj2,originals2,originals1);if(this.options.sort){seq1.sort();seq2.sort()}const opcodes=new SequenceMatcher(null,seq1,seq2).getOpcodes();let result=[];let score=0;let equal=true;for(const[op,i1,i2,j1,j2]of opcodes){let i,j;let asc,end;let asc1,end1;let asc2,end2;if(!(op==="equal"||this.options.keysOnly&&op==="replace")){equal=false}switch(op){case"equal":for(i=i1,end=i2,asc=i1<=end;asc?i<end:i>end;asc?i++:i--){const item=seq1[i];if(this.isScalarized(item,originals1)){if(!this.isScalarized(item,originals2)){throw new Error(`internal bug: isScalarized(item, originals1) != isScalarized(item, originals2) for item ${JSON.stringify(item)}`)}const item1=this.descalarize(item,originals1);const item2=this.descalarize(item,originals2);const change=this.diff(item1,item2);if(!change.equal){result.push(["~",change.result]);equal=false}else{if(this.options.full||this.options.keepUnchangedValues){result.push([" ",item1])}else{result.push([" "])}}}else{if(this.options.full||this.options.keepUnchangedValues){result.push([" ",item])}else{result.push([" "])}}score+=10}break;case"delete":for(i=i1,end1=i2,asc1=i1<=end1;asc1?i<end1:i>end1;asc1?i++:i--){result.push(["-",this.descalarize(seq1[i],originals1)]);score-=5}break;case"insert":for(j=j1,end2=j2,asc2=j1<=end2;asc2?j<end2:j>end2;asc2?j++:j--){result.push(["+",this.descalarize(seq2[j],originals2)]);score-=5}break;case"replace":if(!this.options.keysOnly){let asc3,end3;let asc4,end4;for(i=i1,end3=i2,asc3=i1<=end3;asc3?i<end3:i>end3;asc3?i++:i--){result.push(["-",this.descalarize(seq1[i],originals1)]);score-=5}for(j=j1,end4=j2,asc4=j1<=end4;asc4?j<end4:j>end4;asc4?j++:j--){result.push(["+",this.descalarize(seq2[j],originals2)]);score-=5}}else{let asc5,end5;for(i=i1,end5=i2,asc5=i1<=end5;asc5?i<end5:i>end5;asc5?i++:i--){const change=this.diff(this.descalarize(seq1[i],originals1),this.descalarize(seq2[i-i1+j1],originals2));if(!change.equal){result.push(["~",change.result]);equal=false}else{result.push([" "])}}}break}}if(equal||opcodes.length===0){if(!this.options.full){result=undefined}else{result=obj1}score=100}else{score=Math.max(0,score)}return{score:score,result:result,equal:equal}}diff(obj1,obj2){const type1=extendedTypeOf(obj1);const type2=extendedTypeOf(obj2);if(type1===type2){switch(type1){case"object":return this.objectDiff(obj1,obj2);case"array":return this.arrayDiff(obj1,obj2)}}let score=100;let result=obj1;let equal;if(!this.options.keysOnly){equal=obj1===obj2;if(!equal){score=0;if(this.options.outputNewOnly){result=obj2}else{result={__old:obj1,__new:obj2}}}else if(!this.options.full){result=undefined}}else{equal=true;result=undefined}return{score:score,result:result,equal:equal}}}function diff(obj1,obj2,options={}){if(options.precision!==undefined){obj1=roundObj(obj1,options.precision);obj2=roundObj(obj2,options.precision)}return new JsonDiff(options).diff(obj1,obj2).result}function diffString(obj1,obj2,options={}){return colorize(diff(obj1,obj2,options),options)}module.exports={diff:diff,diffString:diffString}},{"./colorize":311,"./util":313,"@ewoudenberg/difflib":2}],313:[function(require,module,exports){const extendedTypeOf=function(obj){const result=typeof obj;if(obj==null){return"null"}else if(result==="object"&&obj.constructor===Array){return"array"}else{return result}};const roundObj=function(data,precision){const type=typeof data;if(type==="array"){return data.map((x=>roundObj(x,precision)))}else if(type==="object"){for(const key in data){data[key]=roundObj(data[key],precision)}return data}else if(type==="number"&&Number.isFinite(data)&&!Number.isInteger(data)){return+data.toFixed(precision)}else{return data}};module.exports={extendedTypeOf:extendedTypeOf,roundObj:roundObj}},{}],314:[function(require,module,exports){var backslash=require("backslash");module.exports={validate:validate,parse:parse};function validate(jsonString,allowDuplicatedKeys){var error;allowDuplicatedKeys=allowDuplicatedKeys||false;if(typeof jsonString!=="string"){error="Input must be a string"}else{try{_findValue(jsonString,0,allowDuplicatedKeys,false)}catch(e){error=e.message}}return error}function parse(jsonString,allowDuplicatedKeys){if(typeof jsonString!=="string"){throw new Error("Input must be a string")}allowDuplicatedKeys=allowDuplicatedKeys||false;var value=_findValue(jsonString,0,allowDuplicatedKeys,true);return value.value}function _findSeparator(str,startInd){var len=str.length;var sepStartInd=startInd;var sepEndInd;for(var i=startInd;i<len;i++){var ch=str[i];if(ch===","){sepEndInd=i;break}else if(ch==="]"||ch==="}"){sepEndInd=i-1;break}else if(!_isWhiteSpace(ch)){throw _syntaxError(str,i,"expecting end of expression or separator")}}var value;if(sepEndInd===undefined){sepEndInd=len;value=str[sepEndInd]}else{value=str[sepEndInd];sepEndInd++}return{start:sepStartInd,end:sepEndInd,value:value}}function _findSemiColonSeparator(str,startInd){var len=str.length;var semiColStartInd=startInd;var semiColEndInd;for(var i=startInd;i<len;i++){var ch=str[i];if(ch===":"){semiColEndInd=i;break}else if(!_isWhiteSpace(ch)){throw _syntaxError(str,i,"expecting ':'")}}if(semiColEndInd===undefined){throw _syntaxError(str,i,"expecting ':'")}semiColEndInd++;return{start:semiColStartInd,end:semiColEndInd}}function _findValue(str,startInd,allowDuplicatedKeys,parse){var len=str.length;var valueStartInd;var valueEndInd;var isArray=false;var isObject=false;var isString=false;var isNumber=false;var dotFound=false;var exponentInd;var exponentPostNumberCount=0;var whiteSpaceInNumber=false;var value;for(var i=startInd;i<len;i++){var ch=str[i];if(valueStartInd===undefined){if(!_isWhiteSpace(ch)){if(ch==="["){isArray=true}else if(ch==="{"){isObject=true}else if(ch==='"'){isString=true}else if(_isTrueFromIndex(str,i)){valueStartInd=i;i=i+3;valueEndInd=i;value=true;break}else if(_isFalseFromIndex(str,i)){valueStartInd=i;i=i+4;valueEndInd=i;value=false;break}else if(_isNullFromIndex(str,i)){valueStartInd=i;i=i+3;valueEndInd=i;value=null;break}else if(_isNumber(ch)){isNumber=true}else if(ch==="-"){isNumber=true}else{throw _syntaxError(str,i,"")}valueStartInd=i}}else{if(isArray){var arr=_findArray(str,i,allowDuplicatedKeys,parse);valueEndInd=arr.end;value=arr.value;break}else if(isObject){var obj=_findObject(str,i,allowDuplicatedKeys,parse);valueEndInd=obj.end;value=obj.value;break}else if(isString&&ch==='"'&&_hasEvenNumberOfBackSlash(str,i-1)){valueEndInd=i;value=backslash(str.substring(valueStartInd+1,valueEndInd));break}else if(isNumber){if(_isWhiteSpace(ch)){whiteSpaceInNumber=true}else if(ch===","||ch==="]"||ch==="}"){value=parseFloat(str.substring(valueStartInd,valueEndInd),10);valueEndInd=i-1;break}else if(_isNumber(ch)&&!whiteSpaceInNumber){if(exponentInd){exponentPostNumberCount++}continue}else if(ch==="."&&!dotFound&&!exponentInd&&!whiteSpaceInNumber){dotFound=true}else if((ch==="e"||ch==="E")&&!exponentInd&&!whiteSpaceInNumber){exponentInd=i}else if((ch==="+"||ch==="-")&&exponentInd===i-1&&!whiteSpaceInNumber){continue}else{throw _syntaxError(str,i,"expecting number")}}}}if(isNumber&&exponentInd&&!exponentPostNumberCount){throw _syntaxError(str,i,"expecting number")}if(valueEndInd===undefined){if(isNumber){value=parseFloat(str.substring(valueStartInd,i),10);valueEndInd=i-1}else{throw _syntaxError(str,i,"unclosed statement")}}valueEndInd++;return{value:value,start:valueStartInd,end:valueEndInd}}function _findKey(str,startInd){var len=str.length;var keyStartInd;var keyEndInd;for(var i=startInd;i<len;i++){var ch=str[i];if(keyStartInd===undefined){if(!_isWhiteSpace(ch)){if(ch!=='"'){throw _syntaxError(str,i,"expecting String")}keyStartInd=i}}else{if(ch==='"'&&_hasEvenNumberOfBackSlash(str,i-1)){keyEndInd=i;break}}}if(keyEndInd===undefined){throw _syntaxError(str,len,"expecting String")}var value=backslash(str.substring(keyStartInd+1,keyEndInd));if(value===""){throw _syntaxError(str,keyStartInd,"empty string")}keyEndInd++;return{start:keyStartInd,end:keyEndInd,value:value}}function _findObject(str,startInd,allowDuplicatedKeys,parse){var i=startInd;var sepValue=",";var obj={};var keys=[];var values=[];var j=startInd;while(_isWhiteSpace(str[j])){j++}if(str[j]==="}"){return{start:startInd,end:j,value:obj}}while(sepValue===","){var key=_findKey(str,i);var semi=_findSemiColonSeparator(str,key.end);var value=_findValue(str,semi.end,allowDuplicatedKeys,parse);var sepIndex=_findSeparator(str,value.end);if(!allowDuplicatedKeys){if(keys.indexOf(key.value)!==-1){throw _syntaxError(str,key.end,'duplicated keys "'+key.value+'"')}}keys.push(key.value);values.push(value.value);i=sepIndex.end;sepValue=sepIndex.value}if(parse){var indx=0;for(indx=0;indx<keys.length;indx++){obj[keys[indx]]=values[indx]}}return{start:startInd,end:i,value:obj}}function _hasEvenNumberOfBackSlash(str,endInd){var i=endInd;var count=0;while(i>-1&&str[i]==="\\"){count++;i--}return count%2===0}function _findArray(str,startInd,allowDuplicatedKeys,parse){var i=startInd;var sepValue=",";var arr=[];var j=startInd;while(_isWhiteSpace(str[j])){j++}if(str[j]==="]"){return{start:startInd,end:j,value:arr}}while(sepValue===","){var value=_findValue(str,i,allowDuplicatedKeys,parse);var sepIndex=_findSeparator(str,value.end);if(parse){arr.push(value.value)}i=sepIndex.end;sepValue=sepIndex.value}return{start:startInd,end:i,value:arr}}function _isTrueFromIndex(str,ind){return str.substr(ind,4)==="true"}function _isFalseFromIndex(str,ind){return str.substr(ind,5)==="false"}function _isNullFromIndex(str,ind){return str.substr(ind,4)==="null"}var white=new RegExp(/^\s$/);function _isWhiteSpace(ch){return white.test(ch)}var numberReg=new RegExp(/^\d$/);function _isNumber(ch){return numberReg.test(ch)}function _syntaxError(str,index,reason){var regionLen=10;var regionStr;if(str.length<index+regionLen){regionStr=str.substr(_normalizeNegativeNumber(str.length-regionLen),str.length)}else if(index-regionLen/2<0){regionStr=str.substr(0,regionLen)}else{regionStr=str.substr(_normalizeNegativeNumber(index-regionLen/2),regionLen)}var message;if(reason){message="Syntax error: "+reason+" near "+regionStr}else{message="Syntax error near "+regionStr}return new Error(message)}function _normalizeNegativeNumber(num){return num<0?0:num}},{backslash:146}],315:[function(require,module,exports){(function(process){(function(){"use strict";var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(Object.hasOwnProperty.call(mod,k))result[k]=mod[k];result["default"]=mod;return result};Object.defineProperty(exports,"__esModule",{value:true});var json_placeholder_replacer_1=require("./json-placeholder-replacer");exports.JsonPlaceholderReplacer=json_placeholder_replacer_1.JsonPlaceholderReplacer;const json_placeholder_replacer_2=require("./json-placeholder-replacer");const fs=__importStar(require("fs"));if(require.main===module){process.exitCode=process.argv.length;const replacer=new json_placeholder_replacer_2.JsonPlaceholderReplacer;process.argv.filter(((value,index)=>index>2)).map((value=>replacer.addVariableMap(JSON.parse(fs.readFileSync(value).toString()))));const replaceableFileContent=fs.readFileSync(process.argv[2]).toString();const replacedValue=replacer.replace(JSON.parse(replaceableFileContent));console.log(JSON.stringify(replacedValue,null,4));process.exitCode=0}}).call(this)}).call(this,require("_process"))},{"./json-placeholder-replacer":316,_process:378,fs:149}],316:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const defaultDelimiterTags=[{begin:"{{",end:"}}"},{begin:"<<",end:">>"}];class JsonPlaceholderReplacer{constructor(...delimiterTags){this.variablesMap=[];if(delimiterTags.length===0){delimiterTags=defaultDelimiterTags}const escapeRegExp=text=>text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");this.delimiterTags=delimiterTags.map((tag=>Object.assign(Object.assign({},tag),{escapedBeginning:escapeRegExp(tag.begin),escapedEnding:escapeRegExp(tag.end)})))}addVariableMap(variableMap){if(typeof variableMap=="string"){this.variablesMap.push(JSON.parse(variableMap))}else{this.variablesMap.push(variableMap)}return this}replace(json){return this.replaceChildren(json)}replaceChildren(node){for(const key in node){const attribute=node[key];if(typeof attribute=="object"){node[key]=this.replaceChildren(attribute)}else if(attribute!==undefined){node[key]=this.replaceValue(attribute.toString())}}return node}replaceValue(node){const delimiterTagRegex=this.delimiterTags.map((delimiterTag=>`^${delimiterTag.begin}[^${delimiterTag.end}]+${delimiterTag.end}$`)).join("|");const regExp=new RegExp(delimiterTagRegex);const placeHolderIsInsideStringContext=!regExp.test(node);const replacer=delimiterTag=>placeHolder=>{const path=placeHolder.substr(delimiterTag.begin.length,placeHolder.length-(delimiterTag.begin.length+delimiterTag.end.length));const mapCheckResult=this.checkInEveryMap(path);if(mapCheckResult===undefined){return placeHolder}if(!placeHolderIsInsideStringContext){return mapCheckResult}const parsed=JSON.parse(mapCheckResult);if(typeof parsed==="object"){return JSON.stringify(parsed)}return parsed};const output=this.delimiterTags.reduce(((acc,delimiterTag)=>{const regex=new RegExp(`(${delimiterTag.escapedBeginning}[^${delimiterTag.escapedEnding}]+${delimiterTag.escapedEnding})`,"g");return acc.replace(regex,replacer(delimiterTag))}),node);try{return JSON.parse(output)}catch(exc){return output}}checkInEveryMap(path){let result=undefined;this.variablesMap.forEach((map=>result=this.navigateThroughMap(map,path)));return result}navigateThroughMap(map,path){if(map===undefined){return}const shortCircuit=map[path];if(shortCircuit!==undefined){return JSON.stringify(shortCircuit)}let keys=path.split(".");const key=keys[0];keys.shift();return this.navigateThroughMap(map[key],keys.join("."))}}exports.JsonPlaceholderReplacer=JsonPlaceholderReplacer},{}],317:[function(require,module,exports){"use strict";var traverse=module.exports=function(schema,opts,cb){if(typeof opts=="function"){cb=opts;opts={}}cb=opts.cb||cb;var pre=typeof cb=="function"?cb:cb.pre||function(){};var post=cb.post||function(){};_traverse(opts,pre,post,schema,"",schema)};traverse.keywords={additionalItems:true,items:true,contains:true,additionalProperties:true,propertyNames:true,not:true,if:true,then:true,else:true};traverse.arrayKeywords={items:true,allOf:true,anyOf:true,oneOf:true};traverse.propsKeywords={$defs:true,definitions:true,properties:true,patternProperties:true,dependencies:true};traverse.skipKeywords={default:true,enum:true,const:true,required:true,maximum:true,minimum:true,exclusiveMaximum:true,exclusiveMinimum:true,multipleOf:true,maxLength:true,minLength:true,pattern:true,format:true,maxItems:true,minItems:true,uniqueItems:true,maxProperties:true,minProperties:true};function _traverse(opts,pre,post,schema,jsonPtr,rootSchema,parentJsonPtr,parentKeyword,parentSchema,keyIndex){if(schema&&typeof schema=="object"&&!Array.isArray(schema)){pre(schema,jsonPtr,rootSchema,parentJsonPtr,parentKeyword,parentSchema,keyIndex);for(var key in schema){var sch=schema[key];if(Array.isArray(sch)){if(key in traverse.arrayKeywords){for(var i=0;i<sch.length;i++)_traverse(opts,pre,post,sch[i],jsonPtr+"/"+key+"/"+i,rootSchema,jsonPtr,key,schema,i)}}else if(key in traverse.propsKeywords){if(sch&&typeof sch=="object"){for(var prop in sch)_traverse(opts,pre,post,sch[prop],jsonPtr+"/"+key+"/"+escapeJsonPtr(prop),rootSchema,jsonPtr,key,schema,prop)}}else if(key in traverse.keywords||opts.allKeys&&!(key in traverse.skipKeywords)){_traverse(opts,pre,post,sch,jsonPtr+"/"+key,rootSchema,jsonPtr,key,schema)}}post(schema,jsonPtr,rootSchema,parentJsonPtr,parentKeyword,parentSchema,keyIndex)}}function escapeJsonPtr(str){return str.replace(/~/g,"~0").replace(/\//g,"~1")}},{}],318:[function(require,module,exports){"use strict";const{isArray:_isArray,isObject:_isObject,isString:_isString}=require("./types");const{asArray:_asArray}=require("./util");const{prependBase:prependBase}=require("./url");const JsonLdError=require("./JsonLdError");const ResolvedContext=require("./ResolvedContext");const MAX_CONTEXT_URLS=10;module.exports=class ContextResolver{constructor({sharedCache:sharedCache}){this.perOpCache=new Map;this.sharedCache=sharedCache}async resolve({activeCtx:activeCtx,context:context,documentLoader:documentLoader,base:base,cycles:cycles=new Set}){if(context&&_isObject(context)&&context["@context"]){context=context["@context"]}context=_asArray(context);const allResolved=[];for(const ctx of context){if(_isString(ctx)){let resolved=this._get(ctx);if(!resolved){resolved=await this._resolveRemoteContext({activeCtx:activeCtx,url:ctx,documentLoader:documentLoader,base:base,cycles:cycles})}if(_isArray(resolved)){allResolved.push(...resolved)}else{allResolved.push(resolved)}continue}if(ctx===null){allResolved.push(new ResolvedContext({document:null}));continue}if(!_isObject(ctx)){_throwInvalidLocalContext(context)}const key=JSON.stringify(ctx);let resolved=this._get(key);if(!resolved){resolved=new ResolvedContext({document:ctx});this._cacheResolvedContext({key:key,resolved:resolved,tag:"static"})}allResolved.push(resolved)}return allResolved}_get(key){let resolved=this.perOpCache.get(key);if(!resolved){const tagMap=this.sharedCache.get(key);if(tagMap){resolved=tagMap.get("static");if(resolved){this.perOpCache.set(key,resolved)}}}return resolved}_cacheResolvedContext({key:key,resolved:resolved,tag:tag}){this.perOpCache.set(key,resolved);if(tag!==undefined){let tagMap=this.sharedCache.get(key);if(!tagMap){tagMap=new Map;this.sharedCache.set(key,tagMap)}tagMap.set(tag,resolved)}return resolved}async _resolveRemoteContext({activeCtx:activeCtx,url:url,documentLoader:documentLoader,base:base,cycles:cycles}){url=prependBase(base,url);const{context:context,remoteDoc:remoteDoc}=await this._fetchContext({activeCtx:activeCtx,url:url,documentLoader:documentLoader,cycles:cycles});base=remoteDoc.documentUrl||url;_resolveContextUrls({context:context,base:base});const resolved=await this.resolve({activeCtx:activeCtx,context:context,documentLoader:documentLoader,base:base,cycles:cycles});this._cacheResolvedContext({key:url,resolved:resolved,tag:remoteDoc.tag});return resolved}async _fetchContext({activeCtx:activeCtx,url:url,documentLoader:documentLoader,cycles:cycles}){if(cycles.size>MAX_CONTEXT_URLS){throw new JsonLdError("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:activeCtx.processingMode==="json-ld-1.0"?"loading remote context failed":"context overflow",max:MAX_CONTEXT_URLS})}if(cycles.has(url)){throw new JsonLdError("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:activeCtx.processingMode==="json-ld-1.0"?"recursive context inclusion":"context overflow",url:url})}cycles.add(url);let context;let remoteDoc;try{remoteDoc=await documentLoader(url);context=remoteDoc.document||null;if(_isString(context)){context=JSON.parse(context)}}catch(e){throw new JsonLdError("Dereferencing a URL did not result in a valid JSON-LD object. "+"Possible causes are an inaccessible URL perhaps due to "+"a same-origin policy (ensure the server uses CORS if you are "+"using client-side JavaScript), too many redirects, a "+"non-JSON response, or more than one HTTP Link Header was "+"provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:url,cause:e})}if(!_isObject(context)){throw new JsonLdError("Dereferencing a URL did not result in a JSON object. The "+"response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:url})}if(!("@context"in context)){context={"@context":{}}}else{context={"@context":context["@context"]}}if(remoteDoc.contextUrl){if(!_isArray(context["@context"])){context["@context"]=[context["@context"]]}context["@context"].push(remoteDoc.contextUrl)}return{context:context,remoteDoc:remoteDoc}}};function _throwInvalidLocalContext(ctx){throw new JsonLdError("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:ctx})}function _resolveContextUrls({context:context,base:base}){if(!context){return}const ctx=context["@context"];if(_isString(ctx)){context["@context"]=prependBase(base,ctx);return}if(_isArray(ctx)){for(let i=0;i<ctx.length;++i){const element=ctx[i];if(_isString(element)){ctx[i]=prependBase(base,element);continue}if(_isObject(element)){_resolveContextUrls({context:{"@context":element},base:base})}}return}if(!_isObject(ctx)){return}for(const term in ctx){_resolveContextUrls({context:ctx[term],base:base})}}},{"./JsonLdError":319,"./ResolvedContext":323,"./types":337,"./url":338,"./util":339}],319:[function(require,module,exports){"use strict";module.exports=class JsonLdError extends Error{constructor(message="An unspecified JSON-LD error occurred.",name="jsonld.Error",details={}){super(message);this.name=name;this.message=message;this.details=details}}},{}],320:[function(require,module,exports){"use strict";module.exports=jsonld=>{class JsonLdProcessor{toString(){return"[object JsonLdProcessor]"}}Object.defineProperty(JsonLdProcessor,"prototype",{writable:false,enumerable:false});Object.defineProperty(JsonLdProcessor.prototype,"constructor",{writable:true,enumerable:false,configurable:true,value:JsonLdProcessor});JsonLdProcessor.compact=function(input,ctx){if(arguments.length<2){return Promise.reject(new TypeError("Could not compact, too few arguments."))}return jsonld.compact(input,ctx)};JsonLdProcessor.expand=function(input){if(arguments.length<1){return Promise.reject(new TypeError("Could not expand, too few arguments."))}return jsonld.expand(input)};JsonLdProcessor.flatten=function(input){if(arguments.length<1){return Promise.reject(new TypeError("Could not flatten, too few arguments."))}return jsonld.flatten(input)};return JsonLdProcessor}},{}],321:[function(require,module,exports){"use strict";module.exports=require("rdf-canonize").NQuads},{"rdf-canonize":390}],322:[function(require,module,exports){"use strict";module.exports=class RequestQueue{constructor(){this._requests={}}wrapLoader(loader){const self=this;self._loader=loader;return function(){return self.add.apply(self,arguments)}}async add(url){let promise=this._requests[url];if(promise){return Promise.resolve(promise)}promise=this._requests[url]=this._loader(url);try{return await promise}finally{delete this._requests[url]}}}},{}],323:[function(require,module,exports){"use strict";const LRU=require("lru-cache");const MAX_ACTIVE_CONTEXTS=10;module.exports=class ResolvedContext{constructor({document:document}){this.document=document;this.cache=new LRU({max:MAX_ACTIVE_CONTEXTS})}getProcessed(activeCtx){return this.cache.get(activeCtx)}setProcessed(activeCtx,processedCtx){this.cache.set(activeCtx,processedCtx)}}},{"lru-cache":340}],324:[function(require,module,exports){"use strict";const JsonLdError=require("./JsonLdError");const{isArray:_isArray,isObject:_isObject,isString:_isString,isUndefined:_isUndefined}=require("./types");const{isList:_isList,isValue:_isValue,isGraph:_isGraph,isSimpleGraph:_isSimpleGraph,isSubjectReference:_isSubjectReference}=require("./graphTypes");const{expandIri:_expandIri,getContextValue:_getContextValue,isKeyword:_isKeyword,process:_processContext,processingMode:_processingMode}=require("./context");const{removeBase:_removeBase,prependBase:_prependBase}=require("./url");const{addValue:_addValue,asArray:_asArray,compareShortestLeast:_compareShortestLeast}=require("./util");const api={};module.exports=api;api.compact=async({activeCtx:activeCtx,activeProperty:activeProperty=null,element:element,options:options={},compactionMap:compactionMap=(()=>undefined)})=>{if(_isArray(element)){let rval=[];for(let i=0;i<element.length;++i){let compacted=await api.compact({activeCtx:activeCtx,activeProperty:activeProperty,element:element[i],options:options,compactionMap:compactionMap});if(compacted===null){compacted=await compactionMap({unmappedValue:element[i],activeCtx:activeCtx,activeProperty:activeProperty,parent:element,index:i,options:options});if(compacted===undefined){continue}}rval.push(compacted)}if(options.compactArrays&&rval.length===1){const container=_getContextValue(activeCtx,activeProperty,"@container")||[];if(container.length===0){rval=rval[0]}}return rval}const ctx=_getContextValue(activeCtx,activeProperty,"@context");if(!_isUndefined(ctx)){activeCtx=await _processContext({activeCtx:activeCtx,localCtx:ctx,propagate:true,overrideProtected:true,options:options})}if(_isObject(element)){if(options.link&&"@id"in element&&options.link.hasOwnProperty(element["@id"])){const linked=options.link[element["@id"]];for(let i=0;i<linked.length;++i){if(linked[i].expanded===element){return linked[i].compacted}}}if(_isValue(element)||_isSubjectReference(element)){const rval=api.compactValue({activeCtx:activeCtx,activeProperty:activeProperty,value:element,options:options});if(options.link&&_isSubjectReference(element)){if(!options.link.hasOwnProperty(element["@id"])){options.link[element["@id"]]=[]}options.link[element["@id"]].push({expanded:element,compacted:rval})}return rval}if(_isList(element)){const container=_getContextValue(activeCtx,activeProperty,"@container")||[];if(container.includes("@list")){return api.compact({activeCtx:activeCtx,activeProperty:activeProperty,element:element["@list"],options:options,compactionMap:compactionMap})}}const insideReverse=activeProperty==="@reverse";const rval={};const inputCtx=activeCtx;if(!_isValue(element)&&!_isSubjectReference(element)){activeCtx=activeCtx.revertToPreviousContext()}const propertyScopedCtx=_getContextValue(inputCtx,activeProperty,"@context");if(!_isUndefined(propertyScopedCtx)){activeCtx=await _processContext({activeCtx:activeCtx,localCtx:propertyScopedCtx,propagate:true,overrideProtected:true,options:options})}if(options.link&&"@id"in element){if(!options.link.hasOwnProperty(element["@id"])){options.link[element["@id"]]=[]}options.link[element["@id"]].push({expanded:element,compacted:rval})}let types=element["@type"]||[];if(types.length>1){types=Array.from(types).sort()}const typeContext=activeCtx;for(const type of types){const compactedType=api.compactIri({activeCtx:typeContext,iri:type,relativeTo:{vocab:true}});const ctx=_getContextValue(inputCtx,compactedType,"@context");if(!_isUndefined(ctx)){activeCtx=await _processContext({activeCtx:activeCtx,localCtx:ctx,options:options,propagate:false})}}const keys=Object.keys(element).sort();for(const expandedProperty of keys){const expandedValue=element[expandedProperty];if(expandedProperty==="@id"){let compactedValue=_asArray(expandedValue).map((expandedIri=>api.compactIri({activeCtx:activeCtx,iri:expandedIri,relativeTo:{vocab:false},base:options.base})));if(compactedValue.length===1){compactedValue=compactedValue[0]}const alias=api.compactIri({activeCtx:activeCtx,iri:"@id",relativeTo:{vocab:true}});rval[alias]=compactedValue;continue}if(expandedProperty==="@type"){let compactedValue=_asArray(expandedValue).map((expandedIri=>api.compactIri({activeCtx:inputCtx,iri:expandedIri,relativeTo:{vocab:true}})));if(compactedValue.length===1){compactedValue=compactedValue[0]}const alias=api.compactIri({activeCtx:activeCtx,iri:"@type",relativeTo:{vocab:true}});const container=_getContextValue(activeCtx,alias,"@container")||[];const typeAsSet=container.includes("@set")&&_processingMode(activeCtx,1.1);const isArray=typeAsSet||_isArray(compactedValue)&&expandedValue.length===0;_addValue(rval,alias,compactedValue,{propertyIsArray:isArray});continue}if(expandedProperty==="@reverse"){const compactedValue=await api.compact({activeCtx:activeCtx,activeProperty:"@reverse",element:expandedValue,options:options,compactionMap:compactionMap});for(const compactedProperty in compactedValue){if(activeCtx.mappings.has(compactedProperty)&&activeCtx.mappings.get(compactedProperty).reverse){const value=compactedValue[compactedProperty];const container=_getContextValue(activeCtx,compactedProperty,"@container")||[];const useArray=container.includes("@set")||!options.compactArrays;_addValue(rval,compactedProperty,value,{propertyIsArray:useArray});delete compactedValue[compactedProperty]}}if(Object.keys(compactedValue).length>0){const alias=api.compactIri({activeCtx:activeCtx,iri:expandedProperty,relativeTo:{vocab:true}});_addValue(rval,alias,compactedValue)}continue}if(expandedProperty==="@preserve"){const compactedValue=await api.compact({activeCtx:activeCtx,activeProperty:activeProperty,element:expandedValue,options:options,compactionMap:compactionMap});if(!(_isArray(compactedValue)&&compactedValue.length===0)){_addValue(rval,expandedProperty,compactedValue)}continue}if(expandedProperty==="@index"){const container=_getContextValue(activeCtx,activeProperty,"@container")||[];if(container.includes("@index")){continue}const alias=api.compactIri({activeCtx:activeCtx,iri:expandedProperty,relativeTo:{vocab:true}});_addValue(rval,alias,expandedValue);continue}if(expandedProperty!=="@graph"&&expandedProperty!=="@list"&&expandedProperty!=="@included"&&_isKeyword(expandedProperty)){const alias=api.compactIri({activeCtx:activeCtx,iri:expandedProperty,relativeTo:{vocab:true}});_addValue(rval,alias,expandedValue);continue}if(!_isArray(expandedValue)){throw new JsonLdError("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError")}if(expandedValue.length===0){const itemActiveProperty=api.compactIri({activeCtx:activeCtx,iri:expandedProperty,value:expandedValue,relativeTo:{vocab:true},reverse:insideReverse});const nestProperty=activeCtx.mappings.has(itemActiveProperty)?activeCtx.mappings.get(itemActiveProperty)["@nest"]:null;let nestResult=rval;if(nestProperty){_checkNestProperty(activeCtx,nestProperty,options);if(!_isObject(rval[nestProperty])){rval[nestProperty]={}}nestResult=rval[nestProperty]}_addValue(nestResult,itemActiveProperty,expandedValue,{propertyIsArray:true})}for(const expandedItem of expandedValue){const itemActiveProperty=api.compactIri({activeCtx:activeCtx,iri:expandedProperty,value:expandedItem,relativeTo:{vocab:true},reverse:insideReverse});const nestProperty=activeCtx.mappings.has(itemActiveProperty)?activeCtx.mappings.get(itemActiveProperty)["@nest"]:null;let nestResult=rval;if(nestProperty){_checkNestProperty(activeCtx,nestProperty,options);if(!_isObject(rval[nestProperty])){rval[nestProperty]={}}nestResult=rval[nestProperty]}const container=_getContextValue(activeCtx,itemActiveProperty,"@container")||[];const isGraph=_isGraph(expandedItem);const isList=_isList(expandedItem);let inner;if(isList){inner=expandedItem["@list"]}else if(isGraph){inner=expandedItem["@graph"]}let compactedItem=await api.compact({activeCtx:activeCtx,activeProperty:itemActiveProperty,element:isList||isGraph?inner:expandedItem,options:options,compactionMap:compactionMap});if(isList){if(!_isArray(compactedItem)){compactedItem=[compactedItem]}if(!container.includes("@list")){compactedItem={[api.compactIri({activeCtx:activeCtx,iri:"@list",relativeTo:{vocab:true}})]:compactedItem};if("@index"in expandedItem){compactedItem[api.compactIri({activeCtx:activeCtx,iri:"@index",relativeTo:{vocab:true}})]=expandedItem["@index"]}}else{_addValue(nestResult,itemActiveProperty,compactedItem,{valueIsArray:true,allowDuplicate:true});continue}}if(isGraph){if(container.includes("@graph")&&(container.includes("@id")||container.includes("@index")&&_isSimpleGraph(expandedItem))){let mapObject;if(nestResult.hasOwnProperty(itemActiveProperty)){mapObject=nestResult[itemActiveProperty]}else{nestResult[itemActiveProperty]=mapObject={}}const key=(container.includes("@id")?expandedItem["@id"]:expandedItem["@index"])||api.compactIri({activeCtx:activeCtx,iri:"@none",relativeTo:{vocab:true}});_addValue(mapObject,key,compactedItem,{propertyIsArray:!options.compactArrays||container.includes("@set")})}else if(container.includes("@graph")&&_isSimpleGraph(expandedItem)){if(_isArray(compactedItem)&&compactedItem.length>1){compactedItem={"@included":compactedItem}}_addValue(nestResult,itemActiveProperty,compactedItem,{propertyIsArray:!options.compactArrays||container.includes("@set")})}else{if(_isArray(compactedItem)&&compactedItem.length===1&&options.compactArrays){compactedItem=compactedItem[0]}compactedItem={[api.compactIri({activeCtx:activeCtx,iri:"@graph",relativeTo:{vocab:true}})]:compactedItem};if("@id"in expandedItem){compactedItem[api.compactIri({activeCtx:activeCtx,iri:"@id",relativeTo:{vocab:true}})]=expandedItem["@id"]}if("@index"in expandedItem){compactedItem[api.compactIri({activeCtx:activeCtx,iri:"@index",relativeTo:{vocab:true}})]=expandedItem["@index"]}_addValue(nestResult,itemActiveProperty,compactedItem,{propertyIsArray:!options.compactArrays||container.includes("@set")})}}else if(container.includes("@language")||container.includes("@index")||container.includes("@id")||container.includes("@type")){let mapObject;if(nestResult.hasOwnProperty(itemActiveProperty)){mapObject=nestResult[itemActiveProperty]}else{nestResult[itemActiveProperty]=mapObject={}}let key;if(container.includes("@language")){if(_isValue(compactedItem)){compactedItem=compactedItem["@value"]}key=expandedItem["@language"]}else if(container.includes("@index")){const indexKey=_getContextValue(activeCtx,itemActiveProperty,"@index")||"@index";const containerKey=api.compactIri({activeCtx:activeCtx,iri:indexKey,relativeTo:{vocab:true}});if(indexKey==="@index"){key=expandedItem["@index"];delete compactedItem[containerKey]}else{let others;[key,...others]=_asArray(compactedItem[indexKey]||[]);if(!_isString(key)){key=null}else{switch(others.length){case 0:delete compactedItem[indexKey];break;case 1:compactedItem[indexKey]=others[0];break;default:compactedItem[indexKey]=others;break}}}}else if(container.includes("@id")){const idKey=api.compactIri({activeCtx:activeCtx,iri:"@id",relativeTo:{vocab:true}});key=compactedItem[idKey];delete compactedItem[idKey]}else if(container.includes("@type")){const typeKey=api.compactIri({activeCtx:activeCtx,iri:"@type",relativeTo:{vocab:true}});let types;[key,...types]=_asArray(compactedItem[typeKey]||[]);switch(types.length){case 0:delete compactedItem[typeKey];break;case 1:compactedItem[typeKey]=types[0];break;default:compactedItem[typeKey]=types;break}if(Object.keys(compactedItem).length===1&&"@id"in expandedItem){compactedItem=await api.compact({activeCtx:activeCtx,activeProperty:itemActiveProperty,element:{"@id":expandedItem["@id"]},options:options,compactionMap:compactionMap})}}if(!key){key=api.compactIri({activeCtx:activeCtx,iri:"@none",relativeTo:{vocab:true}})}_addValue(mapObject,key,compactedItem,{propertyIsArray:container.includes("@set")})}else{const isArray=!options.compactArrays||container.includes("@set")||container.includes("@list")||_isArray(compactedItem)&&compactedItem.length===0||expandedProperty==="@list"||expandedProperty==="@graph";_addValue(nestResult,itemActiveProperty,compactedItem,{propertyIsArray:isArray})}}}return rval}return element};api.compactIri=({activeCtx:activeCtx,iri:iri,value:value=null,relativeTo:relativeTo={vocab:false},reverse:reverse=false,base:base=null})=>{if(iri===null){return iri}if(activeCtx.isPropertyTermScoped&&activeCtx.previousContext){activeCtx=activeCtx.previousContext}const inverseCtx=activeCtx.getInverse();if(_isKeyword(iri)&&iri in inverseCtx&&"@none"in inverseCtx[iri]&&"@type"in inverseCtx[iri]["@none"]&&"@none"in inverseCtx[iri]["@none"]["@type"]){return inverseCtx[iri]["@none"]["@type"]["@none"]}if(relativeTo.vocab&&iri in inverseCtx){const defaultLanguage=activeCtx["@language"]||"@none";const containers=[];if(_isObject(value)&&"@index"in value&&!("@graph"in value)){containers.push("@index","@index@set")}if(_isObject(value)&&"@preserve"in value){value=value["@preserve"][0]}if(_isGraph(value)){if("@index"in value){containers.push("@graph@index","@graph@index@set","@index","@index@set")}if("@id"in value){containers.push("@graph@id","@graph@id@set")}containers.push("@graph","@graph@set","@set");if(!("@index"in value)){containers.push("@graph@index","@graph@index@set","@index","@index@set")}if(!("@id"in value)){containers.push("@graph@id","@graph@id@set")}}else if(_isObject(value)&&!_isValue(value)){containers.push("@id","@id@set","@type","@set@type")}let typeOrLanguage="@language";let typeOrLanguageValue="@null";if(reverse){typeOrLanguage="@type";typeOrLanguageValue="@reverse";containers.push("@set")}else if(_isList(value)){if(!("@index"in value)){containers.push("@list")}const list=value["@list"];if(list.length===0){typeOrLanguage="@any";typeOrLanguageValue="@none"}else{let commonLanguage=list.length===0?defaultLanguage:null;let commonType=null;for(let i=0;i<list.length;++i){const item=list[i];let itemLanguage="@none";let itemType="@none";if(_isValue(item)){if("@direction"in item){const lang=(item["@language"]||"").toLowerCase();const dir=item["@direction"];itemLanguage=`${lang}_${dir}`}else if("@language"in item){itemLanguage=item["@language"].toLowerCase()}else if("@type"in item){itemType=item["@type"]}else{itemLanguage="@null"}}else{itemType="@id"}if(commonLanguage===null){commonLanguage=itemLanguage}else if(itemLanguage!==commonLanguage&&_isValue(item)){commonLanguage="@none"}if(commonType===null){commonType=itemType}else if(itemType!==commonType){commonType="@none"}if(commonLanguage==="@none"&&commonType==="@none"){break}}commonLanguage=commonLanguage||"@none";commonType=commonType||"@none";if(commonType!=="@none"){typeOrLanguage="@type";typeOrLanguageValue=commonType}else{typeOrLanguageValue=commonLanguage}}}else{if(_isValue(value)){if("@language"in value&&!("@index"in value)){containers.push("@language","@language@set");typeOrLanguageValue=value["@language"];const dir=value["@direction"];if(dir){typeOrLanguageValue=`${typeOrLanguageValue}_${dir}`}}else if("@direction"in value&&!("@index"in value)){typeOrLanguageValue=`_${value["@direction"]}`}else if("@type"in value){typeOrLanguage="@type";typeOrLanguageValue=value["@type"]}}else{typeOrLanguage="@type";typeOrLanguageValue="@id"}containers.push("@set")}containers.push("@none");if(_isObject(value)&&!("@index"in value)){containers.push("@index","@index@set")}if(_isValue(value)&&Object.keys(value).length===1){containers.push("@language","@language@set")}const term=_selectTerm(activeCtx,iri,value,containers,typeOrLanguage,typeOrLanguageValue);if(term!==null){return term}}if(relativeTo.vocab){if("@vocab"in activeCtx){const vocab=activeCtx["@vocab"];if(iri.indexOf(vocab)===0&&iri!==vocab){const suffix=iri.substr(vocab.length);if(!activeCtx.mappings.has(suffix)){return suffix}}}}let choice=null;const partialMatches=[];let iriMap=activeCtx.fastCurieMap;const maxPartialLength=iri.length-1;for(let i=0;i<maxPartialLength&&iri[i]in iriMap;++i){iriMap=iriMap[iri[i]];if(""in iriMap){partialMatches.push(iriMap[""][0])}}for(let i=partialMatches.length-1;i>=0;--i){const entry=partialMatches[i];const terms=entry.terms;for(const term of terms){const curie=term+":"+iri.substr(entry.iri.length);const isUsableCurie=activeCtx.mappings.get(term)._prefix&&(!activeCtx.mappings.has(curie)||value===null&&activeCtx.mappings.get(curie)["@id"]===iri);if(isUsableCurie&&(choice===null||_compareShortestLeast(curie,choice)<0)){choice=curie}}}if(choice!==null){return choice}for(const[term,td]of activeCtx.mappings){if(td&&td._prefix&&iri.startsWith(term+":")){throw new JsonLdError(`Absolute IRI "${iri}" confused with prefix "${term}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:activeCtx})}}if(!relativeTo.vocab){if("@base"in activeCtx){if(!activeCtx["@base"]){return iri}else{return _removeBase(_prependBase(base,activeCtx["@base"]),iri)}}else{return _removeBase(base,iri)}}return iri};api.compactValue=({activeCtx:activeCtx,activeProperty:activeProperty,value:value,options:options})=>{if(_isValue(value)){const type=_getContextValue(activeCtx,activeProperty,"@type");const language=_getContextValue(activeCtx,activeProperty,"@language");const direction=_getContextValue(activeCtx,activeProperty,"@direction");const container=_getContextValue(activeCtx,activeProperty,"@container")||[];const preserveIndex="@index"in value&&!container.includes("@index");if(!preserveIndex&&type!=="@none"){if(value["@type"]===type){return value["@value"]}if("@language"in value&&value["@language"]===language&&"@direction"in value&&value["@direction"]===direction){return value["@value"]}if("@language"in value&&value["@language"]===language){return value["@value"]}if("@direction"in value&&value["@direction"]===direction){return value["@value"]}}const keyCount=Object.keys(value).length;const isValueOnlyKey=keyCount===1||keyCount===2&&"@index"in value&&!preserveIndex;const hasDefaultLanguage="@language"in activeCtx;const isValueString=_isString(value["@value"]);const hasNullMapping=activeCtx.mappings.has(activeProperty)&&activeCtx.mappings.get(activeProperty)["@language"]===null;if(isValueOnlyKey&&type!=="@none"&&(!hasDefaultLanguage||!isValueString||hasNullMapping)){return value["@value"]}const rval={};if(preserveIndex){rval[api.compactIri({activeCtx:activeCtx,iri:"@index",relativeTo:{vocab:true}})]=value["@index"]}if("@type"in value){rval[api.compactIri({activeCtx:activeCtx,iri:"@type",relativeTo:{vocab:true}})]=api.compactIri({activeCtx:activeCtx,iri:value["@type"],relativeTo:{vocab:true}})}else if("@language"in value){rval[api.compactIri({activeCtx:activeCtx,iri:"@language",relativeTo:{vocab:true}})]=value["@language"]}if("@direction"in value){rval[api.compactIri({activeCtx:activeCtx,iri:"@direction",relativeTo:{vocab:true}})]=value["@direction"]}rval[api.compactIri({activeCtx:activeCtx,iri:"@value",relativeTo:{vocab:true}})]=value["@value"];return rval}const expandedProperty=_expandIri(activeCtx,activeProperty,{vocab:true},options);const type=_getContextValue(activeCtx,activeProperty,"@type");const compacted=api.compactIri({activeCtx:activeCtx,iri:value["@id"],relativeTo:{vocab:type==="@vocab"},base:options.base});if(type==="@id"||type==="@vocab"||expandedProperty==="@graph"){return compacted}return{[api.compactIri({activeCtx:activeCtx,iri:"@id",relativeTo:{vocab:true}})]:compacted}};function _selectTerm(activeCtx,iri,value,containers,typeOrLanguage,typeOrLanguageValue){if(typeOrLanguageValue===null){typeOrLanguageValue="@null"}const prefs=[];if((typeOrLanguageValue==="@id"||typeOrLanguageValue==="@reverse")&&_isObject(value)&&"@id"in value){if(typeOrLanguageValue==="@reverse"){prefs.push("@reverse")}const term=api.compactIri({activeCtx:activeCtx,iri:value["@id"],relativeTo:{vocab:true}});if(activeCtx.mappings.has(term)&&activeCtx.mappings.get(term)&&activeCtx.mappings.get(term)["@id"]===value["@id"]){prefs.push.apply(prefs,["@vocab","@id"])}else{prefs.push.apply(prefs,["@id","@vocab"])}}else{prefs.push(typeOrLanguageValue);const langDir=prefs.find((el=>el.includes("_")));if(langDir){prefs.push(langDir.replace(/^[^_]+_/,"_"))}}prefs.push("@none");const containerMap=activeCtx.inverse[iri];for(const container of containers){if(!(container in containerMap)){continue}const typeOrLanguageValueMap=containerMap[container][typeOrLanguage];for(const pref of prefs){if(!(pref in typeOrLanguageValueMap)){continue}return typeOrLanguageValueMap[pref]}}return null}function _checkNestProperty(activeCtx,nestProperty,options){if(_expandIri(activeCtx,nestProperty,{vocab:true},options)!=="@nest"){throw new JsonLdError("JSON-LD compact error; nested property must have an @nest value "+"resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}}},{"./JsonLdError":319,"./context":326,"./graphTypes":333,"./types":337,"./url":338,"./util":339}],325:[function(require,module,exports){"use strict";const RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#";const XSD="http://www.w3.org/2001/XMLSchema#";module.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:RDF,RDF_LIST:RDF+"List",RDF_FIRST:RDF+"first",RDF_REST:RDF+"rest",RDF_NIL:RDF+"nil",RDF_TYPE:RDF+"type",RDF_PLAIN_LITERAL:RDF+"PlainLiteral",RDF_XML_LITERAL:RDF+"XMLLiteral",RDF_JSON_LITERAL:RDF+"JSON",RDF_OBJECT:RDF+"object",RDF_LANGSTRING:RDF+"langString",XSD:XSD,XSD_BOOLEAN:XSD+"boolean",XSD_DOUBLE:XSD+"double",XSD_INTEGER:XSD+"integer",XSD_STRING:XSD+"string"}},{}],326:[function(require,module,exports){"use strict";const util=require("./util");const JsonLdError=require("./JsonLdError");const{isArray:_isArray,isObject:_isObject,isString:_isString,isUndefined:_isUndefined}=require("./types");const{isAbsolute:_isAbsoluteIri,isRelative:_isRelativeIri,prependBase:prependBase}=require("./url");const{asArray:_asArray,compareShortestLeast:_compareShortestLeast}=require("./util");const INITIAL_CONTEXT_CACHE=new Map;const INITIAL_CONTEXT_CACHE_MAX_SIZE=1e4;const KEYWORD_PATTERN=/^@[a-zA-Z]+$/;const api={};module.exports=api;api.process=async({activeCtx:activeCtx,localCtx:localCtx,options:options,propagate:propagate=true,overrideProtected:overrideProtected=false,cycles:cycles=new Set})=>{if(_isObject(localCtx)&&"@context"in localCtx&&_isArray(localCtx["@context"])){localCtx=localCtx["@context"]}const ctxs=_asArray(localCtx);if(ctxs.length===0){return activeCtx}const resolved=await options.contextResolver.resolve({activeCtx:activeCtx,context:localCtx,documentLoader:options.documentLoader,base:options.base});if(_isObject(resolved[0].document)&&typeof resolved[0].document["@propagate"]==="boolean"){propagate=resolved[0].document["@propagate"]}let rval=activeCtx;if(!propagate&&!rval.previousContext){rval=rval.clone();rval.previousContext=activeCtx}for(const resolvedContext of resolved){let{document:ctx}=resolvedContext;activeCtx=rval;if(ctx===null){if(!overrideProtected&&Object.keys(activeCtx.protected).length!==0){const protectedMode=options&&options.protectedMode||"error";if(protectedMode==="error"){throw new JsonLdError("Tried to nullify a context with protected terms outside of "+"a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"})}else if(protectedMode==="warn"){console.warn("WARNING: invalid context nullification");const processed=resolvedContext.getProcessed(activeCtx);if(processed){rval=activeCtx=processed;continue}const oldActiveCtx=activeCtx;rval=activeCtx=api.getInitialContext(options).clone();for(const[term,_protected]of Object.entries(oldActiveCtx.protected)){if(_protected){activeCtx.mappings[term]=util.clone(oldActiveCtx.mappings[term])}}activeCtx.protected=util.clone(oldActiveCtx.protected);resolvedContext.setProcessed(oldActiveCtx,rval);continue}throw new JsonLdError("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:localCtx,protectedMode:protectedMode})}rval=activeCtx=api.getInitialContext(options).clone();continue}const processed=resolvedContext.getProcessed(activeCtx);if(processed){rval=activeCtx=processed;continue}if(_isObject(ctx)&&"@context"in ctx){ctx=ctx["@context"]}if(!_isObject(ctx)){throw new JsonLdError("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:ctx})}rval=rval.clone();const defined=new Map;if("@version"in ctx){if(ctx["@version"]!==1.1){throw new JsonLdError("Unsupported JSON-LD version: "+ctx["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:ctx})}if(activeCtx.processingMode&&activeCtx.processingMode==="json-ld-1.0"){throw new JsonLdError("@version: "+ctx["@version"]+" not compatible with "+activeCtx.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:ctx})}rval.processingMode="json-ld-1.1";rval["@version"]=ctx["@version"];defined.set("@version",true)}rval.processingMode=rval.processingMode||activeCtx.processingMode;if("@base"in ctx){let base=ctx["@base"];if(base===null||_isAbsoluteIri(base)){}else if(_isRelativeIri(base)){base=prependBase(rval["@base"],base)}else{throw new JsonLdError('Invalid JSON-LD syntax; the value of "@base" in a '+"@context must be an absolute IRI, a relative IRI, or null.","jsonld.SyntaxError",{code:"invalid base IRI",context:ctx})}rval["@base"]=base;defined.set("@base",true)}if("@vocab"in ctx){const value=ctx["@vocab"];if(value===null){delete rval["@vocab"]}else if(!_isString(value)){throw new JsonLdError('Invalid JSON-LD syntax; the value of "@vocab" in a '+"@context must be a string or null.","jsonld.SyntaxError",{code:"invalid vocab mapping",context:ctx})}else if(!_isAbsoluteIri(value)&&api.processingMode(rval,1)){throw new JsonLdError('Invalid JSON-LD syntax; the value of "@vocab" in a '+"@context must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid vocab mapping",context:ctx})}else{rval["@vocab"]=_expandIri(rval,value,{vocab:true,base:true},undefined,undefined,options)}defined.set("@vocab",true)}if("@language"in ctx){const value=ctx["@language"];if(value===null){delete rval["@language"]}else if(!_isString(value)){throw new JsonLdError('Invalid JSON-LD syntax; the value of "@language" in a '+"@context must be a string or null.","jsonld.SyntaxError",{code:"invalid default language",context:ctx})}else{rval["@language"]=value.toLowerCase()}defined.set("@language",true)}if("@direction"in ctx){const value=ctx["@direction"];if(activeCtx.processingMode==="json-ld-1.0"){throw new JsonLdError("Invalid JSON-LD syntax; @direction not compatible with "+activeCtx.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:ctx})}if(value===null){delete rval["@direction"]}else if(value!=="ltr"&&value!=="rtl"){throw new JsonLdError('Invalid JSON-LD syntax; the value of "@direction" in a '+'@context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:ctx})}else{rval["@direction"]=value}defined.set("@direction",true)}if("@propagate"in ctx){const value=ctx["@propagate"];if(activeCtx.processingMode==="json-ld-1.0"){throw new JsonLdError("Invalid JSON-LD syntax; @propagate not compatible with "+activeCtx.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ctx})}if(typeof value!=="boolean"){throw new JsonLdError("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:localCtx})}defined.set("@propagate",true)}if("@import"in ctx){const value=ctx["@import"];if(activeCtx.processingMode==="json-ld-1.0"){throw new JsonLdError("Invalid JSON-LD syntax; @import not compatible with "+activeCtx.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ctx})}if(!_isString(value)){throw new JsonLdError("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:localCtx})}const resolvedImport=await options.contextResolver.resolve({activeCtx:activeCtx,context:value,documentLoader:options.documentLoader,base:options.base});if(resolvedImport.length!==1){throw new JsonLdError("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:localCtx})}const processedImport=resolvedImport[0].getProcessed(activeCtx);if(processedImport){ctx=processedImport}else{const importCtx=resolvedImport[0].document;if("@import"in importCtx){throw new JsonLdError("Invalid JSON-LD syntax: "+"imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:localCtx})}for(const key in importCtx){if(!ctx.hasOwnProperty(key)){ctx[key]=importCtx[key]}}resolvedImport[0].setProcessed(activeCtx,ctx)}defined.set("@import",true)}defined.set("@protected",ctx["@protected"]||false);for(const key in ctx){api.createTermDefinition({activeCtx:rval,localCtx:ctx,term:key,defined:defined,options:options,overrideProtected:overrideProtected});if(_isObject(ctx[key])&&"@context"in ctx[key]){const keyCtx=ctx[key]["@context"];let process=true;if(_isString(keyCtx)){const url=prependBase(options.base,keyCtx);if(cycles.has(url)){process=false}else{cycles.add(url)}}if(process){try{await api.process({activeCtx:rval.clone(),localCtx:ctx[key]["@context"],overrideProtected:true,options:options,cycles:cycles})}catch(e){throw new JsonLdError("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:ctx[key]["@context"],term:key})}}}}resolvedContext.setProcessed(activeCtx,rval)}return rval};api.createTermDefinition=({activeCtx:activeCtx,localCtx:localCtx,term:term,defined:defined,options:options,overrideProtected:overrideProtected=false})=>{if(defined.has(term)){if(defined.get(term)){return}throw new JsonLdError("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:localCtx,term:term})}defined.set(term,false);let value;if(localCtx.hasOwnProperty(term)){value=localCtx[term]}if(term==="@type"&&_isObject(value)&&(value["@container"]||"@set")==="@set"&&api.processingMode(activeCtx,1.1)){const validKeys=["@container","@id","@protected"];const keys=Object.keys(value);if(keys.length===0||keys.some((k=>!validKeys.includes(k)))){throw new JsonLdError("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:localCtx,term:term})}}else if(api.isKeyword(term)){throw new JsonLdError("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:localCtx,term:term})}else if(term.match(KEYWORD_PATTERN)){console.warn('WARNING: terms beginning with "@" are reserved'+" for future use and ignored",{term:term});return}else if(term===""){throw new JsonLdError("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:localCtx})}const previousMapping=activeCtx.mappings.get(term);if(activeCtx.mappings.has(term)){activeCtx.mappings.delete(term)}let simpleTerm=false;if(_isString(value)||value===null){simpleTerm=true;value={"@id":value}}if(!_isObject(value)){throw new JsonLdError("Invalid JSON-LD syntax; @context term values must be "+"strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:localCtx})}const mapping={};activeCtx.mappings.set(term,mapping);mapping.reverse=false;const validKeys=["@container","@id","@language","@reverse","@type"];if(api.processingMode(activeCtx,1.1)){validKeys.push("@context","@direction","@index","@nest","@prefix","@protected")}for(const kw in value){if(!validKeys.includes(kw)){throw new JsonLdError("Invalid JSON-LD syntax; a term definition must not contain "+kw,"jsonld.SyntaxError",{code:"invalid term definition",context:localCtx})}}const colon=term.indexOf(":");mapping._termHasColon=colon>0;if("@reverse"in value){if("@id"in value){throw new JsonLdError("Invalid JSON-LD syntax; a @reverse term definition must not "+"contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:localCtx})}if("@nest"in value){throw new JsonLdError("Invalid JSON-LD syntax; a @reverse term definition must not "+"contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:localCtx})}const reverse=value["@reverse"];if(!_isString(reverse)){throw new JsonLdError("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx})}if(!api.isKeyword(reverse)&&reverse.match(KEYWORD_PATTERN)){console.warn('WARNING: values beginning with "@" are reserved'+" for future use and ignored",{reverse:reverse});if(previousMapping){activeCtx.mappings.set(term,previousMapping)}else{activeCtx.mappings.delete(term)}return}const id=_expandIri(activeCtx,reverse,{vocab:true,base:false},localCtx,defined,options);if(!_isAbsoluteIri(id)){throw new JsonLdError("Invalid JSON-LD syntax; a @context @reverse value must be an "+"absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx})}mapping["@id"]=id;mapping.reverse=true}else if("@id"in value){let id=value["@id"];if(id&&!_isString(id)){throw new JsonLdError("Invalid JSON-LD syntax; a @context @id value must be an array "+"of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx})}if(id===null){mapping["@id"]=null}else if(!api.isKeyword(id)&&id.match(KEYWORD_PATTERN)){console.warn('WARNING: values beginning with "@" are reserved'+" for future use and ignored",{id:id});if(previousMapping){activeCtx.mappings.set(term,previousMapping)}else{activeCtx.mappings.delete(term)}return}else if(id!==term){id=_expandIri(activeCtx,id,{vocab:true,base:false},localCtx,defined,options);if(!_isAbsoluteIri(id)&&!api.isKeyword(id)){throw new JsonLdError("Invalid JSON-LD syntax; a @context @id value must be an "+"absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx})}if(term.match(/(?::[^:])|\//)){const termDefined=new Map(defined).set(term,true);const termIri=_expandIri(activeCtx,term,{vocab:true,base:false},localCtx,termDefined,options);if(termIri!==id){throw new JsonLdError("Invalid JSON-LD syntax; term in form of IRI must "+"expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx})}}mapping["@id"]=id;mapping._prefix=simpleTerm&&!mapping._termHasColon&&id.match(/[:\/\?#\[\]@]$/)}}if(!("@id"in mapping)){if(mapping._termHasColon){const prefix=term.substr(0,colon);if(localCtx.hasOwnProperty(prefix)){api.createTermDefinition({activeCtx:activeCtx,localCtx:localCtx,term:prefix,defined:defined,options:options})}if(activeCtx.mappings.has(prefix)){const suffix=term.substr(colon+1);mapping["@id"]=activeCtx.mappings.get(prefix)["@id"]+suffix}else{mapping["@id"]=term}}else if(term==="@type"){mapping["@id"]=term}else{if(!("@vocab"in activeCtx)){throw new JsonLdError("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx,term:term})}mapping["@id"]=activeCtx["@vocab"]+term}}if(value["@protected"]===true||defined.get("@protected")===true&&value["@protected"]!==false){activeCtx.protected[term]=true;mapping.protected=true}defined.set(term,true);if("@type"in value){let type=value["@type"];if(!_isString(type)){throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx})}if(type==="@json"||type==="@none"){if(api.processingMode(activeCtx,1)){throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must not be "+`"${type}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx})}}else if(type!=="@id"&&type!=="@vocab"){type=_expandIri(activeCtx,type,{vocab:true,base:false},localCtx,defined,options);if(!_isAbsoluteIri(type)){throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must be an "+"absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx})}if(type.indexOf("_:")===0){throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must be an IRI, "+"not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx})}}mapping["@type"]=type}if("@container"in value){const container=_isString(value["@container"])?[value["@container"]]:value["@container"]||[];const validContainers=["@list","@set","@index","@language"];let isValid=true;const hasSet=container.includes("@set");if(api.processingMode(activeCtx,1.1)){validContainers.push("@graph","@id","@type");if(container.includes("@list")){if(container.length!==1){throw new JsonLdError("Invalid JSON-LD syntax; @context @container with @list must "+"have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:localCtx})}}else if(container.includes("@graph")){if(container.some((key=>key!=="@graph"&&key!=="@id"&&key!=="@index"&&key!=="@set"))){throw new JsonLdError("Invalid JSON-LD syntax; @context @container with @graph must "+"have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:localCtx})}}else{isValid&=container.length<=(hasSet?2:1)}if(container.includes("@type")){mapping["@type"]=mapping["@type"]||"@id";if(!["@id","@vocab"].includes(mapping["@type"])){throw new JsonLdError("Invalid JSON-LD syntax; container: @type requires @type to be "+"@id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx})}}}else{isValid&=!_isArray(value["@container"]);isValid&=container.length<=1}isValid&=container.every((c=>validContainers.includes(c)));isValid&=!(hasSet&&container.includes("@list"));if(!isValid){throw new JsonLdError("Invalid JSON-LD syntax; @context @container value must be "+"one of the following: "+validContainers.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:localCtx})}if(mapping.reverse&&!container.every((c=>["@index","@set"].includes(c)))){throw new JsonLdError("Invalid JSON-LD syntax; @context @container value for a @reverse "+"type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:localCtx})}mapping["@container"]=container}if("@index"in value){if(!("@container"in value)||!mapping["@container"].includes("@index")){throw new JsonLdError("Invalid JSON-LD syntax; @index without @index in @container: "+`"${value["@index"]}" on term "${term}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:localCtx})}if(!_isString(value["@index"])||value["@index"].indexOf("@")===0){throw new JsonLdError("Invalid JSON-LD syntax; @index must expand to an IRI: "+`"${value["@index"]}" on term "${term}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:localCtx})}mapping["@index"]=value["@index"]}if("@context"in value){mapping["@context"]=value["@context"]}if("@language"in value&&!("@type"in value)){let language=value["@language"];if(language!==null&&!_isString(language)){throw new JsonLdError("Invalid JSON-LD syntax; @context @language value must be "+"a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:localCtx})}if(language!==null){language=language.toLowerCase()}mapping["@language"]=language}if("@prefix"in value){if(term.match(/:|\//)){throw new JsonLdError("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:localCtx})}if(api.isKeyword(mapping["@id"])){throw new JsonLdError("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:localCtx})}if(typeof value["@prefix"]==="boolean"){mapping._prefix=value["@prefix"]===true}else{throw new JsonLdError("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:localCtx})}}if("@direction"in value){const direction=value["@direction"];if(direction!==null&&direction!=="ltr"&&direction!=="rtl"){throw new JsonLdError("Invalid JSON-LD syntax; @direction value must be "+'null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:localCtx})}mapping["@direction"]=direction}if("@nest"in value){const nest=value["@nest"];if(!_isString(nest)||nest!=="@nest"&&nest.indexOf("@")===0){throw new JsonLdError("Invalid JSON-LD syntax; @context @nest value must be "+"a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:localCtx})}mapping["@nest"]=nest}
// disallow aliasing @context and @preserve
const id=mapping["@id"];if(id==="@context"||id==="@preserve"){throw new JsonLdError("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:localCtx})}if(previousMapping&&previousMapping.protected&&!overrideProtected){activeCtx.protected[term]=true;mapping.protected=true;if(!_deepCompare(previousMapping,mapping)){const protectedMode=options&&options.protectedMode||"error";if(protectedMode==="error"){throw new JsonLdError(`Invalid JSON-LD syntax; tried to redefine "${term}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:localCtx,term:term})}else if(protectedMode==="warn"){console.warn("WARNING: protected term redefinition",{term:term});return}throw new JsonLdError("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:localCtx,term:term,protectedMode:protectedMode})}}};api.expandIri=(activeCtx,value,relativeTo,options)=>_expandIri(activeCtx,value,relativeTo,undefined,undefined,options);function _expandIri(activeCtx,value,relativeTo,localCtx,defined,options){if(value===null||!_isString(value)||api.isKeyword(value)){return value}if(value.match(KEYWORD_PATTERN)){return null}if(localCtx&&localCtx.hasOwnProperty(value)&&defined.get(value)!==true){api.createTermDefinition({activeCtx:activeCtx,localCtx:localCtx,term:value,defined:defined,options:options})}relativeTo=relativeTo||{};if(relativeTo.vocab){const mapping=activeCtx.mappings.get(value);if(mapping===null){return null}if(_isObject(mapping)&&"@id"in mapping){return mapping["@id"]}}const colon=value.indexOf(":");if(colon>0){const prefix=value.substr(0,colon);const suffix=value.substr(colon+1);if(prefix==="_"||suffix.indexOf("//")===0){return value}if(localCtx&&localCtx.hasOwnProperty(prefix)){api.createTermDefinition({activeCtx:activeCtx,localCtx:localCtx,term:prefix,defined:defined,options:options})}const mapping=activeCtx.mappings.get(prefix);if(mapping&&mapping._prefix){return mapping["@id"]+suffix}if(_isAbsoluteIri(value)){return value}}if(relativeTo.vocab&&"@vocab"in activeCtx){return activeCtx["@vocab"]+value}if(relativeTo.base&&"@base"in activeCtx){if(activeCtx["@base"]){return prependBase(prependBase(options.base,activeCtx["@base"]),value)}}else if(relativeTo.base){return prependBase(options.base,value)}return value}api.getInitialContext=options=>{const key=JSON.stringify({processingMode:options.processingMode});const cached=INITIAL_CONTEXT_CACHE.get(key);if(cached){return cached}const initialContext={processingMode:options.processingMode,mappings:new Map,inverse:null,getInverse:_createInverseContext,clone:_cloneActiveContext,revertToPreviousContext:_revertToPreviousContext,protected:{}};if(INITIAL_CONTEXT_CACHE.size===INITIAL_CONTEXT_CACHE_MAX_SIZE){INITIAL_CONTEXT_CACHE.clear()}INITIAL_CONTEXT_CACHE.set(key,initialContext);return initialContext;function _createInverseContext(){const activeCtx=this;if(activeCtx.inverse){return activeCtx.inverse}const inverse=activeCtx.inverse={};const fastCurieMap=activeCtx.fastCurieMap={};const irisToTerms={};const defaultLanguage=(activeCtx["@language"]||"@none").toLowerCase();const defaultDirection=activeCtx["@direction"];const mappings=activeCtx.mappings;const terms=[...mappings.keys()].sort(_compareShortestLeast);for(const term of terms){const mapping=mappings.get(term);if(mapping===null){continue}let container=mapping["@container"]||"@none";container=[].concat(container).sort().join("");if(mapping["@id"]===null){continue}const ids=_asArray(mapping["@id"]);for(const iri of ids){let entry=inverse[iri];const isKeyword=api.isKeyword(iri);if(!entry){inverse[iri]=entry={};if(!isKeyword&&!mapping._termHasColon){irisToTerms[iri]=[term];const fastCurieEntry={iri:iri,terms:irisToTerms[iri]};if(iri[0]in fastCurieMap){fastCurieMap[iri[0]].push(fastCurieEntry)}else{fastCurieMap[iri[0]]=[fastCurieEntry]}}}else if(!isKeyword&&!mapping._termHasColon){irisToTerms[iri].push(term)}if(!entry[container]){entry[container]={"@language":{},"@type":{},"@any":{}}}entry=entry[container];_addPreferredTerm(term,entry["@any"],"@none");if(mapping.reverse){_addPreferredTerm(term,entry["@type"],"@reverse")}else if(mapping["@type"]==="@none"){_addPreferredTerm(term,entry["@any"],"@none");_addPreferredTerm(term,entry["@language"],"@none");_addPreferredTerm(term,entry["@type"],"@none")}else if("@type"in mapping){_addPreferredTerm(term,entry["@type"],mapping["@type"])}else if("@language"in mapping&&"@direction"in mapping){const language=mapping["@language"];const direction=mapping["@direction"];if(language&&direction){_addPreferredTerm(term,entry["@language"],`${language}_${direction}`.toLowerCase())}else if(language){_addPreferredTerm(term,entry["@language"],language.toLowerCase())}else if(direction){_addPreferredTerm(term,entry["@language"],`_${direction}`)}else{_addPreferredTerm(term,entry["@language"],"@null")}}else if("@language"in mapping){_addPreferredTerm(term,entry["@language"],(mapping["@language"]||"@null").toLowerCase())}else if("@direction"in mapping){if(mapping["@direction"]){_addPreferredTerm(term,entry["@language"],`_${mapping["@direction"]}`)}else{_addPreferredTerm(term,entry["@language"],"@none")}}else if(defaultDirection){_addPreferredTerm(term,entry["@language"],`_${defaultDirection}`);_addPreferredTerm(term,entry["@language"],"@none");_addPreferredTerm(term,entry["@type"],"@none")}else{_addPreferredTerm(term,entry["@language"],defaultLanguage);_addPreferredTerm(term,entry["@language"],"@none");_addPreferredTerm(term,entry["@type"],"@none")}}}for(const key in fastCurieMap){_buildIriMap(fastCurieMap,key,1)}return inverse}function _buildIriMap(iriMap,key,idx){const entries=iriMap[key];const next=iriMap[key]={};let iri;let letter;for(const entry of entries){iri=entry.iri;if(idx>=iri.length){letter=""}else{letter=iri[idx]}if(letter in next){next[letter].push(entry)}else{next[letter]=[entry]}}for(const key in next){if(key===""){continue}_buildIriMap(next,key,idx+1)}}function _addPreferredTerm(term,entry,typeOrLanguageValue){if(!entry.hasOwnProperty(typeOrLanguageValue)){entry[typeOrLanguageValue]=term}}function _cloneActiveContext(){const child={};child.mappings=util.clone(this.mappings);child.clone=this.clone;child.inverse=null;child.getInverse=this.getInverse;child.protected=util.clone(this.protected);if(this.previousContext){child.previousContext=this.previousContext.clone()}child.revertToPreviousContext=this.revertToPreviousContext;if("@base"in this){child["@base"]=this["@base"]}if("@language"in this){child["@language"]=this["@language"]}if("@vocab"in this){child["@vocab"]=this["@vocab"]}return child}function _revertToPreviousContext(){if(!this.previousContext){return this}return this.previousContext.clone()}};api.getContextValue=(ctx,key,type)=>{if(key===null){if(type==="@context"){return undefined}return null}if(ctx.mappings.has(key)){const entry=ctx.mappings.get(key);if(_isUndefined(type)){return entry}if(entry.hasOwnProperty(type)){return entry[type]}}if(type==="@language"&&type in ctx){return ctx[type]}if(type==="@direction"&&type in ctx){return ctx[type]}if(type==="@context"){return undefined}return null};api.processingMode=(activeCtx,version)=>{if(version.toString()>="1.1"){return!activeCtx.processingMode||activeCtx.processingMode>="json-ld-"+version.toString()}else{return activeCtx.processingMode==="json-ld-1.0"}};api.isKeyword=v=>{if(!_isString(v)||v[0]!=="@"){return false}switch(v){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return true}return false};function _deepCompare(x1,x2){if(!(x1&&typeof x1==="object")||!(x2&&typeof x2==="object")){return x1===x2}const x1Array=Array.isArray(x1);if(x1Array!==Array.isArray(x2)){return false}if(x1Array){if(x1.length!==x2.length){return false}for(let i=0;i<x1.length;++i){if(!_deepCompare(x1[i],x2[i])){return false}}return true}const k1s=Object.keys(x1);const k2s=Object.keys(x2);if(k1s.length!==k2s.length){return false}for(const k1 in x1){let v1=x1[k1];let v2=x2[k1];if(k1==="@container"){if(Array.isArray(v1)&&Array.isArray(v2)){v1=v1.slice().sort();v2=v2.slice().sort()}}if(!_deepCompare(v1,v2)){return false}}return true}},{"./JsonLdError":319,"./types":337,"./url":338,"./util":339}],327:[function(require,module,exports){"use strict";const{parseLinkHeader:parseLinkHeader,buildHeaders:buildHeaders}=require("../util");const{LINK_HEADER_CONTEXT:LINK_HEADER_CONTEXT}=require("../constants");const JsonLdError=require("../JsonLdError");const RequestQueue=require("../RequestQueue");const{prependBase:prependBase}=require("../url");module.exports=({secure:secure,strictSSL:strictSSL=true,maxRedirects:maxRedirects=-1,request:request,headers:headers={}}={strictSSL:true,maxRedirects:-1,headers:{}})=>{headers=buildHeaders(headers);request=request||require("request");const http=require("http");const queue=new RequestQueue;return queue.wrapLoader((function(url){return loadDocument(url,[])}));async function loadDocument(url,redirects){if(url.indexOf("http:")!==0&&url.indexOf("https:")!==0){throw new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are '+"supported.","jsonld.InvalidUrl",{code:"loading document failed",url:url})}if(secure&&url.indexOf("https")!==0){throw new JsonLdError("URL could not be dereferenced; secure mode is enabled and "+'the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:url})}let doc=null;if(doc!==null){return doc}let result;let alternate=null;try{result=await _request(request,{url:url,headers:headers,strictSSL:strictSSL,followRedirect:false})}catch(e){throw new JsonLdError("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:url,cause:e})}const{res:res,body:body}=result;doc={contextUrl:null,documentUrl:url,document:body||null};const statusText=http.STATUS_CODES[res.statusCode];if(res.statusCode>=400){throw new JsonLdError(`URL "${url}" could not be dereferenced: ${statusText}`,"jsonld.InvalidUrl",{code:"loading document failed",url:url,httpStatusCode:res.statusCode})}if(res.headers.link&&res.headers["content-type"]!=="application/ld+json"){const linkHeaders=parseLinkHeader(res.headers.link);const linkedContext=linkHeaders[LINK_HEADER_CONTEXT];if(Array.isArray(linkedContext)){throw new JsonLdError("URL could not be dereferenced, it has more than one associated "+"HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:url})}if(linkedContext){doc.contextUrl=linkedContext.target}alternate=linkHeaders["alternate"];if(alternate&&alternate.type=="application/ld+json"&&!(res.headers["content-type"]||"").match(/^application\/(\w*\+)?json$/)){res.headers.location=prependBase(url,alternate.target)}}if((alternate||res.statusCode>=300&&res.statusCode<400)&&res.headers.location){if(redirects.length===maxRedirects){throw new JsonLdError("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:url,httpStatusCode:res.statusCode,redirects:redirects})}if(redirects.indexOf(url)!==-1){throw new JsonLdError("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:url,httpStatusCode:res.statusCode,redirects:redirects})}redirects.push(url);return loadDocument(res.headers.location,redirects)}redirects.push(url);return doc}};function _request(request,options){return new Promise(((resolve,reject)=>{request(options,((err,res,body)=>{if(err){reject(err)}else{resolve({res:res,body:body})}}))}))}},{"../JsonLdError":319,"../RequestQueue":322,"../constants":325,"../url":338,"../util":339,http:148,request:148}],328:[function(require,module,exports){"use strict";const{parseLinkHeader:parseLinkHeader,buildHeaders:buildHeaders}=require("../util");const{LINK_HEADER_CONTEXT:LINK_HEADER_CONTEXT}=require("../constants");const JsonLdError=require("../JsonLdError");const RequestQueue=require("../RequestQueue");const{prependBase:prependBase}=require("../url");const REGEX_LINK_HEADER=/(^|(\r\n))link:/i;module.exports=({secure:secure,headers:headers={},xhr:xhr}={headers:{}})=>{headers=buildHeaders(headers);const queue=new RequestQueue;return queue.wrapLoader(loader);async function loader(url){if(url.indexOf("http:")!==0&&url.indexOf("https:")!==0){throw new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are '+"supported.","jsonld.InvalidUrl",{code:"loading document failed",url:url})}if(secure&&url.indexOf("https")!==0){throw new JsonLdError("URL could not be dereferenced; secure mode is enabled and "+'the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:url})}let req;try{req=await _get(xhr,url,headers)}catch(e){throw new JsonLdError("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:url,cause:e})}if(req.status>=400){throw new JsonLdError("URL could not be dereferenced: "+req.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:url,httpStatusCode:req.status})}let doc={contextUrl:null,documentUrl:url,document:req.response};let alternate=null;const contentType=req.getResponseHeader("Content-Type");let linkHeader;if(REGEX_LINK_HEADER.test(req.getAllResponseHeaders())){linkHeader=req.getResponseHeader("Link")}if(linkHeader&&contentType!=="application/ld+json"){const linkHeaders=parseLinkHeader(linkHeader);const linkedContext=linkHeaders[LINK_HEADER_CONTEXT];if(Array.isArray(linkedContext)){throw new JsonLdError("URL could not be dereferenced, it has more than one "+"associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:url})}if(linkedContext){doc.contextUrl=linkedContext.target}alternate=linkHeaders["alternate"];if(alternate&&alternate.type=="application/ld+json"&&!(contentType||"").match(/^application\/(\w*\+)?json$/)){doc=await loader(prependBase(url,alternate.target))}}return doc}};function _get(xhr,url,headers){xhr=xhr||XMLHttpRequest;const req=new xhr;return new Promise(((resolve,reject)=>{req.onload=()=>resolve(req);req.onerror=err=>reject(err);req.open("GET",url,true);for(const k in headers){req.setRequestHeader(k,headers[k])}req.send()}))}},{"../JsonLdError":319,"../RequestQueue":322,"../constants":325,"../url":338,"../util":339}],329:[function(require,module,exports){"use strict";const JsonLdError=require("./JsonLdError");const{isArray:_isArray,isObject:_isObject,isEmptyObject:_isEmptyObject,isString:_isString,isUndefined:_isUndefined}=require("./types");const{isList:_isList,isValue:_isValue,isGraph:_isGraph,isSubject:_isSubject}=require("./graphTypes");const{expandIri:_expandIri,getContextValue:_getContextValue,isKeyword:_isKeyword,process:_processContext,processingMode:_processingMode}=require("./context");const{isAbsolute:_isAbsoluteIri}=require("./url");const{addValue:_addValue,asArray:_asArray,getValues:_getValues,validateTypeValue:_validateTypeValue}=require("./util");const api={};module.exports=api;const REGEX_BCP47=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;api.expand=async({activeCtx:activeCtx,activeProperty:activeProperty=null,element:element,options:options={},insideList:insideList=false,insideIndex:insideIndex=false,typeScopedContext:typeScopedContext=null,expansionMap:expansionMap=(()=>undefined)})=>{if(element===null||element===undefined){return null}if(activeProperty==="@default"){options=Object.assign({},options,{isFrame:false})}if(!_isArray(element)&&!_isObject(element)){if(!insideList&&(activeProperty===null||_expandIri(activeCtx,activeProperty,{vocab:true},options)==="@graph")){const mapped=await expansionMap({unmappedValue:element,activeCtx:activeCtx,activeProperty:activeProperty,options:options,insideList:insideList});if(mapped===undefined){return null}return mapped}return _expandValue({activeCtx:activeCtx,activeProperty:activeProperty,value:element,options:options})}if(_isArray(element)){let rval=[];const container=_getContextValue(activeCtx,activeProperty,"@container")||[];insideList=insideList||container.includes("@list");for(let i=0;i<element.length;++i){let e=await api.expand({activeCtx:activeCtx,activeProperty:activeProperty,element:element[i],options:options,expansionMap:expansionMap,insideIndex:insideIndex,typeScopedContext:typeScopedContext});if(insideList&&_isArray(e)){e={"@list":e}}if(e===null){e=await expansionMap({unmappedValue:element[i],activeCtx:activeCtx,activeProperty:activeProperty,parent:element,index:i,options:options,expandedParent:rval,insideList:insideList});if(e===undefined){continue}}if(_isArray(e)){rval=rval.concat(e)}else{rval.push(e)}}return rval}const expandedActiveProperty=_expandIri(activeCtx,activeProperty,{vocab:true},options);const propertyScopedCtx=_getContextValue(activeCtx,activeProperty,"@context");typeScopedContext=typeScopedContext||(activeCtx.previousContext?activeCtx:null);let keys=Object.keys(element).sort();let mustRevert=!insideIndex;if(mustRevert&&typeScopedContext&&keys.length<=2&&!keys.includes("@context")){for(const key of keys){const expandedProperty=_expandIri(typeScopedContext,key,{vocab:true},options);if(expandedProperty==="@value"){mustRevert=false;activeCtx=typeScopedContext;break}if(expandedProperty==="@id"&&keys.length===1){mustRevert=false;break}}}if(mustRevert){activeCtx=activeCtx.revertToPreviousContext()}if(!_isUndefined(propertyScopedCtx)){activeCtx=await _processContext({activeCtx:activeCtx,localCtx:propertyScopedCtx,propagate:true,overrideProtected:true,options:options})}if("@context"in element){activeCtx=await _processContext({activeCtx:activeCtx,localCtx:element["@context"],options:options})}typeScopedContext=activeCtx;let typeKey=null;for(const key of keys){const expandedProperty=_expandIri(activeCtx,key,{vocab:true},options);if(expandedProperty==="@type"){typeKey=typeKey||key;const value=element[key];const types=Array.isArray(value)?value.length>1?value.slice().sort():value:[value];for(const type of types){const ctx=_getContextValue(typeScopedContext,type,"@context");if(!_isUndefined(ctx)){activeCtx=await _processContext({activeCtx:activeCtx,localCtx:ctx,options:options,propagate:false})}}}}let rval={};await _expandObject({activeCtx:activeCtx,activeProperty:activeProperty,expandedActiveProperty:expandedActiveProperty,element:element,expandedParent:rval,options:options,insideList:insideList,typeKey:typeKey,typeScopedContext:typeScopedContext,expansionMap:expansionMap});keys=Object.keys(rval);let count=keys.length;if("@value"in rval){if("@type"in rval&&("@language"in rval||"@direction"in rval)){throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" may not '+'contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:rval})}let validCount=count-1;if("@type"in rval){validCount-=1}if("@index"in rval){validCount-=1}if("@language"in rval){validCount-=1}if("@direction"in rval){validCount-=1}if(validCount!==0){throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" may only '+'have an "@index" property and either "@type" '+'or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:rval})}const values=rval["@value"]===null?[]:_asArray(rval["@value"]);const types=_getValues(rval,"@type");if(_processingMode(activeCtx,1.1)&&types.includes("@json")&&types.length===1){}else if(values.length===0){const mapped=await expansionMap({unmappedValue:rval,activeCtx:activeCtx,activeProperty:activeProperty,element:element,options:options,insideList:insideList});if(mapped!==undefined){rval=mapped}else{rval=null}}else if(!values.every((v=>_isString(v)||_isEmptyObject(v)))&&"@language"in rval){throw new JsonLdError("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:rval})}else if(!types.every((t=>_isAbsoluteIri(t)&&!(_isString(t)&&t.indexOf("_:")===0)||_isEmptyObject(t)))){throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" and "@type" '+'must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:rval})}}else if("@type"in rval&&!_isArray(rval["@type"])){rval["@type"]=[rval["@type"]]}else if("@set"in rval||"@list"in rval){if(count>1&&!(count===2&&"@index"in rval)){throw new JsonLdError('Invalid JSON-LD syntax; if an element has the property "@set" '+'or "@list", then it can have at most one other property that is '+'"@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:rval})}if("@set"in rval){rval=rval["@set"];keys=Object.keys(rval);count=keys.length}}else if(count===1&&"@language"in rval){const mapped=await expansionMap(rval,{unmappedValue:rval,activeCtx:activeCtx,activeProperty:activeProperty,element:element,options:options,insideList:insideList});if(mapped!==undefined){rval=mapped}else{rval=null}}if(_isObject(rval)&&!options.keepFreeFloatingNodes&&!insideList&&(activeProperty===null||expandedActiveProperty==="@graph")){if(count===0||"@value"in rval||"@list"in rval||count===1&&"@id"in rval){const mapped=await expansionMap({unmappedValue:rval,activeCtx:activeCtx,activeProperty:activeProperty,element:element,options:options,insideList:insideList});if(mapped!==undefined){rval=mapped}else{rval=null}}}return rval};async function _expandObject({activeCtx:activeCtx,activeProperty:activeProperty,expandedActiveProperty:expandedActiveProperty,element:element,expandedParent:expandedParent,options:options={},insideList:insideList,typeKey:typeKey,typeScopedContext:typeScopedContext,expansionMap:expansionMap}){const keys=Object.keys(element).sort();const nests=[];let unexpandedValue;const isJsonType=element[typeKey]&&_expandIri(activeCtx,_isArray(element[typeKey])?element[typeKey][0]:element[typeKey],{vocab:true},options)==="@json";for(const key of keys){let value=element[key];let expandedValue;if(key==="@context"){continue}let expandedProperty=_expandIri(activeCtx,key,{vocab:true},options);if(expandedProperty===null||!(_isAbsoluteIri(expandedProperty)||_isKeyword(expandedProperty))){expandedProperty=expansionMap({unmappedProperty:key,activeCtx:activeCtx,activeProperty:activeProperty,parent:element,options:options,insideList:insideList,value:value,expandedParent:expandedParent});if(expandedProperty===undefined){continue}}if(_isKeyword(expandedProperty)){if(expandedActiveProperty==="@reverse"){throw new JsonLdError("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse "+"property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:value})}if(expandedProperty in expandedParent&&expandedProperty!=="@included"&&expandedProperty!=="@type"){throw new JsonLdError("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:expandedProperty})}}if(expandedProperty==="@id"){if(!_isString(value)){if(!options.isFrame){throw new JsonLdError('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:value})}if(_isObject(value)){if(!_isEmptyObject(value)){throw new JsonLdError('Invalid JSON-LD syntax; "@id" value an empty object or array '+"of strings, if framing","jsonld.SyntaxError",{code:"invalid @id value",value:value})}}else if(_isArray(value)){if(!value.every((v=>_isString(v)))){throw new JsonLdError('Invalid JSON-LD syntax; "@id" value an empty object or array '+"of strings, if framing","jsonld.SyntaxError",{code:"invalid @id value",value:value})}}else{throw new JsonLdError('Invalid JSON-LD syntax; "@id" value an empty object or array '+"of strings, if framing","jsonld.SyntaxError",{code:"invalid @id value",value:value})}}_addValue(expandedParent,"@id",_asArray(value).map((v=>_isString(v)?_expandIri(activeCtx,v,{base:true},options):v)),{propertyIsArray:options.isFrame});continue}if(expandedProperty==="@type"){if(_isObject(value)){value=Object.fromEntries(Object.entries(value).map((([k,v])=>[_expandIri(typeScopedContext,k,{vocab:true}),_asArray(v).map((vv=>_expandIri(typeScopedContext,vv,{base:true,vocab:true})))])))}_validateTypeValue(value,options.isFrame);_addValue(expandedParent,"@type",_asArray(value).map((v=>_isString(v)?_expandIri(typeScopedContext,v,{base:true,vocab:true},options):v)),{propertyIsArray:options.isFrame});continue}if(expandedProperty==="@included"&&_processingMode(activeCtx,1.1)){const includedResult=_asArray(await api.expand({activeCtx:activeCtx,activeProperty:activeProperty,element:value,options:options,expansionMap:expansionMap}));if(!includedResult.every((v=>_isSubject(v)))){throw new JsonLdError("Invalid JSON-LD syntax; "+"values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:value})}_addValue(expandedParent,"@included",includedResult,{propertyIsArray:true});continue}if(expandedProperty==="@graph"&&!(_isObject(value)||_isArray(value))){throw new JsonLdError('Invalid JSON-LD syntax; "@graph" value must not be an '+"object or an array.","jsonld.SyntaxError",{code:"invalid @graph value",value:value})}if(expandedProperty==="@value"){unexpandedValue=value;if(isJsonType&&_processingMode(activeCtx,1.1)){expandedParent["@value"]=value}else{_addValue(expandedParent,"@value",value,{propertyIsArray:options.isFrame})}continue}if(expandedProperty==="@language"){if(value===null){continue}if(!_isString(value)&&!options.isFrame){throw new JsonLdError('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:value})}value=_asArray(value).map((v=>_isString(v)?v.toLowerCase():v));for(const lang of value){if(_isString(lang)&&!lang.match(REGEX_BCP47)){console.warn(`@language must be valid BCP47: ${lang}`)}}_addValue(expandedParent,"@language",value,{propertyIsArray:options.isFrame});continue}if(expandedProperty==="@direction"){if(!_isString(value)&&!options.isFrame){throw new JsonLdError('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:value})}value=_asArray(value);for(const dir of value){if(_isString(dir)&&dir!=="ltr"&&dir!=="rtl"){throw new JsonLdError('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:value})}}_addValue(expandedParent,"@direction",value,{propertyIsArray:options.isFrame});continue}if(expandedProperty==="@index"){if(!_isString(value)){throw new JsonLdError('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:value})}_addValue(expandedParent,"@index",value);continue}if(expandedProperty==="@reverse"){if(!_isObject(value)){throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:value})}expandedValue=await api.expand({activeCtx:activeCtx,activeProperty:"@reverse",element:value,options:options,expansionMap:expansionMap});if("@reverse"in expandedValue){for(const property in expandedValue["@reverse"]){_addValue(expandedParent,property,expandedValue["@reverse"][property],{propertyIsArray:true})}}let reverseMap=expandedParent["@reverse"]||null;for(const property in expandedValue){if(property==="@reverse"){continue}if(reverseMap===null){reverseMap=expandedParent["@reverse"]={}}_addValue(reverseMap,property,[],{propertyIsArray:true});const items=expandedValue[property];for(let ii=0;ii<items.length;++ii){const item=items[ii];if(_isValue(item)||_isList(item)){throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must not be a '+"@value or an @list.","jsonld.SyntaxError",{code:"invalid reverse property value",value:expandedValue})}_addValue(reverseMap,property,item,{propertyIsArray:true})}}continue}if(expandedProperty==="@nest"){nests.push(key);continue}let termCtx=activeCtx;const ctx=_getContextValue(activeCtx,key,"@context");if(!_isUndefined(ctx)){termCtx=await _processContext({activeCtx:activeCtx,localCtx:ctx,propagate:true,overrideProtected:true,options:options})}const container=_getContextValue(termCtx,key,"@container")||[];if(container.includes("@language")&&_isObject(value)){const direction=_getContextValue(termCtx,key,"@direction");expandedValue=_expandLanguageMap(termCtx,value,direction,options)}else if(container.includes("@index")&&_isObject(value)){const asGraph=container.includes("@graph");const indexKey=_getContextValue(termCtx,key,"@index")||"@index";const propertyIndex=indexKey!=="@index"&&_expandIri(activeCtx,indexKey,{vocab:true},options);expandedValue=await _expandIndexMap({activeCtx:termCtx,options:options,activeProperty:key,value:value,expansionMap:expansionMap,asGraph:asGraph,indexKey:indexKey,propertyIndex:propertyIndex})}else if(container.includes("@id")&&_isObject(value)){const asGraph=container.includes("@graph");expandedValue=await _expandIndexMap({activeCtx:termCtx,options:options,activeProperty:key,value:value,expansionMap:expansionMap,asGraph:asGraph,indexKey:"@id"})}else if(container.includes("@type")&&_isObject(value)){expandedValue=await _expandIndexMap({activeCtx:termCtx.revertToPreviousContext(),options:options,activeProperty:key,value:value,expansionMap:expansionMap,asGraph:false,indexKey:"@type"})}else{const isList=expandedProperty==="@list";if(isList||expandedProperty==="@set"){let nextActiveProperty=activeProperty;if(isList&&expandedActiveProperty==="@graph"){nextActiveProperty=null}expandedValue=await api.expand({activeCtx:termCtx,activeProperty:nextActiveProperty,element:value,options:options,insideList:isList,expansionMap:expansionMap})}else if(_getContextValue(activeCtx,key,"@type")==="@json"){expandedValue={"@type":"@json","@value":value}}else{expandedValue=await api.expand({activeCtx:termCtx,activeProperty:key,element:value,options:options,insideList:false,expansionMap:expansionMap})}}if(expandedValue===null&&expandedProperty!=="@value"){expandedValue=expansionMap({unmappedValue:value,expandedProperty:expandedProperty,activeCtx:termCtx,activeProperty:activeProperty,parent:element,options:options,insideList:insideList,key:key,expandedParent:expandedParent});if(expandedValue===undefined){continue}}if(expandedProperty!=="@list"&&!_isList(expandedValue)&&container.includes("@list")){expandedValue={"@list":_asArray(expandedValue)}}if(container.includes("@graph")&&!container.some((key=>key==="@id"||key==="@index"))){expandedValue=_asArray(expandedValue).map((v=>({"@graph":_asArray(v)})))}if(termCtx.mappings.has(key)&&termCtx.mappings.get(key).reverse){const reverseMap=expandedParent["@reverse"]=expandedParent["@reverse"]||{};expandedValue=_asArray(expandedValue);for(let ii=0;ii<expandedValue.length;++ii){const item=expandedValue[ii];if(_isValue(item)||_isList(item)){throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must not be a '+"@value or an @list.","jsonld.SyntaxError",{code:"invalid reverse property value",value:expandedValue})}_addValue(reverseMap,expandedProperty,item,{propertyIsArray:true})}continue}_addValue(expandedParent,expandedProperty,expandedValue,{propertyIsArray:true})}if("@value"in expandedParent){if(expandedParent["@type"]==="@json"&&_processingMode(activeCtx,1.1)){}else if((_isObject(unexpandedValue)||_isArray(unexpandedValue))&&!options.isFrame){throw new JsonLdError('Invalid JSON-LD syntax; "@value" value must not be an '+"object or an array.","jsonld.SyntaxError",{code:"invalid value object value",value:unexpandedValue})}}for(const key of nests){const nestedValues=_isArray(element[key])?element[key]:[element[key]];for(const nv of nestedValues){if(!_isObject(nv)||Object.keys(nv).some((k=>_expandIri(activeCtx,k,{vocab:true},options)==="@value"))){throw new JsonLdError("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:nv})}await _expandObject({activeCtx:activeCtx,activeProperty:activeProperty,expandedActiveProperty:expandedActiveProperty,element:nv,expandedParent:expandedParent,options:options,insideList:insideList,typeScopedContext:typeScopedContext,typeKey:typeKey,expansionMap:expansionMap})}}}function _expandValue({activeCtx:activeCtx,activeProperty:activeProperty,value:value,options:options}){if(value===null||value===undefined){return null}const expandedProperty=_expandIri(activeCtx,activeProperty,{vocab:true},options);if(expandedProperty==="@id"){return _expandIri(activeCtx,value,{base:true},options)}else if(expandedProperty==="@type"){return _expandIri(activeCtx,value,{vocab:true,base:true},options)}const type=_getContextValue(activeCtx,activeProperty,"@type");if((type==="@id"||expandedProperty==="@graph")&&_isString(value)){return{"@id":_expandIri(activeCtx,value,{base:true},options)}}if(type==="@vocab"&&_isString(value)){return{"@id":_expandIri(activeCtx,value,{vocab:true,base:true},options)}}if(_isKeyword(expandedProperty)){return value}const rval={};if(type&&!["@id","@vocab","@none"].includes(type)){rval["@type"]=type}else if(_isString(value)){const language=_getContextValue(activeCtx,activeProperty,"@language");if(language!==null){rval["@language"]=language}const direction=_getContextValue(activeCtx,activeProperty,"@direction");if(direction!==null){rval["@direction"]=direction}}if(!["boolean","number","string"].includes(typeof value)){value=value.toString()}rval["@value"]=value;return rval}function _expandLanguageMap(activeCtx,languageMap,direction,options){const rval=[];const keys=Object.keys(languageMap).sort();for(const key of keys){const expandedKey=_expandIri(activeCtx,key,{vocab:true},options);let val=languageMap[key];if(!_isArray(val)){val=[val]}for(const item of val){if(item===null){continue}if(!_isString(item)){throw new JsonLdError("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:languageMap})}const val={"@value":item};if(expandedKey!=="@none"){val["@language"]=key.toLowerCase()}if(direction){val["@direction"]=direction}rval.push(val)}}return rval}async function _expandIndexMap({activeCtx:activeCtx,options:options,activeProperty:activeProperty,value:value,expansionMap:expansionMap,asGraph:asGraph,indexKey:indexKey,propertyIndex:propertyIndex}){const rval=[];const keys=Object.keys(value).sort();const isTypeIndex=indexKey==="@type";for(let key of keys){if(isTypeIndex){const ctx=_getContextValue(activeCtx,key,"@context");if(!_isUndefined(ctx)){activeCtx=await _processContext({activeCtx:activeCtx,localCtx:ctx,propagate:false,options:options})}}let val=value[key];if(!_isArray(val)){val=[val]}val=await api.expand({activeCtx:activeCtx,activeProperty:activeProperty,element:val,options:options,insideList:false,insideIndex:true,expansionMap:expansionMap});let expandedKey;if(propertyIndex){if(key==="@none"){expandedKey="@none"}else{expandedKey=_expandValue({activeCtx:activeCtx,activeProperty:indexKey,value:key,options:options})}}else{expandedKey=_expandIri(activeCtx,key,{vocab:true},options)}if(indexKey==="@id"){key=_expandIri(activeCtx,key,{base:true},options)}else if(isTypeIndex){key=expandedKey}for(let item of val){if(asGraph&&!_isGraph(item)){item={"@graph":[item]}}if(indexKey==="@type"){if(expandedKey==="@none"){}else if(item["@type"]){item["@type"]=[key].concat(item["@type"])}else{item["@type"]=[key]}}else if(_isValue(item)&&!["@language","@type","@index"].includes(indexKey)){throw new JsonLdError("Invalid JSON-LD syntax; Attempt to add illegal key to value "+`object: "${indexKey}".`,"jsonld.SyntaxError",{code:"invalid value object",value:item})}else if(propertyIndex){if(expandedKey!=="@none"){_addValue(item,propertyIndex,expandedKey,{propertyIsArray:true,prependValue:true})}}else if(expandedKey!=="@none"&&!(indexKey in item)){item[indexKey]=key}rval.push(item)}}return rval}},{"./JsonLdError":319,"./context":326,"./graphTypes":333,"./types":337,"./url":338,"./util":339}],330:[function(require,module,exports){"use strict";const{isSubjectReference:_isSubjectReference}=require("./graphTypes");const{createMergedNodeMap:_createMergedNodeMap}=require("./nodeMap");const api={};module.exports=api;api.flatten=input=>{const defaultGraph=_createMergedNodeMap(input);const flattened=[];const keys=Object.keys(defaultGraph).sort();for(let ki=0;ki<keys.length;++ki){const node=defaultGraph[keys[ki]];if(!_isSubjectReference(node)){flattened.push(node)}}return flattened}},{"./graphTypes":333,"./nodeMap":335}],331:[function(require,module,exports){"use strict";const{isKeyword:isKeyword}=require("./context");const graphTypes=require("./graphTypes");const types=require("./types");const util=require("./util");const url=require("./url");const JsonLdError=require("./JsonLdError");const{createNodeMap:_createNodeMap,mergeNodeMapGraphs:_mergeNodeMapGraphs}=require("./nodeMap");const api={};module.exports=api;api.frameMergedOrDefault=(input,frame,options)=>{const state={options:options,embedded:false,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}};const issuer=new util.IdentifierIssuer("_:b");_createNodeMap(input,state.graphMap,"@default",issuer);if(options.merged){state.graphMap["@merged"]=_mergeNodeMapGraphs(state.graphMap);state.graph="@merged"}state.subjects=state.graphMap[state.graph];const framed=[];api.frame(state,Object.keys(state.subjects).sort(),frame,framed);if(options.pruneBlankNodeIdentifiers){options.bnodesToClear=Object.keys(state.bnodeMap).filter((id=>state.bnodeMap[id].length===1))}
// remove @preserve from results
options.link={};return _cleanupPreserve(framed,options)};api.frame=(state,subjects,frame,parent,property=null)=>{_validateFrame(frame);frame=frame[0];const options=state.options;const flags={embed:_getFrameFlag(frame,options,"embed"),explicit:_getFrameFlag(frame,options,"explicit"),requireAll:_getFrameFlag(frame,options,"requireAll")};if(!state.link.hasOwnProperty(state.graph)){state.link[state.graph]={}}const link=state.link[state.graph];const matches=_filterSubjects(state,subjects,frame,flags);const ids=Object.keys(matches).sort();for(const id of ids){const subject=matches[id];if(property===null){state.uniqueEmbeds={[state.graph]:{}}}else{state.uniqueEmbeds[state.graph]=state.uniqueEmbeds[state.graph]||{}}if(flags.embed==="@link"&&id in link){_addFrameOutput(parent,property,link[id]);continue}const output={"@id":id};if(id.indexOf("_:")===0){util.addValue(state.bnodeMap,id,output,{propertyIsArray:true})}link[id]=output;if((flags.embed==="@first"||flags.embed==="@last")&&state.is11){throw new JsonLdError("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:frame})}if(!state.embedded&&state.uniqueEmbeds[state.graph].hasOwnProperty(id)){continue}if(state.embedded&&(flags.embed==="@never"||_createsCircularReference(subject,state.graph,state.subjectStack))){_addFrameOutput(parent,property,output);continue}if(state.embedded&&(flags.embed=="@first"||flags.embed=="@once")&&state.uniqueEmbeds[state.graph].hasOwnProperty(id)){_addFrameOutput(parent,property,output);continue}if(flags.embed==="@last"){if(id in state.uniqueEmbeds[state.graph]){_removeEmbed(state,id)}}state.uniqueEmbeds[state.graph][id]={parent:parent,property:property};state.subjectStack.push({subject:subject,graph:state.graph});if(id in state.graphMap){let recurse=false;let subframe=null;if(!("@graph"in frame)){recurse=state.graph!=="@merged";subframe={}}else{subframe=frame["@graph"][0];recurse=!(id==="@merged"||id==="@default");if(!types.isObject(subframe)){subframe={}}}if(recurse){api.frame({...state,graph:id,embedded:false},Object.keys(state.graphMap[id]).sort(),[subframe],output,"@graph")}}if("@included"in frame){api.frame({...state,embedded:false},subjects,frame["@included"],output,"@included")}for(const prop of Object.keys(subject).sort()){if(isKeyword(prop)){output[prop]=util.clone(subject[prop]);if(prop==="@type"){for(const type of subject["@type"]){if(type.indexOf("_:")===0){util.addValue(state.bnodeMap,type,output,{propertyIsArray:true})}}}continue}if(flags.explicit&&!(prop in frame)){continue}for(const o of subject[prop]){const subframe=prop in frame?frame[prop]:_createImplicitFrame(flags);if(graphTypes.isList(o)){const subframe=frame[prop]&&frame[prop][0]&&frame[prop][0]["@list"]?frame[prop][0]["@list"]:_createImplicitFrame(flags);const list={"@list":[]};_addFrameOutput(output,prop,list);const src=o["@list"];for(const oo of src){if(graphTypes.isSubjectReference(oo)){api.frame({...state,embedded:true},[oo["@id"]],subframe,list,"@list")}else{_addFrameOutput(list,"@list",util.clone(oo))}}}else if(graphTypes.isSubjectReference(o)){api.frame({...state,embedded:true},[o["@id"]],subframe,output,prop)}else if(_valueMatch(subframe[0],o)){_addFrameOutput(output,prop,util.clone(o))}}}for(const prop of Object.keys(frame).sort()){if(prop==="@type"){if(!types.isObject(frame[prop][0])||!("@default"in frame[prop][0])){continue}}else if(isKeyword(prop)){continue}const next=frame[prop][0]||{};const omitDefaultOn=_getFrameFlag(next,options,"omitDefault");if(!omitDefaultOn&&!(prop in output)){let preserve="@null";if("@default"in next){preserve=util.clone(next["@default"])}if(!types.isArray(preserve)){preserve=[preserve]}output[prop]=[{"@preserve":preserve}]}}for(const reverseProp of Object.keys(frame["@reverse"]||{}).sort()){const subframe=frame["@reverse"][reverseProp];for(const subject of Object.keys(state.subjects)){const nodeValues=util.getValues(state.subjects[subject],reverseProp);if(nodeValues.some((v=>v["@id"]===id))){output["@reverse"]=output["@reverse"]||{};util.addValue(output["@reverse"],reverseProp,[],{propertyIsArray:true});api.frame({...state,embedded:true},[subject],subframe,output["@reverse"][reverseProp],property)}}}_addFrameOutput(parent,property,output);state.subjectStack.pop()}};api.cleanupNull=(input,options)=>{if(types.isArray(input)){const noNulls=input.map((v=>api.cleanupNull(v,options)));return noNulls.filter((v=>v))}if(input==="@null"){return null}if(types.isObject(input)){if("@id"in input){const id=input["@id"];if(options.link.hasOwnProperty(id)){const idx=options.link[id].indexOf(input);if(idx!==-1){return options.link[id][idx]}options.link[id].push(input)}else{options.link[id]=[input]}}for(const key in input){input[key]=api.cleanupNull(input[key],options)}}return input};function _createImplicitFrame(flags){const frame={};for(const key in flags){if(flags[key]!==undefined){frame["@"+key]=[flags[key]]}}return[frame]}function _createsCircularReference(subjectToEmbed,graph,subjectStack){for(let i=subjectStack.length-1;i>=0;--i){const subject=subjectStack[i];if(subject.graph===graph&&subject.subject["@id"]===subjectToEmbed["@id"]){return true}}return false}function _getFrameFlag(frame,options,name){const flag="@"+name;let rval=flag in frame?frame[flag][0]:options[name];if(name==="embed"){if(rval===true){rval="@once"}else if(rval===false){rval="@never"}else if(rval!=="@always"&&rval!=="@never"&&rval!=="@link"&&rval!=="@first"&&rval!=="@last"&&rval!=="@once"){throw new JsonLdError("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:frame})}}return rval}function _validateFrame(frame){if(!types.isArray(frame)||frame.length!==1||!types.isObject(frame[0])){throw new JsonLdError("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:frame})}if("@id"in frame[0]){for(const id of util.asArray(frame[0]["@id"])){if(!(types.isObject(id)||url.isAbsolute(id))||types.isString(id)&&id.indexOf("_:")===0){throw new JsonLdError("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:frame})}}}if("@type"in frame[0]){for(const type of util.asArray(frame[0]["@type"])){if(!(types.isObject(type)||url.isAbsolute(type))||types.isString(type)&&type.indexOf("_:")===0){throw new JsonLdError("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:frame})}}}}function _filterSubjects(state,subjects,frame,flags){const rval={};for(const id of subjects){const subject=state.graphMap[state.graph][id];if(_filterSubject(state,subject,frame,flags)){rval[id]=subject}}return rval}function _filterSubject(state,subject,frame,flags){let wildcard=true;let matchesSome=false;for(const key in frame){let matchThis=false;const nodeValues=util.getValues(subject,key);const isEmpty=util.getValues(frame,key).length===0;if(key==="@id"){if(types.isEmptyObject(frame["@id"][0]||{})){matchThis=true}else if(frame["@id"].length>=0){matchThis=frame["@id"].includes(nodeValues[0])}if(!flags.requireAll){return matchThis}}else if(key==="@type"){wildcard=false;if(isEmpty){if(nodeValues.length>0){return false}matchThis=true}else if(frame["@type"].length===1&&types.isEmptyObject(frame["@type"][0])){matchThis=nodeValues.length>0}else{for(const type of frame["@type"]){if(types.isObject(type)&&"@default"in type){matchThis=true}else{matchThis=matchThis||nodeValues.some((tt=>tt===type))}}}if(!flags.requireAll){return matchThis}}else if(isKeyword(key)){continue}else{const thisFrame=util.getValues(frame,key)[0];let hasDefault=false;if(thisFrame){_validateFrame([thisFrame]);hasDefault="@default"in thisFrame}wildcard=false;if(nodeValues.length===0&&hasDefault){continue}if(nodeValues.length>0&&isEmpty){return false}if(thisFrame===undefined){if(nodeValues.length>0){return false}matchThis=true}else{if(graphTypes.isList(thisFrame)){const listValue=thisFrame["@list"][0];if(graphTypes.isList(nodeValues[0])){const nodeListValues=nodeValues[0]["@list"];if(graphTypes.isValue(listValue)){matchThis=nodeListValues.some((lv=>_valueMatch(listValue,lv)))}else if(graphTypes.isSubject(listValue)||graphTypes.isSubjectReference(listValue)){matchThis=nodeListValues.some((lv=>_nodeMatch(state,listValue,lv,flags)))}}}else if(graphTypes.isValue(thisFrame)){matchThis=nodeValues.some((nv=>_valueMatch(thisFrame,nv)))}else if(graphTypes.isSubjectReference(thisFrame)){matchThis=nodeValues.some((nv=>_nodeMatch(state,thisFrame,nv,flags)))}else if(types.isObject(thisFrame)){matchThis=nodeValues.length>0}else{matchThis=false}}}if(!matchThis&&flags.requireAll){return false}matchesSome=matchesSome||matchThis}return wildcard||matchesSome}function _removeEmbed(state,id){const embeds=state.uniqueEmbeds[state.graph];const embed=embeds[id];const parent=embed.parent;const property=embed.property;const subject={"@id":id};if(types.isArray(parent)){for(let i=0;i<parent.length;++i){if(util.compareValues(parent[i],subject)){parent[i]=subject;break}}}else{const useArray=types.isArray(parent[property]);util.removeValue(parent,property,subject,{propertyIsArray:useArray});util.addValue(parent,property,subject,{propertyIsArray:useArray})}const removeDependents=id=>{const ids=Object.keys(embeds);for(const next of ids){if(next in embeds&&types.isObject(embeds[next].parent)&&embeds[next].parent["@id"]===id){delete embeds[next];removeDependents(next)}}};removeDependents(id)}
/**
 * Removes the @preserve keywords from expanded result of framing.
 *
 * @param input the framed, framed output.
 * @param options the framing options used.
 *
 * @return the resulting output.
 */function _cleanupPreserve(input,options){if(types.isArray(input)){return input.map((value=>_cleanupPreserve(value,options)))}if(types.isObject(input)){
// remove @preserve
if("@preserve"in input){return input["@preserve"][0]}if(graphTypes.isValue(input)){return input}if(graphTypes.isList(input)){input["@list"]=_cleanupPreserve(input["@list"],options);return input}if("@id"in input){const id=input["@id"];if(options.link.hasOwnProperty(id)){const idx=options.link[id].indexOf(input);if(idx!==-1){return options.link[id][idx]}options.link[id].push(input)}else{options.link[id]=[input]}}for(const prop in input){if(prop==="@id"&&options.bnodesToClear.includes(input[prop])){delete input["@id"];continue}input[prop]=_cleanupPreserve(input[prop],options)}}return input}function _addFrameOutput(parent,property,output){if(types.isObject(parent)){util.addValue(parent,property,output,{propertyIsArray:true})}else{parent.push(output)}}function _nodeMatch(state,pattern,value,flags){if(!("@id"in value)){return false}const nodeObject=state.subjects[value["@id"]];return nodeObject&&_filterSubject(state,nodeObject,pattern,flags)}function _valueMatch(pattern,value){const v1=value["@value"];const t1=value["@type"];const l1=value["@language"];const v2=pattern["@value"]?types.isArray(pattern["@value"])?pattern["@value"]:[pattern["@value"]]:[];const t2=pattern["@type"]?types.isArray(pattern["@type"])?pattern["@type"]:[pattern["@type"]]:[];const l2=pattern["@language"]?types.isArray(pattern["@language"])?pattern["@language"]:[pattern["@language"]]:[];if(v2.length===0&&t2.length===0&&l2.length===0){return true}if(!(v2.includes(v1)||types.isEmptyObject(v2[0]))){return false}if(!(!t1&&t2.length===0||t2.includes(t1)||t1&&types.isEmptyObject(t2[0]))){return false}if(!(!l1&&l2.length===0||l2.includes(l1)||l1&&types.isEmptyObject(l2[0]))){return false}return true}},{"./JsonLdError":319,"./context":326,"./graphTypes":333,"./nodeMap":335,"./types":337,"./url":338,"./util":339}],332:[function(require,module,exports){"use strict";const JsonLdError=require("./JsonLdError");const graphTypes=require("./graphTypes");const types=require("./types");const util=require("./util");const{RDF_LIST:RDF_LIST,RDF_FIRST:RDF_FIRST,RDF_REST:RDF_REST,RDF_NIL:RDF_NIL,RDF_TYPE:RDF_TYPE,RDF_JSON_LITERAL:RDF_JSON_LITERAL,XSD_BOOLEAN:XSD_BOOLEAN,XSD_DOUBLE:XSD_DOUBLE,XSD_INTEGER:XSD_INTEGER,XSD_STRING:XSD_STRING}=require("./constants");const REGEX_BCP47=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;const api={};module.exports=api;api.fromRDF=async(dataset,{useRdfType:useRdfType=false,useNativeTypes:useNativeTypes=false,rdfDirection:rdfDirection=null})=>{const defaultGraph={};const graphMap={"@default":defaultGraph};const referencedOnce={};for(const quad of dataset){const name=quad.graph.termType==="DefaultGraph"?"@default":quad.graph.value;if(!(name in graphMap)){graphMap[name]={}}if(name!=="@default"&&!(name in defaultGraph)){defaultGraph[name]={"@id":name}}const nodeMap=graphMap[name];const s=quad.subject.value;const p=quad.predicate.value;const o=quad.object;if(!(s in nodeMap)){nodeMap[s]={"@id":s}}const node=nodeMap[s];const objectIsNode=o.termType.endsWith("Node");if(objectIsNode&&!(o.value in nodeMap)){nodeMap[o.value]={"@id":o.value}}if(p===RDF_TYPE&&!useRdfType&&objectIsNode){util.addValue(node,"@type",o.value,{propertyIsArray:true});continue}const value=_RDFToObject(o,useNativeTypes,rdfDirection);util.addValue(node,p,value,{propertyIsArray:true});if(objectIsNode){if(o.value===RDF_NIL){const object=nodeMap[o.value];if(!("usages"in object)){object.usages=[]}object.usages.push({node:node,property:p,value:value})}else if(o.value in referencedOnce){referencedOnce[o.value]=false}else{referencedOnce[o.value]={node:node,property:p,value:value}}}}for(const name in graphMap){const graphObject=graphMap[name];if(!(RDF_NIL in graphObject)){continue}const nil=graphObject[RDF_NIL];if(!nil.usages){continue}for(let usage of nil.usages){let node=usage.node;let property=usage.property;let head=usage.value;const list=[];const listNodes=[];let nodeKeyCount=Object.keys(node).length;while(property===RDF_REST&&types.isObject(referencedOnce[node["@id"]])&&types.isArray(node[RDF_FIRST])&&node[RDF_FIRST].length===1&&types.isArray(node[RDF_REST])&&node[RDF_REST].length===1&&(nodeKeyCount===3||nodeKeyCount===4&&types.isArray(node["@type"])&&node["@type"].length===1&&node["@type"][0]===RDF_LIST)){list.push(node[RDF_FIRST][0]);listNodes.push(node["@id"]);usage=referencedOnce[node["@id"]];node=usage.node;property=usage.property;head=usage.value;nodeKeyCount=Object.keys(node).length;if(!graphTypes.isBlankNode(node)){break}}delete head["@id"];head["@list"]=list.reverse();for(const listNode of listNodes){delete graphObject[listNode]}}delete nil.usages}const result=[];const subjects=Object.keys(defaultGraph).sort();for(const subject of subjects){const node=defaultGraph[subject];if(subject in graphMap){const graph=node["@graph"]=[];const graphObject=graphMap[subject];const graphSubjects=Object.keys(graphObject).sort();for(const graphSubject of graphSubjects){const node=graphObject[graphSubject];if(!graphTypes.isSubjectReference(node)){graph.push(node)}}}if(!graphTypes.isSubjectReference(node)){result.push(node)}}return result};function _RDFToObject(o,useNativeTypes,rdfDirection){if(o.termType.endsWith("Node")){return{"@id":o.value}}const rval={"@value":o.value};if(o.language){rval["@language"]=o.language}else{let type=o.datatype.value;if(!type){type=XSD_STRING}if(type===RDF_JSON_LITERAL){type="@json";try{rval["@value"]=JSON.parse(rval["@value"])}catch(e){throw new JsonLdError("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:rval["@value"],cause:e})}}if(useNativeTypes){if(type===XSD_BOOLEAN){if(rval["@value"]==="true"){rval["@value"]=true}else if(rval["@value"]==="false"){rval["@value"]=false}}else if(types.isNumeric(rval["@value"])){if(type===XSD_INTEGER){const i=parseInt(rval["@value"],10);if(i.toFixed(0)===rval["@value"]){rval["@value"]=i}}else if(type===XSD_DOUBLE){rval["@value"]=parseFloat(rval["@value"])}}if(![XSD_BOOLEAN,XSD_INTEGER,XSD_DOUBLE,XSD_STRING].includes(type)){rval["@type"]=type}}else if(rdfDirection==="i18n-datatype"&&type.startsWith("https://www.w3.org/ns/i18n#")){const[,language,direction]=type.split(/[#_]/);if(language.length>0){rval["@language"]=language;if(!language.match(REGEX_BCP47)){console.warn(`@language must be valid BCP47: ${language}`)}}rval["@direction"]=direction}else if(type!==XSD_STRING){rval["@type"]=type}}return rval}},{"./JsonLdError":319,"./constants":325,"./graphTypes":333,"./types":337,"./util":339}],333:[function(require,module,exports){"use strict";const types=require("./types");const api={};module.exports=api;api.isSubject=v=>{if(types.isObject(v)&&!("@value"in v||"@set"in v||"@list"in v)){const keyCount=Object.keys(v).length;return keyCount>1||!("@id"in v)}return false};api.isSubjectReference=v=>types.isObject(v)&&Object.keys(v).length===1&&"@id"in v;api.isValue=v=>types.isObject(v)&&"@value"in v;api.isList=v=>types.isObject(v)&&"@list"in v;api.isGraph=v=>types.isObject(v)&&"@graph"in v&&Object.keys(v).filter((key=>key!=="@id"&&key!=="@index")).length===1;api.isSimpleGraph=v=>api.isGraph(v)&&!("@id"in v);api.isBlankNode=v=>{if(types.isObject(v)){if("@id"in v){return v["@id"].indexOf("_:")===0}return Object.keys(v).length===0||!("@value"in v||"@set"in v||"@list"in v)}return false}},{"./types":337}],334:[function(require,module,exports){(function(process,global){(function(){
/**
 * A JavaScript implementation of the JSON-LD API.
 *
 * @author Dave Longley
 *
 * @license BSD 3-Clause License
 * Copyright (c) 2011-2019 Digital Bazaar, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 *
 * Neither the name of the Digital Bazaar, Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
 * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
const canonize=require("rdf-canonize");const util=require("./util");const ContextResolver=require("./ContextResolver");const IdentifierIssuer=util.IdentifierIssuer;const JsonLdError=require("./JsonLdError");const LRU=require("lru-cache");const NQuads=require("./NQuads");const{expand:_expand}=require("./expand");const{flatten:_flatten}=require("./flatten");const{fromRDF:_fromRDF}=require("./fromRdf");const{toRDF:_toRDF}=require("./toRdf");const{frameMergedOrDefault:_frameMergedOrDefault,cleanupNull:_cleanupNull}=require("./frame");const{isArray:_isArray,isObject:_isObject,isString:_isString}=require("./types");const{isSubjectReference:_isSubjectReference}=require("./graphTypes");const{expandIri:_expandIri,getInitialContext:_getInitialContext,process:_processContext,processingMode:_processingMode}=require("./context");const{compact:_compact,compactIri:_compactIri}=require("./compact");const{createNodeMap:_createNodeMap,createMergedNodeMap:_createMergedNodeMap,mergeNodeMaps:_mergeNodeMaps}=require("./nodeMap");const _nodejs=typeof process!=="undefined"&&process.versions&&process.versions.node;const _browser=!_nodejs&&(typeof window!=="undefined"||typeof self!=="undefined");const wrapper=function(jsonld){const _rdfParsers={};const RESOLVED_CONTEXT_CACHE_MAX_SIZE=100;const _resolvedContextCache=new LRU({max:RESOLVED_CONTEXT_CACHE_MAX_SIZE});jsonld.compact=async function(input,ctx,options){if(arguments.length<2){throw new TypeError("Could not compact, too few arguments.")}if(ctx===null){throw new JsonLdError("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"})}if(input===null){return null}options=_setDefaults(options,{base:_isString(input)?input:"",compactArrays:true,compactToRelative:true,graph:false,skipExpansion:false,link:false,issuer:new IdentifierIssuer("_:b"),contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});if(options.link){options.skipExpansion=true}if(!options.compactToRelative){delete options.base}let expanded;if(options.skipExpansion){expanded=input}else{expanded=await jsonld.expand(input,options)}const activeCtx=await jsonld.processContext(_getInitialContext(options),ctx,options);let compacted=await _compact({activeCtx:activeCtx,element:expanded,options:options,compactionMap:options.compactionMap});if(options.compactArrays&&!options.graph&&_isArray(compacted)){if(compacted.length===1){compacted=compacted[0]}else if(compacted.length===0){compacted={}}}else if(options.graph&&_isObject(compacted)){compacted=[compacted]}if(_isObject(ctx)&&"@context"in ctx){ctx=ctx["@context"]}ctx=util.clone(ctx);if(!_isArray(ctx)){ctx=[ctx]}const tmp=ctx;ctx=[];for(let i=0;i<tmp.length;++i){if(!_isObject(tmp[i])||Object.keys(tmp[i]).length>0){ctx.push(tmp[i])}}const hasContext=ctx.length>0;if(ctx.length===1){ctx=ctx[0]}if(_isArray(compacted)){const graphAlias=_compactIri({activeCtx:activeCtx,iri:"@graph",relativeTo:{vocab:true}});const graph=compacted;compacted={};if(hasContext){compacted["@context"]=ctx}compacted[graphAlias]=graph}else if(_isObject(compacted)&&hasContext){const graph=compacted;compacted={"@context":ctx};for(const key in graph){compacted[key]=graph[key]}}return compacted};jsonld.expand=async function(input,options){if(arguments.length<1){throw new TypeError("Could not expand, too few arguments.")}options=_setDefaults(options,{keepFreeFloatingNodes:false,contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});if(options.expansionMap===false){options.expansionMap=undefined}const toResolve={};const contextsToProcess=[];if("expandContext"in options){const expandContext=util.clone(options.expandContext);if(_isObject(expandContext)&&"@context"in expandContext){toResolve.expandContext=expandContext}else{toResolve.expandContext={"@context":expandContext}}contextsToProcess.push(toResolve.expandContext)}let defaultBase;if(!_isString(input)){toResolve.input=util.clone(input)}else{const remoteDoc=await jsonld.get(input,options);defaultBase=remoteDoc.documentUrl;toResolve.input=remoteDoc.document;if(remoteDoc.contextUrl){toResolve.remoteContext={"@context":remoteDoc.contextUrl};contextsToProcess.push(toResolve.remoteContext)}}if(!("base"in options)){options.base=defaultBase||""}let activeCtx=_getInitialContext(options);for(const localCtx of contextsToProcess){activeCtx=await _processContext({activeCtx:activeCtx,localCtx:localCtx,options:options})}let expanded=await _expand({activeCtx:activeCtx,element:toResolve.input,options:options,expansionMap:options.expansionMap});if(_isObject(expanded)&&"@graph"in expanded&&Object.keys(expanded).length===1){expanded=expanded["@graph"]}else if(expanded===null){expanded=[]}if(!_isArray(expanded)){expanded=[expanded]}return expanded};jsonld.flatten=async function(input,ctx,options){if(arguments.length<1){return new TypeError("Could not flatten, too few arguments.")}if(typeof ctx==="function"){ctx=null}else{ctx=ctx||null}options=_setDefaults(options,{base:_isString(input)?input:"",contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});const expanded=await jsonld.expand(input,options);const flattened=_flatten(expanded);if(ctx===null){return flattened}options.graph=true;options.skipExpansion=true;const compacted=await jsonld.compact(flattened,ctx,options);return compacted};jsonld.frame=async function(input,frame,options){if(arguments.length<2){throw new TypeError("Could not frame, too few arguments.")}options=_setDefaults(options,{base:_isString(input)?input:"",embed:"@once",explicit:false,requireAll:false,omitDefault:false,bnodesToClear:[],contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});if(_isString(frame)){const remoteDoc=await jsonld.get(frame,options);frame=remoteDoc.document;if(remoteDoc.contextUrl){let ctx=frame["@context"];if(!ctx){ctx=remoteDoc.contextUrl}else if(_isArray(ctx)){ctx.push(remoteDoc.contextUrl)}else{ctx=[ctx,remoteDoc.contextUrl]}frame["@context"]=ctx}}const frameContext=frame?frame["@context"]||{}:{};const activeCtx=await jsonld.processContext(_getInitialContext(options),frameContext,options);if(!options.hasOwnProperty("omitGraph")){options.omitGraph=_processingMode(activeCtx,1.1)}if(!options.hasOwnProperty("pruneBlankNodeIdentifiers")){options.pruneBlankNodeIdentifiers=_processingMode(activeCtx,1.1)}const expanded=await jsonld.expand(input,options);const opts={...options};opts.isFrame=true;opts.keepFreeFloatingNodes=true;const expandedFrame=await jsonld.expand(frame,opts);const frameKeys=Object.keys(frame).map((key=>_expandIri(activeCtx,key,{vocab:true})));opts.merged=!frameKeys.includes("@graph");opts.is11=_processingMode(activeCtx,1.1);const framed=_frameMergedOrDefault(expanded,expandedFrame,opts);opts.graph=!options.omitGraph;opts.skipExpansion=true;opts.link={};opts.framing=true;let compacted=await jsonld.compact(framed,frameContext,opts);opts.link={};compacted=_cleanupNull(compacted,opts);return compacted};jsonld.link=async function(input,ctx,options){const frame={};if(ctx){frame["@context"]=ctx}frame["@embed"]="@link";return jsonld.frame(input,frame,options)};jsonld.normalize=jsonld.canonize=async function(input,options){if(arguments.length<1){throw new TypeError("Could not canonize, too few arguments.")}options=_setDefaults(options,{base:_isString(input)?input:"",algorithm:"URDNA2015",skipExpansion:false,contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});if("inputFormat"in options){if(options.inputFormat!=="application/n-quads"&&options.inputFormat!=="application/nquads"){throw new JsonLdError("Unknown canonicalization input format.","jsonld.CanonizeError")}const parsedInput=NQuads.parse(input);return canonize.canonize(parsedInput,options)}const opts={...options};delete opts.format;opts.produceGeneralizedRdf=false;const dataset=await jsonld.toRDF(input,opts);return canonize.canonize(dataset,options)};jsonld.fromRDF=async function(dataset,options){if(arguments.length<1){throw new TypeError("Could not convert from RDF, too few arguments.")}options=_setDefaults(options,{format:_isString(dataset)?"application/n-quads":undefined});const{format:format}=options;let{rdfParser:rdfParser}=options;if(format){rdfParser=rdfParser||_rdfParsers[format];if(!rdfParser){throw new JsonLdError("Unknown input format.","jsonld.UnknownFormat",{format:format})}}else{rdfParser=()=>dataset}const parsedDataset=await rdfParser(dataset);return _fromRDF(parsedDataset,options)};jsonld.toRDF=async function(input,options){if(arguments.length<1){throw new TypeError("Could not convert to RDF, too few arguments.")}options=_setDefaults(options,{base:_isString(input)?input:"",skipExpansion:false,contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});let expanded;if(options.skipExpansion){expanded=input}else{expanded=await jsonld.expand(input,options)}const dataset=_toRDF(expanded,options);if(options.format){if(options.format==="application/n-quads"||options.format==="application/nquads"){return await NQuads.serialize(dataset)}throw new JsonLdError("Unknown output format.","jsonld.UnknownFormat",{format:options.format})}return dataset};jsonld.createNodeMap=async function(input,options){if(arguments.length<1){throw new TypeError("Could not create node map, too few arguments.")}options=_setDefaults(options,{base:_isString(input)?input:"",contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});const expanded=await jsonld.expand(input,options);return _createMergedNodeMap(expanded,options)};jsonld.merge=async function(docs,ctx,options){if(arguments.length<1){throw new TypeError("Could not merge, too few arguments.")}if(!_isArray(docs)){throw new TypeError('Could not merge, "docs" must be an array.')}if(typeof ctx==="function"){ctx=null}else{ctx=ctx||null}options=_setDefaults(options,{contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});const expanded=await Promise.all(docs.map((doc=>{const opts={...options};return jsonld.expand(doc,opts)})));let mergeNodes=true;if("mergeNodes"in options){mergeNodes=options.mergeNodes}const issuer=options.issuer||new IdentifierIssuer("_:b");const graphs={"@default":{}};for(let i=0;i<expanded.length;++i){const doc=util.relabelBlankNodes(expanded[i],{issuer:new IdentifierIssuer("_:b"+i+"-")});const _graphs=mergeNodes||i===0?graphs:{"@default":{}};_createNodeMap(doc,_graphs,"@default",issuer);if(_graphs!==graphs){for(const graphName in _graphs){const _nodeMap=_graphs[graphName];if(!(graphName in graphs)){graphs[graphName]=_nodeMap;continue}const nodeMap=graphs[graphName];for(const key in _nodeMap){if(!(key in nodeMap)){nodeMap[key]=_nodeMap[key]}}}}}const defaultGraph=_mergeNodeMaps(graphs);const flattened=[];const keys=Object.keys(defaultGraph).sort();for(let ki=0;ki<keys.length;++ki){const node=defaultGraph[keys[ki]];if(!_isSubjectReference(node)){flattened.push(node)}}if(ctx===null){return flattened}options.graph=true;options.skipExpansion=true;const compacted=await jsonld.compact(flattened,ctx,options);return compacted};Object.defineProperty(jsonld,"documentLoader",{get:()=>jsonld._documentLoader,set:v=>jsonld._documentLoader=v});jsonld.documentLoader=async url=>{throw new JsonLdError("Could not retrieve a JSON-LD document from the URL. URL "+"dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:url})};jsonld.get=async function(url,options){let load;if(typeof options.documentLoader==="function"){load=options.documentLoader}else{load=jsonld.documentLoader}const remoteDoc=await load(url);try{if(!remoteDoc.document){throw new JsonLdError("No remote document found at the given URL.","jsonld.NullRemoteDocument")}if(_isString(remoteDoc.document)){remoteDoc.document=JSON.parse(remoteDoc.document)}}catch(e){throw new JsonLdError("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:remoteDoc})}return remoteDoc};jsonld.processContext=async function(activeCtx,localCtx,options){options=_setDefaults(options,{base:"",contextResolver:new ContextResolver({sharedCache:_resolvedContextCache})});if(localCtx===null){return _getInitialContext(options)}localCtx=util.clone(localCtx);if(!(_isObject(localCtx)&&"@context"in localCtx)){localCtx={"@context":localCtx}}return _processContext({activeCtx:activeCtx,localCtx:localCtx,options:options})};jsonld.getContextValue=require("./context").getContextValue;jsonld.documentLoaders={};jsonld.documentLoaders.node=require("./documentLoaders/node");jsonld.documentLoaders.xhr=require("./documentLoaders/xhr");jsonld.useDocumentLoader=function(type){if(!(type in jsonld.documentLoaders)){throw new JsonLdError('Unknown document loader type: "'+type+'"',"jsonld.UnknownDocumentLoader",{type:type})}jsonld.documentLoader=jsonld.documentLoaders[type].apply(jsonld,Array.prototype.slice.call(arguments,1))};jsonld.registerRDFParser=function(contentType,parser){_rdfParsers[contentType]=parser};jsonld.unregisterRDFParser=function(contentType){delete _rdfParsers[contentType]};jsonld.registerRDFParser("application/n-quads",NQuads.parse);jsonld.registerRDFParser("application/nquads",NQuads.parse);jsonld.url=require("./url");jsonld.util=util;Object.assign(jsonld,util);jsonld.promises=jsonld;jsonld.RequestQueue=require("./RequestQueue");jsonld.JsonLdProcessor=require("./JsonLdProcessor")(jsonld);if(_browser&&typeof global.JsonLdProcessor==="undefined"){Object.defineProperty(global,"JsonLdProcessor",{writable:true,enumerable:false,configurable:true,value:jsonld.JsonLdProcessor})}if(_nodejs){jsonld.useDocumentLoader("node")}else if(typeof XMLHttpRequest!=="undefined"){jsonld.useDocumentLoader("xhr")}function _setDefaults(options,{documentLoader:documentLoader=jsonld.documentLoader,...defaults}){return Object.assign({},{documentLoader:documentLoader},defaults,options)}return jsonld};const factory=function(){return wrapper((function(){return factory()}))};wrapper(factory);module.exports=factory}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./ContextResolver":318,"./JsonLdError":319,"./JsonLdProcessor":320,"./NQuads":321,"./RequestQueue":322,"./compact":324,"./context":326,"./documentLoaders/node":327,"./documentLoaders/xhr":328,"./expand":329,"./flatten":330,"./frame":331,"./fromRdf":332,"./graphTypes":333,"./nodeMap":335,"./toRdf":336,"./types":337,"./url":338,"./util":339,_process:378,"lru-cache":340,"rdf-canonize":390}],335:[function(require,module,exports){"use strict";const{isKeyword:isKeyword}=require("./context");const graphTypes=require("./graphTypes");const types=require("./types");const util=require("./util");const JsonLdError=require("./JsonLdError");const api={};module.exports=api;api.createMergedNodeMap=(input,options)=>{options=options||{};const issuer=options.issuer||new util.IdentifierIssuer("_:b");const graphs={"@default":{}};api.createNodeMap(input,graphs,"@default",issuer);return api.mergeNodeMaps(graphs)};api.createNodeMap=(input,graphs,graph,issuer,name,list)=>{if(types.isArray(input)){for(const node of input){api.createNodeMap(node,graphs,graph,issuer,undefined,list)}return}if(!types.isObject(input)){if(list){list.push(input)}return}if(graphTypes.isValue(input)){if("@type"in input){let type=input["@type"];if(type.indexOf("_:")===0){input["@type"]=type=issuer.getId(type)}}if(list){list.push(input)}return}else if(list&&graphTypes.isList(input)){const _list=[];api.createNodeMap(input["@list"],graphs,graph,issuer,name,_list);list.push({"@list":_list});return}if("@type"in input){const types=input["@type"];for(const type of types){if(type.indexOf("_:")===0){issuer.getId(type)}}}if(types.isUndefined(name)){name=graphTypes.isBlankNode(input)?issuer.getId(input["@id"]):input["@id"]}if(list){list.push({"@id":name})}const subjects=graphs[graph];const subject=subjects[name]=subjects[name]||{};subject["@id"]=name;const properties=Object.keys(input).sort();for(let property of properties){if(property==="@id"){continue}if(property==="@reverse"){const referencedNode={"@id":name};const reverseMap=input["@reverse"];for(const reverseProperty in reverseMap){const items=reverseMap[reverseProperty];for(const item of items){let itemName=item["@id"];if(graphTypes.isBlankNode(item)){itemName=issuer.getId(itemName)}api.createNodeMap(item,graphs,graph,issuer,itemName);util.addValue(subjects[itemName],reverseProperty,referencedNode,{propertyIsArray:true,allowDuplicate:false})}}continue}if(property==="@graph"){if(!(name in graphs)){graphs[name]={}}api.createNodeMap(input[property],graphs,name,issuer);continue}if(property==="@included"){api.createNodeMap(input[property],graphs,graph,issuer);continue}if(property!=="@type"&&isKeyword(property)){if(property==="@index"&&property in subject&&(input[property]!==subject[property]||input[property]["@id"]!==subject[property]["@id"])){throw new JsonLdError("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:subject})}subject[property]=input[property];continue}const objects=input[property];if(property.indexOf("_:")===0){property=issuer.getId(property)}if(objects.length===0){util.addValue(subject,property,[],{propertyIsArray:true});continue}for(let o of objects){if(property==="@type"){o=o.indexOf("_:")===0?issuer.getId(o):o}if(graphTypes.isSubject(o)||graphTypes.isSubjectReference(o)){if("@id"in o&&!o["@id"]){continue}const id=graphTypes.isBlankNode(o)?issuer.getId(o["@id"]):o["@id"];util.addValue(subject,property,{"@id":id},{propertyIsArray:true,allowDuplicate:false});api.createNodeMap(o,graphs,graph,issuer,id)}else if(graphTypes.isValue(o)){util.addValue(subject,property,o,{propertyIsArray:true,allowDuplicate:false})}else if(graphTypes.isList(o)){const _list=[];api.createNodeMap(o["@list"],graphs,graph,issuer,name,_list);o={"@list":_list};util.addValue(subject,property,o,{propertyIsArray:true,allowDuplicate:false})}else{api.createNodeMap(o,graphs,graph,issuer,name);util.addValue(subject,property,o,{propertyIsArray:true,allowDuplicate:false})}}}};api.mergeNodeMapGraphs=graphs=>{const merged={};for(const name of Object.keys(graphs).sort()){for(const id of Object.keys(graphs[name]).sort()){const node=graphs[name][id];if(!(id in merged)){merged[id]={"@id":id}}const mergedNode=merged[id];for(const property of Object.keys(node).sort()){if(isKeyword(property)&&property!=="@type"){mergedNode[property]=util.clone(node[property])}else{for(const value of node[property]){util.addValue(mergedNode,property,util.clone(value),{propertyIsArray:true,allowDuplicate:false})}}}}}return merged};api.mergeNodeMaps=graphs=>{const defaultGraph=graphs["@default"];const graphNames=Object.keys(graphs).sort();for(const graphName of graphNames){if(graphName==="@default"){continue}const nodeMap=graphs[graphName];let subject=defaultGraph[graphName];if(!subject){defaultGraph[graphName]=subject={"@id":graphName,"@graph":[]}}else if(!("@graph"in subject)){subject["@graph"]=[]}const graph=subject["@graph"];for(const id of Object.keys(nodeMap).sort()){const node=nodeMap[id];if(!graphTypes.isSubjectReference(node)){graph.push(node)}}}return defaultGraph}},{"./JsonLdError":319,"./context":326,"./graphTypes":333,"./types":337,"./util":339}],336:[function(require,module,exports){"use strict";const{createNodeMap:createNodeMap}=require("./nodeMap");const{isKeyword:isKeyword}=require("./context");const graphTypes=require("./graphTypes");const jsonCanonicalize=require("canonicalize");const types=require("./types");const util=require("./util");const{RDF_FIRST:RDF_FIRST,RDF_REST:RDF_REST,RDF_NIL:RDF_NIL,RDF_TYPE:RDF_TYPE,RDF_JSON_LITERAL:RDF_JSON_LITERAL,RDF_LANGSTRING:RDF_LANGSTRING,XSD_BOOLEAN:XSD_BOOLEAN,XSD_DOUBLE:XSD_DOUBLE,XSD_INTEGER:XSD_INTEGER,XSD_STRING:XSD_STRING}=require("./constants");const{isAbsolute:_isAbsoluteIri}=require("./url");const api={};module.exports=api;api.toRDF=(input,options)=>{const issuer=new util.IdentifierIssuer("_:b");const nodeMap={"@default":{}};createNodeMap(input,nodeMap,"@default",issuer);const dataset=[];const graphNames=Object.keys(nodeMap).sort();for(const graphName of graphNames){let graphTerm;if(graphName==="@default"){graphTerm={termType:"DefaultGraph",value:""}}else if(_isAbsoluteIri(graphName)){if(graphName.startsWith("_:")){graphTerm={termType:"BlankNode"}}else{graphTerm={termType:"NamedNode"}}graphTerm.value=graphName}else{continue}_graphToRDF(dataset,nodeMap[graphName],graphTerm,issuer,options)}return dataset};function _graphToRDF(dataset,graph,graphTerm,issuer,options){const ids=Object.keys(graph).sort();for(const id of ids){const node=graph[id];const properties=Object.keys(node).sort();for(let property of properties){const items=node[property];if(property==="@type"){property=RDF_TYPE}else if(isKeyword(property)){continue}for(const item of items){const subject={termType:id.startsWith("_:")?"BlankNode":"NamedNode",value:id};if(!_isAbsoluteIri(id)){continue}const predicate={termType:property.startsWith("_:")?"BlankNode":"NamedNode",value:property};if(!_isAbsoluteIri(property)){continue}if(predicate.termType==="BlankNode"&&!options.produceGeneralizedRdf){continue}const object=_objectToRDF(item,issuer,dataset,graphTerm,options.rdfDirection);if(object){dataset.push({subject:subject,predicate:predicate,object:object,graph:graphTerm})}}}}}function _listToRDF(list,issuer,dataset,graphTerm,rdfDirection){const first={termType:"NamedNode",value:RDF_FIRST};const rest={termType:"NamedNode",value:RDF_REST};const nil={termType:"NamedNode",value:RDF_NIL};const last=list.pop();const result=last?{termType:"BlankNode",value:issuer.getId()}:nil;let subject=result;for(const item of list){const object=_objectToRDF(item,issuer,dataset,graphTerm,rdfDirection);const next={termType:"BlankNode",value:issuer.getId()};dataset.push({subject:subject,predicate:first,object:object,graph:graphTerm});dataset.push({subject:subject,predicate:rest,object:next,graph:graphTerm});subject=next}if(last){const object=_objectToRDF(last,issuer,dataset,graphTerm,rdfDirection);dataset.push({subject:subject,predicate:first,object:object,graph:graphTerm});dataset.push({subject:subject,predicate:rest,object:nil,graph:graphTerm})}return result}function _objectToRDF(item,issuer,dataset,graphTerm,rdfDirection){const object={};if(graphTypes.isValue(item)){object.termType="Literal";object.value=undefined;object.datatype={termType:"NamedNode"};let value=item["@value"];const datatype=item["@type"]||null;if(datatype==="@json"){object.value=jsonCanonicalize(value);object.datatype.value=RDF_JSON_LITERAL}else if(types.isBoolean(value)){object.value=value.toString();object.datatype.value=datatype||XSD_BOOLEAN}else if(types.isDouble(value)||datatype===XSD_DOUBLE){if(!types.isDouble(value)){value=parseFloat(value)}object.value=value.toExponential(15).replace(/(\d)0*e\+?/,"$1E");object.datatype.value=datatype||XSD_DOUBLE}else if(types.isNumber(value)){object.value=value.toFixed(0);object.datatype.value=datatype||XSD_INTEGER}else if(rdfDirection==="i18n-datatype"&&"@direction"in item){const datatype="https://www.w3.org/ns/i18n#"+(item["@language"]||"")+`_${item["@direction"]}`;object.datatype.value=datatype;object.value=value}else if("@language"in item){object.value=value;object.datatype.value=datatype||RDF_LANGSTRING;object.language=item["@language"]}else{object.value=value;object.datatype.value=datatype||XSD_STRING}}else if(graphTypes.isList(item)){const _list=_listToRDF(item["@list"],issuer,dataset,graphTerm,rdfDirection);object.termType=_list.termType;object.value=_list.value}else{const id=types.isObject(item)?item["@id"]:item;object.termType=id.startsWith("_:")?"BlankNode":"NamedNode";object.value=id}if(object.termType==="NamedNode"&&!_isAbsoluteIri(object.value)){return null}return object}},{"./constants":325,"./context":326,"./graphTypes":333,"./nodeMap":335,"./types":337,"./url":338,"./util":339,canonicalize:155}],337:[function(require,module,exports){"use strict";const api={};module.exports=api;api.isArray=Array.isArray;api.isBoolean=v=>typeof v==="boolean"||Object.prototype.toString.call(v)==="[object Boolean]";api.isDouble=v=>api.isNumber(v)&&(String(v).indexOf(".")!==-1||Math.abs(v)>=1e21);api.isEmptyObject=v=>api.isObject(v)&&Object.keys(v).length===0;api.isNumber=v=>typeof v==="number"||Object.prototype.toString.call(v)==="[object Number]";api.isNumeric=v=>!isNaN(parseFloat(v))&&isFinite(v);api.isObject=v=>Object.prototype.toString.call(v)==="[object Object]";api.isString=v=>typeof v==="string"||Object.prototype.toString.call(v)==="[object String]";api.isUndefined=v=>typeof v==="undefined"},{}],338:[function(require,module,exports){"use strict";const types=require("./types");const api={};module.exports=api;api.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}};api.parse=(str,parser)=>{const parsed={};const o=api.parsers[parser||"full"];const m=o.regex.exec(str);let i=o.keys.length;while(i--){parsed[o.keys[i]]=m[i]===undefined?null:m[i]}if(parsed.scheme==="https"&&parsed.port==="443"||parsed.scheme==="http"&&parsed.port==="80"){parsed.href=parsed.href.replace(":"+parsed.port,"");parsed.authority=parsed.authority.replace(":"+parsed.port,"");parsed.port=null}parsed.normalizedPath=api.removeDotSegments(parsed.path);return parsed};api.prependBase=(base,iri)=>{if(base===null){return iri}if(api.isAbsolute(iri)){return iri}if(!base||types.isString(base)){base=api.parse(base||"")}const rel=api.parse(iri);const transform={protocol:base.protocol||""};if(rel.authority!==null){transform.authority=rel.authority;transform.path=rel.path;transform.query=rel.query}else{transform.authority=base.authority;if(rel.path===""){transform.path=base.path;if(rel.query!==null){transform.query=rel.query}else{transform.query=base.query}}else{if(rel.path.indexOf("/")===0){transform.path=rel.path}else{let path=base.path;path=path.substr(0,path.lastIndexOf("/")+1);if((path.length>0||base.authority)&&path.substr(-1)!=="/"){path+="/"}path+=rel.path;transform.path=path}transform.query=rel.query}}if(rel.path!==""){transform.path=api.removeDotSegments(transform.path)}let rval=transform.protocol;if(transform.authority!==null){rval+="//"+transform.authority}rval+=transform.path;if(transform.query!==null){rval+="?"+transform.query}if(rel.fragment!==null){rval+="#"+rel.fragment}if(rval===""){rval="./"}return rval};api.removeBase=(base,iri)=>{if(base===null){return iri}if(!base||types.isString(base)){base=api.parse(base||"")}let root="";if(base.href!==""){root+=(base.protocol||"")+"//"+(base.authority||"")}else if(iri.indexOf("//")){root+="//"}if(iri.indexOf(root)!==0){return iri}const rel=api.parse(iri.substr(root.length));const baseSegments=base.normalizedPath.split("/");const iriSegments=rel.normalizedPath.split("/");const last=rel.fragment||rel.query?0:1;while(baseSegments.length>0&&iriSegments.length>last){if(baseSegments[0]!==iriSegments[0]){break}baseSegments.shift();iriSegments.shift()}let rval="";if(baseSegments.length>0){baseSegments.pop();for(let i=0;i<baseSegments.length;++i){rval+="../"}}rval+=iriSegments.join("/");if(rel.query!==null){rval+="?"+rel.query}if(rel.fragment!==null){rval+="#"+rel.fragment}if(rval===""){rval="./"}return rval};api.removeDotSegments=path=>{if(path.length===0){return""}const input=path.split("/");const output=[];while(input.length>0){const next=input.shift();const done=input.length===0;if(next==="."){if(done){output.push("")}continue}if(next===".."){output.pop();if(done){output.push("")}continue}output.push(next)}if(path[0]==="/"&&output.length>0&&output[0]!==""){output.unshift("")}if(output.length===1&&output[0]===""){return"/"}return output.join("/")};const isAbsoluteRegex=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;api.isAbsolute=v=>types.isString(v)&&isAbsoluteRegex.test(v);api.isRelative=v=>types.isString(v)},{"./types":337}],339:[function(require,module,exports){"use strict";const graphTypes=require("./graphTypes");const types=require("./types");const IdentifierIssuer=require("rdf-canonize").IdentifierIssuer;const JsonLdError=require("./JsonLdError");const REGEX_LINK_HEADERS=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g;const REGEX_LINK_HEADER=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/;const REGEX_LINK_HEADER_PARAMS=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;const DEFAULTS={headers:{accept:"application/ld+json, application/json"}};const api={};module.exports=api;api.IdentifierIssuer=IdentifierIssuer;api.clone=function(value){if(value&&typeof value==="object"){let rval;if(types.isArray(value)){rval=[];for(let i=0;i<value.length;++i){rval[i]=api.clone(value[i])}}else if(value instanceof Map){rval=new Map;for(const[k,v]of value){rval.set(k,api.clone(v))}}else if(value instanceof Set){rval=new Set;for(const v of value){rval.add(api.clone(v))}}else if(types.isObject(value)){rval={};for(const key in value){rval[key]=api.clone(value[key])}}else{rval=value.toString()}return rval}return value};api.asArray=function(value){return Array.isArray(value)?value:[value]};api.buildHeaders=(headers={})=>{const hasAccept=Object.keys(headers).some((h=>h.toLowerCase()==="accept"));if(hasAccept){throw new RangeError('Accept header may not be specified; only "'+DEFAULTS.headers.accept+'" is supported.')}return Object.assign({Accept:DEFAULTS.headers.accept},headers)};api.parseLinkHeader=header=>{const rval={};const entries=header.match(REGEX_LINK_HEADERS);for(let i=0;i<entries.length;++i){let match=entries[i].match(REGEX_LINK_HEADER);if(!match){continue}const result={target:match[1]};const params=match[2];while(match=REGEX_LINK_HEADER_PARAMS.exec(params)){result[match[1]]=match[2]===undefined?match[3]:match[2]}const rel=result["rel"]||"";if(Array.isArray(rval[rel])){rval[rel].push(result)}else if(rval.hasOwnProperty(rel)){rval[rel]=[rval[rel],result]}else{rval[rel]=result}}return rval};api.validateTypeValue=(v,isFrame)=>{if(types.isString(v)){return}if(types.isArray(v)&&v.every((vv=>types.isString(vv)))){return}if(isFrame&&types.isObject(v)){switch(Object.keys(v).length){case 0:return;case 1:if("@default"in v&&api.asArray(v["@default"]).every((vv=>types.isString(vv)))){return}}}throw new JsonLdError('Invalid JSON-LD syntax; "@type" value must a string, an array of '+"strings, an empty object, "+"or a default object.","jsonld.SyntaxError",{code:"invalid type value",value:v})};api.hasProperty=(subject,property)=>{if(subject.hasOwnProperty(property)){const value=subject[property];return!types.isArray(value)||value.length>0}return false};api.hasValue=(subject,property,value)=>{if(api.hasProperty(subject,property)){let val=subject[property];const isList=graphTypes.isList(val);if(types.isArray(val)||isList){if(isList){val=val["@list"]}for(let i=0;i<val.length;++i){if(api.compareValues(value,val[i])){return true}}}else if(!types.isArray(value)){return api.compareValues(value,val)}}return false};api.addValue=(subject,property,value,options)=>{options=options||{};if(!("propertyIsArray"in options)){options.propertyIsArray=false}if(!("valueIsArray"in options)){options.valueIsArray=false}if(!("allowDuplicate"in options)){options.allowDuplicate=true}if(!("prependValue"in options)){options.prependValue=false}if(options.valueIsArray){subject[property]=value}else if(types.isArray(value)){if(value.length===0&&options.propertyIsArray&&!subject.hasOwnProperty(property)){subject[property]=[]}if(options.prependValue){value=value.concat(subject[property]);subject[property]=[]}for(let i=0;i<value.length;++i){api.addValue(subject,property,value[i],options)}}else if(subject.hasOwnProperty(property)){const hasValue=!options.allowDuplicate&&api.hasValue(subject,property,value);if(!types.isArray(subject[property])&&(!hasValue||options.propertyIsArray)){subject[property]=[subject[property]]}if(!hasValue){if(options.prependValue){subject[property].unshift(value)}else{subject[property].push(value)}}}else{subject[property]=options.propertyIsArray?[value]:value}};api.getValues=(subject,property)=>[].concat(subject[property]||[]);api.removeProperty=(subject,property)=>{delete subject[property]};api.removeValue=(subject,property,value,options)=>{options=options||{};if(!("propertyIsArray"in options)){options.propertyIsArray=false}const values=api.getValues(subject,property).filter((e=>!api.compareValues(e,value)));if(values.length===0){api.removeProperty(subject,property)}else if(values.length===1&&!options.propertyIsArray){subject[property]=values[0]}else{subject[property]=values}};api.relabelBlankNodes=(input,options)=>{options=options||{};const issuer=options.issuer||new IdentifierIssuer("_:b");return _labelBlankNodes(issuer,input)};api.compareValues=(v1,v2)=>{if(v1===v2){return true}if(graphTypes.isValue(v1)&&graphTypes.isValue(v2)&&v1["@value"]===v2["@value"]&&v1["@type"]===v2["@type"]&&v1["@language"]===v2["@language"]&&v1["@index"]===v2["@index"]){return true}if(types.isObject(v1)&&"@id"in v1&&types.isObject(v2)&&"@id"in v2){return v1["@id"]===v2["@id"]}return false};api.compareShortestLeast=(a,b)=>{if(a.length<b.length){return-1}if(b.length<a.length){return 1}if(a===b){return 0}return a<b?-1:1};function _labelBlankNodes(issuer,element){if(types.isArray(element)){for(let i=0;i<element.length;++i){element[i]=_labelBlankNodes(issuer,element[i])}}else if(graphTypes.isList(element)){element["@list"]=_labelBlankNodes(issuer,element["@list"])}else if(types.isObject(element)){if(graphTypes.isBlankNode(element)){element["@id"]=issuer.getId(element["@id"])}const keys=Object.keys(element).sort();for(let ki=0;ki<keys.length;++ki){const key=keys[ki];if(key!=="@id"){element[key]=_labelBlankNodes(issuer,element[key])}}}return element}},{"./JsonLdError":319,"./graphTypes":333,"./types":337,"rdf-canonize":390}],340:[function(require,module,exports){"use strict";const Yallist=require("yallist");const MAX=Symbol("max");const LENGTH=Symbol("length");const LENGTH_CALCULATOR=Symbol("lengthCalculator");const ALLOW_STALE=Symbol("allowStale");const MAX_AGE=Symbol("maxAge");const DISPOSE=Symbol("dispose");const NO_DISPOSE_ON_SET=Symbol("noDisposeOnSet");const LRU_LIST=Symbol("lruList");const CACHE=Symbol("cache");const UPDATE_AGE_ON_GET=Symbol("updateAgeOnGet");const naiveLength=()=>1;class LRUCache{constructor(options){if(typeof options==="number")options={max:options};if(!options)options={};if(options.max&&(typeof options.max!=="number"||options.max<0))throw new TypeError("max must be a non-negative number");const max=this[MAX]=options.max||Infinity;const lc=options.length||naiveLength;this[LENGTH_CALCULATOR]=typeof lc!=="function"?naiveLength:lc;this[ALLOW_STALE]=options.stale||false;if(options.maxAge&&typeof options.maxAge!=="number")throw new TypeError("maxAge must be a number");this[MAX_AGE]=options.maxAge||0;this[DISPOSE]=options.dispose;this[NO_DISPOSE_ON_SET]=options.noDisposeOnSet||false;this[UPDATE_AGE_ON_GET]=options.updateAgeOnGet||false;this.reset()}set max(mL){if(typeof mL!=="number"||mL<0)throw new TypeError("max must be a non-negative number");this[MAX]=mL||Infinity;trim(this)}get max(){return this[MAX]}set allowStale(allowStale){this[ALLOW_STALE]=!!allowStale}get allowStale(){return this[ALLOW_STALE]}set maxAge(mA){if(typeof mA!=="number")throw new TypeError("maxAge must be a non-negative number");this[MAX_AGE]=mA;trim(this)}get maxAge(){return this[MAX_AGE]}set lengthCalculator(lC){if(typeof lC!=="function")lC=naiveLength;if(lC!==this[LENGTH_CALCULATOR]){this[LENGTH_CALCULATOR]=lC;this[LENGTH]=0;this[LRU_LIST].forEach((hit=>{hit.length=this[LENGTH_CALCULATOR](hit.value,hit.key);this[LENGTH]+=hit.length}))}trim(this)}get lengthCalculator(){return this[LENGTH_CALCULATOR]}get length(){return this[LENGTH]}get itemCount(){return this[LRU_LIST].length}rforEach(fn,thisp){thisp=thisp||this;for(let walker=this[LRU_LIST].tail;walker!==null;){const prev=walker.prev;forEachStep(this,fn,walker,thisp);walker=prev}}forEach(fn,thisp){thisp=thisp||this;for(let walker=this[LRU_LIST].head;walker!==null;){const next=walker.next;forEachStep(this,fn,walker,thisp);walker=next}}keys(){return this[LRU_LIST].toArray().map((k=>k.key))}values(){return this[LRU_LIST].toArray().map((k=>k.value))}reset(){if(this[DISPOSE]&&this[LRU_LIST]&&this[LRU_LIST].length){this[LRU_LIST].forEach((hit=>this[DISPOSE](hit.key,hit.value)))}this[CACHE]=new Map;this[LRU_LIST]=new Yallist;this[LENGTH]=0}dump(){return this[LRU_LIST].map((hit=>isStale(this,hit)?false:{k:hit.key,v:hit.value,e:hit.now+(hit.maxAge||0)})).toArray().filter((h=>h))}dumpLru(){return this[LRU_LIST]}set(key,value,maxAge){maxAge=maxAge||this[MAX_AGE];if(maxAge&&typeof maxAge!=="number")throw new TypeError("maxAge must be a number");const now=maxAge?Date.now():0;const len=this[LENGTH_CALCULATOR](value,key);if(this[CACHE].has(key)){if(len>this[MAX]){del(this,this[CACHE].get(key));return false}const node=this[CACHE].get(key);const item=node.value;if(this[DISPOSE]){if(!this[NO_DISPOSE_ON_SET])this[DISPOSE](key,item.value)}item.now=now;item.maxAge=maxAge;item.value=value;this[LENGTH]+=len-item.length;item.length=len;this.get(key);trim(this);return true}const hit=new Entry(key,value,len,now,maxAge);if(hit.length>this[MAX]){if(this[DISPOSE])this[DISPOSE](key,value);return false}this[LENGTH]+=hit.length;this[LRU_LIST].unshift(hit);this[CACHE].set(key,this[LRU_LIST].head);trim(this);return true}has(key){if(!this[CACHE].has(key))return false;const hit=this[CACHE].get(key).value;return!isStale(this,hit)}get(key){return get(this,key,true)}peek(key){return get(this,key,false)}pop(){const node=this[LRU_LIST].tail;if(!node)return null;del(this,node);return node.value}del(key){del(this,this[CACHE].get(key))}load(arr){this.reset();const now=Date.now();for(let l=arr.length-1;l>=0;l--){const hit=arr[l];const expiresAt=hit.e||0;if(expiresAt===0)this.set(hit.k,hit.v);else{const maxAge=expiresAt-now;if(maxAge>0){this.set(hit.k,hit.v,maxAge)}}}}prune(){this[CACHE].forEach(((value,key)=>get(this,key,false)))}}const get=(self,key,doUse)=>{const node=self[CACHE].get(key);if(node){const hit=node.value;if(isStale(self,hit)){del(self,node);if(!self[ALLOW_STALE])return undefined}else{if(doUse){if(self[UPDATE_AGE_ON_GET])node.value.now=Date.now();self[LRU_LIST].unshiftNode(node)}}return hit.value}};const isStale=(self,hit)=>{if(!hit||!hit.maxAge&&!self[MAX_AGE])return false;const diff=Date.now()-hit.now;return hit.maxAge?diff>hit.maxAge:self[MAX_AGE]&&diff>self[MAX_AGE]};const trim=self=>{if(self[LENGTH]>self[MAX]){for(let walker=self[LRU_LIST].tail;self[LENGTH]>self[MAX]&&walker!==null;){const prev=walker.prev;del(self,walker);walker=prev}}};const del=(self,node)=>{if(node){const hit=node.value;if(self[DISPOSE])self[DISPOSE](hit.key,hit.value);self[LENGTH]-=hit.length;self[CACHE].delete(hit.key);self[LRU_LIST].removeNode(node)}};class Entry{constructor(key,value,length,now,maxAge){this.key=key;this.value=value;this.length=length;this.now=now;this.maxAge=maxAge||0}}const forEachStep=(self,fn,node,thisp)=>{let hit=node.value;if(isStale(self,hit)){del(self,node);if(!self[ALLOW_STALE])hit=undefined}if(hit)fn.call(thisp,hit.value,hit.key,self)};module.exports=LRUCache},{yallist:342}],341:[function(require,module,exports){"use strict";module.exports=function(Yallist){Yallist.prototype[Symbol.iterator]=function*(){for(let walker=this.head;walker;walker=walker.next){yield walker.value}}}},{}],342:[function(require,module,exports){"use strict";module.exports=Yallist;Yallist.Node=Node;Yallist.create=Yallist;function Yallist(list){var self=this;if(!(self instanceof Yallist)){self=new Yallist}self.tail=null;self.head=null;self.length=0;if(list&&typeof list.forEach==="function"){list.forEach((function(item){self.push(item)}))}else if(arguments.length>0){for(var i=0,l=arguments.length;i<l;i++){self.push(arguments[i])}}return self}Yallist.prototype.removeNode=function(node){if(node.list!==this){throw new Error("removing node which does not belong to this list")}var next=node.next;var prev=node.prev;if(next){next.prev=prev}if(prev){prev.next=next}if(node===this.head){this.head=next}if(node===this.tail){this.tail=prev}node.list.length--;node.next=null;node.prev=null;node.list=null;return next};Yallist.prototype.unshiftNode=function(node){if(node===this.head){return}if(node.list){node.list.removeNode(node)}var head=this.head;node.list=this;node.next=head;if(head){head.prev=node}this.head=node;if(!this.tail){this.tail=node}this.length++};Yallist.prototype.pushNode=function(node){if(node===this.tail){return}if(node.list){node.list.removeNode(node)}var tail=this.tail;node.list=this;node.prev=tail;if(tail){tail.next=node}this.tail=node;if(!this.head){this.head=node}this.length++};Yallist.prototype.push=function(){for(var i=0,l=arguments.length;i<l;i++){push(this,arguments[i])}return this.length};Yallist.prototype.unshift=function(){for(var i=0,l=arguments.length;i<l;i++){unshift(this,arguments[i])}return this.length};Yallist.prototype.pop=function(){if(!this.tail){return undefined}var res=this.tail.value;this.tail=this.tail.prev;if(this.tail){this.tail.next=null}else{this.head=null}this.length--;return res};Yallist.prototype.shift=function(){if(!this.head){return undefined}var res=this.head.value;this.head=this.head.next;if(this.head){this.head.prev=null}else{this.tail=null}this.length--;return res};Yallist.prototype.forEach=function(fn,thisp){thisp=thisp||this;for(var walker=this.head,i=0;walker!==null;i++){fn.call(thisp,walker.value,i,this);walker=walker.next}};Yallist.prototype.forEachReverse=function(fn,thisp){thisp=thisp||this;for(var walker=this.tail,i=this.length-1;walker!==null;i--){fn.call(thisp,walker.value,i,this);walker=walker.prev}};Yallist.prototype.get=function(n){for(var i=0,walker=this.head;walker!==null&&i<n;i++){walker=walker.next}if(i===n&&walker!==null){return walker.value}};Yallist.prototype.getReverse=function(n){for(var i=0,walker=this.tail;walker!==null&&i<n;i++){walker=walker.prev}if(i===n&&walker!==null){return walker.value}};Yallist.prototype.map=function(fn,thisp){thisp=thisp||this;var res=new Yallist;for(var walker=this.head;walker!==null;){res.push(fn.call(thisp,walker.value,this));walker=walker.next}return res};Yallist.prototype.mapReverse=function(fn,thisp){thisp=thisp||this;var res=new Yallist;for(var walker=this.tail;walker!==null;){res.push(fn.call(thisp,walker.value,this));walker=walker.prev}return res};Yallist.prototype.reduce=function(fn,initial){var acc;var walker=this.head;if(arguments.length>1){acc=initial}else if(this.head){walker=this.head.next;acc=this.head.value}else{throw new TypeError("Reduce of empty list with no initial value")}for(var i=0;walker!==null;i++){acc=fn(acc,walker.value,i);walker=walker.next}return acc};Yallist.prototype.reduceReverse=function(fn,initial){var acc;var walker=this.tail;if(arguments.length>1){acc=initial}else if(this.tail){walker=this.tail.prev;acc=this.tail.value}else{throw new TypeError("Reduce of empty list with no initial value")}for(var i=this.length-1;walker!==null;i--){acc=fn(acc,walker.value,i);walker=walker.prev}return acc};Yallist.prototype.toArray=function(){var arr=new Array(this.length);for(var i=0,walker=this.head;walker!==null;i++){arr[i]=walker.value;walker=walker.next}return arr};Yallist.prototype.toArrayReverse=function(){var arr=new Array(this.length);for(var i=0,walker=this.tail;walker!==null;i++){arr[i]=walker.value;walker=walker.prev}return arr};Yallist.prototype.slice=function(from,to){to=to||this.length;if(to<0){to+=this.length}from=from||0;if(from<0){from+=this.length}var ret=new Yallist;if(to<from||to<0){return ret}if(from<0){from=0}if(to>this.length){to=this.length}for(var i=0,walker=this.head;walker!==null&&i<from;i++){walker=walker.next}for(;walker!==null&&i<to;i++,walker=walker.next){ret.push(walker.value)}return ret};Yallist.prototype.sliceReverse=function(from,to){to=to||this.length;if(to<0){to+=this.length}from=from||0;if(from<0){from+=this.length}var ret=new Yallist;if(to<from||to<0){return ret}if(from<0){from=0}if(to>this.length){to=this.length}for(var i=this.length,walker=this.tail;walker!==null&&i>to;i--){walker=walker.prev}for(;walker!==null&&i>from;i--,walker=walker.prev){ret.push(walker.value)}return ret};Yallist.prototype.splice=function(start,deleteCount){if(start>this.length){start=this.length-1}if(start<0){start=this.length+start}for(var i=0,walker=this.head;walker!==null&&i<start;i++){walker=walker.next}var ret=[];for(var i=0;walker&&i<deleteCount;i++){ret.push(walker.value);walker=this.removeNode(walker)}if(walker===null){walker=this.tail}if(walker!==this.head&&walker!==this.tail){walker=walker.prev}for(var i=2;i<arguments.length;i++){walker=insert(this,walker,arguments[i])}return ret};Yallist.prototype.reverse=function(){var head=this.head;var tail=this.tail;for(var walker=head;walker!==null;walker=walker.prev){var p=walker.prev;walker.prev=walker.next;walker.next=p}this.head=tail;this.tail=head;return this};function insert(self,node,value){var inserted=node===self.head?new Node(value,null,node,self):new Node(value,node,node.next,self);if(inserted.next===null){self.tail=inserted}if(inserted.prev===null){self.head=inserted}self.length++;return inserted}function push(self,item){self.tail=new Node(item,self.tail,null,self);if(!self.head){self.head=self.tail}self.length++}function unshift(self,item){self.head=new Node(item,null,self.head,self);if(!self.tail){self.tail=self.head}self.length++}function Node(value,prev,next,list){if(!(this instanceof Node)){return new Node(value,prev,next,list)}this.list=list;this.value=value;if(prev){prev.next=this;this.prev=prev}else{this.prev=null}if(next){next.prev=this;this.next=next}else{this.next=null}}try{require("./iterator.js")(Yallist)}catch(er){}},{"./iterator.js":341}],343:[function(require,module,exports){var _=require("lodash");var xmlBuilder=require("xmlbuilder");var path=require("path");var makeDir=require("make-dir");var fs=require("fs");var TestSuite=require("./test_suite");var TestCase=require("./test_case");function JUnitReportBuilder(factory){this._factory=factory;this._testSuitesAndCases=[]}JUnitReportBuilder.prototype.writeTo=function(reportPath){makeDir.sync(path.dirname(reportPath));fs.writeFileSync(reportPath,this.build(),"utf8")};JUnitReportBuilder.prototype.build=function(){var xmlTree=xmlBuilder.create("testsuites",{encoding:"UTF-8",invalidCharReplacement:""});_.forEach(this._testSuitesAndCases,(function(suiteOrCase){suiteOrCase.build(xmlTree)}));return xmlTree.end({pretty:true})};JUnitReportBuilder.prototype.testSuite=function(){var suite=this._factory.newTestSuite();this._testSuitesAndCases.push(suite);return suite};JUnitReportBuilder.prototype.testCase=function(){var testCase=this._factory.newTestCase();this._testSuitesAndCases.push(testCase);return testCase};JUnitReportBuilder.prototype.newBuilder=function(){return this._factory.newBuilder()};module.exports=JUnitReportBuilder},{"./test_case":346,"./test_suite":347,fs:149,lodash:348,"make-dir":351,path:377,xmlbuilder:477}],344:[function(require,module,exports){var Builder=require("./builder");var TestSuite=require("./test_suite");var TestCase=require("./test_case");function Factory(){}Factory.prototype.newBuilder=function(){return new Builder(this)};Factory.prototype.newTestSuite=function(){return new TestSuite(this)};Factory.prototype.newTestCase=function(){return new TestCase(this)};module.exports=Factory},{"./builder":343,"./test_case":346,"./test_suite":347}],345:[function(require,module,exports){var Factory=require("./factory");module.exports=(new Factory).newBuilder()},{"./factory":344}],346:[function(require,module,exports){function TestCase(){this._error=false;this._failure=false;this._skipped=false;this._standardOutput=undefined;this._standardError=undefined;this._stacktrace=undefined;this._attributes={};this._errorAttributes={};this._failureAttributes={};this._errorAttachment=undefined;this._errorContent=undefined}TestCase.prototype.className=function(className){this._attributes.classname=className;return this};TestCase.prototype.name=function(name){this._attributes.name=name;return this};TestCase.prototype.time=function(timeInSeconds){this._attributes.time=timeInSeconds;return this};TestCase.prototype.file=function(filepath){this._attributes.file=filepath;return this};TestCase.prototype.failure=function(message,type){this._failure=true;if(message){this._failureAttributes.message=message}if(type){this._failureAttributes.type=type}return this};TestCase.prototype.error=function(message,type,content){this._error=true;if(message){this._errorAttributes.message=message}if(type){this._errorAttributes.type=type}if(content){this._errorContent=content}return this};TestCase.prototype.stacktrace=function(stacktrace){this._failure=true;this._stacktrace=stacktrace;return this};TestCase.prototype.skipped=function(){this._skipped=true;return this};TestCase.prototype.standardOutput=function(log){this._standardOutput=log;return this};TestCase.prototype.standardError=function(log){this._standardError=log;return this};TestCase.prototype.getFailureCount=function(){return Number(this._failure)};TestCase.prototype.getErrorCount=function(){return Number(this._error)};TestCase.prototype.getSkippedCount=function(){return Number(this._skipped)};TestCase.prototype.errorAttachment=function(path){this._errorAttachment=path;return this};TestCase.prototype.build=function(parentElement){var testCaseElement=parentElement.ele("testcase",this._attributes);if(this._failure){var failureElement=testCaseElement.ele("failure",this._failureAttributes);if(this._stacktrace){failureElement.cdata(this._stacktrace)}}if(this._error){var errorElement=testCaseElement.ele("error",this._errorAttributes);if(this._errorContent){errorElement.cdata(this._errorContent)}}if(this._skipped){testCaseElement.ele("skipped")}if(this._standardOutput){testCaseElement.ele("system-out").cdata(this._standardOutput)}var systemError;if(this._standardError){systemError=testCaseElement.ele("system-err").cdata(this._standardError);if(this._errorAttachment){systemError.txt("[[ATTACHMENT|"+this._errorAttachment+"]]")}}};module.exports=TestCase},{}],347:[function(require,module,exports){var _=require("lodash");var formatDate=require("date-format").asString;function TestSuite(factory){this._factory=factory;this._attributes={};this._testCases=[];this._properties=[]}TestSuite.prototype.name=function(name){this._attributes.name=name;return this};TestSuite.prototype.time=function(timeInSeconds){this._attributes.time=timeInSeconds;return this};TestSuite.prototype.timestamp=function(timestamp){if(_.isDate(timestamp)){this._attributes.timestamp=formatDate("yyyy-MM-ddThh:mm:ss",timestamp)}else{this._attributes.timestamp=timestamp}return this};TestSuite.prototype.property=function(name,value){this._properties.push({name:name,value:value});return this};TestSuite.prototype.testCase=function(){var testCase=this._factory.newTestCase();this._testCases.push(testCase);return testCase};TestSuite.prototype.getFailureCount=function(){return this._sumTestCaseCounts((function(testCase){return testCase.getFailureCount()}))};TestSuite.prototype.getErrorCount=function(){return this._sumTestCaseCounts((function(testCase){return testCase.getErrorCount()}))};TestSuite.prototype.getSkippedCount=function(){return this._sumTestCaseCounts((function(testCase){return testCase.getSkippedCount()}))};TestSuite.prototype._sumTestCaseCounts=function(counterFunction){var counts=_.map(this._testCases,counterFunction);return _.sum(counts)};TestSuite.prototype.build=function(parentElement){this._attributes.tests=this._testCases.length;this._attributes.failures=this.getFailureCount();this._attributes.errors=this.getErrorCount();this._attributes.skipped=this.getSkippedCount();var suiteElement=parentElement.ele("testsuite",this._attributes);if(this._properties.length){var propertiesElement=suiteElement.ele("properties");_.forEach(this._properties,(function(property){propertiesElement.ele("property",{name:property.name,value:property.value})}))}_.forEach(this._testCases,(function(testCase){testCase.build(suiteElement)}))};module.exports=TestSuite},{"date-format":177,lodash:348}],348:[function(require,module,exports){(function(global){(function(){(function(){var undefined;var VERSION="4.17.21";var LARGE_ARRAY_SIZE=200;var CORE_ERROR_TEXT="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",FUNC_ERROR_TEXT="Expected a function",INVALID_TEMPL_VAR_ERROR_TEXT="Invalid `variable` option passed into `_.template`";var HASH_UNDEFINED="__lodash_hash_undefined__";var MAX_MEMOIZE_SIZE=500;var PLACEHOLDER="__lodash_placeholder__";var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4;var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;var WRAP_BIND_FLAG=1,WRAP_BIND_KEY_FLAG=2,WRAP_CURRY_BOUND_FLAG=4,WRAP_CURRY_FLAG=8,WRAP_CURRY_RIGHT_FLAG=16,WRAP_PARTIAL_FLAG=32,WRAP_PARTIAL_RIGHT_FLAG=64,WRAP_ARY_FLAG=128,WRAP_REARG_FLAG=256,WRAP_FLIP_FLAG=512;var DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...";var HOT_COUNT=800,HOT_SPAN=16;var LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,LAZY_WHILE_FLAG=3;var INFINITY=1/0,MAX_SAFE_INTEGER=9007199254740991,MAX_INTEGER=17976931348623157e292,NAN=0/0;var MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1;var wrapFlags=[["ary",WRAP_ARY_FLAG],["bind",WRAP_BIND_FLAG],["bindKey",WRAP_BIND_KEY_FLAG],["curry",WRAP_CURRY_FLAG],["curryRight",WRAP_CURRY_RIGHT_FLAG],["flip",WRAP_FLIP_FLAG],["partial",WRAP_PARTIAL_FLAG],["partialRight",WRAP_PARTIAL_RIGHT_FLAG],["rearg",WRAP_REARG_FLAG]];var argsTag="[object Arguments]",arrayTag="[object Array]",asyncTag="[object AsyncFunction]",boolTag="[object Boolean]",dateTag="[object Date]",domExcTag="[object DOMException]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",nullTag="[object Null]",objectTag="[object Object]",promiseTag="[object Promise]",proxyTag="[object Proxy]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",undefinedTag="[object Undefined]",weakMapTag="[object WeakMap]",weakSetTag="[object WeakSet]";var arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reUnescapedHtml=/[&<>"']/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g;var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source);var reTrimStart=/^\s+/;var reWhitespace=/\s/;var reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /;var reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/;var reEscapeChar=/\\(\\)?/g;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reFlags=/\w*$/;var reIsBadHex=/^[-+]0x[0-9a-f]+$/i;var reIsBinary=/^0b[01]+$/i;var reIsHostCtor=/^\[object .+?Constructor\]$/;var reIsOctal=/^0o[0-7]+$/i;var reIsUint=/^(?:0|[1-9]\d*)$/;var reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;var reNoMatch=/($^)/;var reUnescapedString=/['\n\r\u2028\u2029\\]/g;var rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsDingbatRange="\\u2700-\\u27bf",rsLowerRange="a-z\\xdf-\\xf6\\xf8-\\xff",rsMathOpRange="\\xac\\xb1\\xd7\\xf7",rsNonCharRange="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rsPunctuationRange="\\u2000-\\u206f",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange="A-Z\\xc0-\\xd6\\xd8-\\xde",rsVarRange="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange+rsNonCharRange+rsPunctuationRange+rsSpaceRange;var rsApos="['’]",rsAstral="["+rsAstralRange+"]",rsBreak="["+rsBreakRange+"]",rsCombo="["+rsComboRange+"]",rsDigits="\\d+",rsDingbat="["+rsDingbatRange+"]",rsLower="["+rsLowerRange+"]",rsMisc="[^"+rsAstralRange+rsBreakRange+rsDigits+rsDingbatRange+rsLowerRange+rsUpperRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="["+rsUpperRange+"]",rsZWJ="\\u200d";var rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",rsMiscUpper="(?:"+rsUpper+"|"+rsMisc+")",rsOptContrLower="(?:"+rsApos+"(?:d|ll|m|re|s|t|ve))?",rsOptContrUpper="(?:"+rsApos+"(?:D|LL|M|RE|S|T|VE))?",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsOrdLower="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rsOrdUpper="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsEmoji="(?:"+[rsDingbat,rsRegional,rsSurrPair].join("|")+")"+rsSeq,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")";var reApos=RegExp(rsApos,"g");var reComboMark=RegExp(rsCombo,"g");var reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");var reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+"+rsOptContrLower+"(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsMiscUpper+"+"+rsOptContrUpper+"(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+"+rsOptContrLower,rsUpper+"+"+rsOptContrUpper,rsOrdUpper,rsOrdLower,rsDigits,rsEmoji].join("|"),"g");var reHasUnicode=RegExp("["+rsZWJ+rsAstralRange+rsComboRange+rsVarRange+"]");var reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var contextProps=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"];var templateCounter=-1;var typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=true;typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=false;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=true;cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=false;var deburredLetters={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"};var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};var freeParseFloat=parseFloat,freeParseInt=parseInt;var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal||freeSelf||Function("return this")();var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports=freeModule&&freeModule.exports===freeExports;var freeProcess=moduleExports&&freeGlobal.process;var nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;if(types){return types}return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();var nodeIsArrayBuffer=nodeUtil&&nodeUtil.isArrayBuffer,nodeIsDate=nodeUtil&&nodeUtil.isDate,nodeIsMap=nodeUtil&&nodeUtil.isMap,nodeIsRegExp=nodeUtil&&nodeUtil.isRegExp,nodeIsSet=nodeUtil&&nodeUtil.isSet,nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function arrayAggregator(array,setter,iteratee,accumulator){var index=-1,length=array==null?0:array.length;while(++index<length){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}function arrayEach(array,iteratee){var index=-1,length=array==null?0:array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}function arrayEachRight(array,iteratee){var length=array==null?0:array.length;while(length--){if(iteratee(array[length],length,array)===false){break}}return array}function arrayEvery(array,predicate){var index=-1,length=array==null?0:array.length;while(++index<length){if(!predicate(array[index],index,array)){return false}}return true}function arrayFilter(array,predicate){var index=-1,length=array==null?0:array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(predicate(value,index,array)){result[resIndex++]=value}}return result}function arrayIncludes(array,value){var length=array==null?0:array.length;return!!length&&baseIndexOf(array,value,0)>-1}function arrayIncludesWith(array,value,comparator){var index=-1,length=array==null?0:array.length;while(++index<length){if(comparator(value,array[index])){return true}}return false}function arrayMap(array,iteratee){var index=-1,length=array==null?0:array.length,result=Array(length);while(++index<length){result[index]=iteratee(array[index],index,array)}return result}function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index<length){array[offset+index]=values[index]}return array}function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=array==null?0:array.length;if(initAccum&&length){accumulator=array[++index]}while(++index<length){accumulator=iteratee(accumulator,array[index],index,array)}return accumulator}function arrayReduceRight(array,iteratee,accumulator,initAccum){var length=array==null?0:array.length;if(initAccum&&length){accumulator=array[--length]}while(length--){accumulator=iteratee(accumulator,array[length],length,array)}return accumulator}function arraySome(array,predicate){var index=-1,length=array==null?0:array.length;while(++index<length){if(predicate(array[index],index,array)){return true}}return false}var asciiSize=baseProperty("length");function asciiToArray(string){return string.split("")}function asciiWords(string){return string.match(reAsciiWord)||[]}function baseFindKey(collection,predicate,eachFunc){var result;eachFunc(collection,(function(value,key,collection){if(predicate(value,key,collection)){result=key;return false}}));return result}function baseFindIndex(array,predicate,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?1:-1);while(fromRight?index--:++index<length){if(predicate(array[index],index,array)){return index}}return-1}function baseIndexOf(array,value,fromIndex){return value===value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}function baseIndexOfWith(array,value,fromIndex,comparator){var index=fromIndex-1,length=array.length;while(++index<length){if(comparator(array[index],value)){return index}}return-1}function baseIsNaN(value){return value!==value}function baseMean(array,iteratee){var length=array==null?0:array.length;return length?baseSum(array,iteratee)/length:NAN}function baseProperty(key){return function(object){return object==null?undefined:object[key]}}function basePropertyOf(object){return function(key){return object==null?undefined:object[key]}}function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){eachFunc(collection,(function(value,index,collection){accumulator=initAccum?(initAccum=false,value):iteratee(accumulator,value,index,collection)}));return accumulator}function baseSortBy(array,comparer){var length=array.length;array.sort(comparer);while(length--){array[length]=array[length].value}return array}function baseSum(array,iteratee){var result,index=-1,length=array.length;while(++index<length){var current=iteratee(array[index]);if(current!==undefined){result=result===undefined?current:result+current}}return result}function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index<n){result[index]=iteratee(index)}return result}function baseToPairs(object,props){return arrayMap(props,(function(key){return[key,object[key]]}))}function baseTrim(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,""):string}function baseUnary(func){return function(value){return func(value)}}function baseValues(object,props){return arrayMap(props,(function(key){return object[key]}))}function cacheHas(cache,key){return cache.has(key)}function charsStartIndex(strSymbols,chrSymbols){var index=-1,length=strSymbols.length;while(++index<length&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1){}return index}function charsEndIndex(strSymbols,chrSymbols){var index=strSymbols.length;while(index--&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1){}return index}function countHolders(array,placeholder){var length=array.length,result=0;while(length--){if(array[length]===placeholder){++result}}return result}var deburrLetter=basePropertyOf(deburredLetters);var escapeHtmlChar=basePropertyOf(htmlEscapes);function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function getValue(object,key){return object==null?undefined:object[key]}function hasUnicode(string){return reHasUnicode.test(string)}function hasUnicodeWord(string){return reHasUnicodeWord.test(string)}function iteratorToArray(iterator){var data,result=[];while(!(data=iterator.next()).done){result.push(data.value)}return result}function mapToArray(map){var index=-1,result=Array(map.size);map.forEach((function(value,key){result[++index]=[key,value]}));return result}function overArg(func,transform){return function(arg){return func(transform(arg))}}function replaceHolders(array,placeholder){var index=-1,length=array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(value===placeholder||value===PLACEHOLDER){array[index]=PLACEHOLDER;result[resIndex++]=index}}return result}function setToArray(set){var index=-1,result=Array(set.size);set.forEach((function(value){result[++index]=value}));return result}function setToPairs(set){var index=-1,result=Array(set.size);set.forEach((function(value){result[++index]=[value,value]}));return result}function strictIndexOf(array,value,fromIndex){var index=fromIndex-1,length=array.length;while(++index<length){if(array[index]===value){return index}}return-1}function strictLastIndexOf(array,value,fromIndex){var index=fromIndex+1;while(index--){if(array[index]===value){return index}}return index}function stringSize(string){return hasUnicode(string)?unicodeSize(string):asciiSize(string)}function stringToArray(string){return hasUnicode(string)?unicodeToArray(string):asciiToArray(string)}function trimmedEndIndex(string){var index=string.length;while(index--&&reWhitespace.test(string.charAt(index))){}return index}var unescapeHtmlChar=basePropertyOf(htmlUnescapes);function unicodeSize(string){var result=reUnicode.lastIndex=0;while(reUnicode.test(string)){++result}return result}function unicodeToArray(string){return string.match(reUnicode)||[]}function unicodeWords(string){return string.match(reUnicodeWord)||[]}var runInContext=function runInContext(context){context=context==null?root:_.defaults(root.Object(),context,_.pick(root,contextProps));var Array=context.Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError;var arrayProto=Array.prototype,funcProto=Function.prototype,objectProto=Object.prototype;var coreJsData=context["__core-js_shared__"];var funcToString=funcProto.toString;var hasOwnProperty=objectProto.hasOwnProperty;var idCounter=0;var maskSrcKey=function(){var uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return uid?"Symbol(src)_1."+uid:""}();var nativeObjectToString=objectProto.toString;var objectCtorString=funcToString.call(Object);var oldDash=root._;var reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Buffer=moduleExports?context.Buffer:undefined,Symbol=context.Symbol,Uint8Array=context.Uint8Array,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined,getPrototype=overArg(Object.getPrototypeOf,Object),objectCreate=Object.create,propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice,spreadableSymbol=Symbol?Symbol.isConcatSpreadable:undefined,symIterator=Symbol?Symbol.iterator:undefined,symToStringTag=Symbol?Symbol.toStringTag:undefined;var defineProperty=function(){try{var func=getNative(Object,"defineProperty");func({},"",{});return func}catch(e){}}();var ctxClearTimeout=context.clearTimeout!==root.clearTimeout&&context.clearTimeout,ctxNow=Date&&Date.now!==root.Date.now&&Date.now,ctxSetTimeout=context.setTimeout!==root.setTimeout&&context.setTimeout;var nativeCeil=Math.ceil,nativeFloor=Math.floor,nativeGetSymbols=Object.getOwnPropertySymbols,nativeIsBuffer=Buffer?Buffer.isBuffer:undefined,nativeIsFinite=context.isFinite,nativeJoin=arrayProto.join,nativeKeys=overArg(Object.keys,Object),nativeMax=Math.max,nativeMin=Math.min,nativeNow=Date.now,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeReverse=arrayProto.reverse;var DataView=getNative(context,"DataView"),Map=getNative(context,"Map"),Promise=getNative(context,"Promise"),Set=getNative(context,"Set"),WeakMap=getNative(context,"WeakMap"),nativeCreate=getNative(Object,"create");var metaMap=WeakMap&&new WeakMap;var realNames={};var dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap);var symbolProto=Symbol?Symbol.prototype:undefined,symbolValueOf=symbolProto?symbolProto.valueOf:undefined,symbolToString=symbolProto?symbolProto.toString:undefined;function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper){return value}if(hasOwnProperty.call(value,"__wrapped__")){return wrapperClone(value)}}return new LodashWrapper(value)}var baseCreate=function(){function object(){}return function(proto){if(!isObject(proto)){return{}}if(objectCreate){return objectCreate(proto)}object.prototype=proto;var result=new object;object.prototype=undefined;return result}}();function baseLodash(){}function LodashWrapper(value,chainAll){this.__wrapped__=value;this.__actions__=[];this.__chain__=!!chainAll;this.__index__=0;this.__values__=undefined}lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};lodash.prototype=baseLodash.prototype;lodash.prototype.constructor=lodash;LodashWrapper.prototype=baseCreate(baseLodash.prototype);LodashWrapper.prototype.constructor=LodashWrapper;function LazyWrapper(value){this.__wrapped__=value;this.__actions__=[];this.__dir__=1;this.__filtered__=false;this.__iteratees__=[];this.__takeCount__=MAX_ARRAY_LENGTH;this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);result.__actions__=copyArray(this.__actions__);result.__dir__=this.__dir__;result.__filtered__=this.__filtered__;result.__iteratees__=copyArray(this.__iteratees__);result.__takeCount__=this.__takeCount__;result.__views__=copyArray(this.__views__);return result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1;result.__filtered__=true}else{result=this.clone();result.__dir__*=-1}return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir<0,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||!isRight&&arrLength==length&&takeCount==length){return baseWrapperValue(array,this.__actions__)}var result=[];outer:while(length--&&resIndex<takeCount){index+=dir;var iterIndex=-1,value=array[index];while(++iterIndex<iterLength){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG){value=computed}else if(!computed){if(type==LAZY_FILTER_FLAG){continue outer}else{break outer}}}result[resIndex++]=value}return result}LazyWrapper.prototype=baseCreate(baseLodash.prototype);LazyWrapper.prototype.constructor=LazyWrapper;function Hash(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{};this.size=0}function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];this.size-=result?1:0;return result}function hashGet(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED?undefined:result}return hasOwnProperty.call(data,key)?data[key]:undefined}function hashHas(key){var data=this.__data__;return nativeCreate?data[key]!==undefined:hasOwnProperty.call(data,key)}function hashSet(key,value){var data=this.__data__;this.size+=this.has(key)?0:1;data[key]=nativeCreate&&value===undefined?HASH_UNDEFINED:value;return this}Hash.prototype.clear=hashClear;Hash.prototype["delete"]=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function ListCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}function listCacheClear(){this.__data__=[];this.size=0}function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){return false}var lastIndex=data.length-1;if(index==lastIndex){data.pop()}else{splice.call(data,index,1)}--this.size;return true}function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?undefined:data[index][1]}function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1}function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){++this.size;data.push([key,value])}else{data[index][1]=value}return this}ListCache.prototype.clear=listCacheClear;ListCache.prototype["delete"]=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;function MapCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}function mapCacheClear(){this.size=0;this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function mapCacheDelete(key){var result=getMapData(this,key)["delete"](key);this.size-=result?1:0;return result}function mapCacheGet(key){return getMapData(this,key).get(key)}function mapCacheHas(key){return getMapData(this,key).has(key)}function mapCacheSet(key,value){var data=getMapData(this,key),size=data.size;data.set(key,value);this.size+=data.size==size?0:1;return this}MapCache.prototype.clear=mapCacheClear;MapCache.prototype["delete"]=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;function SetCache(values){var index=-1,length=values==null?0:values.length;this.__data__=new MapCache;while(++index<length){this.add(values[index])}}function setCacheAdd(value){this.__data__.set(value,HASH_UNDEFINED);return this}function setCacheHas(value){return this.__data__.has(value)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}function stackClear(){this.__data__=new ListCache;this.size=0}function stackDelete(key){var data=this.__data__,result=data["delete"](key);this.size=data.size;return result}function stackGet(key){return this.__data__.get(key)}function stackHas(key){return this.__data__.has(key)}function stackSet(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<LARGE_ARRAY_SIZE-1){pairs.push([key,value]);this.size=++data.size;return this}data=this.__data__=new MapCache(pairs)}data.set(key,value);this.size=data.size;return this}Stack.prototype.clear=stackClear;Stack.prototype["delete"]=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value){if((inherited||hasOwnProperty.call(value,key))&&!(skipIndexes&&(key=="length"||isBuff&&(key=="offset"||key=="parent")||isType&&(key=="buffer"||key=="byteLength"||key=="byteOffset")||isIndex(key,length)))){result.push(key)}}return result}function arraySample(array){var length=array.length;return length?array[baseRandom(0,length-1)]:undefined}function arraySampleSize(array,n){return shuffleSelf(copyArray(array),baseClamp(n,0,array.length))}function arrayShuffle(array){return shuffleSelf(copyArray(array))}function assignMergeValue(object,key,value){if(value!==undefined&&!eq(object[key],value)||value===undefined&&!(key in object)){baseAssignValue(object,key,value)}}function assignValue(object,key,value){var objValue=object[key];if(!(hasOwnProperty.call(object,key)&&eq(objValue,value))||value===undefined&&!(key in object)){baseAssignValue(object,key,value)}}function assocIndexOf(array,key){var length=array.length;while(length--){if(eq(array[length][0],key)){return length}}return-1}function baseAggregator(collection,setter,iteratee,accumulator){baseEach(collection,(function(value,key,collection){setter(accumulator,value,iteratee(value),collection)}));return accumulator}function baseAssign(object,source){return object&&copyObject(source,keys(source),object)}function baseAssignIn(object,source){return object&&copyObject(source,keysIn(source),object)}function baseAssignValue(object,key,value){if(key=="__proto__"&&defineProperty){defineProperty(object,key,{configurable:true,enumerable:true,value:value,writable:true})}else{object[key]=value}}function baseAt(object,paths){var index=-1,length=paths.length,result=Array(length),skip=object==null;while(++index<length){result[index]=skip?undefined:get(object,paths[index])}return result}function baseClamp(number,lower,upper){if(number===number){if(upper!==undefined){number=number<=upper?number:upper}if(lower!==undefined){number=number>=lower?number:lower}}return number}function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG,isFlat=bitmask&CLONE_FLAT_FLAG,isFull=bitmask&CLONE_SYMBOLS_FLAG;if(customizer){result=object?customizer(value,key,object,stack):customizer(value)}if(result!==undefined){return result}if(!isObject(value)){return value}var isArr=isArray(value);if(isArr){result=initCloneArray(value);if(!isDeep){return copyArray(value,result)}}else{var tag=getTag(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer(value)){return cloneBuffer(value,isDeep)}if(tag==objectTag||tag==argsTag||isFunc&&!object){result=isFlat||isFunc?{}:initCloneObject(value);if(!isDeep){return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value))}}else{if(!cloneableTags[tag]){return object?value:{}}result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked){return stacked}stack.set(value,result);if(isSet(value)){value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}))}else if(isMap(value)){value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}))}var keysFunc=isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys;var props=isArr?undefined:keysFunc(value);arrayEach(props||value,(function(subValue,key){if(props){key=subValue;subValue=value[key]}assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}));return result}function baseConforms(source){var props=keys(source);return function(object){return baseConformsTo(object,source,props)}}function baseConformsTo(object,source,props){var length=props.length;if(object==null){return!length}object=Object(object);while(length--){var key=props[length],predicate=source[key],value=object[key];if(value===undefined&&!(key in object)||!predicate(value)){return false}}return true}function baseDelay(func,wait,args){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}return setTimeout((function(){func.apply(undefined,args)}),wait)}function baseDifference(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=true,length=array.length,result=[],valuesLength=values.length;if(!length){return result}if(iteratee){values=arrayMap(values,baseUnary(iteratee))}if(comparator){includes=arrayIncludesWith;isCommon=false}else if(values.length>=LARGE_ARRAY_SIZE){includes=cacheHas;isCommon=false;values=new SetCache(values)}outer:while(++index<length){var value=array[index],computed=iteratee==null?value:iteratee(value);value=comparator||value!==0?value:0;if(isCommon&&computed===computed){var valuesIndex=valuesLength;while(valuesIndex--){if(values[valuesIndex]===computed){continue outer}}result.push(value)}else if(!includes(values,computed,comparator)){result.push(value)}}return result}var baseEach=createBaseEach(baseForOwn);var baseEachRight=createBaseEach(baseForOwnRight,true);function baseEvery(collection,predicate){var result=true;baseEach(collection,(function(value,index,collection){result=!!predicate(value,index,collection);return result}));return result}function baseExtremum(array,iteratee,comparator){var index=-1,length=array.length;while(++index<length){var value=array[index],current=iteratee(value);if(current!=null&&(computed===undefined?current===current&&!isSymbol(current):comparator(current,computed))){var computed=current,result=value}}return result}function baseFill(array,value,start,end){var length=array.length;start=toInteger(start);if(start<0){start=-start>length?0:length+start}end=end===undefined||end>length?length:toInteger(end);if(end<0){end+=length}end=start>end?0:toLength(end);while(start<end){array[start++]=value}return array}function baseFilter(collection,predicate){var result=[];baseEach(collection,(function(value,index,collection){if(predicate(value,index,collection)){result.push(value)}}));return result}function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;predicate||(predicate=isFlattenable);result||(result=[]);while(++index<length){var value=array[index];if(depth>0&&predicate(value)){if(depth>1){baseFlatten(value,depth-1,predicate,isStrict,result)}else{arrayPush(result,value)}}else if(!isStrict){result[result.length]=value}}return result}var baseFor=createBaseFor();var baseForRight=createBaseFor(true);function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return object&&baseForRight(object,iteratee,keys)}function baseFunctions(object,props){return arrayFilter(props,(function(key){return isFunction(object[key])}))}function baseGet(object,path){path=castPath(path,object);var index=0,length=path.length;while(object!=null&&index<length){object=object[toKey(path[index++])]}return index&&index==length?object:undefined}function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}function baseGetTag(value){if(value==null){return value===undefined?undefinedTag:nullTag}return symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}function baseGt(value,other){return value>other}function baseHas(object,key){return object!=null&&hasOwnProperty.call(object,key)}function baseHasIn(object,key){return object!=null&&key in Object(object)}function baseInRange(number,start,end){return number>=nativeMin(start,end)&&number<nativeMax(start,end)}function baseIntersection(arrays,iteratee,comparator){var includes=comparator?arrayIncludesWith:arrayIncludes,length=arrays[0].length,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),maxLength=Infinity,result=[];while(othIndex--){var array=arrays[othIndex];if(othIndex&&iteratee){array=arrayMap(array,baseUnary(iteratee))}maxLength=nativeMin(array.length,maxLength);caches[othIndex]=!comparator&&(iteratee||length>=120&&array.length>=120)?new SetCache(othIndex&&array):undefined}array=arrays[0];var index=-1,seen=caches[0];outer:while(++index<length&&result.length<maxLength){var value=array[index],computed=iteratee?iteratee(value):value;value=comparator||value!==0?value:0;if(!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){othIndex=othLength;while(--othIndex){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator))){continue outer}}if(seen){seen.push(computed)}result.push(value)}}return result}function baseInverter(object,setter,iteratee,accumulator){baseForOwn(object,(function(value,key,object){setter(accumulator,iteratee(value),key,object)}));return accumulator}function baseInvoke(object,path,args){path=castPath(path,object);object=parent(object,path);var func=object==null?object:object[toKey(last(path))];return func==null?undefined:apply(func,object,args)}function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}function baseIsArrayBuffer(value){return isObjectLike(value)&&baseGetTag(value)==arrayBufferTag}function baseIsDate(value){return isObjectLike(value)&&baseGetTag(value)==dateTag}function baseIsEqual(value,other,bitmask,customizer,stack){if(value===other){return true}if(value==null||other==null||!isObjectLike(value)&&!isObjectLike(other)){return value!==value&&other!==other}return baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack)}function baseIsEqualDeep(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?arrayTag:getTag(object),othTag=othIsArr?arrayTag:getTag(other);objTag=objTag==argsTag?objectTag:objTag;othTag=othTag==argsTag?objectTag:othTag;var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other)){return false}objIsArr=true;objIsObj=false}if(isSameTag&&!objIsObj){stack||(stack=new Stack);return objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack)}if(!(bitmask&COMPARE_PARTIAL_FLAG)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;stack||(stack=new Stack);return equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}if(!isSameTag){return false}stack||(stack=new Stack);return equalObjects(object,other,bitmask,customizer,equalFunc,stack)}function baseIsMap(value){return isObjectLike(value)&&getTag(value)==mapTag}function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(object==null){return!length}object=Object(object);while(index--){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object)){return false}}while(++index<length){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object)){return false}}else{var stack=new Stack;if(customizer){var result=customizer(objValue,srcValue,key,object,source,stack)}if(!(result===undefined?baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG,customizer,stack):result)){return false}}}return true}function baseIsNative(value){if(!isObject(value)||isMasked(value)){return false}var pattern=isFunction(value)?reIsNative:reIsHostCtor;return pattern.test(toSource(value))}function baseIsRegExp(value){return isObjectLike(value)&&baseGetTag(value)==regexpTag}function baseIsSet(value){return isObjectLike(value)&&getTag(value)==setTag}function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseIteratee(value){if(typeof value=="function"){return value}if(value==null){return identity}if(typeof value=="object"){return isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value)}return property(value)}function baseKeys(object){if(!isPrototype(object)){return nativeKeys(object)}var result=[];for(var key in Object(object)){if(hasOwnProperty.call(object,key)&&key!="constructor"){result.push(key)}}return result}function baseKeysIn(object){if(!isObject(object)){return nativeKeysIn(object)}var isProto=isPrototype(object),result=[];for(var key in object){if(!(key=="constructor"&&(isProto||!hasOwnProperty.call(object,key)))){result.push(key)}}return result}function baseLt(value,other){return value<other}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];baseEach(collection,(function(value,key,collection){result[++index]=iteratee(value,key,collection)}));return result}function baseMatches(source){var matchData=getMatchData(source);if(matchData.length==1&&matchData[0][2]){return matchesStrictComparable(matchData[0][0],matchData[0][1])}return function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseMatchesProperty(path,srcValue){if(isKey(path)&&isStrictComparable(srcValue)){return matchesStrictComparable(toKey(path),srcValue)}return function(object){var objValue=get(object,path);return objValue===undefined&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseMerge(object,source,srcIndex,customizer,stack){if(object===source){return}baseFor(source,(function(srcValue,key){stack||(stack=new Stack);if(isObject(srcValue)){baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack)}else{var newValue=customizer?customizer(safeGet(object,key),srcValue,key+"",object,source,stack):undefined;if(newValue===undefined){newValue=srcValue}assignMergeValue(object,key,newValue)}}),keysIn)}function baseMergeDeep(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=safeGet(object,key),srcValue=safeGet(source,key),stacked=stack.get(srcValue);if(stacked){assignMergeValue(object,key,stacked);return}var newValue=customizer?customizer(objValue,srcValue,key+"",object,source,stack):undefined;var isCommon=newValue===undefined;if(isCommon){var isArr=isArray(srcValue),isBuff=!isArr&&isBuffer(srcValue),isTyped=!isArr&&!isBuff&&isTypedArray(srcValue);newValue=srcValue;if(isArr||isBuff||isTyped){if(isArray(objValue)){newValue=objValue}else if(isArrayLikeObject(objValue)){newValue=copyArray(objValue)}else if(isBuff){isCommon=false;newValue=cloneBuffer(srcValue,true)}else if(isTyped){isCommon=false;newValue=cloneTypedArray(srcValue,true)}else{newValue=[]}}else if(isPlainObject(srcValue)||isArguments(srcValue)){newValue=objValue;if(isArguments(objValue)){newValue=toPlainObject(objValue)}else if(!isObject(objValue)||isFunction(objValue)){newValue=initCloneObject(srcValue)}}else{isCommon=false}}if(isCommon){stack.set(srcValue,newValue);mergeFunc(newValue,srcValue,srcIndex,customizer,stack);stack["delete"](srcValue)}assignMergeValue(object,key,newValue)}function baseNth(array,n){var length=array.length;if(!length){return}n+=n<0?length:0;return isIndex(n,length)?array[n]:undefined}function baseOrderBy(collection,iteratees,orders){if(iteratees.length){iteratees=arrayMap(iteratees,(function(iteratee){if(isArray(iteratee)){return function(value){return baseGet(value,iteratee.length===1?iteratee[0]:iteratee)}}return iteratee}))}else{iteratees=[identity]}var index=-1;iteratees=arrayMap(iteratees,baseUnary(getIteratee()));var result=baseMap(collection,(function(value,key,collection){var criteria=arrayMap(iteratees,(function(iteratee){return iteratee(value)}));return{criteria:criteria,index:++index,value:value}}));return baseSortBy(result,(function(object,other){return compareMultiple(object,other,orders)}))}function basePick(object,paths){return basePickBy(object,paths,(function(value,path){return hasIn(object,path)}))}function basePickBy(object,paths,predicate){var index=-1,length=paths.length,result={};while(++index<length){var path=paths[index],value=baseGet(object,path);if(predicate(value,path)){baseSet(result,castPath(path,object),value)}}return result}function basePropertyDeep(path){return function(object){return baseGet(object,path)}}function basePullAll(array,values,iteratee,comparator){var indexOf=comparator?baseIndexOfWith:baseIndexOf,index=-1,length=values.length,seen=array;if(array===values){values=copyArray(values)}if(iteratee){seen=arrayMap(array,baseUnary(iteratee))}while(++index<length){var fromIndex=0,value=values[index],computed=iteratee?iteratee(value):value;while((fromIndex=indexOf(seen,computed,fromIndex,comparator))>-1){if(seen!==array){splice.call(seen,fromIndex,1)}splice.call(array,fromIndex,1)}}return array}function basePullAt(array,indexes){var length=array?indexes.length:0,lastIndex=length-1;while(length--){var index=indexes[length];if(length==lastIndex||index!==previous){var previous=index;if(isIndex(index)){splice.call(array,index,1)}else{baseUnset(array,index)}}}return array}function baseRandom(lower,upper){return lower+nativeFloor(nativeRandom()*(upper-lower+1))}function baseRange(start,end,step,fromRight){var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);while(length--){result[fromRight?length:++index]=start;start+=step}return result}function baseRepeat(string,n){var result="";if(!string||n<1||n>MAX_SAFE_INTEGER){return result}do{if(n%2){result+=string}n=nativeFloor(n/2);if(n){string+=string}}while(n);return result}function baseRest(func,start){return setToString(overRest(func,start,identity),func+"")}function baseSample(collection){return arraySample(values(collection))}function baseSampleSize(collection,n){var array=values(collection);return shuffleSelf(array,baseClamp(n,0,array.length))}function baseSet(object,path,value,customizer){if(!isObject(object)){return object}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(key==="__proto__"||key==="constructor"||key==="prototype"){return object}if(index!=lastIndex){var objValue=nested[key];newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{}}}assignValue(nested,key,newValue);nested=nested[key]}return object}var baseSetData=!metaMap?identity:function(func,data){metaMap.set(func,data);return func};var baseSetToString=!defineProperty?identity:function(func,string){return defineProperty(func,"toString",{configurable:true,enumerable:false,value:constant(string),writable:true})};function baseShuffle(collection){return shuffleSelf(values(collection))}function baseSlice(array,start,end){var index=-1,length=array.length;if(start<0){start=-start>length?0:length+start}end=end>length?length:end;if(end<0){end+=length}length=start>end?0:end-start>>>0;start>>>=0;var result=Array(length);while(++index<length){result[index]=array[index+start]}return result}function baseSome(collection,predicate){var result;baseEach(collection,(function(value,index,collection){result=predicate(value,index,collection);return!result}));return!!result}function baseSortedIndex(array,value,retHighest){var low=0,high=array==null?low:array.length;if(typeof value=="number"&&value===value&&high<=HALF_MAX_ARRAY_LENGTH){while(low<high){var mid=low+high>>>1,computed=array[mid];if(computed!==null&&!isSymbol(computed)&&(retHighest?computed<=value:computed<value)){low=mid+1}else{high=mid}}return high}return baseSortedIndexBy(array,value,identity,retHighest)}function baseSortedIndexBy(array,value,iteratee,retHighest){var low=0,high=array==null?0:array.length;if(high===0){return 0}value=iteratee(value);var valIsNaN=value!==value,valIsNull=value===null,valIsSymbol=isSymbol(value),valIsUndefined=value===undefined;while(low<high){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),othIsDefined=computed!==undefined,othIsNull=computed===null,othIsReflexive=computed===computed,othIsSymbol=isSymbol(computed);if(valIsNaN){var setLow=retHighest||othIsReflexive}else if(valIsUndefined){setLow=othIsReflexive&&(retHighest||othIsDefined)}else if(valIsNull){setLow=othIsReflexive&&othIsDefined&&(retHighest||!othIsNull)}else if(valIsSymbol){setLow=othIsReflexive&&othIsDefined&&!othIsNull&&(retHighest||!othIsSymbol)}else if(othIsNull||othIsSymbol){setLow=false}else{setLow=retHighest?computed<=value:computed<value}if(setLow){low=mid+1}else{high=mid}}return nativeMin(high,MAX_ARRAY_INDEX)}function baseSortedUniq(array,iteratee){var index=-1,length=array.length,resIndex=0,result=[];while(++index<length){var value=array[index],computed=iteratee?iteratee(value):value;if(!index||!eq(computed,seen)){var seen=computed;result[resIndex++]=value===0?0:value}}return result}function baseToNumber(value){if(typeof value=="number"){return value}if(isSymbol(value)){return NAN}return+value}function baseToString(value){if(typeof value=="string"){return value}if(isArray(value)){return arrayMap(value,baseToString)+""}if(isSymbol(value)){return symbolToString?symbolToString.call(value):""}var result=value+"";return result=="0"&&1/value==-INFINITY?"-0":result}function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=true,result=[],seen=result;if(comparator){isCommon=false;includes=arrayIncludesWith}else if(length>=LARGE_ARRAY_SIZE){var set=iteratee?null:createSet(array);if(set){return setToArray(set)}isCommon=false;includes=cacheHas;seen=new SetCache}else{seen=iteratee?[]:result}outer:while(++index<length){var value=array[index],computed=iteratee?iteratee(value):value;value=comparator||value!==0?value:0;if(isCommon&&computed===computed){var seenIndex=seen.length;while(seenIndex--){if(seen[seenIndex]===computed){continue outer}}if(iteratee){seen.push(computed)}result.push(value)}else if(!includes(seen,computed,comparator)){if(seen!==result){seen.push(computed)}result.push(value)}}return result}function baseUnset(object,path){path=castPath(path,object);object=parent(object,path);return object==null||delete object[toKey(last(path))]}function baseUpdate(object,path,updater,customizer){return baseSet(object,path,updater(baseGet(object,path)),customizer)}function baseWhile(array,predicate,isDrop,fromRight){var length=array.length,index=fromRight?length:-1;while((fromRight?index--:++index<length)&&predicate(array[index],index,array)){}return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;if(result instanceof LazyWrapper){result=result.value()}return arrayReduce(actions,(function(result,action){return action.func.apply(action.thisArg,arrayPush([result],action.args))}),result)}function baseXor(arrays,iteratee,comparator){var length=arrays.length;if(length<2){return length?baseUniq(arrays[0]):[]}var index=-1,result=Array(length);while(++index<length){var array=arrays[index],othIndex=-1;while(++othIndex<length){if(othIndex!=index){result[index]=baseDifference(result[index]||array,arrays[othIndex],iteratee,comparator)}}}return baseUniq(baseFlatten(result,1),iteratee,comparator)}function baseZipObject(props,values,assignFunc){var index=-1,length=props.length,valsLength=values.length,result={};while(++index<length){var value=index<valsLength?values[index]:undefined;assignFunc(result,props[index],value)}return result}function castArrayLikeObject(value){return isArrayLikeObject(value)?value:[]}function castFunction(value){return typeof value=="function"?value:identity}function castPath(value,object){if(isArray(value)){return value}return isKey(value,object)?[value]:stringToPath(toString(value))}var castRest=baseRest;function castSlice(array,start,end){var length=array.length;end=end===undefined?length:end;return!start&&end>=length?array:baseSlice(array,start,end)}var clearTimeout=ctxClearTimeout||function(id){return root.clearTimeout(id)};function cloneBuffer(buffer,isDeep){if(isDeep){return buffer.slice()}var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);buffer.copy(result);return result}function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);new Uint8Array(result).set(new Uint8Array(arrayBuffer));return result}function cloneDataView(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));result.lastIndex=regexp.lastIndex;return result}function cloneSymbol(symbol){return symbolValueOf?Object(symbolValueOf.call(symbol)):{}}function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}function compareAscending(value,other){if(value!==other){var valIsDefined=value!==undefined,valIsNull=value===null,valIsReflexive=value===value,valIsSymbol=isSymbol(value);var othIsDefined=other!==undefined,othIsNull=other===null,othIsReflexive=other===other,othIsSymbol=isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive){return 1}if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive){return-1}}return 0}function compareMultiple(object,other,orders){var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;while(++index<length){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength){return result}var order=orders[index];return result*(order=="desc"?-1:1)}}return object.index-other.index}function composeArgs(args,partials,holders,isCurried){var argsIndex=-1,argsLength=args.length,holdersLength=holders.length,leftIndex=-1,leftLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(leftLength+rangeLength),isUncurried=!isCurried;while(++leftIndex<leftLength){result[leftIndex]=partials[leftIndex]}while(++argsIndex<holdersLength){if(isUncurried||argsIndex<argsLength){result[holders[argsIndex]]=args[argsIndex]}}while(rangeLength--){result[leftIndex++]=args[argsIndex++]}return result}function composeArgsRight(args,partials,holders,isCurried){var argsIndex=-1,argsLength=args.length,holdersIndex=-1,holdersLength=holders.length,rightIndex=-1,rightLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(rangeLength+rightLength),isUncurried=!isCurried;while(++argsIndex<rangeLength){result[argsIndex]=args[argsIndex]}var offset=argsIndex;while(++rightIndex<rightLength){result[offset+rightIndex]=partials[rightIndex]}while(++holdersIndex<holdersLength){if(isUncurried||argsIndex<argsLength){result[offset+holders[holdersIndex]]=args[argsIndex++]}}return result}function copyArray(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index]}return array}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];var newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;if(newValue===undefined){newValue=source[key]}if(isNew){baseAssignValue(object,key,newValue)}else{assignValue(object,key,newValue)}}return object}function copySymbols(source,object){return copyObject(source,getSymbols(source),object)}function copySymbolsIn(source,object){return copyObject(source,getSymbolsIn(source),object)}function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,getIteratee(iteratee,2),accumulator)}}function createAssigner(assigner){return baseRest((function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:undefined,guard=length>2?sources[2]:undefined;customizer=assigner.length>3&&typeof customizer=="function"?(length--,customizer):undefined;if(guard&&isIterateeCall(sources[0],sources[1],guard)){customizer=length<3?undefined:customizer;length=1}object=Object(object);while(++index<length){var source=sources[index];if(source){assigner(object,source,index,customizer)}}return object}))}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(collection==null){return collection}if(!isArrayLike(collection)){return eachFunc(collection,iteratee)}var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);while(fromRight?index--:++index<length){if(iteratee(iterable[index],index,iterable)===false){break}}return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;while(length--){var key=props[fromRight?length:++index];if(iteratee(iterable[key],key,iterable)===false){break}}return object}}function createBind(func,bitmask,thisArg){var isBind=bitmask&WRAP_BIND_FLAG,Ctor=createCtor(func);function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,arguments)}return wrapper}function createCaseFirst(methodName){return function(string){string=toString(string);var strSymbols=hasUnicode(string)?stringToArray(string):undefined;var chr=strSymbols?strSymbols[0]:string.charAt(0);var trailing=strSymbols?castSlice(strSymbols,1).join(""):string.slice(1);return chr[methodName]()+trailing}}function createCompounder(callback){return function(string){return arrayReduce(words(deburr(string).replace(reApos,"")),callback,"")}}function createCtor(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(func,bitmask,arity){var Ctor=createCtor(func);function wrapper(){var length=arguments.length,args=Array(length),index=length,placeholder=getHolder(wrapper);while(index--){args[index]=arguments[index]}var holders=length<3&&args[0]!==placeholder&&args[length-1]!==placeholder?[]:replaceHolders(args,placeholder);length-=holders.length;if(length<arity){return createRecurry(func,bitmask,createHybrid,wrapper.placeholder,undefined,args,holders,undefined,undefined,arity-length)}var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return apply(fn,this,args)}return wrapper}function createFind(findIndexFunc){return function(collection,predicate,fromIndex){var iterable=Object(collection);if(!isArrayLike(collection)){var iteratee=getIteratee(predicate,3);collection=keys(collection);predicate=function(key){return iteratee(iterable[key],key,iterable)}}var index=findIndexFunc(collection,predicate,fromIndex);return index>-1?iterable[iteratee?collection[index]:index]:undefined}}function createFlow(fromRight){return flatRest((function(funcs){var length=funcs.length,index=length,prereq=LodashWrapper.prototype.thru;if(fromRight){funcs.reverse()}while(index--){var func=funcs[index];if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}if(prereq&&!wrapper&&getFuncName(func)=="wrapper"){var wrapper=new LodashWrapper([],true)}}index=wrapper?index:length;while(++index<length){func=funcs[index];var funcName=getFuncName(func),data=funcName=="wrapper"?getData(func):undefined;if(data&&isLaziable(data[0])&&data[1]==(WRAP_ARY_FLAG|WRAP_CURRY_FLAG|WRAP_PARTIAL_FLAG|WRAP_REARG_FLAG)&&!data[4].length&&data[9]==1){wrapper=wrapper[getFuncName(data[0])].apply(wrapper,data[3])}else{wrapper=func.length==1&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}}return function(){var args=arguments,value=args[0];if(wrapper&&args.length==1&&isArray(value)){return wrapper.plant(value).value()}var index=0,result=length?funcs[index].apply(this,args):value;while(++index<length){result=funcs[index].call(this,result)}return result}}))}function createHybrid(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){var isAry=bitmask&WRAP_ARY_FLAG,isBind=bitmask&WRAP_BIND_FLAG,isBindKey=bitmask&WRAP_BIND_KEY_FLAG,isCurried=bitmask&(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG),isFlip=bitmask&WRAP_FLIP_FLAG,Ctor=isBindKey?undefined:createCtor(func);function wrapper(){var length=arguments.length,args=Array(length),index=length;while(index--){args[index]=arguments[index]}if(isCurried){var placeholder=getHolder(wrapper),holdersCount=countHolders(args,placeholder)}if(partials){args=composeArgs(args,partials,holders,isCurried)}if(partialsRight){args=composeArgsRight(args,partialsRight,holdersRight,isCurried)}length-=holdersCount;if(isCurried&&length<arity){var newHolders=replaceHolders(args,placeholder);return createRecurry(func,bitmask,createHybrid,wrapper.placeholder,thisArg,args,newHolders,argPos,ary,arity-length)}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;length=args.length;if(argPos){args=reorder(args,argPos)}else if(isFlip&&length>1){args.reverse()}if(isAry&&ary<length){args.length=ary}if(this&&this!==root&&this instanceof wrapper){fn=Ctor||createCtor(fn)}return fn.apply(thisBinding,args)}return wrapper}function createInverter(setter,toIteratee){return function(object,iteratee){return baseInverter(object,setter,toIteratee(iteratee),{})}}function createMathOperation(operator,defaultValue){return function(value,other){var result;if(value===undefined&&other===undefined){return defaultValue}if(value!==undefined){result=value}if(other!==undefined){if(result===undefined){return other}if(typeof value=="string"||typeof other=="string"){value=baseToString(value);other=baseToString(other)}else{value=baseToNumber(value);other=baseToNumber(other)}result=operator(value,other)}return result}}function createOver(arrayFunc){return flatRest((function(iteratees){iteratees=arrayMap(iteratees,baseUnary(getIteratee()));return baseRest((function(args){var thisArg=this;return arrayFunc(iteratees,(function(iteratee){return apply(iteratee,thisArg,args)}))}))}))}function createPadding(length,chars){chars=chars===undefined?" ":baseToString(chars);var charsLength=chars.length;if(charsLength<2){return charsLength?baseRepeat(chars,length):chars}var result=baseRepeat(chars,nativeCeil(length/stringSize(chars)));return hasUnicode(chars)?castSlice(stringToArray(result),0,length).join(""):result.slice(0,length)}function createPartial(func,bitmask,thisArg,partials){var isBind=bitmask&WRAP_BIND_FLAG,Ctor=createCtor(func);function wrapper(){var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength),fn=this&&this!==root&&this instanceof wrapper?Ctor:func;while(++leftIndex<leftLength){args[leftIndex]=partials[leftIndex]}while(argsLength--){args[leftIndex++]=arguments[++argsIndex]}return apply(fn,isBind?thisArg:this,args)}return wrapper}function createRange(fromRight){return function(start,end,step){if(step&&typeof step!="number"&&isIterateeCall(start,end,step)){end=step=undefined}start=toFinite(start);if(end===undefined){end=start;start=0}else{end=toFinite(end)}step=step===undefined?start<end?1:-1:toFinite(step);return baseRange(start,end,step,fromRight)}}function createRelationalOperation(operator){return function(value,other){if(!(typeof value=="string"&&typeof other=="string")){value=toNumber(value);other=toNumber(other)}return operator(value,other)}}function createRecurry(func,bitmask,wrapFunc,placeholder,thisArg,partials,holders,argPos,ary,arity){var isCurry=bitmask&WRAP_CURRY_FLAG,newHolders=isCurry?holders:undefined,newHoldersRight=isCurry?undefined:holders,newPartials=isCurry?partials:undefined,newPartialsRight=isCurry?undefined:partials;bitmask|=isCurry?WRAP_PARTIAL_FLAG:WRAP_PARTIAL_RIGHT_FLAG;bitmask&=~(isCurry?WRAP_PARTIAL_RIGHT_FLAG:WRAP_PARTIAL_FLAG);if(!(bitmask&WRAP_CURRY_BOUND_FLAG)){bitmask&=~(WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG)}var newData=[func,bitmask,thisArg,newPartials,newHolders,newPartialsRight,newHoldersRight,argPos,ary,arity];var result=wrapFunc.apply(undefined,newData);if(isLaziable(func)){setData(result,newData)}result.placeholder=placeholder;return setWrapToString(result,func,bitmask)}function createRound(methodName){var func=Math[methodName];return function(number,precision){number=toNumber(number);precision=precision==null?0:nativeMin(toInteger(precision),292);if(precision&&nativeIsFinite(number)){var pair=(toString(number)+"e").split("e"),value=func(pair[0]+"e"+(+pair[1]+precision));pair=(toString(value)+"e").split("e");return+(pair[0]+"e"+(+pair[1]-precision))}return func(number)}}var createSet=!(Set&&1/setToArray(new Set([,-0]))[1]==INFINITY)?noop:function(values){return new Set(values)};function createToPairs(keysFunc){return function(object){var tag=getTag(object);if(tag==mapTag){return mapToArray(object)}if(tag==setTag){return setToPairs(object)}return baseToPairs(object,keysFunc(object))}}function createWrap(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&WRAP_BIND_KEY_FLAG;if(!isBindKey&&typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}var length=partials?partials.length:0;if(!length){bitmask&=~(WRAP_PARTIAL_FLAG|WRAP_PARTIAL_RIGHT_FLAG);partials=holders=undefined}ary=ary===undefined?ary:nativeMax(toInteger(ary),0);arity=arity===undefined?arity:toInteger(arity);length-=holders?holders.length:0;if(bitmask&WRAP_PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func);var newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data){mergeData(newData,data)}func=newData[0];bitmask=newData[1];thisArg=newData[2];partials=newData[3];holders=newData[4];arity=newData[9]=newData[9]===undefined?isBindKey?0:func.length:nativeMax(newData[9]-length,0);if(!arity&&bitmask&(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG)){bitmask&=~(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG)}if(!bitmask||bitmask==WRAP_BIND_FLAG){var result=createBind(func,bitmask,thisArg)}else if(bitmask==WRAP_CURRY_FLAG||bitmask==WRAP_CURRY_RIGHT_FLAG){result=createCurry(func,bitmask,arity)}else if((bitmask==WRAP_PARTIAL_FLAG||bitmask==(WRAP_BIND_FLAG|WRAP_PARTIAL_FLAG))&&!holders.length){result=createPartial(func,bitmask,thisArg,partials)}else{result=createHybrid.apply(undefined,newData)}var setter=data?baseSetData:setData;return setWrapToString(setter(result,newData),func,bitmask)}function customDefaultsAssignIn(objValue,srcValue,key,object){if(objValue===undefined||eq(objValue,objectProto[key])&&!hasOwnProperty.call(object,key)){return srcValue}return objValue}function customDefaultsMerge(objValue,srcValue,key,object,source,stack){if(isObject(objValue)&&isObject(srcValue)){stack.set(srcValue,objValue);baseMerge(objValue,srcValue,undefined,customDefaultsMerge,stack);stack["delete"](srcValue)}return objValue}function customOmitClone(value){return isPlainObject(value)?undefined:value}function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength)){return false}var arrStacked=stack.get(array);var othStacked=stack.get(other);if(arrStacked&&othStacked){return arrStacked==other&&othStacked==array}var index=-1,result=true,seen=bitmask&COMPARE_UNORDERED_FLAG?new SetCache:undefined;stack.set(array,other);stack.set(other,array);while(++index<arrLength){var arrValue=array[index],othValue=other[index];if(customizer){var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack)}if(compared!==undefined){if(compared){continue}result=false;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){return seen.push(othIndex)}}))){result=false;break}}else if(!(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){result=false;break}}stack["delete"](array);stack["delete"](other);return result}function equalByTag(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset){return false}object=object.buffer;other=other.buffer;case arrayBufferTag:if(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other))){return false}return true;case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=bitmask&COMPARE_PARTIAL_FLAG;convert||(convert=setToArray);if(object.size!=other.size&&!isPartial){return false}var stacked=stack.get(object);if(stacked){return stacked==other}bitmask|=COMPARE_UNORDERED_FLAG;stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);stack["delete"](object);return result;case symbolTag:if(symbolValueOf){return symbolValueOf.call(object)==symbolValueOf.call(other)}}return false}function equalObjects(object,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG,objProps=getAllKeys(object),objLength=objProps.length,othProps=getAllKeys(other),othLength=othProps.length;if(objLength!=othLength&&!isPartial){return false}var index=objLength;while(index--){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key))){return false}}var objStacked=stack.get(object);var othStacked=stack.get(other);if(objStacked&&othStacked){return objStacked==other&&othStacked==object}var result=true;stack.set(object,other);stack.set(other,object);var skipCtor=isPartial;while(++index<objLength){key=objProps[index];var objValue=object[key],othValue=other[key];if(customizer){var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack)}if(!(compared===undefined?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=false;break}skipCtor||(skipCtor=key=="constructor")}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&("constructor"in object&&"constructor"in other)&&!(typeof objCtor=="function"&&objCtor instanceof objCtor&&typeof othCtor=="function"&&othCtor instanceof othCtor)){result=false}}stack["delete"](object);stack["delete"](other);return result}function flatRest(func){return setToString(overRest(func,undefined,flatten),func+"")}function getAllKeys(object){return baseGetAllKeys(object,keys,getSymbols)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}var getData=!metaMap?noop:function(func){return metaMap.get(func)};function getFuncName(func){var result=func.name+"",array=realNames[result],length=hasOwnProperty.call(realNames,result)?array.length:0;while(length--){var data=array[length],otherFunc=data.func;if(otherFunc==null||otherFunc==func){return data.name}}return result}function getHolder(func){var object=hasOwnProperty.call(lodash,"placeholder")?lodash:func;return object.placeholder}function getIteratee(){var result=lodash.iteratee||iteratee;result=result===iteratee?baseIteratee:result;return arguments.length?result(arguments[0],arguments[1]):result}function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data[typeof key=="string"?"string":"hash"]:data.map}function getMatchData(object){var result=keys(object),length=result.length;while(length--){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}function getNative(object,key){var value=getValue(object,key);return baseIsNative(value)?value:undefined}function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=undefined;var unmasked=true}catch(e){}var result=nativeObjectToString.call(value);if(unmasked){if(isOwn){value[symToStringTag]=tag}else{delete value[symToStringTag]}}return result}var getSymbols=!nativeGetSymbols?stubArray:function(object){if(object==null){return[]}object=Object(object);return arrayFilter(nativeGetSymbols(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)}))};var getSymbolsIn=!nativeGetSymbols?stubArray:function(object){var result=[];while(object){arrayPush(result,getSymbols(object));object=getPrototype(object)}return result};var getTag=baseGetTag;if(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&getTag(Promise.resolve())!=promiseTag||Set&&getTag(new Set)!=setTag||WeakMap&&getTag(new WeakMap)!=weakMapTag){getTag=function(value){var result=baseGetTag(value),Ctor=result==objectTag?value.constructor:undefined,ctorString=Ctor?toSource(Ctor):"";if(ctorString){switch(ctorString){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return promiseTag;case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}}return result}}function getView(start,end,transforms){var index=-1,length=transforms.length;while(++index<length){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size);break}}return{start:start,end:end}}function getWrapDetails(source){var match=source.match(reWrapDetails);return match?match[1].split(reSplitDetails):[]}function hasPath(object,path,hasFunc){path=castPath(path,object);var index=-1,length=path.length,result=false;while(++index<length){var key=toKey(path[index]);if(!(result=object!=null&&hasFunc(object,key))){break}object=object[key]}if(result||++index!=length){return result}length=object==null?0:object.length;return!!length&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}function initCloneArray(array){var length=array.length,result=new array.constructor(length);if(length&&typeof array[0]=="string"&&hasOwnProperty.call(array,"index")){result.index=array.index;result.input=array.input}return result}function initCloneObject(object){return typeof object.constructor=="function"&&!isPrototype(object)?baseCreate(getPrototype(object)):{}}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return cloneArrayBuffer(object);case boolTag:case dateTag:return new Ctor(+object);case dataViewTag:return cloneDataView(object,isDeep);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:return cloneTypedArray(object,isDeep);case mapTag:return new Ctor;case numberTag:case stringTag:return new Ctor(object);case regexpTag:return cloneRegExp(object);case setTag:return new Ctor;case symbolTag:return cloneSymbol(object)}}function insertWrapDetails(source,details){var length=details.length;if(!length){return source}var lastIndex=length-1;details[lastIndex]=(length>1?"& ":"")+details[lastIndex];details=details.join(length>2?", ":" ");return source.replace(reWrapComment,"{\n/* [wrapped with "+details+"] */\n")}function isFlattenable(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}function isIndex(value,length){var type=typeof value;length=length==null?MAX_SAFE_INTEGER:length;return!!length&&(type=="number"||type!="symbol"&&reIsUint.test(value))&&(value>-1&&value%1==0&&value<length)}function isIterateeCall(value,index,object){if(!isObject(object)){return false}var type=typeof index;if(type=="number"?isArrayLike(object)&&isIndex(index,object.length):type=="string"&&index in object){return eq(object[index],value)}return false}function isKey(value,object){if(isArray(value)){return false}var type=typeof value;if(type=="number"||type=="symbol"||type=="boolean"||value==null||isSymbol(value)){return true}return reIsPlainProp.test(value)||!reIsDeepProp.test(value)||object!=null&&value in Object(object)}function isKeyable(value){var type=typeof value;return type=="string"||type=="number"||type=="symbol"||type=="boolean"?value!=="__proto__":value===null}function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if(typeof other!="function"||!(funcName in LazyWrapper.prototype)){return false}if(func===other){return true}var data=getData(other);return!!data&&func===data[0]}function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}var isMaskable=coreJsData?isFunction:stubFalse;function isPrototype(value){var Ctor=value&&value.constructor,proto=typeof Ctor=="function"&&Ctor.prototype||objectProto;return value===proto}function isStrictComparable(value){return value===value&&!isObject(value)}function matchesStrictComparable(key,srcValue){return function(object){if(object==null){return false}return object[key]===srcValue&&(srcValue!==undefined||key in Object(object))}}function memoizeCapped(func){var result=memoize(func,(function(key){if(cache.size===MAX_MEMOIZE_SIZE){cache.clear()}return key}));var cache=result.cache;return result}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<(WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG|WRAP_ARY_FLAG);var isCombo=srcBitmask==WRAP_ARY_FLAG&&bitmask==WRAP_CURRY_FLAG||srcBitmask==WRAP_ARY_FLAG&&bitmask==WRAP_REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(WRAP_ARY_FLAG|WRAP_REARG_FLAG)&&source[7].length<=source[8]&&bitmask==WRAP_CURRY_FLAG;if(!(isCommon||isCombo)){return data}if(srcBitmask&WRAP_BIND_FLAG){data[2]=source[2];newBitmask|=bitmask&WRAP_BIND_FLAG?0:WRAP_CURRY_BOUND_FLAG}var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):value;data[4]=partials?replaceHolders(data[3],PLACEHOLDER):source[4]}value=source[5];if(value){partials=data[5];data[5]=partials?composeArgsRight(partials,value,source[6]):value;data[6]=partials?replaceHolders(data[5],PLACEHOLDER):source[6]}value=source[7];if(value){data[7]=value}if(srcBitmask&WRAP_ARY_FLAG){data[8]=data[8]==null?source[8]:nativeMin(data[8],source[8])}if(data[9]==null){data[9]=source[9]}data[0]=source[0];data[1]=newBitmask;return data}function nativeKeysIn(object){var result=[];if(object!=null){for(var key in Object(object)){result.push(key)}}return result}function objectToString(value){return nativeObjectToString.call(value)}function overRest(func,start,transform){start=nativeMax(start===undefined?func.length-1:start,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);while(++index<length){array[index]=args[start+index]}index=-1;var otherArgs=Array(start+1);while(++index<start){otherArgs[index]=args[index]}otherArgs[start]=transform(array);return apply(func,this,otherArgs)}}function parent(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1))}function reorder(array,indexes){var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=copyArray(array);while(length--){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}function safeGet(object,key){if(key==="constructor"&&typeof object[key]==="function"){return}if(key=="__proto__"){return}return object[key]}var setData=shortOut(baseSetData);var setTimeout=ctxSetTimeout||function(func,wait){return root.setTimeout(func,wait)};var setToString=shortOut(baseSetToString);function setWrapToString(wrapper,reference,bitmask){var source=reference+"";return setToString(wrapper,insertWrapDetails(source,updateWrapDetails(getWrapDetails(source),bitmask)))}function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=HOT_SPAN-(stamp-lastCalled);lastCalled=stamp;if(remaining>0){if(++count>=HOT_COUNT){return arguments[0]}}else{count=0}return func.apply(undefined,arguments)}}function shuffleSelf(array,size){var index=-1,length=array.length,lastIndex=length-1;size=size===undefined?length:size;while(++index<size){var rand=baseRandom(index,lastIndex),value=array[rand];array[rand]=array[index];array[index]=value}array.length=size;return array}var stringToPath=memoizeCapped((function(string){var result=[];if(string.charCodeAt(0)===46){result.push("")}string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}));return result}));function toKey(value){if(typeof value=="string"||isSymbol(value)){return value}var result=value+"";return result=="0"&&1/value==-INFINITY?"-0":result}function toSource(func){if(func!=null){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}function updateWrapDetails(details,bitmask){arrayEach(wrapFlags,(function(pair){var value="_."+pair[0];if(bitmask&pair[1]&&!arrayIncludes(details,value)){details.push(value)}}));return details.sort()}function wrapperClone(wrapper){if(wrapper instanceof LazyWrapper){return wrapper.clone()}var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);result.__actions__=copyArray(wrapper.__actions__);result.__index__=wrapper.__index__;result.__values__=wrapper.__values__;return result}function chunk(array,size,guard){if(guard?isIterateeCall(array,size,guard):size===undefined){size=1}else{size=nativeMax(toInteger(size),0)}var length=array==null?0:array.length;if(!length||size<1){return[]}var index=0,resIndex=0,result=Array(nativeCeil(length/size));while(index<length){result[resIndex++]=baseSlice(array,index,index+=size)}return result}function compact(array){var index=-1,length=array==null?0:array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(value){result[resIndex++]=value}}return result}function concat(){var length=arguments.length;if(!length){return[]}var args=Array(length-1),array=arguments[0],index=length;while(index--){args[index-1]=arguments[index]}return arrayPush(isArray(array)?copyArray(array):[array],baseFlatten(args,1))}var difference=baseRest((function(array,values){return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,true)):[]}));var differenceBy=baseRest((function(array,values){var iteratee=last(values);if(isArrayLikeObject(iteratee)){iteratee=undefined}return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,true),getIteratee(iteratee,2)):[]}));var differenceWith=baseRest((function(array,values){var comparator=last(values);if(isArrayLikeObject(comparator)){comparator=undefined}return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,true),undefined,comparator):[]}));function drop(array,n,guard){var length=array==null?0:array.length;if(!length){return[]}n=guard||n===undefined?1:toInteger(n);return baseSlice(array,n<0?0:n,length)}function dropRight(array,n,guard){var length=array==null?0:array.length;if(!length){return[]}n=guard||n===undefined?1:toInteger(n);n=length-n;return baseSlice(array,0,n<0?0:n)}function dropRightWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),true,true):[]}function dropWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),true):[]}function fill(array,value,start,end){var length=array==null?0:array.length;if(!length){return[]}if(start&&typeof start!="number"&&isIterateeCall(array,value,start)){start=0;end=length}return baseFill(array,value,start,end)}function findIndex(array,predicate,fromIndex){var length=array==null?0:array.length;if(!length){return-1}var index=fromIndex==null?0:toInteger(fromIndex);if(index<0){index=nativeMax(length+index,0)}return baseFindIndex(array,getIteratee(predicate,3),index)}function findLastIndex(array,predicate,fromIndex){var length=array==null?0:array.length;if(!length){return-1}var index=length-1;if(fromIndex!==undefined){index=toInteger(fromIndex);index=fromIndex<0?nativeMax(length+index,0):nativeMin(index,length-1)}return baseFindIndex(array,getIteratee(predicate,3),index,true)}function flatten(array){var length=array==null?0:array.length;return length?baseFlatten(array,1):[]}function flattenDeep(array){var length=array==null?0:array.length;return length?baseFlatten(array,INFINITY):[]}function flattenDepth(array,depth){var length=array==null?0:array.length;if(!length){return[]}depth=depth===undefined?1:toInteger(depth);return baseFlatten(array,depth)}function fromPairs(pairs){var index=-1,length=pairs==null?0:pairs.length,result={};while(++index<length){var pair=pairs[index];result[pair[0]]=pair[1]}return result}function head(array){return array&&array.length?array[0]:undefined}function indexOf(array,value,fromIndex){var length=array==null?0:array.length;if(!length){return-1}var index=fromIndex==null?0:toInteger(fromIndex);if(index<0){index=nativeMax(length+index,0)}return baseIndexOf(array,value,index)}function initial(array){var length=array==null?0:array.length;return length?baseSlice(array,0,-1):[]}var intersection=baseRest((function(arrays){var mapped=arrayMap(arrays,castArrayLikeObject);return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped):[]}));var intersectionBy=baseRest((function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);if(iteratee===last(mapped)){iteratee=undefined}else{mapped.pop()}return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,getIteratee(iteratee,2)):[]}));var intersectionWith=baseRest((function(arrays){var comparator=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);comparator=typeof comparator=="function"?comparator:undefined;if(comparator){mapped.pop()}return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,undefined,comparator):[]}));function join(array,separator){return array==null?"":nativeJoin.call(array,separator)}function last(array){var length=array==null?0:array.length;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=array==null?0:array.length;if(!length){return-1}var index=length;if(fromIndex!==undefined){index=toInteger(fromIndex);index=index<0?nativeMax(length+index,0):nativeMin(index,length-1)}return value===value?strictLastIndexOf(array,value,index):baseFindIndex(array,baseIsNaN,index,true)}function nth(array,n){return array&&array.length?baseNth(array,toInteger(n)):undefined}var pull=baseRest(pullAll);function pullAll(array,values){return array&&array.length&&values&&values.length?basePullAll(array,values):array}function pullAllBy(array,values,iteratee){return array&&array.length&&values&&values.length?basePullAll(array,values,getIteratee(iteratee,2)):array}function pullAllWith(array,values,comparator){return array&&array.length&&values&&values.length?basePullAll(array,values,undefined,comparator):array}var pullAt=flatRest((function(array,indexes){var length=array==null?0:array.length,result=baseAt(array,indexes);basePullAt(array,arrayMap(indexes,(function(index){return isIndex(index,length)?+index:index})).sort(compareAscending));return result}));function remove(array,predicate){var result=[];if(!(array&&array.length)){return result}var index=-1,indexes=[],length=array.length;predicate=getIteratee(predicate,3);while(++index<length){var value=array[index];if(predicate(value,index,array)){result.push(value);indexes.push(index)}}basePullAt(array,indexes);return result}function reverse(array){return array==null?array:nativeReverse.call(array)}function slice(array,start,end){var length=array==null?0:array.length;if(!length){return[]}if(end&&typeof end!="number"&&isIterateeCall(array,start,end)){start=0;end=length}else{start=start==null?0:toInteger(start);end=end===undefined?length:toInteger(end)}return baseSlice(array,start,end)}function sortedIndex(array,value){return baseSortedIndex(array,value)}function sortedIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee,2))}function sortedIndexOf(array,value){var length=array==null?0:array.length;if(length){var index=baseSortedIndex(array,value);if(index<length&&eq(array[index],value)){return index}}return-1}function sortedLastIndex(array,value){return baseSortedIndex(array,value,true)}function sortedLastIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee,2),true)}function sortedLastIndexOf(array,value){var length=array==null?0:array.length;if(length){var index=baseSortedIndex(array,value,true)-1;if(eq(array[index],value)){return index}}return-1}function sortedUniq(array){return array&&array.length?baseSortedUniq(array):[]}function sortedUniqBy(array,iteratee){return array&&array.length?baseSortedUniq(array,getIteratee(iteratee,2)):[]}function tail(array){var length=array==null?0:array.length;return length?baseSlice(array,1,length):[]}function take(array,n,guard){if(!(array&&array.length)){return[]}n=guard||n===undefined?1:toInteger(n);return baseSlice(array,0,n<0?0:n)}function takeRight(array,n,guard){var length=array==null?0:array.length;if(!length){return[]}n=guard||n===undefined?1:toInteger(n);n=length-n;return baseSlice(array,n<0?0:n,length)}function takeRightWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),false,true):[]}function takeWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3)):[]}var union=baseRest((function(arrays){return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,true))}));var unionBy=baseRest((function(arrays){var iteratee=last(arrays);if(isArrayLikeObject(iteratee)){iteratee=undefined}return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,true),getIteratee(iteratee,2))}));var unionWith=baseRest((function(arrays){var comparator=last(arrays);comparator=typeof comparator=="function"?comparator:undefined;return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,true),undefined,comparator)}));function uniq(array){return array&&array.length?baseUniq(array):[]}function uniqBy(array,iteratee){return array&&array.length?baseUniq(array,getIteratee(iteratee,2)):[]}function uniqWith(array,comparator){comparator=typeof comparator=="function"?comparator:undefined;return array&&array.length?baseUniq(array,undefined,comparator):[]}function unzip(array){if(!(array&&array.length)){return[]}var length=0;array=arrayFilter(array,(function(group){if(isArrayLikeObject(group)){length=nativeMax(group.length,length);return true}}));return baseTimes(length,(function(index){return arrayMap(array,baseProperty(index))}))}function unzipWith(array,iteratee){if(!(array&&array.length)){return[]}var result=unzip(array);if(iteratee==null){return result}return arrayMap(result,(function(group){return apply(iteratee,undefined,group)}))}var without=baseRest((function(array,values){return isArrayLikeObject(array)?baseDifference(array,values):[]}));var xor=baseRest((function(arrays){return baseXor(arrayFilter(arrays,isArrayLikeObject))}));var xorBy=baseRest((function(arrays){var iteratee=last(arrays);if(isArrayLikeObject(iteratee)){iteratee=undefined}return baseXor(arrayFilter(arrays,isArrayLikeObject),getIteratee(iteratee,2))}));var xorWith=baseRest((function(arrays){var comparator=last(arrays);comparator=typeof comparator=="function"?comparator:undefined;return baseXor(arrayFilter(arrays,isArrayLikeObject),undefined,comparator)}));var zip=baseRest(unzip);function zipObject(props,values){return baseZipObject(props||[],values||[],assignValue)}function zipObjectDeep(props,values){return baseZipObject(props||[],values||[],baseSet)}var zipWith=baseRest((function(arrays){var length=arrays.length,iteratee=length>1?arrays[length-1]:undefined;iteratee=typeof iteratee=="function"?(arrays.pop(),iteratee):undefined;return unzipWith(arrays,iteratee)}));function chain(value){var result=lodash(value);result.__chain__=true;return result}function tap(value,interceptor){interceptor(value);return value}function thru(value,interceptor){return interceptor(value)}var wrapperAt=flatRest((function(paths){var length=paths.length,start=length?paths[0]:0,value=this.__wrapped__,interceptor=function(object){return baseAt(object,paths)};if(length>1||this.__actions__.length||!(value instanceof LazyWrapper)||!isIndex(start)){return this.thru(interceptor)}value=value.slice(start,+start+(length?1:0));value.__actions__.push({func:thru,args:[interceptor],thisArg:undefined});return new LodashWrapper(value,this.__chain__).thru((function(array){if(length&&!array.length){array.push(undefined)}return array}))}));function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperNext(){if(this.__values__===undefined){this.__values__=toArray(this.value())}var done=this.__index__>=this.__values__.length,value=done?undefined:this.__values__[this.__index__++];return{done:done,value:value}}function wrapperToIterator(){return this}function wrapperPlant(value){var result,parent=this;while(parent instanceof baseLodash){var clone=wrapperClone(parent);clone.__index__=0;clone.__values__=undefined;if(result){previous.__wrapped__=clone}else{result=clone}var previous=clone;parent=parent.__wrapped__}previous.__wrapped__=value;return result}function wrapperReverse(){var value=this.__wrapped__;if(value instanceof LazyWrapper){var wrapped=value;if(this.__actions__.length){wrapped=new LazyWrapper(this)}wrapped=wrapped.reverse();wrapped.__actions__.push({func:thru,args:[reverse],thisArg:undefined});return new LodashWrapper(wrapped,this.__chain__)}return this.thru(reverse)}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}var countBy=createAggregator((function(result,value,key){if(hasOwnProperty.call(result,key)){++result[key]}else{baseAssignValue(result,key,1)}}));function every(collection,predicate,guard){var func=isArray(collection)?arrayEvery:baseEvery;if(guard&&isIterateeCall(collection,predicate,guard)){predicate=undefined}return func(collection,getIteratee(predicate,3))}function filter(collection,predicate){var func=isArray(collection)?arrayFilter:baseFilter;return func(collection,getIteratee(predicate,3))}var find=createFind(findIndex);var findLast=createFind(findLastIndex);function flatMap(collection,iteratee){return baseFlatten(map(collection,iteratee),1)}function flatMapDeep(collection,iteratee){return baseFlatten(map(collection,iteratee),INFINITY)}function flatMapDepth(collection,iteratee,depth){depth=depth===undefined?1:toInteger(depth);return baseFlatten(map(collection,iteratee),depth)}function forEach(collection,iteratee){var func=isArray(collection)?arrayEach:baseEach;return func(collection,getIteratee(iteratee,3))}function forEachRight(collection,iteratee){var func=isArray(collection)?arrayEachRight:baseEachRight;return func(collection,getIteratee(iteratee,3))}var groupBy=createAggregator((function(result,value,key){if(hasOwnProperty.call(result,key)){result[key].push(value)}else{baseAssignValue(result,key,[value])}}));function includes(collection,value,fromIndex,guard){collection=isArrayLike(collection)?collection:values(collection);fromIndex=fromIndex&&!guard?toInteger(fromIndex):0;var length=collection.length;if(fromIndex<0){fromIndex=nativeMax(length+fromIndex,0)}return isString(collection)?fromIndex<=length&&collection.indexOf(value,fromIndex)>-1:!!length&&baseIndexOf(collection,value,fromIndex)>-1}var invokeMap=baseRest((function(collection,path,args){var index=-1,isFunc=typeof path=="function",result=isArrayLike(collection)?Array(collection.length):[];baseEach(collection,(function(value){result[++index]=isFunc?apply(path,value,args):baseInvoke(value,path,args)}));return result}));var keyBy=createAggregator((function(result,value,key){baseAssignValue(result,key,value)}));function map(collection,iteratee){var func=isArray(collection)?arrayMap:baseMap;return func(collection,getIteratee(iteratee,3))}function orderBy(collection,iteratees,orders,guard){if(collection==null){return[]}if(!isArray(iteratees)){iteratees=iteratees==null?[]:[iteratees]}orders=guard?undefined:orders;if(!isArray(orders)){orders=orders==null?[]:[orders]}return baseOrderBy(collection,iteratees,orders)}var partition=createAggregator((function(result,value,key){result[key?0:1].push(value)}),(function(){return[[],[]]}));function reduce(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEach)}function reduceRight(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduceRight:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEachRight)}function reject(collection,predicate){var func=isArray(collection)?arrayFilter:baseFilter;return func(collection,negate(getIteratee(predicate,3)))}function sample(collection){var func=isArray(collection)?arraySample:baseSample;return func(collection)}function sampleSize(collection,n,guard){if(guard?isIterateeCall(collection,n,guard):n===undefined){n=1}else{n=toInteger(n)}var func=isArray(collection)?arraySampleSize:baseSampleSize;return func(collection,n)}function shuffle(collection){var func=isArray(collection)?arrayShuffle:baseShuffle;return func(collection)}function size(collection){if(collection==null){return 0}if(isArrayLike(collection)){return isString(collection)?stringSize(collection):collection.length}var tag=getTag(collection);if(tag==mapTag||tag==setTag){return collection.size}return baseKeys(collection).length}function some(collection,predicate,guard){var func=isArray(collection)?arraySome:baseSome;if(guard&&isIterateeCall(collection,predicate,guard)){predicate=undefined}return func(collection,getIteratee(predicate,3))}var sortBy=baseRest((function(collection,iteratees){if(collection==null){return[]}var length=iteratees.length;if(length>1&&isIterateeCall(collection,iteratees[0],iteratees[1])){iteratees=[]}else if(length>2&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])){iteratees=[iteratees[0]]}return baseOrderBy(collection,baseFlatten(iteratees,1),[])}));var now=ctxNow||function(){return root.Date.now()};function after(n,func){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}n=toInteger(n);return function(){if(--n<1){return func.apply(this,arguments)}}}function ary(func,n,guard){n=guard?undefined:n;n=func&&n==null?func.length:n;return createWrap(func,WRAP_ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}n=toInteger(n);return function(){if(--n>0){result=func.apply(this,arguments)}if(n<=1){func=undefined}return result}}var bind=baseRest((function(func,thisArg,partials){var bitmask=WRAP_BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,getHolder(bind));bitmask|=WRAP_PARTIAL_FLAG}return createWrap(func,bitmask,thisArg,partials,holders)}));var bindKey=baseRest((function(object,key,partials){var bitmask=WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,getHolder(bindKey));bitmask|=WRAP_PARTIAL_FLAG}return createWrap(key,bitmask,object,partials,holders)}));function curry(func,arity,guard){arity=guard?undefined:arity;var result=createWrap(func,WRAP_CURRY_FLAG,undefined,undefined,undefined,undefined,undefined,arity);result.placeholder=curry.placeholder;return result}function curryRight(func,arity,guard){arity=guard?undefined:arity;var result=createWrap(func,WRAP_CURRY_RIGHT_FLAG,undefined,undefined,undefined,undefined,undefined,arity);result.placeholder=curryRight.placeholder;return result}function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=false,maxing=false,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}wait=toNumber(wait)||0;if(isObject(options)){leading=!!options.leading;maxing="maxWait"in options;maxWait=maxing?nativeMax(toNumber(options.maxWait)||0,wait):maxWait;trailing="trailing"in options?!!options.trailing:trailing}function invokeFunc(time){var args=lastArgs,thisArg=lastThis;lastArgs=lastThis=undefined;lastInvokeTime=time;result=func.apply(thisArg,args);return result}function leadingEdge(time){lastInvokeTime=time;timerId=setTimeout(timerExpired,wait);return leading?invokeFunc(time):result}function remainingWait(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime,timeWaiting=wait-timeSinceLastCall;return maxing?nativeMin(timeWaiting,maxWait-timeSinceLastInvoke):timeWaiting}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime;return lastCallTime===undefined||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&timeSinceLastInvoke>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time)){return trailingEdge(time)}timerId=setTimeout(timerExpired,remainingWait(time))}function trailingEdge(time){timerId=undefined;if(trailing&&lastArgs){return invokeFunc(time)}lastArgs=lastThis=undefined;return result}function cancel(){if(timerId!==undefined){clearTimeout(timerId)}lastInvokeTime=0;lastArgs=lastCallTime=lastThis=timerId=undefined}function flush(){return timerId===undefined?result:trailingEdge(now())}function debounced(){var time=now(),isInvoking=shouldInvoke(time);lastArgs=arguments;lastThis=this;lastCallTime=time;if(isInvoking){if(timerId===undefined){return leadingEdge(lastCallTime)}if(maxing){clearTimeout(timerId);timerId=setTimeout(timerExpired,wait);return invokeFunc(lastCallTime)}}if(timerId===undefined){timerId=setTimeout(timerExpired,wait)}return result}debounced.cancel=cancel;debounced.flush=flush;return debounced}var defer=baseRest((function(func,args){return baseDelay(func,1,args)}));var delay=baseRest((function(func,wait,args){return baseDelay(func,toNumber(wait)||0,args)}));function flip(func){return createWrap(func,WRAP_FLIP_FLAG)}function memoize(func,resolver){if(typeof func!="function"||resolver!=null&&typeof resolver!="function"){throw new TypeError(FUNC_ERROR_TEXT)}var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key)){return cache.get(key)}var result=func.apply(this,args);memoized.cache=cache.set(key,result)||cache;return result};memoized.cache=new(memoize.Cache||MapCache);return memoized}memoize.Cache=MapCache;function negate(predicate){if(typeof predicate!="function"){throw new TypeError(FUNC_ERROR_TEXT)}return function(){var args=arguments;switch(args.length){case 0:return!predicate.call(this);case 1:return!predicate.call(this,args[0]);case 2:return!predicate.call(this,args[0],args[1]);case 3:return!predicate.call(this,args[0],args[1],args[2])}return!predicate.apply(this,args)}}function once(func){return before(2,func)}var overArgs=castRest((function(func,transforms){transforms=transforms.length==1&&isArray(transforms[0])?arrayMap(transforms[0],baseUnary(getIteratee())):arrayMap(baseFlatten(transforms,1),baseUnary(getIteratee()));var funcsLength=transforms.length;return baseRest((function(args){var index=-1,length=nativeMin(args.length,funcsLength);while(++index<length){args[index]=transforms[index].call(this,args[index])}return apply(func,this,args)}))}));var partial=baseRest((function(func,partials){var holders=replaceHolders(partials,getHolder(partial));return createWrap(func,WRAP_PARTIAL_FLAG,undefined,partials,holders)}));var partialRight=baseRest((function(func,partials){var holders=replaceHolders(partials,getHolder(partialRight));return createWrap(func,WRAP_PARTIAL_RIGHT_FLAG,undefined,partials,holders)}));var rearg=flatRest((function(func,indexes){return createWrap(func,WRAP_REARG_FLAG,undefined,undefined,undefined,indexes)}));function rest(func,start){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}start=start===undefined?start:toInteger(start);return baseRest(func,start)}function spread(func,start){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}start=start==null?0:nativeMax(toInteger(start),0);return baseRest((function(args){var array=args[start],otherArgs=castSlice(args,0,start);if(array){arrayPush(otherArgs,array)}return apply(func,this,otherArgs)}))}function throttle(func,wait,options){var leading=true,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}if(isObject(options)){leading="leading"in options?!!options.leading:leading;trailing="trailing"in options?!!options.trailing:trailing}return debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})}function unary(func){return ary(func,1)}function wrap(value,wrapper){return partial(castFunction(wrapper),value)}function castArray(){if(!arguments.length){return[]}var value=arguments[0];return isArray(value)?value:[value]}function clone(value){return baseClone(value,CLONE_SYMBOLS_FLAG)}function cloneWith(value,customizer){customizer=typeof customizer=="function"?customizer:undefined;return baseClone(value,CLONE_SYMBOLS_FLAG,customizer)}function cloneDeep(value){return baseClone(value,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}function cloneDeepWith(value,customizer){customizer=typeof customizer=="function"?customizer:undefined;return baseClone(value,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG,customizer)}function conformsTo(object,source){return source==null||baseConformsTo(object,source,keys(source))}function eq(value,other){return value===other||value!==value&&other!==other}var gt=createRelationalOperation(baseGt);var gte=createRelationalOperation((function(value,other){return value>=other}));var isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};var isArray=Array.isArray;var isArrayBuffer=nodeIsArrayBuffer?baseUnary(nodeIsArrayBuffer):baseIsArrayBuffer;function isArrayLike(value){return value!=null&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function isBoolean(value){return value===true||value===false||isObjectLike(value)&&baseGetTag(value)==boolTag}var isBuffer=nativeIsBuffer||stubFalse;var isDate=nodeIsDate?baseUnary(nodeIsDate):baseIsDate;function isElement(value){return isObjectLike(value)&&value.nodeType===1&&!isPlainObject(value)}function isEmpty(value){if(value==null){return true}if(isArrayLike(value)&&(isArray(value)||typeof value=="string"||typeof value.splice=="function"||isBuffer(value)||isTypedArray(value)||isArguments(value))){return!value.length}var tag=getTag(value);if(tag==mapTag||tag==setTag){return!value.size}if(isPrototype(value)){return!baseKeys(value).length}for(var key in value){if(hasOwnProperty.call(value,key)){return false}}return true}function isEqual(value,other){return baseIsEqual(value,other)}function isEqualWith(value,other,customizer){customizer=typeof customizer=="function"?customizer:undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,undefined,customizer):!!result}function isError(value){if(!isObjectLike(value)){return false}var tag=baseGetTag(value);return tag==errorTag||tag==domExcTag||typeof value.message=="string"&&typeof value.name=="string"&&!isPlainObject(value)}function isFinite(value){return typeof value=="number"&&nativeIsFinite(value)}function isFunction(value){if(!isObject(value)){return false}var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}function isInteger(value){return typeof value=="number"&&value==toInteger(value)}function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isObject(value){var type=typeof value;return value!=null&&(type=="object"||type=="function")}function isObjectLike(value){return value!=null&&typeof value=="object"}var isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;function isMatch(object,source){return object===source||baseIsMatch(object,source,getMatchData(source))}function isMatchWith(object,source,customizer){customizer=typeof customizer=="function"?customizer:undefined;return baseIsMatch(object,source,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){if(isMaskable(value)){throw new Error(CORE_ERROR_TEXT)}return baseIsNative(value)}function isNull(value){return value===null}function isNil(value){return value==null}function isNumber(value){return typeof value=="number"||isObjectLike(value)&&baseGetTag(value)==numberTag}function isPlainObject(value){if(!isObjectLike(value)||baseGetTag(value)!=objectTag){return false}var proto=getPrototype(value);if(proto===null){return true}var Ctor=hasOwnProperty.call(proto,"constructor")&&proto.constructor;return typeof Ctor=="function"&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}var isRegExp=nodeIsRegExp?baseUnary(nodeIsRegExp):baseIsRegExp;function isSafeInteger(value){return isInteger(value)&&value>=-MAX_SAFE_INTEGER&&value<=MAX_SAFE_INTEGER}var isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;function isString(value){return typeof value=="string"||!isArray(value)&&isObjectLike(value)&&baseGetTag(value)==stringTag}function isSymbol(value){return typeof value=="symbol"||isObjectLike(value)&&baseGetTag(value)==symbolTag}var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;function isUndefined(value){return value===undefined}function isWeakMap(value){return isObjectLike(value)&&getTag(value)==weakMapTag}function isWeakSet(value){return isObjectLike(value)&&baseGetTag(value)==weakSetTag}var lt=createRelationalOperation(baseLt);var lte=createRelationalOperation((function(value,other){return value<=other}));function toArray(value){if(!value){return[]}if(isArrayLike(value)){return isString(value)?stringToArray(value):copyArray(value)}if(symIterator&&value[symIterator]){return iteratorToArray(value[symIterator]())}var tag=getTag(value),func=tag==mapTag?mapToArray:tag==setTag?setToArray:values;return func(value)}function toFinite(value){if(!value){return value===0?value:0}value=toNumber(value);if(value===INFINITY||value===-INFINITY){var sign=value<0?-1:1;return sign*MAX_INTEGER}return value===value?value:0}function toInteger(value){var result=toFinite(value),remainder=result%1;return result===result?remainder?result-remainder:result:0}function toLength(value){return value?baseClamp(toInteger(value),0,MAX_ARRAY_LENGTH):0}function toNumber(value){if(typeof value=="number"){return value}if(isSymbol(value)){return NAN}if(isObject(value)){var other=typeof value.valueOf=="function"?value.valueOf():value;value=isObject(other)?other+"":other}if(typeof value!="string"){return value===0?value:+value}value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value}function toPlainObject(value){return copyObject(value,keysIn(value))}function toSafeInteger(value){return value?baseClamp(toInteger(value),-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER):value===0?value:0}function toString(value){return value==null?"":baseToString(value)}var assign=createAssigner((function(object,source){if(isPrototype(source)||isArrayLike(source)){copyObject(source,keys(source),object);return}for(var key in source){if(hasOwnProperty.call(source,key)){assignValue(object,key,source[key])}}}));var assignIn=createAssigner((function(object,source){copyObject(source,keysIn(source),object)}));var assignInWith=createAssigner((function(object,source,srcIndex,customizer){copyObject(source,keysIn(source),object,customizer)}));var assignWith=createAssigner((function(object,source,srcIndex,customizer){copyObject(source,keys(source),object,customizer)}));var at=flatRest(baseAt);function create(prototype,properties){var result=baseCreate(prototype);return properties==null?result:baseAssign(result,properties)}var defaults=baseRest((function(object,sources){object=Object(object);var index=-1;var length=sources.length;var guard=length>2?sources[2]:undefined;if(guard&&isIterateeCall(sources[0],sources[1],guard)){length=1}while(++index<length){var source=sources[index];var props=keysIn(source);var propsIndex=-1;var propsLength=props.length;while(++propsIndex<propsLength){var key=props[propsIndex];var value=object[key];if(value===undefined||eq(value,objectProto[key])&&!hasOwnProperty.call(object,key)){object[key]=source[key]}}}return object}));var defaultsDeep=baseRest((function(args){args.push(undefined,customDefaultsMerge);return apply(mergeWith,undefined,args)}));function findKey(object,predicate){return baseFindKey(object,getIteratee(predicate,3),baseForOwn)}function findLastKey(object,predicate){return baseFindKey(object,getIteratee(predicate,3),baseForOwnRight)}function forIn(object,iteratee){return object==null?object:baseFor(object,getIteratee(iteratee,3),keysIn)}function forInRight(object,iteratee){return object==null?object:baseForRight(object,getIteratee(iteratee,3),keysIn)}function forOwn(object,iteratee){return object&&baseForOwn(object,getIteratee(iteratee,3))}function forOwnRight(object,iteratee){return object&&baseForOwnRight(object,getIteratee(iteratee,3))}function functions(object){return object==null?[]:baseFunctions(object,keys(object))}function functionsIn(object){return object==null?[]:baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=object==null?undefined:baseGet(object,path);return result===undefined?defaultValue:result}function has(object,path){return object!=null&&hasPath(object,path,baseHas)}function hasIn(object,path){return object!=null&&hasPath(object,path,baseHasIn)}var invert=createInverter((function(result,value,key){if(value!=null&&typeof value.toString!="function"){value=nativeObjectToString.call(value)}result[value]=key}),constant(identity));var invertBy=createInverter((function(result,value,key){if(value!=null&&typeof value.toString!="function"){value=nativeObjectToString.call(value)}if(hasOwnProperty.call(result,value)){result[value].push(key)}else{result[value]=[key]}}),getIteratee);var invoke=baseRest(baseInvoke);function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,true):baseKeysIn(object)}function mapKeys(object,iteratee){var result={};iteratee=getIteratee(iteratee,3);baseForOwn(object,(function(value,key,object){baseAssignValue(result,iteratee(value,key,object),value)}));return result}function mapValues(object,iteratee){var result={};iteratee=getIteratee(iteratee,3);baseForOwn(object,(function(value,key,object){baseAssignValue(result,key,iteratee(value,key,object))}));return result}var merge=createAssigner((function(object,source,srcIndex){baseMerge(object,source,srcIndex)}));var mergeWith=createAssigner((function(object,source,srcIndex,customizer){baseMerge(object,source,srcIndex,customizer)}));var omit=flatRest((function(object,paths){var result={};if(object==null){return result}var isDeep=false;paths=arrayMap(paths,(function(path){path=castPath(path,object);isDeep||(isDeep=path.length>1);return path}));copyObject(object,getAllKeysIn(object),result);if(isDeep){result=baseClone(result,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone)}var length=paths.length;while(length--){baseUnset(result,paths[length])}return result}));function omitBy(object,predicate){return pickBy(object,negate(getIteratee(predicate)))}var pick=flatRest((function(object,paths){return object==null?{}:basePick(object,paths)}));function pickBy(object,predicate){if(object==null){return{}}var props=arrayMap(getAllKeysIn(object),(function(prop){return[prop]}));predicate=getIteratee(predicate);return basePickBy(object,props,(function(value,path){return predicate(value,path[0])}))}function result(object,path,defaultValue){path=castPath(path,object);var index=-1,length=path.length;if(!length){length=1;object=undefined}while(++index<length){var value=object==null?undefined:object[toKey(path[index])];if(value===undefined){index=length;value=defaultValue}object=isFunction(value)?value.call(object):value}return object}function set(object,path,value){return object==null?object:baseSet(object,path,value)}function setWith(object,path,value,customizer){customizer=typeof customizer=="function"?customizer:undefined;return object==null?object:baseSet(object,path,value,customizer)}var toPairs=createToPairs(keys);var toPairsIn=createToPairs(keysIn);function transform(object,iteratee,accumulator){var isArr=isArray(object),isArrLike=isArr||isBuffer(object)||isTypedArray(object);iteratee=getIteratee(iteratee,4);if(accumulator==null){var Ctor=object&&object.constructor;if(isArrLike){accumulator=isArr?new Ctor:[]}else if(isObject(object)){accumulator=isFunction(Ctor)?baseCreate(getPrototype(object)):{}}else{accumulator={}}}(isArrLike?arrayEach:baseForOwn)(object,(function(value,index,object){return iteratee(accumulator,value,index,object)}));return accumulator}function unset(object,path){return object==null?true:baseUnset(object,path)}function update(object,path,updater){return object==null?object:baseUpdate(object,path,castFunction(updater))}function updateWith(object,path,updater,customizer){customizer=typeof customizer=="function"?customizer:undefined;return object==null?object:baseUpdate(object,path,castFunction(updater),customizer)}function values(object){return object==null?[]:baseValues(object,keys(object))}function valuesIn(object){return object==null?[]:baseValues(object,keysIn(object))}function clamp(number,lower,upper){if(upper===undefined){upper=lower;lower=undefined}if(upper!==undefined){upper=toNumber(upper);upper=upper===upper?upper:0}if(lower!==undefined){lower=toNumber(lower);lower=lower===lower?lower:0}return baseClamp(toNumber(number),lower,upper)}function inRange(number,start,end){start=toFinite(start);if(end===undefined){end=start;start=0}else{end=toFinite(end)}number=toNumber(number);return baseInRange(number,start,end)}function random(lower,upper,floating){if(floating&&typeof floating!="boolean"&&isIterateeCall(lower,upper,floating)){upper=floating=undefined}if(floating===undefined){if(typeof upper=="boolean"){floating=upper;upper=undefined}else if(typeof lower=="boolean"){floating=lower;lower=undefined}}if(lower===undefined&&upper===undefined){lower=0;upper=1}else{lower=toFinite(lower);if(upper===undefined){upper=lower;lower=0}else{upper=toFinite(upper)}}if(lower>upper){var temp=lower;lower=upper;upper=temp}if(floating||lower%1||upper%1){var rand=nativeRandom();return nativeMin(lower+rand*(upper-lower+freeParseFloat("1e-"+((rand+"").length-1))),upper)}return baseRandom(lower,upper)}var camelCase=createCompounder((function(result,word,index){word=word.toLowerCase();return result+(index?capitalize(word):word)}));function capitalize(string){return upperFirst(toString(string).toLowerCase())}function deburr(string){string=toString(string);return string&&string.replace(reLatin,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=toString(string);target=baseToString(target);var length=string.length;position=position===undefined?length:baseClamp(toInteger(position),0,length);var end=position;position-=target.length;return position>=0&&string.slice(position,end)==target}function escape(string){string=toString(string);return string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){string=toString(string);return string&&reHasRegExpChar.test(string)?string.replace(reRegExpChar,"\\$&"):string}var kebabCase=createCompounder((function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}));var lowerCase=createCompounder((function(result,word,index){return result+(index?" ":"")+word.toLowerCase()}));var lowerFirst=createCaseFirst("toLowerCase");function pad(string,length,chars){string=toString(string);length=toInteger(length);var strLength=length?stringSize(string):0;if(!length||strLength>=length){return string}var mid=(length-strLength)/2;return createPadding(nativeFloor(mid),chars)+string+createPadding(nativeCeil(mid),chars)}function padEnd(string,length,chars){string=toString(string);length=toInteger(length);var strLength=length?stringSize(string):0;return length&&strLength<length?string+createPadding(length-strLength,chars):string}function padStart(string,length,chars){string=toString(string);length=toInteger(length);var strLength=length?stringSize(string):0;return length&&strLength<length?createPadding(length-strLength,chars)+string:string}function parseInt(string,radix,guard){if(guard||radix==null){radix=0}else if(radix){radix=+radix}return nativeParseInt(toString(string).replace(reTrimStart,""),radix||0)}function repeat(string,n,guard){if(guard?isIterateeCall(string,n,guard):n===undefined){n=1}else{n=toInteger(n)}return baseRepeat(toString(string),n)}function replace(){var args=arguments,string=toString(args[0]);return args.length<3?string:string.replace(args[1],args[2])}var snakeCase=createCompounder((function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}));function split(string,separator,limit){if(limit&&typeof limit!="number"&&isIterateeCall(string,separator,limit)){separator=limit=undefined}limit=limit===undefined?MAX_ARRAY_LENGTH:limit>>>0;if(!limit){return[]}string=toString(string);if(string&&(typeof separator=="string"||separator!=null&&!isRegExp(separator))){separator=baseToString(separator);if(!separator&&hasUnicode(string)){return castSlice(stringToArray(string),0,limit)}}return string.split(separator,limit)}var startCase=createCompounder((function(result,word,index){return result+(index?" ":"")+upperFirst(word)}));function startsWith(string,target,position){string=toString(string);position=position==null?0:baseClamp(toInteger(position),0,string.length);target=baseToString(target);return string.slice(position,position+target.length)==target}function template(string,options,guard){var settings=lodash.templateSettings;if(guard&&isIterateeCall(string,options,guard)){options=undefined}string=toString(string);options=assignInWith({},options,settings,customDefaultsAssignIn);var imports=assignInWith({},options.imports,settings.imports,customDefaultsAssignIn),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys);var isEscaping,isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");var sourceURL="//# sourceURL="+(hasOwnProperty.call(options,"sourceURL")?(options.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,(function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){isEscaping=true;source+="' +\n__e("+escapeValue+") +\n'"}if(evaluateValue){isEvaluating=true;source+="';\n"+evaluateValue+";\n__p += '"}if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"}index=offset+match.length;return match}));source+="';\n";var variable=hasOwnProperty.call(options,"variable")&&options.variable;if(!variable){source="with (obj) {\n"+source+"\n}\n"}else if(reForbiddenIdentifierChars.test(variable)){throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT)}source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt((function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)}));result.source=source;if(isError(result)){throw result}return result}function toLower(value){return toString(value).toLowerCase()}function toUpper(value){return toString(value).toUpperCase()}function trim(string,chars,guard){string=toString(string);if(string&&(guard||chars===undefined)){return baseTrim(string)}if(!string||!(chars=baseToString(chars))){return string}var strSymbols=stringToArray(string),chrSymbols=stringToArray(chars),start=charsStartIndex(strSymbols,chrSymbols),end=charsEndIndex(strSymbols,chrSymbols)+1;return castSlice(strSymbols,start,end).join("")}function trimEnd(string,chars,guard){string=toString(string);if(string&&(guard||chars===undefined)){return string.slice(0,trimmedEndIndex(string)+1)}if(!string||!(chars=baseToString(chars))){return string}var strSymbols=stringToArray(string),end=charsEndIndex(strSymbols,stringToArray(chars))+1;return castSlice(strSymbols,0,end).join("")}function trimStart(string,chars,guard){string=toString(string);if(string&&(guard||chars===undefined)){return string.replace(reTrimStart,"")}if(!string||!(chars=baseToString(chars))){return string}var strSymbols=stringToArray(string),start=charsStartIndex(strSymbols,stringToArray(chars));return castSlice(strSymbols,start).join("")}function truncate(string,options){var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?toInteger(options.length):length;omission="omission"in options?baseToString(options.omission):omission}string=toString(string);var strLength=string.length;if(hasUnicode(string)){var strSymbols=stringToArray(string);strLength=strSymbols.length}if(length>=strLength){return string}var end=length-stringSize(omission);if(end<1){return omission}var result=strSymbols?castSlice(strSymbols,0,end).join(""):string.slice(0,end);if(separator===undefined){return result+omission}if(strSymbols){end+=result.length-end}if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,substring=result;if(!separator.global){separator=RegExp(separator.source,toString(reFlags.exec(separator))+"g")}separator.lastIndex=0;while(match=separator.exec(substring)){var newEnd=match.index}result=result.slice(0,newEnd===undefined?end:newEnd)}}else if(string.indexOf(baseToString(separator),end)!=end){var index=result.lastIndexOf(separator);if(index>-1){result=result.slice(0,index)}}return result+omission}function unescape(string){string=toString(string);return string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}var upperCase=createCompounder((function(result,word,index){return result+(index?" ":"")+word.toUpperCase()}));var upperFirst=createCaseFirst("toUpperCase");function words(string,pattern,guard){string=toString(string);pattern=guard?undefined:pattern;if(pattern===undefined){return hasUnicodeWord(string)?unicodeWords(string):asciiWords(string)}return string.match(pattern)||[]}var attempt=baseRest((function(func,args){try{return apply(func,undefined,args)}catch(e){return isError(e)?e:new Error(e)}}));var bindAll=flatRest((function(object,methodNames){arrayEach(methodNames,(function(key){key=toKey(key);baseAssignValue(object,key,bind(object[key],object))}));return object}));function cond(pairs){var length=pairs==null?0:pairs.length,toIteratee=getIteratee();pairs=!length?[]:arrayMap(pairs,(function(pair){if(typeof pair[1]!="function"){throw new TypeError(FUNC_ERROR_TEXT)}return[toIteratee(pair[0]),pair[1]]}));return baseRest((function(args){var index=-1;while(++index<length){var pair=pairs[index];if(apply(pair[0],this,args)){return apply(pair[1],this,args)}}}))}function conforms(source){return baseConforms(baseClone(source,CLONE_DEEP_FLAG))}function constant(value){return function(){return value}}function defaultTo(value,defaultValue){return value==null||value!==value?defaultValue:value}var flow=createFlow();var flowRight=createFlow(true);function identity(value){return value}function iteratee(func){return baseIteratee(typeof func=="function"?func:baseClone(func,CLONE_DEEP_FLAG))}function matches(source){return baseMatches(baseClone(source,CLONE_DEEP_FLAG))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,CLONE_DEEP_FLAG))}var method=baseRest((function(path,args){return function(object){return baseInvoke(object,path,args)}}));var methodOf=baseRest((function(object,args){return function(path){return baseInvoke(object,path,args)}}));function mixin(object,source,options){var props=keys(source),methodNames=baseFunctions(source,props);if(options==null&&!(isObject(source)&&(methodNames.length||!props.length))){options=source;source=object;object=this;methodNames=baseFunctions(source,keys(source))}var chain=!(isObject(options)&&"chain"in options)||!!options.chain,isFunc=isFunction(object);arrayEach(methodNames,(function(methodName){var func=source[methodName];object[methodName]=func;if(isFunc){object.prototype[methodName]=function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=copyArray(this.__actions__);actions.push({func:func,args:arguments,thisArg:object});result.__chain__=chainAll;return result}return func.apply(object,arrayPush([this.value()],arguments))}}}));return object}function noConflict(){if(root._===this){root._=oldDash}return this}function noop(){}function nthArg(n){n=toInteger(n);return baseRest((function(args){return baseNth(args,n)}))}var over=createOver(arrayMap);var overEvery=createOver(arrayEvery);var overSome=createOver(arraySome);function property(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}function propertyOf(object){return function(path){return object==null?undefined:baseGet(object,path)}}var range=createRange();var rangeRight=createRange(true);function stubArray(){return[]}function stubFalse(){return false}function stubObject(){return{}}function stubString(){return""}function stubTrue(){return true}function times(n,iteratee){n=toInteger(n);if(n<1||n>MAX_SAFE_INTEGER){return[]}var index=MAX_ARRAY_LENGTH,length=nativeMin(n,MAX_ARRAY_LENGTH);iteratee=getIteratee(iteratee);n-=MAX_ARRAY_LENGTH;var result=baseTimes(length,iteratee);while(++index<n){iteratee(index)}return result}function toPath(value){if(isArray(value)){return arrayMap(value,toKey)}return isSymbol(value)?[value]:copyArray(stringToPath(toString(value)))}function uniqueId(prefix){var id=++idCounter;return toString(prefix)+id}var add=createMathOperation((function(augend,addend){return augend+addend}),0);var ceil=createRound("ceil");var divide=createMathOperation((function(dividend,divisor){return dividend/divisor}),1);var floor=createRound("floor");function max(array){return array&&array.length?baseExtremum(array,identity,baseGt):undefined}function maxBy(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee,2),baseGt):undefined}function mean(array){return baseMean(array,identity)}function meanBy(array,iteratee){return baseMean(array,getIteratee(iteratee,2))}function min(array){return array&&array.length?baseExtremum(array,identity,baseLt):undefined}function minBy(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee,2),baseLt):undefined}var multiply=createMathOperation((function(multiplier,multiplicand){return multiplier*multiplicand}),1);var round=createRound("round");var subtract=createMathOperation((function(minuend,subtrahend){return minuend-subtrahend}),0);function sum(array){return array&&array.length?baseSum(array,identity):0}function sumBy(array,iteratee){return array&&array.length?baseSum(array,getIteratee(iteratee,2)):0}lodash.after=after;lodash.ary=ary;lodash.assign=assign;lodash.assignIn=assignIn;lodash.assignInWith=assignInWith;lodash.assignWith=assignWith;lodash.at=at;lodash.before=before;lodash.bind=bind;lodash.bindAll=bindAll;lodash.bindKey=bindKey;lodash.castArray=castArray;lodash.chain=chain;lodash.chunk=chunk;lodash.compact=compact;lodash.concat=concat;lodash.cond=cond;lodash.conforms=conforms;lodash.constant=constant;lodash.countBy=countBy;lodash.create=create;lodash.curry=curry;lodash.curryRight=curryRight;lodash.debounce=debounce;lodash.defaults=defaults;lodash.defaultsDeep=defaultsDeep;lodash.defer=defer;lodash.delay=delay;lodash.difference=difference;lodash.differenceBy=differenceBy;lodash.differenceWith=differenceWith;lodash.drop=drop;lodash.dropRight=dropRight;lodash.dropRightWhile=dropRightWhile;lodash.dropWhile=dropWhile;lodash.fill=fill;lodash.filter=filter;lodash.flatMap=flatMap;lodash.flatMapDeep=flatMapDeep;lodash.flatMapDepth=flatMapDepth;lodash.flatten=flatten;lodash.flattenDeep=flattenDeep;lodash.flattenDepth=flattenDepth;lodash.flip=flip;lodash.flow=flow;lodash.flowRight=flowRight;lodash.fromPairs=fromPairs;lodash.functions=functions;lodash.functionsIn=functionsIn;lodash.groupBy=groupBy;lodash.initial=initial;lodash.intersection=intersection;lodash.intersectionBy=intersectionBy;lodash.intersectionWith=intersectionWith;lodash.invert=invert;lodash.invertBy=invertBy;lodash.invokeMap=invokeMap;lodash.iteratee=iteratee;lodash.keyBy=keyBy;lodash.keys=keys;lodash.keysIn=keysIn;lodash.map=map;lodash.mapKeys=mapKeys;lodash.mapValues=mapValues;lodash.matches=matches;lodash.matchesProperty=matchesProperty;lodash.memoize=memoize;lodash.merge=merge;lodash.mergeWith=mergeWith;lodash.method=method;lodash.methodOf=methodOf;lodash.mixin=mixin;lodash.negate=negate;lodash.nthArg=nthArg;lodash.omit=omit;lodash.omitBy=omitBy;lodash.once=once;lodash.orderBy=orderBy;lodash.over=over;lodash.overArgs=overArgs;lodash.overEvery=overEvery;lodash.overSome=overSome;lodash.partial=partial;lodash.partialRight=partialRight;lodash.partition=partition;lodash.pick=pick;lodash.pickBy=pickBy;lodash.property=property;lodash.propertyOf=propertyOf;lodash.pull=pull;lodash.pullAll=pullAll;lodash.pullAllBy=pullAllBy;lodash.pullAllWith=pullAllWith;lodash.pullAt=pullAt;lodash.range=range;lodash.rangeRight=rangeRight;lodash.rearg=rearg;lodash.reject=reject;lodash.remove=remove;lodash.rest=rest;lodash.reverse=reverse;lodash.sampleSize=sampleSize;lodash.set=set;lodash.setWith=setWith;lodash.shuffle=shuffle;lodash.slice=slice;lodash.sortBy=sortBy;lodash.sortedUniq=sortedUniq;lodash.sortedUniqBy=sortedUniqBy;lodash.split=split;lodash.spread=spread;lodash.tail=tail;lodash.take=take;lodash.takeRight=takeRight;lodash.takeRightWhile=takeRightWhile;lodash.takeWhile=takeWhile;lodash.tap=tap;lodash.throttle=throttle;lodash.thru=thru;lodash.toArray=toArray;lodash.toPairs=toPairs;lodash.toPairsIn=toPairsIn;lodash.toPath=toPath;lodash.toPlainObject=toPlainObject;lodash.transform=transform;lodash.unary=unary;lodash.union=union;lodash.unionBy=unionBy;lodash.unionWith=unionWith;lodash.uniq=uniq;lodash.uniqBy=uniqBy;lodash.uniqWith=uniqWith;lodash.unset=unset;lodash.unzip=unzip;lodash.unzipWith=unzipWith;lodash.update=update;lodash.updateWith=updateWith;lodash.values=values;lodash.valuesIn=valuesIn;lodash.without=without;lodash.words=words;lodash.wrap=wrap;lodash.xor=xor;lodash.xorBy=xorBy;lodash.xorWith=xorWith;lodash.zip=zip;lodash.zipObject=zipObject;lodash.zipObjectDeep=zipObjectDeep;lodash.zipWith=zipWith;lodash.entries=toPairs;lodash.entriesIn=toPairsIn;lodash.extend=assignIn;lodash.extendWith=assignInWith;mixin(lodash,lodash);lodash.add=add;lodash.attempt=attempt;lodash.camelCase=camelCase;lodash.capitalize=capitalize;lodash.ceil=ceil;lodash.clamp=clamp;lodash.clone=clone;lodash.cloneDeep=cloneDeep;lodash.cloneDeepWith=cloneDeepWith;lodash.cloneWith=cloneWith;lodash.conformsTo=conformsTo;lodash.deburr=deburr;lodash.defaultTo=defaultTo;lodash.divide=divide;lodash.endsWith=endsWith;lodash.eq=eq;lodash.escape=escape;lodash.escapeRegExp=escapeRegExp;lodash.every=every;lodash.find=find;lodash.findIndex=findIndex;lodash.findKey=findKey;lodash.findLast=findLast;lodash.findLastIndex=findLastIndex;lodash.findLastKey=findLastKey;lodash.floor=floor;lodash.forEach=forEach;lodash.forEachRight=forEachRight;lodash.forIn=forIn;lodash.forInRight=forInRight;lodash.forOwn=forOwn;lodash.forOwnRight=forOwnRight;lodash.get=get;lodash.gt=gt;lodash.gte=gte;lodash.has=has;lodash.hasIn=hasIn;lodash.head=head;lodash.identity=identity;lodash.includes=includes;lodash.indexOf=indexOf;lodash.inRange=inRange;lodash.invoke=invoke;lodash.isArguments=isArguments;lodash.isArray=isArray;lodash.isArrayBuffer=isArrayBuffer;lodash.isArrayLike=isArrayLike;lodash.isArrayLikeObject=isArrayLikeObject;lodash.isBoolean=isBoolean;lodash.isBuffer=isBuffer;lodash.isDate=isDate;lodash.isElement=isElement;lodash.isEmpty=isEmpty;lodash.isEqual=isEqual;lodash.isEqualWith=isEqualWith;lodash.isError=isError;lodash.isFinite=isFinite;lodash.isFunction=isFunction;lodash.isInteger=isInteger;lodash.isLength=isLength;lodash.isMap=isMap;lodash.isMatch=isMatch;lodash.isMatchWith=isMatchWith;lodash.isNaN=isNaN;lodash.isNative=isNative;lodash.isNil=isNil;lodash.isNull=isNull;lodash.isNumber=isNumber;lodash.isObject=isObject;lodash.isObjectLike=isObjectLike;lodash.isPlainObject=isPlainObject;lodash.isRegExp=isRegExp;lodash.isSafeInteger=isSafeInteger;lodash.isSet=isSet;lodash.isString=isString;lodash.isSymbol=isSymbol;lodash.isTypedArray=isTypedArray;lodash.isUndefined=isUndefined;lodash.isWeakMap=isWeakMap;lodash.isWeakSet=isWeakSet;lodash.join=join;lodash.kebabCase=kebabCase;lodash.last=last;lodash.lastIndexOf=lastIndexOf;lodash.lowerCase=lowerCase;lodash.lowerFirst=lowerFirst;lodash.lt=lt;lodash.lte=lte;lodash.max=max;lodash.maxBy=maxBy;lodash.mean=mean;lodash.meanBy=meanBy;lodash.min=min;lodash.minBy=minBy;lodash.stubArray=stubArray;lodash.stubFalse=stubFalse;lodash.stubObject=stubObject;lodash.stubString=stubString;lodash.stubTrue=stubTrue;lodash.multiply=multiply;lodash.nth=nth;lodash.noConflict=noConflict;lodash.noop=noop;lodash.now=now;lodash.pad=pad;lodash.padEnd=padEnd;lodash.padStart=padStart;lodash.parseInt=parseInt;lodash.random=random;lodash.reduce=reduce;lodash.reduceRight=reduceRight;lodash.repeat=repeat;lodash.replace=replace;lodash.result=result;lodash.round=round;lodash.runInContext=runInContext;lodash.sample=sample;lodash.size=size;lodash.snakeCase=snakeCase;lodash.some=some;lodash.sortedIndex=sortedIndex;lodash.sortedIndexBy=sortedIndexBy;lodash.sortedIndexOf=sortedIndexOf;lodash.sortedLastIndex=sortedLastIndex;lodash.sortedLastIndexBy=sortedLastIndexBy;lodash.sortedLastIndexOf=sortedLastIndexOf;lodash.startCase=startCase;lodash.startsWith=startsWith;lodash.subtract=subtract;lodash.sum=sum;lodash.sumBy=sumBy;lodash.template=template;lodash.times=times;lodash.toFinite=toFinite;lodash.toInteger=toInteger;lodash.toLength=toLength;lodash.toLower=toLower;lodash.toNumber=toNumber;lodash.toSafeInteger=toSafeInteger;lodash.toString=toString;lodash.toUpper=toUpper;lodash.trim=trim;lodash.trimEnd=trimEnd;lodash.trimStart=trimStart;lodash.truncate=truncate;lodash.unescape=unescape;lodash.uniqueId=uniqueId;lodash.upperCase=upperCase;lodash.upperFirst=upperFirst;lodash.each=forEach;lodash.eachRight=forEachRight;lodash.first=head;mixin(lodash,function(){var source={};baseForOwn(lodash,(function(func,methodName){if(!hasOwnProperty.call(lodash.prototype,methodName)){source[methodName]=func}}));return source}(),{chain:false});lodash.VERSION=VERSION;arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(methodName){lodash[methodName].placeholder=lodash}));arrayEach(["drop","take"],(function(methodName,index){LazyWrapper.prototype[methodName]=function(n){n=n===undefined?1:nativeMax(toInteger(n),0);var result=this.__filtered__&&!index?new LazyWrapper(this):this.clone();if(result.__filtered__){result.__takeCount__=nativeMin(n,result.__takeCount__)}else{result.__views__.push({size:nativeMin(n,MAX_ARRAY_LENGTH),type:methodName+(result.__dir__<0?"Right":"")})}return result};LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}));arrayEach(["filter","map","takeWhile"],(function(methodName,index){var type=index+1,isFilter=type==LAZY_FILTER_FLAG||type==LAZY_WHILE_FLAG;LazyWrapper.prototype[methodName]=function(iteratee){var result=this.clone();result.__iteratees__.push({iteratee:getIteratee(iteratee,3),type:type});result.__filtered__=result.__filtered__||isFilter;return result}}));arrayEach(["head","last"],(function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}));arrayEach(["initial","tail"],(function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}));LazyWrapper.prototype.compact=function(){return this.filter(identity)};LazyWrapper.prototype.find=function(predicate){return this.filter(predicate).head()};LazyWrapper.prototype.findLast=function(predicate){return this.reverse().find(predicate)};LazyWrapper.prototype.invokeMap=baseRest((function(path,args){if(typeof path=="function"){return new LazyWrapper(this)}return this.map((function(value){return baseInvoke(value,path,args)}))}));LazyWrapper.prototype.reject=function(predicate){return this.filter(negate(getIteratee(predicate)))};LazyWrapper.prototype.slice=function(start,end){start=toInteger(start);var result=this;if(result.__filtered__&&(start>0||end<0)){return new LazyWrapper(result)}if(start<0){result=result.takeRight(-start)}else if(start){result=result.drop(start)}if(end!==undefined){end=toInteger(end);result=end<0?result.dropRight(-end):result.take(end-start)}return result};LazyWrapper.prototype.takeRightWhile=function(predicate){return this.reverse().takeWhile(predicate).reverse()};LazyWrapper.prototype.toArray=function(){return this.take(MAX_ARRAY_LENGTH)};baseForOwn(LazyWrapper.prototype,(function(func,methodName){var checkIteratee=/^(?:filter|find|map|reject)|While$/.test(methodName),isTaker=/^(?:head|last)$/.test(methodName),lodashFunc=lodash[isTaker?"take"+(methodName=="last"?"Right":""):methodName],retUnwrapped=isTaker||/^find/.test(methodName);if(!lodashFunc){return}lodash.prototype[methodName]=function(){var value=this.__wrapped__,args=isTaker?[1]:arguments,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value);var interceptor=function(value){var result=lodashFunc.apply(lodash,arrayPush([value],args));return isTaker&&chainAll?result[0]:result};if(useLazy&&checkIteratee&&typeof iteratee=="function"&&iteratee.length!=1){isLazy=useLazy=false}var chainAll=this.__chain__,isHybrid=!!this.__actions__.length,isUnwrapped=retUnwrapped&&!chainAll,onlyLazy=isLazy&&!isHybrid;if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);result.__actions__.push({func:thru,args:[interceptor],thisArg:undefined});return new LodashWrapper(result,chainAll)}if(isUnwrapped&&onlyLazy){return func.apply(this,args)}result=this.thru(interceptor);return isUnwrapped?isTaker?result.value()[0]:result.value():result}}));arrayEach(["pop","push","shift","sort","splice","unshift"],(function(methodName){var func=arrayProto[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:pop|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;if(retUnwrapped&&!this.__chain__){var value=this.value();return func.apply(isArray(value)?value:[],args)}return this[chainName]((function(value){return func.apply(isArray(value)?value:[],args)}))}}));baseForOwn(LazyWrapper.prototype,(function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name+"";if(!hasOwnProperty.call(realNames,key)){realNames[key]=[]}realNames[key].push({name:methodName,func:lodashFunc})}}));realNames[createHybrid(undefined,WRAP_BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}];LazyWrapper.prototype.clone=lazyClone;LazyWrapper.prototype.reverse=lazyReverse;LazyWrapper.prototype.value=lazyValue;lodash.prototype.at=wrapperAt;lodash.prototype.chain=wrapperChain;lodash.prototype.commit=wrapperCommit;lodash.prototype.next=wrapperNext;lodash.prototype.plant=wrapperPlant;lodash.prototype.reverse=wrapperReverse;lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue;lodash.prototype.first=lodash.prototype.head;if(symIterator){lodash.prototype[symIterator]=wrapperToIterator}return lodash};var _=runInContext();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){root._=_;define((function(){return _}))}else if(freeModule){(freeModule.exports=_)._=_;freeExports._=_}else{root._=_}}).call(this)}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],349:[function(require,module,exports){"use strict";var toPosInt=require("es5-ext/number/to-pos-integer"),create=Object.create,hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(limit){var size=0,base=1,queue=create(null),map=create(null),index=0,del;limit=toPosInt(limit);return{hit:function(id){var oldIndex=map[id],nuIndex=++index;queue[nuIndex]=id;map[id]=nuIndex;if(!oldIndex){++size;if(size<=limit)return;id=queue[base];del(id);return id}delete queue[oldIndex];if(base!==oldIndex)return;while(!hasOwnProperty.call(queue,++base))continue},delete:del=function(id){var oldIndex=map[id];if(!oldIndex)return;delete queue[oldIndex];delete map[id];--size;if(base!==oldIndex)return;if(!size){index=0;base=1;return}while(!hasOwnProperty.call(queue,++base))continue},clear:function(){size=0;base=1;queue=create(null);map=create(null);index=0}}}},{"es5-ext/number/to-pos-integer":208}],350:[function(require,module,exports){var LZString=function(){var f=String.fromCharCode;var keyStrBase64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var keyStrUriSafe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$";var baseReverseDic={};function getBaseValue(alphabet,character){if(!baseReverseDic[alphabet]){baseReverseDic[alphabet]={};for(var i=0;i<alphabet.length;i++){baseReverseDic[alphabet][alphabet.charAt(i)]=i}}return baseReverseDic[alphabet][character]}var LZString={compressToBase64:function(input){if(input==null)return"";var res=LZString._compress(input,6,(function(a){return keyStrBase64.charAt(a)}));switch(res.length%4){default:case 0:return res;case 1:return res+"===";case 2:return res+"==";case 3:return res+"="}},decompressFromBase64:function(input){if(input==null)return"";if(input=="")return null;return LZString._decompress(input.length,32,(function(index){return getBaseValue(keyStrBase64,input.charAt(index))}))},compressToUTF16:function(input){if(input==null)return"";return LZString._compress(input,15,(function(a){return f(a+32)}))+" "},decompressFromUTF16:function(compressed){if(compressed==null)return"";if(compressed=="")return null;return LZString._decompress(compressed.length,16384,(function(index){return compressed.charCodeAt(index)-32}))},compressToUint8Array:function(uncompressed){var compressed=LZString.compress(uncompressed);var buf=new Uint8Array(compressed.length*2);for(var i=0,TotalLen=compressed.length;i<TotalLen;i++){var current_value=compressed.charCodeAt(i);buf[i*2]=current_value>>>8;buf[i*2+1]=current_value%256}return buf},decompressFromUint8Array:function(compressed){if(compressed===null||compressed===undefined){return LZString.decompress(compressed)}else{var buf=new Array(compressed.length/2);for(var i=0,TotalLen=buf.length;i<TotalLen;i++){buf[i]=compressed[i*2]*256+compressed[i*2+1]}var result=[];buf.forEach((function(c){result.push(f(c))}));return LZString.decompress(result.join(""))}},compressToEncodedURIComponent:function(input){if(input==null)return"";return LZString._compress(input,6,(function(a){return keyStrUriSafe.charAt(a)}))},decompressFromEncodedURIComponent:function(input){if(input==null)return"";if(input=="")return null;input=input.replace(/ /g,"+");return LZString._decompress(input.length,32,(function(index){return getBaseValue(keyStrUriSafe,input.charAt(index))}))},compress:function(uncompressed){return LZString._compress(uncompressed,16,(function(a){return f(a)}))},_compress:function(uncompressed,bitsPerChar,getCharFromInt){if(uncompressed==null)return"";var i,value,context_dictionary={},context_dictionaryToCreate={},context_c="",context_wc="",context_w="",context_enlargeIn=2,context_dictSize=3,context_numBits=2,context_data=[],context_data_val=0,context_data_position=0,ii;for(ii=0;ii<uncompressed.length;ii+=1){context_c=uncompressed.charAt(ii);if(!Object.prototype.hasOwnProperty.call(context_dictionary,context_c)){context_dictionary[context_c]=context_dictSize++;context_dictionaryToCreate[context_c]=true}context_wc=context_w+context_c;if(Object.prototype.hasOwnProperty.call(context_dictionary,context_wc)){context_w=context_wc}else{if(Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)){if(context_w.charCodeAt(0)<256){for(i=0;i<context_numBits;i++){context_data_val=context_data_val<<1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}}value=context_w.charCodeAt(0);for(i=0;i<8;i++){context_data_val=context_data_val<<1|value&1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=value>>1}}else{value=1;for(i=0;i<context_numBits;i++){context_data_val=context_data_val<<1|value;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=0}value=context_w.charCodeAt(0);for(i=0;i<16;i++){context_data_val=context_data_val<<1|value&1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=value>>1}}context_enlargeIn--;if(context_enlargeIn==0){context_enlargeIn=Math.pow(2,context_numBits);context_numBits++}delete context_dictionaryToCreate[context_w]}else{value=context_dictionary[context_w];for(i=0;i<context_numBits;i++){context_data_val=context_data_val<<1|value&1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=value>>1}}context_enlargeIn--;if(context_enlargeIn==0){context_enlargeIn=Math.pow(2,context_numBits);context_numBits++}context_dictionary[context_wc]=context_dictSize++;context_w=String(context_c)}}if(context_w!==""){if(Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)){if(context_w.charCodeAt(0)<256){for(i=0;i<context_numBits;i++){context_data_val=context_data_val<<1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}}value=context_w.charCodeAt(0);for(i=0;i<8;i++){context_data_val=context_data_val<<1|value&1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=value>>1}}else{value=1;for(i=0;i<context_numBits;i++){context_data_val=context_data_val<<1|value;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=0}value=context_w.charCodeAt(0);for(i=0;i<16;i++){context_data_val=context_data_val<<1|value&1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=value>>1}}context_enlargeIn--;if(context_enlargeIn==0){context_enlargeIn=Math.pow(2,context_numBits);context_numBits++}delete context_dictionaryToCreate[context_w]}else{value=context_dictionary[context_w];for(i=0;i<context_numBits;i++){context_data_val=context_data_val<<1|value&1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=value>>1}}context_enlargeIn--;if(context_enlargeIn==0){context_enlargeIn=Math.pow(2,context_numBits);context_numBits++}}value=2;for(i=0;i<context_numBits;i++){context_data_val=context_data_val<<1|value&1;if(context_data_position==bitsPerChar-1){context_data_position=0;context_data.push(getCharFromInt(context_data_val));context_data_val=0}else{context_data_position++}value=value>>1}while(true){context_data_val=context_data_val<<1;if(context_data_position==bitsPerChar-1){context_data.push(getCharFromInt(context_data_val));break}else context_data_position++}return context_data.join("")},decompress:function(compressed){if(compressed==null)return"";if(compressed=="")return null;return LZString._decompress(compressed.length,32768,(function(index){return compressed.charCodeAt(index)}))},_decompress:function(length,resetValue,getNextValue){var dictionary=[],next,enlargeIn=4,dictSize=4,numBits=3,entry="",result=[],i,w,bits,resb,maxpower,power,c,data={val:getNextValue(0),position:resetValue,index:1};for(i=0;i<3;i+=1){dictionary[i]=i}bits=0;maxpower=Math.pow(2,2);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=resetValue;data.val=getNextValue(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}switch(next=bits){case 0:bits=0;maxpower=Math.pow(2,8);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=resetValue;data.val=getNextValue(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}c=f(bits);break;case 1:bits=0;maxpower=Math.pow(2,16);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=resetValue;data.val=getNextValue(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}c=f(bits);break;case 2:return""}dictionary[3]=c;w=c;result.push(c);while(true){if(data.index>length){return""}bits=0;maxpower=Math.pow(2,numBits);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=resetValue;data.val=getNextValue(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}switch(c=bits){case 0:bits=0;maxpower=Math.pow(2,8);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=resetValue;data.val=getNextValue(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}dictionary[dictSize++]=f(bits);c=dictSize-1;enlargeIn--;break;case 1:bits=0;maxpower=Math.pow(2,16);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=resetValue;data.val=getNextValue(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}dictionary[dictSize++]=f(bits);c=dictSize-1;enlargeIn--;break;case 2:return result.join("")}if(enlargeIn==0){enlargeIn=Math.pow(2,numBits);numBits++}if(dictionary[c]){entry=dictionary[c]}else{if(c===dictSize){entry=w+w.charAt(0)}else{return null}}result.push(entry);dictionary[dictSize++]=w+entry.charAt(0);enlargeIn--;w=entry;if(enlargeIn==0){enlargeIn=Math.pow(2,numBits);numBits++}}}};return LZString}();if(typeof define==="function"&&define.amd){define((function(){return LZString}))}else if(typeof module!=="undefined"&&module!=null){module.exports=LZString}},{}],351:[function(require,module,exports){(function(process){(function(){"use strict";const fs=require("fs");const path=require("path");const{promisify:promisify}=require("util");const semver=require("semver");const useNativeRecursiveOption=semver.satisfies(process.version,">=10.12.0");const checkPath=pth=>{if(process.platform==="win32"){const pathHasInvalidWinCharacters=/[<>:"|?*]/.test(pth.replace(path.parse(pth).root,""));if(pathHasInvalidWinCharacters){const error=new Error(`Path contains invalid characters: ${pth}`);error.code="EINVAL";throw error}}};const processOptions=options=>{const defaults={mode:511,fs:fs};return{...defaults,...options}};const permissionError=pth=>{const error=new Error(`operation not permitted, mkdir '${pth}'`);error.code="EPERM";error.errno=-4048;error.path=pth;error.syscall="mkdir";return error};const makeDir=async(input,options)=>{checkPath(input);options=processOptions(options);const mkdir=promisify(options.fs.mkdir);const stat=promisify(options.fs.stat);if(useNativeRecursiveOption&&options.fs.mkdir===fs.mkdir){const pth=path.resolve(input);await mkdir(pth,{mode:options.mode,recursive:true});return pth}const make=async pth=>{try{await mkdir(pth,options.mode);return pth}catch(error){if(error.code==="EPERM"){throw error}if(error.code==="ENOENT"){if(path.dirname(pth)===pth){throw permissionError(pth)}if(error.message.includes("null bytes")){throw error}await make(path.dirname(pth));return make(pth)}try{const stats=await stat(pth);if(!stats.isDirectory()){throw new Error("The path is not a directory")}}catch(_){throw error}return pth}};return make(path.resolve(input))};module.exports=makeDir;module.exports.sync=(input,options)=>{checkPath(input);options=processOptions(options);if(useNativeRecursiveOption&&options.fs.mkdirSync===fs.mkdirSync){const pth=path.resolve(input);fs.mkdirSync(pth,{mode:options.mode,recursive:true});return pth}const make=pth=>{try{options.fs.mkdirSync(pth,options.mode)}catch(error){if(error.code==="EPERM"){throw error}if(error.code==="ENOENT"){if(path.dirname(pth)===pth){throw permissionError(pth)}if(error.message.includes("null bytes")){throw error}make(path.dirname(pth));return make(pth)}try{if(!options.fs.statSync(pth).isDirectory()){throw new Error("The path is not a directory")}}catch(_){throw error}}return pth};return make(path.resolve(input))}}).call(this)}).call(this,require("_process"))},{_process:378,fs:149,path:377,semver:397,util:442}],352:[function(require,module,exports){"use strict";var aFrom=require("es5-ext/array/from"),objectMap=require("es5-ext/object/map"),mixin=require("es5-ext/object/mixin"),defineLength=require("es5-ext/function/_define-length"),nextTick=require("next-tick");var slice=Array.prototype.slice,apply=Function.prototype.apply,create=Object.create;require("../lib/registered-extensions").async=function(tbi,conf){var waiting=create(null),cache=create(null),base=conf.memoized,original=conf.original,currentCallback,currentContext,currentArgs;conf.memoized=defineLength((function(arg){var args=arguments,last=args[args.length-1];if(typeof last==="function"){currentCallback=last;args=slice.call(args,0,-1)}return base.apply(currentContext=this,currentArgs=args)}),base);try{mixin(conf.memoized,base)}catch(ignore){}conf.on("get",(function(id){var cb,context,args;if(!currentCallback)return;if(waiting[id]){if(typeof waiting[id]==="function")waiting[id]=[waiting[id],currentCallback];else waiting[id].push(currentCallback);currentCallback=null;return}cb=currentCallback;context=currentContext;args=currentArgs;currentCallback=currentContext=currentArgs=null;nextTick((function(){var data;if(hasOwnProperty.call(cache,id)){data=cache[id];conf.emit("getasync",id,args,context);apply.call(cb,data.context,data.args)}else{currentCallback=cb;currentContext=context;currentArgs=args;base.apply(context,args)}}))}));conf.original=function(){var args,cb,origCb,result;if(!currentCallback)return apply.call(original,this,arguments);args=aFrom(arguments);cb=function self(err){var cb,args,id=self.id;if(id==null){nextTick(apply.bind(self,this,arguments));return undefined}delete self.id;cb=waiting[id];delete waiting[id];if(!cb){return undefined}args=aFrom(arguments);if(conf.has(id)){if(err){conf.delete(id)}else{cache[id]={context:this,args:args};conf.emit("setasync",id,typeof cb==="function"?1:cb.length)}}if(typeof cb==="function"){result=apply.call(cb,this,args)}else{cb.forEach((function(cb){result=apply.call(cb,this,args)}),this)}return result};origCb=currentCallback;currentCallback=currentContext=currentArgs=null;args.push(cb);result=apply.call(original,this,args);cb.cb=origCb;currentCallback=cb;return result};conf.on("set",(function(id){if(!currentCallback){conf.delete(id);return}if(waiting[id]){if(typeof waiting[id]==="function")waiting[id]=[waiting[id],currentCallback.cb];else waiting[id].push(currentCallback.cb)}else{waiting[id]=currentCallback.cb}delete currentCallback.cb;currentCallback.id=id;currentCallback=null}));conf.on("delete",(function(id){var result;if(hasOwnProperty.call(waiting,id))return;if(!cache[id])return;result=cache[id];delete cache[id];conf.emit("deleteasync",id,slice.call(result.args,1))}));conf.on("clear",(function(){var oldCache=cache;cache=create(null);conf.emit("clearasync",objectMap(oldCache,(function(data){return slice.call(data.args,1)})))}))}},{"../lib/registered-extensions":361,"es5-ext/array/from":185,"es5-ext/function/_define-length":192,"es5-ext/object/map":224,"es5-ext/object/mixin":225,"next-tick":374}],353:[function(require,module,exports){"use strict";var callable=require("es5-ext/object/valid-callable"),forEach=require("es5-ext/object/for-each"),extensions=require("../lib/registered-extensions"),apply=Function.prototype.apply;extensions.dispose=function(dispose,conf,options){var del;callable(dispose);if(options.async&&extensions.async||options.promise&&extensions.promise){conf.on("deleteasync",del=function(id,resultArray){apply.call(dispose,null,resultArray)});conf.on("clearasync",(function(cache){forEach(cache,(function(result,id){del(id,result)}))}));return}conf.on("delete",del=function(id,result){dispose(result)});conf.on("clear",(function(cache){forEach(cache,(function(result,id){del(id,result)}))}))}},{"../lib/registered-extensions":361,"es5-ext/object/for-each":216,"es5-ext/object/valid-callable":231}],354:[function(require,module,exports){"use strict";var aFrom=require("es5-ext/array/from"),forEach=require("es5-ext/object/for-each"),nextTick=require("next-tick"),isPromise=require("is-promise"),timeout=require("timers-ext/valid-timeout"),extensions=require("../lib/registered-extensions");var noop=Function.prototype,max=Math.max,min=Math.min,create=Object.create;extensions.maxAge=function(maxAge,conf,options){var timeouts,postfix,preFetchAge,preFetchTimeouts;maxAge=timeout(maxAge);if(!maxAge)return;timeouts=create(null);postfix=options.async&&extensions.async||options.promise&&extensions.promise?"async":"";conf.on("set"+postfix,(function(id){timeouts[id]=setTimeout((function(){conf.delete(id)}),maxAge);if(typeof timeouts[id].unref==="function")timeouts[id].unref();if(!preFetchTimeouts)return;if(preFetchTimeouts[id]){if(preFetchTimeouts[id]!=="nextTick")clearTimeout(preFetchTimeouts[id])}preFetchTimeouts[id]=setTimeout((function(){delete preFetchTimeouts[id]}),preFetchAge);if(typeof preFetchTimeouts[id].unref==="function")preFetchTimeouts[id].unref()}));conf.on("delete"+postfix,(function(id){clearTimeout(timeouts[id]);delete timeouts[id];if(!preFetchTimeouts)return;if(preFetchTimeouts[id]!=="nextTick")clearTimeout(preFetchTimeouts[id]);delete preFetchTimeouts[id]}));if(options.preFetch){if(options.preFetch===true||isNaN(options.preFetch)){preFetchAge=.333}else{preFetchAge=max(min(Number(options.preFetch),1),0)}if(preFetchAge){preFetchTimeouts={};preFetchAge=(1-preFetchAge)*maxAge;conf.on("get"+postfix,(function(id,args,context){if(!preFetchTimeouts[id]){preFetchTimeouts[id]="nextTick";nextTick((function(){var result;if(preFetchTimeouts[id]!=="nextTick")return;delete preFetchTimeouts[id];conf.delete(id);if(options.async){args=aFrom(args);args.push(noop)}result=conf.memoized.apply(context,args);if(options.promise){if(isPromise(result)){if(typeof result.done==="function")result.done(noop,noop);else result.then(noop,noop)}}}))}}))}}conf.on("clear"+postfix,(function(){forEach(timeouts,(function(id){clearTimeout(id)}));timeouts={};if(preFetchTimeouts){forEach(preFetchTimeouts,(function(id){if(id!=="nextTick")clearTimeout(id)}));preFetchTimeouts={}}}))}},{"../lib/registered-extensions":361,"es5-ext/array/from":185,"es5-ext/object/for-each":216,"is-promise":284,"next-tick":374,"timers-ext/valid-timeout":423}],355:[function(require,module,exports){"use strict";var toPosInteger=require("es5-ext/number/to-pos-integer"),lruQueue=require("lru-queue"),extensions=require("../lib/registered-extensions");extensions.max=function(max,conf,options){var postfix,queue,hit;max=toPosInteger(max);if(!max)return;queue=lruQueue(max);postfix=options.async&&extensions.async||options.promise&&extensions.promise?"async":"";conf.on("set"+postfix,hit=function(id){id=queue.hit(id);if(id===undefined)return;conf.delete(id)});conf.on("get"+postfix,hit);conf.on("delete"+postfix,queue.delete);conf.on("clear"+postfix,queue.clear)}},{"../lib/registered-extensions":361,"es5-ext/number/to-pos-integer":208,"lru-queue":349}],356:[function(require,module,exports){"use strict";var objectMap=require("es5-ext/object/map"),primitiveSet=require("es5-ext/object/primitive-set"),ensureString=require("es5-ext/object/validate-stringifiable-value"),toShortString=require("es5-ext/to-short-string-representation"),isPromise=require("is-promise"),nextTick=require("next-tick");var create=Object.create,supportedModes=primitiveSet("then","then:finally","done","done:finally");require("../lib/registered-extensions").promise=function(mode,conf){var waiting=create(null),cache=create(null),promises=create(null);if(mode===true){mode=null}else{mode=ensureString(mode);if(!supportedModes[mode]){throw new TypeError("'"+toShortString(mode)+"' is not valid promise mode")}}conf.on("set",(function(id,ignore,promise){var isFailed=false;if(!isPromise(promise)){cache[id]=promise;conf.emit("setasync",id,1);return}waiting[id]=1;promises[id]=promise;var onSuccess=function(result){var count=waiting[id];if(isFailed){throw new Error("Memoizee error: Detected unordered then|done & finally resolution, which "+"in turn makes proper detection of success/failure impossible (when in "+"'done:finally' mode)\n"+"Consider to rely on 'then' or 'done' mode instead.")}if(!count)return;delete waiting[id];cache[id]=result;conf.emit("setasync",id,count)};var onFailure=function(){isFailed=true;if(!waiting[id])return;delete waiting[id];delete promises[id];conf.delete(id)};var resolvedMode=mode;if(!resolvedMode)resolvedMode="then";if(resolvedMode==="then"){var nextTickFailure=function(){nextTick(onFailure)};promise=promise.then((function(result){nextTick(onSuccess.bind(this,result))}),nextTickFailure);if(typeof promise.finally==="function"){promise.finally(nextTickFailure)}}else if(resolvedMode==="done"){if(typeof promise.done!=="function"){throw new Error("Memoizee error: Retrieved promise does not implement 'done' "+"in 'done' mode")}promise.done(onSuccess,onFailure)}else if(resolvedMode==="done:finally"){if(typeof promise.done!=="function"){throw new Error("Memoizee error: Retrieved promise does not implement 'done' "+"in 'done:finally' mode")}if(typeof promise.finally!=="function"){throw new Error("Memoizee error: Retrieved promise does not implement 'finally' "+"in 'done:finally' mode")}promise.done(onSuccess);promise.finally(onFailure)}}));conf.on("get",(function(id,args,context){var promise;if(waiting[id]){++waiting[id];return}promise=promises[id];var emit=function(){conf.emit("getasync",id,args,context)};if(isPromise(promise)){if(typeof promise.done==="function")promise.done(emit);else{promise.then((function(){nextTick(emit)}))}}else{emit()}}));conf.on("delete",(function(id){delete promises[id];if(waiting[id]){delete waiting[id];return}if(!hasOwnProperty.call(cache,id))return;var result=cache[id];delete cache[id];conf.emit("deleteasync",id,[result])}));conf.on("clear",(function(){var oldCache=cache;cache=create(null);waiting=create(null);promises=create(null);conf.emit("clearasync",objectMap(oldCache,(function(data){return[data]})))}))}},{"../lib/registered-extensions":361,"es5-ext/object/map":224,"es5-ext/object/primitive-set":227,"es5-ext/object/validate-stringifiable-value":234,"es5-ext/to-short-string-representation":244,"is-promise":284,"next-tick":374}],357:[function(require,module,exports){"use strict";var d=require("d"),extensions=require("../lib/registered-extensions"),create=Object.create,defineProperties=Object.defineProperties;extensions.refCounter=function(ignore,conf,options){var cache,postfix;cache=create(null);postfix=options.async&&extensions.async||options.promise&&extensions.promise?"async":"";conf.on("set"+postfix,(function(id,length){cache[id]=length||1}));conf.on("get"+postfix,(function(id){++cache[id]}));conf.on("delete"+postfix,(function(id){delete cache[id]}));conf.on("clear"+postfix,(function(){cache={}}));defineProperties(conf.memoized,{deleteRef:d((function(){var id=conf.get(arguments);if(id===null)return null;if(!cache[id])return null;if(!--cache[id]){conf.delete(id);return true}return false})),getRefCount:d((function(){var id=conf.get(arguments);if(id===null)return 0;if(!cache[id])return 0;return cache[id]}))})}},{"../lib/registered-extensions":361,d:175}],358:[function(require,module,exports){"use strict";var normalizeOpts=require("es5-ext/object/normalize-options"),resolveLength=require("./lib/resolve-length"),plain=require("./plain");module.exports=function(fn){var options=normalizeOpts(arguments[1]),length;if(!options.normalizer){length=options.length=resolveLength(options.length,fn.length,options.async);if(length!==0){if(options.primitive){if(length===false){options.normalizer=require("./normalizers/primitive")}else if(length>1){options.normalizer=require("./normalizers/get-primitive-fixed")(length)}}else if(length===false)options.normalizer=require("./normalizers/get")();else if(length===1)options.normalizer=require("./normalizers/get-1")();else options.normalizer=require("./normalizers/get-fixed")(length)}}if(options.async)require("./ext/async");if(options.promise)require("./ext/promise");if(options.dispose)require("./ext/dispose");if(options.maxAge)require("./ext/max-age");if(options.max)require("./ext/max");if(options.refCounter)require("./ext/ref-counter");return plain(fn,options)}},{"./ext/async":352,"./ext/dispose":353,"./ext/max":355,"./ext/max-age":354,"./ext/promise":356,"./ext/ref-counter":357,"./lib/resolve-length":362,"./normalizers/get":369,"./normalizers/get-1":366,"./normalizers/get-fixed":367,"./normalizers/get-primitive-fixed":368,"./normalizers/primitive":370,"./plain":371,"es5-ext/object/normalize-options":226}],359:[function(require,module,exports){"use strict";var customError=require("es5-ext/error/custom"),defineLength=require("es5-ext/function/_define-length"),d=require("d"),ee=require("event-emitter").methods,resolveResolve=require("./resolve-resolve"),resolveNormalize=require("./resolve-normalize");var apply=Function.prototype.apply,call=Function.prototype.call,create=Object.create,defineProperties=Object.defineProperties,on=ee.on,emit=ee.emit;module.exports=function(original,length,options){var cache=create(null),conf,memLength,get,set,del,clear,extDel,extGet,extHas,normalizer,getListeners,setListeners,deleteListeners,memoized,resolve;if(length!==false)memLength=length;else if(isNaN(original.length))memLength=1;else memLength=original.length;if(options.normalizer){normalizer=resolveNormalize(options.normalizer);get=normalizer.get;set=normalizer.set;del=normalizer.delete;clear=normalizer.clear}if(options.resolvers!=null)resolve=resolveResolve(options.resolvers);if(get){memoized=defineLength((function(arg){var id,result,args=arguments;if(resolve)args=resolve(args);id=get(args);if(id!==null){if(hasOwnProperty.call(cache,id)){if(getListeners)conf.emit("get",id,args,this);return cache[id]}}if(args.length===1)result=call.call(original,this,args[0]);else result=apply.call(original,this,args);if(id===null){id=get(args);if(id!==null)throw customError("Circular invocation","CIRCULAR_INVOCATION");id=set(args)}else if(hasOwnProperty.call(cache,id)){throw customError("Circular invocation","CIRCULAR_INVOCATION")}cache[id]=result;if(setListeners)conf.emit("set",id,null,result);return result}),memLength)}else if(length===0){memoized=function(){var result;if(hasOwnProperty.call(cache,"data")){if(getListeners)conf.emit("get","data",arguments,this);return cache.data}if(arguments.length)result=apply.call(original,this,arguments);else result=call.call(original,this);if(hasOwnProperty.call(cache,"data")){throw customError("Circular invocation","CIRCULAR_INVOCATION")}cache.data=result;if(setListeners)conf.emit("set","data",null,result);return result}}else{memoized=function(arg){var result,args=arguments,id;if(resolve)args=resolve(arguments);id=String(args[0]);if(hasOwnProperty.call(cache,id)){if(getListeners)conf.emit("get",id,args,this);return cache[id]}if(args.length===1)result=call.call(original,this,args[0]);else result=apply.call(original,this,args);if(hasOwnProperty.call(cache,id)){throw customError("Circular invocation","CIRCULAR_INVOCATION")}cache[id]=result;if(setListeners)conf.emit("set",id,null,result);return result}}conf={original:original,memoized:memoized,profileName:options.profileName,get:function(args){if(resolve)args=resolve(args);if(get)return get(args);return String(args[0])},has:function(id){return hasOwnProperty.call(cache,id)},delete:function(id){var result;if(!hasOwnProperty.call(cache,id))return;if(del)del(id);result=cache[id];delete cache[id];if(deleteListeners)conf.emit("delete",id,result)},clear:function(){var oldCache=cache;if(clear)clear();cache=create(null);conf.emit("clear",oldCache)},on:function(type,listener){if(type==="get")getListeners=true;else if(type==="set")setListeners=true;else if(type==="delete")deleteListeners=true;return on.call(this,type,listener)},emit:emit,updateEnv:function(){original=conf.original}};if(get){extDel=defineLength((function(arg){var id,args=arguments;if(resolve)args=resolve(args);id=get(args);if(id===null)return;conf.delete(id)}),memLength)}else if(length===0){extDel=function(){return conf.delete("data")}}else{extDel=function(arg){if(resolve)arg=resolve(arguments)[0];return conf.delete(arg)}}extGet=defineLength((function(){var id,args=arguments;if(length===0)return cache.data;if(resolve)args=resolve(args);if(get)id=get(args);else id=String(args[0]);return cache[id]}));extHas=defineLength((function(){var id,args=arguments;if(length===0)return conf.has("data");if(resolve)args=resolve(args);if(get)id=get(args);else id=String(args[0]);if(id===null)return false;return conf.has(id)}));defineProperties(memoized,{__memoized__:d(true),delete:d(extDel),clear:d(conf.clear),_get:d(extGet),_has:d(extHas)});return conf}},{"./resolve-normalize":363,"./resolve-resolve":364,d:175,"es5-ext/error/custom":190,"es5-ext/function/_define-length":192,"event-emitter":260}],360:[function(require,module,exports){"use strict";var forEach=require("es5-ext/object/for-each"),normalizeOpts=require("es5-ext/object/normalize-options"),callable=require("es5-ext/object/valid-callable"),lazy=require("d/lazy"),resolveLength=require("./resolve-length"),extensions=require("./registered-extensions");module.exports=function(memoize){return function(props){forEach(props,(function(desc){var fn=callable(desc.value),length;desc.value=function(options){if(options.getNormalizer){options=normalizeOpts(options);if(length===undefined){length=resolveLength(options.length,fn.length,options.async&&extensions.async)}options.normalizer=options.getNormalizer(length);delete options.getNormalizer}return memoize(fn.bind(this),options)}}));return lazy(props)}}},{"./registered-extensions":361,"./resolve-length":362,"d/lazy":176,"es5-ext/object/for-each":216,"es5-ext/object/normalize-options":226,"es5-ext/object/valid-callable":231}],361:[function(require,module,exports){"use strict"},{}],362:[function(require,module,exports){"use strict";var toPosInt=require("es5-ext/number/to-pos-integer");module.exports=function(optsLength,fnLength,isAsync){var length;if(isNaN(optsLength)){length=fnLength;if(!(length>=0))return 1;if(isAsync&&length)return length-1;return length}if(optsLength===false)return false;return toPosInt(optsLength)}},{"es5-ext/number/to-pos-integer":208}],363:[function(require,module,exports){"use strict";var callable=require("es5-ext/object/valid-callable");module.exports=function(userNormalizer){var normalizer;if(typeof userNormalizer==="function")return{set:userNormalizer,get:userNormalizer};normalizer={get:callable(userNormalizer.get)};if(userNormalizer.set!==undefined){normalizer.set=callable(userNormalizer.set);if(userNormalizer.delete)normalizer.delete=callable(userNormalizer.delete);if(userNormalizer.clear)normalizer.clear=callable(userNormalizer.clear);return normalizer}normalizer.set=normalizer.get;return normalizer}},{"es5-ext/object/valid-callable":231}],364:[function(require,module,exports){"use strict";var toArray=require("es5-ext/array/to-array"),isValue=require("es5-ext/object/is-value"),callable=require("es5-ext/object/valid-callable");var slice=Array.prototype.slice,resolveArgs;resolveArgs=function(args){return this.map((function(resolve,i){return resolve?resolve(args[i]):args[i]})).concat(slice.call(args,this.length))};module.exports=function(resolvers){resolvers=toArray(resolvers);resolvers.forEach((function(resolve){if(isValue(resolve))callable(resolve)}));return resolveArgs.bind(resolvers)}},{"es5-ext/array/to-array":189,"es5-ext/object/is-value":220,"es5-ext/object/valid-callable":231}],365:[function(require,module,exports){"use strict";module.exports=require("./lib/methods")(require("./"))},{"./":358,"./lib/methods":360}],366:[function(require,module,exports){"use strict";var indexOf=require("es5-ext/array/#/e-index-of");module.exports=function(){var lastId=0,argsMap=[],cache=[];return{get:function(args){var index=indexOf.call(argsMap,args[0]);return index===-1?null:cache[index]},set:function(args){argsMap.push(args[0]);cache.push(++lastId);return lastId},delete:function(id){var index=indexOf.call(cache,id);if(index!==-1){argsMap.splice(index,1);cache.splice(index,1)}},clear:function(){argsMap=[];cache=[]}}}},{"es5-ext/array/#/e-index-of":182}],367:[function(require,module,exports){"use strict";var indexOf=require("es5-ext/array/#/e-index-of"),create=Object.create;module.exports=function(length){var lastId=0,map=[[],[]],cache=create(null);return{get:function(args){var index=0,set=map,i;while(index<length-1){i=indexOf.call(set[0],args[index]);if(i===-1)return null;set=set[1][i];++index}i=indexOf.call(set[0],args[index]);if(i===-1)return null;return set[1][i]||null},set:function(args){var index=0,set=map,i;while(index<length-1){i=indexOf.call(set[0],args[index]);if(i===-1){i=set[0].push(args[index])-1;set[1].push([[],[]])}set=set[1][i];++index}i=indexOf.call(set[0],args[index]);if(i===-1){i=set[0].push(args[index])-1}set[1][i]=++lastId;cache[lastId]=args;return lastId},delete:function(id){var index=0,set=map,i,path=[],args=cache[id];while(index<length-1){i=indexOf.call(set[0],args[index]);if(i===-1){return}path.push(set,i);set=set[1][i];++index}i=indexOf.call(set[0],args[index]);if(i===-1){return}id=set[1][i];set[0].splice(i,1);set[1].splice(i,1);while(!set[0].length&&path.length){i=path.pop();set=path.pop();set[0].splice(i,1);set[1].splice(i,1)}delete cache[id]},clear:function(){map=[[],[]];cache=create(null)}}}},{"es5-ext/array/#/e-index-of":182}],368:[function(require,module,exports){"use strict";module.exports=function(length){if(!length){return function(){return""}}return function(args){var id=String(args[0]),i=0,currentLength=length;while(--currentLength){id+=""+args[++i]}return id}}},{}],369:[function(require,module,exports){"use strict";var indexOf=require("es5-ext/array/#/e-index-of");var create=Object.create;module.exports=function(){var lastId=0,map=[],cache=create(null);return{get:function(args){var index=0,set=map,i,length=args.length;if(length===0)return set[length]||null;if(set=set[length]){while(index<length-1){i=indexOf.call(set[0],args[index]);if(i===-1)return null;set=set[1][i];++index}i=indexOf.call(set[0],args[index]);if(i===-1)return null;return set[1][i]||null}return null},set:function(args){var index=0,set=map,i,length=args.length;if(length===0){set[length]=++lastId}else{if(!set[length]){set[length]=[[],[]]}set=set[length];while(index<length-1){i=indexOf.call(set[0],args[index]);if(i===-1){i=set[0].push(args[index])-1;set[1].push([[],[]])}set=set[1][i];++index}i=indexOf.call(set[0],args[index]);if(i===-1){i=set[0].push(args[index])-1}set[1][i]=++lastId}cache[lastId]=args;return lastId},delete:function(id){var index=0,set=map,i,args=cache[id],length=args.length,path=[];if(length===0){delete set[length]}else if(set=set[length]){while(index<length-1){i=indexOf.call(set[0],args[index]);if(i===-1){return}path.push(set,i);set=set[1][i];++index}i=indexOf.call(set[0],args[index]);if(i===-1){return}id=set[1][i];set[0].splice(i,1);set[1].splice(i,1);while(!set[0].length&&path.length){i=path.pop();set=path.pop();set[0].splice(i,1);set[1].splice(i,1)}}delete cache[id]},clear:function(){map=[];cache=create(null)}}}},{"es5-ext/array/#/e-index-of":182}],370:[function(require,module,exports){"use strict";module.exports=function(args){var id,i,length=args.length;if(!length)return"";id=String(args[i=0]);while(--length)id+=""+args[++i];return id}},{}],371:[function(require,module,exports){"use strict";var callable=require("es5-ext/object/valid-callable"),forEach=require("es5-ext/object/for-each"),extensions=require("./lib/registered-extensions"),configure=require("./lib/configure-map"),resolveLength=require("./lib/resolve-length");module.exports=function self(fn){var options,length,conf;callable(fn);options=Object(arguments[1]);if(options.async&&options.promise){throw new Error("Options 'async' and 'promise' cannot be used together")}if(hasOwnProperty.call(fn,"__memoized__")&&!options.force)return fn;length=resolveLength(options.length,fn.length,options.async&&extensions.async);conf=configure(fn,length,options);forEach(extensions,(function(extFn,name){if(options[name])extFn(options[name],conf,options)}));if(self.__profiler__)self.__profiler__(conf);conf.updateEnv();return conf.memoized}},{"./lib/configure-map":359,"./lib/registered-extensions":361,"./lib/resolve-length":362,"es5-ext/object/for-each":216,"es5-ext/object/valid-callable":231}],372:[function(require,module,exports){var s=1e3;var m=s*60;var h=m*60;var d=h*24;var w=d*7;var y=d*365.25;module.exports=function(val,options){options=options||{};var type=typeof val;if(type==="string"&&val.length>0){return parse(val)}else if(type==="number"&&isFinite(val)){return options.long?fmtLong(val):fmtShort(val)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))};function parse(str){str=String(str);if(str.length>100){return}var match=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(str);if(!match){return}var n=parseFloat(match[1]);var type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"weeks":case"week":case"w":return n*w;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return undefined}}function fmtShort(ms){var msAbs=Math.abs(ms);if(msAbs>=d){return Math.round(ms/d)+"d"}if(msAbs>=h){return Math.round(ms/h)+"h"}if(msAbs>=m){return Math.round(ms/m)+"m"}if(msAbs>=s){return Math.round(ms/s)+"s"}return ms+"ms"}function fmtLong(ms){var msAbs=Math.abs(ms);if(msAbs>=d){return plural(ms,msAbs,d,"day")}if(msAbs>=h){return plural(ms,msAbs,h,"hour")}if(msAbs>=m){return plural(ms,msAbs,m,"minute")}if(msAbs>=s){return plural(ms,msAbs,s,"second")}return ms+" ms"}function plural(ms,msAbs,n,name){var isPlural=msAbs>=n*1.5;return Math.round(ms/n)+" "+name+(isPlural?"s":"")}},{}],373:[function(require,module,exports){(function(root,factory){if(typeof module==="object"&&module.exports){module.exports=factory()}else{root.nearley=factory()}})(this,(function(){function Rule(name,symbols,postprocess){this.id=++Rule.highestId;this.name=name;this.symbols=symbols;this.postprocess=postprocess;return this}Rule.highestId=0;Rule.prototype.toString=function(withCursorAt){var symbolSequence=typeof withCursorAt==="undefined"?this.symbols.map(getSymbolShortDisplay).join(" "):this.symbols.slice(0,withCursorAt).map(getSymbolShortDisplay).join(" ")+" ● "+this.symbols.slice(withCursorAt).map(getSymbolShortDisplay).join(" ");return this.name+" → "+symbolSequence};function State(rule,dot,reference,wantedBy){this.rule=rule;this.dot=dot;this.reference=reference;this.data=[];this.wantedBy=wantedBy;this.isComplete=this.dot===rule.symbols.length}State.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)};State.prototype.nextState=function(child){var state=new State(this.rule,this.dot+1,this.reference,this.wantedBy);state.left=this;state.right=child;if(state.isComplete){state.data=state.build();state.right=undefined}return state};State.prototype.build=function(){var children=[];var node=this;do{children.push(node.right.data);node=node.left}while(node.left);children.reverse();return children};State.prototype.finish=function(){if(this.rule.postprocess){this.data=this.rule.postprocess(this.data,this.reference,Parser.fail)}};function Column(grammar,index){this.grammar=grammar;this.index=index;this.states=[];this.wants={};this.scannable=[];this.completed={}}Column.prototype.process=function(nextColumn){var states=this.states;var wants=this.wants;var completed=this.completed;for(var w=0;w<states.length;w++){var state=states[w];if(state.isComplete){state.finish();if(state.data!==Parser.fail){var wantedBy=state.wantedBy;for(var i=wantedBy.length;i--;){var left=wantedBy[i];this.complete(left,state)}if(state.reference===this.index){var exp=state.rule.name;(this.completed[exp]=this.completed[exp]||[]).push(state)}}}else{var exp=state.rule.symbols[state.dot];if(typeof exp!=="string"){this.scannable.push(state);continue}if(wants[exp]){wants[exp].push(state);if(completed.hasOwnProperty(exp)){var nulls=completed[exp];for(var i=0;i<nulls.length;i++){var right=nulls[i];this.complete(state,right)}}}else{wants[exp]=[state];this.predict(exp)}}}};Column.prototype.predict=function(exp){var rules=this.grammar.byName[exp]||[];for(var i=0;i<rules.length;i++){var r=rules[i];var wantedBy=this.wants[exp];var s=new State(r,0,this.index,wantedBy);this.states.push(s)}};Column.prototype.complete=function(left,right){var copy=left.nextState(right);this.states.push(copy)};function Grammar(rules,start){this.rules=rules;this.start=start||this.rules[0].name;var byName=this.byName={};this.rules.forEach((function(rule){if(!byName.hasOwnProperty(rule.name)){byName[rule.name]=[]}byName[rule.name].push(rule)}))}Grammar.fromCompiled=function(rules,start){var lexer=rules.Lexer;if(rules.ParserStart){start=rules.ParserStart;rules=rules.ParserRules}var rules=rules.map((function(r){return new Rule(r.name,r.symbols,r.postprocess)}));var g=new Grammar(rules,start);g.lexer=lexer;return g};function StreamLexer(){this.reset("")}StreamLexer.prototype.reset=function(data,state){this.buffer=data;this.index=0;this.line=state?state.line:1;this.lastLineBreak=state?-state.col:0};StreamLexer.prototype.next=function(){if(this.index<this.buffer.length){var ch=this.buffer[this.index++];if(ch==="\n"){this.line+=1;this.lastLineBreak=this.index}return{value:ch}}};StreamLexer.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}};StreamLexer.prototype.formatError=function(token,message){var buffer=this.buffer;if(typeof buffer==="string"){var lines=buffer.split("\n").slice(Math.max(0,this.line-5),this.line);var nextLineBreak=buffer.indexOf("\n",this.index);if(nextLineBreak===-1)nextLineBreak=buffer.length;var col=this.index-this.lastLineBreak;var lastLineDigits=String(this.line).length;message+=" at line "+this.line+" col "+col+":\n\n";message+=lines.map((function(line,i){return pad(this.line-lines.length+i+1,lastLineDigits)+" "+line}),this).join("\n");message+="\n"+pad("",lastLineDigits+col)+"^\n";return message}else{return message+" at index "+(this.index-1)}function pad(n,length){var s=String(n);return Array(length-s.length+1).join(" ")+s}};function Parser(rules,start,options){if(rules instanceof Grammar){var grammar=rules;var options=start}else{var grammar=Grammar.fromCompiled(rules,start)}this.grammar=grammar;this.options={keepHistory:false,lexer:grammar.lexer||new StreamLexer};for(var key in options||{}){this.options[key]=options[key]}this.lexer=this.options.lexer;this.lexerState=undefined;var column=new Column(grammar,0);var table=this.table=[column];column.wants[grammar.start]=[];column.predict(grammar.start);column.process();this.current=0}Parser.fail={};Parser.prototype.feed=function(chunk){var lexer=this.lexer;lexer.reset(chunk,this.lexerState);var token;while(true){try{token=lexer.next();if(!token){break}}catch(e){var nextColumn=new Column(this.grammar,this.current+1);this.table.push(nextColumn);var err=new Error(this.reportLexerError(e));err.offset=this.current;err.token=e.token;throw err}var column=this.table[this.current];if(!this.options.keepHistory){delete this.table[this.current-1]}var n=this.current+1;var nextColumn=new Column(this.grammar,n);this.table.push(nextColumn);var literal=token.text!==undefined?token.text:token.value;var value=lexer.constructor===StreamLexer?token.value:token;var scannable=column.scannable;for(var w=scannable.length;w--;){var state=scannable[w];var expect=state.rule.symbols[state.dot];if(expect.test?expect.test(value):expect.type?expect.type===token.type:expect.literal===literal){var next=state.nextState({data:value,token:token,isToken:true,reference:n-1});nextColumn.states.push(next)}}nextColumn.process();if(nextColumn.states.length===0){var err=new Error(this.reportError(token));err.offset=this.current;err.token=token;throw err}if(this.options.keepHistory){column.lexerState=lexer.save()}this.current++}if(column){this.lexerState=lexer.save()}this.results=this.finish();return this};Parser.prototype.reportLexerError=function(lexerError){var tokenDisplay,lexerMessage;var token=lexerError.token;if(token){tokenDisplay="input "+JSON.stringify(token.text[0])+" (lexer error)";lexerMessage=this.lexer.formatError(token,"Syntax error")}else{tokenDisplay="input (lexer error)";lexerMessage=lexerError.message}return this.reportErrorCommon(lexerMessage,tokenDisplay)};Parser.prototype.reportError=function(token){var tokenDisplay=(token.type?token.type+" token: ":"")+JSON.stringify(token.value!==undefined?token.value:token);var lexerMessage=this.lexer.formatError(token,"Syntax error");return this.reportErrorCommon(lexerMessage,tokenDisplay)};Parser.prototype.reportErrorCommon=function(lexerMessage,tokenDisplay){var lines=[];lines.push(lexerMessage);var lastColumnIndex=this.table.length-2;var lastColumn=this.table[lastColumnIndex];var expectantStates=lastColumn.states.filter((function(state){var nextSymbol=state.rule.symbols[state.dot];return nextSymbol&&typeof nextSymbol!=="string"}));if(expectantStates.length===0){lines.push("Unexpected "+tokenDisplay+". I did not expect any more input. Here is the state of my parse table:\n");this.displayStateStack(lastColumn.states,lines)}else{lines.push("Unexpected "+tokenDisplay+". Instead, I was expecting to see one of the following:\n");var stateStacks=expectantStates.map((function(state){return this.buildFirstStateStack(state,[])||[state]}),this);stateStacks.forEach((function(stateStack){var state=stateStack[0];var nextSymbol=state.rule.symbols[state.dot];var symbolDisplay=this.getSymbolDisplay(nextSymbol);lines.push("A "+symbolDisplay+" based on:");this.displayStateStack(stateStack,lines)}),this)}lines.push("");return lines.join("\n")};Parser.prototype.displayStateStack=function(stateStack,lines){var lastDisplay;var sameDisplayCount=0;for(var j=0;j<stateStack.length;j++){var state=stateStack[j];var display=state.rule.toString(state.dot);if(display===lastDisplay){sameDisplayCount++}else{if(sameDisplayCount>0){lines.push("    ^ "+sameDisplayCount+" more lines identical to this")}sameDisplayCount=0;lines.push("    "+display)}lastDisplay=display}};Parser.prototype.getSymbolDisplay=function(symbol){return getSymbolLongDisplay(symbol)};Parser.prototype.buildFirstStateStack=function(state,visited){if(visited.indexOf(state)!==-1){return null}if(state.wantedBy.length===0){return[state]}var prevState=state.wantedBy[0];var childVisited=[state].concat(visited);var childResult=this.buildFirstStateStack(prevState,childVisited);if(childResult===null){return null}return[state].concat(childResult)};Parser.prototype.save=function(){var column=this.table[this.current];column.lexerState=this.lexerState;return column};Parser.prototype.restore=function(column){var index=column.index;this.current=index;this.table[index]=column;this.table.splice(index+1);this.lexerState=column.lexerState;this.results=this.finish()};Parser.prototype.rewind=function(index){if(!this.options.keepHistory){throw new Error("set option `keepHistory` to enable rewinding")}this.restore(this.table[index])};Parser.prototype.finish=function(){var considerations=[];var start=this.grammar.start;var column=this.table[this.table.length-1];column.states.forEach((function(t){if(t.rule.name===start&&t.dot===t.rule.symbols.length&&t.reference===0&&t.data!==Parser.fail){considerations.push(t)}}));return considerations.map((function(c){return c.data}))};function getSymbolLongDisplay(symbol){var type=typeof symbol;if(type==="string"){return symbol}else if(type==="object"){if(symbol.literal){return JSON.stringify(symbol.literal)}else if(symbol instanceof RegExp){return"character matching "+symbol}else if(symbol.type){return symbol.type+" token"}else if(symbol.test){return"token matching "+String(symbol.test)}else{throw new Error("Unknown symbol type: "+symbol)}}}function getSymbolShortDisplay(symbol){var type=typeof symbol;if(type==="string"){return symbol}else if(type==="object"){if(symbol.literal){return JSON.stringify(symbol.literal)}else if(symbol instanceof RegExp){return symbol.toString()}else if(symbol.type){return"%"+symbol.type}else if(symbol.test){return"<"+String(symbol.test)+">"}else{throw new Error("Unknown symbol type: "+symbol)}}}return{Parser:Parser,Grammar:Grammar,Rule:Rule}}))},{}],374:[function(require,module,exports){(function(process,setImmediate){(function(){"use strict";var ensureCallable=function(fn){if(typeof fn!=="function")throw new TypeError(fn+" is not a function");return fn};var byObserver=function(Observer){var node=document.createTextNode(""),queue,currentQueue,i=0;new Observer((function(){var callback;if(!queue){if(!currentQueue)return;queue=currentQueue}else if(currentQueue){queue=currentQueue.concat(queue)}currentQueue=queue;queue=null;if(typeof currentQueue==="function"){callback=currentQueue;currentQueue=null;callback();return}node.data=i=++i%2;while(currentQueue){callback=currentQueue.shift();if(!currentQueue.length)currentQueue=null;callback()}})).observe(node,{characterData:true});return function(fn){ensureCallable(fn);if(queue){if(typeof queue==="function")queue=[queue,fn];else queue.push(fn);return}queue=fn;node.data=i=++i%2}};module.exports=function(){if(typeof process==="object"&&process&&typeof process.nextTick==="function"){return process.nextTick}if(typeof queueMicrotask==="function"){return function(cb){queueMicrotask(ensureCallable(cb))}}if(typeof document==="object"&&document){if(typeof MutationObserver==="function")return byObserver(MutationObserver);if(typeof WebKitMutationObserver==="function")return byObserver(WebKitMutationObserver)}if(typeof setImmediate==="function"){return function(cb){setImmediate(ensureCallable(cb))}}if(typeof setTimeout==="function"||typeof setTimeout==="object"){return function(cb){setTimeout(ensureCallable(cb),0)}}return null}()}).call(this)}).call(this,require("_process"),require("timers").setImmediate)},{_process:378,timers:421}],375:[function(require,module,exports){(function(global){(function(){"use strict";var getGlobal=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var global=getGlobal();module.exports=exports=global.fetch;if(global.fetch){exports.default=global.fetch.bind(global)}exports.Headers=global.Headers;exports.Request=global.Request;exports.Response=global.Response}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],376:[function(require,module,exports){
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols;var hasOwnProperty=Object.prototype.hasOwnProperty;var propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(val===null||val===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(val)}function shouldUseNative(){try{if(!Object.assign){return false}var test1=new String("abc");test1[5]="de";if(Object.getOwnPropertyNames(test1)[0]==="5"){return false}var test2={};for(var i=0;i<10;i++){test2["_"+String.fromCharCode(i)]=i}var order2=Object.getOwnPropertyNames(test2).map((function(n){return test2[n]}));if(order2.join("")!=="0123456789"){return false}var test3={};"abcdefghijklmnopqrst".split("").forEach((function(letter){test3[letter]=letter}));if(Object.keys(Object.assign({},test3)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(err){return false}}module.exports=shouldUseNative()?Object.assign:function(target,source){var from;var to=toObject(target);var symbols;for(var s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from){if(hasOwnProperty.call(from,key)){to[key]=from[key]}}if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++){if(propIsEnumerable.call(from,symbols[i])){to[symbols[i]]=from[symbols[i]]}}}}return to}},{}],377:[function(require,module,exports){(function(process){(function(){"use strict";function assertPath(path){if(typeof path!=="string"){throw new TypeError("Path must be a string. Received "+JSON.stringify(path))}}function normalizeStringPosix(path,allowAboveRoot){var res="";var lastSegmentLength=0;var lastSlash=-1;var dots=0;var code;for(var i=0;i<=path.length;++i){if(i<path.length)code=path.charCodeAt(i);else if(code===47)break;else code=47;if(code===47){if(lastSlash===i-1||dots===1){}else if(lastSlash!==i-1&&dots===2){if(res.length<2||lastSegmentLength!==2||res.charCodeAt(res.length-1)!==46||res.charCodeAt(res.length-2)!==46){if(res.length>2){var lastSlashIndex=res.lastIndexOf("/");if(lastSlashIndex!==res.length-1){if(lastSlashIndex===-1){res="";lastSegmentLength=0}else{res=res.slice(0,lastSlashIndex);lastSegmentLength=res.length-1-res.lastIndexOf("/")}lastSlash=i;dots=0;continue}}else if(res.length===2||res.length===1){res="";lastSegmentLength=0;lastSlash=i;dots=0;continue}}if(allowAboveRoot){if(res.length>0)res+="/..";else res="..";lastSegmentLength=2}}else{if(res.length>0)res+="/"+path.slice(lastSlash+1,i);else res=path.slice(lastSlash+1,i);lastSegmentLength=i-lastSlash-1}lastSlash=i;dots=0}else if(code===46&&dots!==-1){++dots}else{dots=-1}}return res}function _format(sep,pathObject){var dir=pathObject.dir||pathObject.root;var base=pathObject.base||(pathObject.name||"")+(pathObject.ext||"");if(!dir){return base}if(dir===pathObject.root){return dir+base}return dir+sep+base}var posix={resolve:function resolve(){var resolvedPath="";var resolvedAbsolute=false;var cwd;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path;if(i>=0)path=arguments[i];else{if(cwd===undefined)cwd=process.cwd();path=cwd}assertPath(path);if(path.length===0){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charCodeAt(0)===47}resolvedPath=normalizeStringPosix(resolvedPath,!resolvedAbsolute);if(resolvedAbsolute){if(resolvedPath.length>0)return"/"+resolvedPath;else return"/"}else if(resolvedPath.length>0){return resolvedPath}else{return"."}},normalize:function normalize(path){assertPath(path);if(path.length===0)return".";var isAbsolute=path.charCodeAt(0)===47;var trailingSeparator=path.charCodeAt(path.length-1)===47;path=normalizeStringPosix(path,!isAbsolute);if(path.length===0&&!isAbsolute)path=".";if(path.length>0&&trailingSeparator)path+="/";if(isAbsolute)return"/"+path;return path},isAbsolute:function isAbsolute(path){assertPath(path);return path.length>0&&path.charCodeAt(0)===47},join:function join(){if(arguments.length===0)return".";var joined;for(var i=0;i<arguments.length;++i){var arg=arguments[i];assertPath(arg);if(arg.length>0){if(joined===undefined)joined=arg;else joined+="/"+arg}}if(joined===undefined)return".";return posix.normalize(joined)},relative:function relative(from,to){assertPath(from);assertPath(to);if(from===to)return"";from=posix.resolve(from);to=posix.resolve(to);if(from===to)return"";var fromStart=1;for(;fromStart<from.length;++fromStart){if(from.charCodeAt(fromStart)!==47)break}var fromEnd=from.length;var fromLen=fromEnd-fromStart;var toStart=1;for(;toStart<to.length;++toStart){if(to.charCodeAt(toStart)!==47)break}var toEnd=to.length;var toLen=toEnd-toStart;var length=fromLen<toLen?fromLen:toLen;var lastCommonSep=-1;var i=0;for(;i<=length;++i){if(i===length){if(toLen>length){if(to.charCodeAt(toStart+i)===47){return to.slice(toStart+i+1)}else if(i===0){return to.slice(toStart+i)}}else if(fromLen>length){if(from.charCodeAt(fromStart+i)===47){lastCommonSep=i}else if(i===0){lastCommonSep=0}}break}var fromCode=from.charCodeAt(fromStart+i);var toCode=to.charCodeAt(toStart+i);if(fromCode!==toCode)break;else if(fromCode===47)lastCommonSep=i}var out="";for(i=fromStart+lastCommonSep+1;i<=fromEnd;++i){if(i===fromEnd||from.charCodeAt(i)===47){if(out.length===0)out+="..";else out+="/.."}}if(out.length>0)return out+to.slice(toStart+lastCommonSep);else{toStart+=lastCommonSep;if(to.charCodeAt(toStart)===47)++toStart;return to.slice(toStart)}},_makeLong:function _makeLong(path){return path},dirname:function dirname(path){assertPath(path);if(path.length===0)return".";var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break}}else{matchedSlash=false}}if(end===-1)return hasRoot?"/":".";if(hasRoot&&end===1)return"//";return path.slice(0,end)},basename:function basename(path,ext){if(ext!==undefined&&typeof ext!=="string")throw new TypeError('"ext" argument must be a string');assertPath(path);var start=0;var end=-1;var matchedSlash=true;var i;if(ext!==undefined&&ext.length>0&&ext.length<=path.length){if(ext.length===path.length&&ext===path)return"";var extIdx=ext.length-1;var firstNonSlashEnd=-1;for(i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){start=i+1;break}}else{if(firstNonSlashEnd===-1){matchedSlash=false;firstNonSlashEnd=i+1}if(extIdx>=0){if(code===ext.charCodeAt(extIdx)){if(--extIdx===-1){end=i}}else{extIdx=-1;end=firstNonSlashEnd}}}}if(start===end)end=firstNonSlashEnd;else if(end===-1)end=path.length;return path.slice(start,end)}else{for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break}}else if(end===-1){matchedSlash=false;end=i+1}}if(end===-1)return"";return path.slice(start,end)}},extname:function extname(path){assertPath(path);var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return""}return path.slice(startDot,end)},format:function format(pathObject){if(pathObject===null||typeof pathObject!=="object"){throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof pathObject)}return _format("/",pathObject)},parse:function parse(path){assertPath(path);var ret={root:"",dir:"",base:"",ext:"",name:""};if(path.length===0)return ret;var code=path.charCodeAt(0);var isAbsolute=code===47;var start;if(isAbsolute){ret.root="/";start=1}else{start=0}var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var i=path.length-1;var preDotState=0;for(;i>=start;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){if(end!==-1){if(startPart===0&&isAbsolute)ret.base=ret.name=path.slice(1,end);else ret.base=ret.name=path.slice(startPart,end)}}else{if(startPart===0&&isAbsolute){ret.name=path.slice(1,startDot);ret.base=path.slice(1,end)}else{ret.name=path.slice(startPart,startDot);ret.base=path.slice(startPart,end)}ret.ext=path.slice(startDot,end)}if(startPart>0)ret.dir=path.slice(0,startPart-1);else if(isAbsolute)ret.dir="/";return ret},sep:"/",delimiter:":",win32:null,posix:null};posix.posix=posix;module.exports=posix}).call(this)}).call(this,require("_process"))},{_process:378}],378:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],379:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],380:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),(function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))})).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}})).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],381:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode")},{"./decode":379,"./encode":380}],382:[function(require,module,exports){"use strict";module.exports=class IdentifierIssuer{constructor(prefix,existing=new Map,counter=0){this.prefix=prefix;this._existing=existing;this.counter=counter}clone(){const{prefix:prefix,_existing:_existing,counter:counter}=this;return new IdentifierIssuer(prefix,new Map(_existing),counter)}getId(old){const existing=old&&this._existing.get(old);if(existing){return existing}const identifier=this.prefix+this.counter;this.counter++;if(old){this._existing.set(old,identifier)}return identifier}hasId(old){return this._existing.has(old)}getOldIds(){return[...this._existing.keys()]}}},{}],383:[function(require,module,exports){"use strict";require("setimmediate");const crypto=self.crypto||self.msCrypto;module.exports=class MessageDigest{constructor(algorithm){if(!(crypto&&crypto.subtle)){throw new Error("crypto.subtle not found.")}if(algorithm==="sha256"){this.algorithm={name:"SHA-256"}}else if(algorithm==="sha1"){this.algorithm={name:"SHA-1"}}else{throw new Error(`Unsupport algorithm "${algorithm}".`)}this._content=""}update(msg){this._content+=msg}async digest(){const data=(new TextEncoder).encode(this._content);const buffer=new Uint8Array(await crypto.subtle.digest(this.algorithm,data));let hex="";for(let i=0;i<buffer.length;++i){hex+=buffer[i].toString(16).padStart(2,"0")}return hex}}},{setimmediate:398}],384:[function(require,module,exports){"use strict";const TERMS=["subject","predicate","object","graph"];const RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#";const RDF_LANGSTRING=RDF+"langString";const XSD_STRING="http://www.w3.org/2001/XMLSchema#string";const TYPE_NAMED_NODE="NamedNode";const TYPE_BLANK_NODE="BlankNode";const TYPE_LITERAL="Literal";const TYPE_DEFAULT_GRAPH="DefaultGraph";const REGEX={};(()=>{const iri="(?:<([^:]+:[^>]*)>)";const PN_CHARS_BASE="A-Z"+"a-z"+"À-Ö"+"Ø-ö"+"ø-˿"+"Ͱ-ͽ"+"Ϳ-῿"+"‌-‍"+"⁰-↏"+"Ⰰ-⿯"+"、-퟿"+"豈-﷏"+"ﷰ-�";const PN_CHARS_U=PN_CHARS_BASE+"_";const PN_CHARS=PN_CHARS_U+"0-9"+"-"+"·"+"̀-ͯ"+"‿-⁀";const BLANK_NODE_LABEL="(_:"+"(?:["+PN_CHARS_U+"0-9])"+"(?:(?:["+PN_CHARS+".])*(?:["+PN_CHARS+"]))?"+")";const bnode=BLANK_NODE_LABEL;const plain='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"';const datatype="(?:\\^\\^"+iri+")";const language="(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*))";const literal="(?:"+plain+"(?:"+datatype+"|"+language+")?)";const ws="[ \\t]+";const wso="[ \\t]*";const subject="(?:"+iri+"|"+bnode+")"+ws;const property=iri+ws;const object="(?:"+iri+"|"+bnode+"|"+literal+")"+wso;const graphName="(?:\\.|(?:(?:"+iri+"|"+bnode+")"+wso+"\\.))";REGEX.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g;REGEX.empty=new RegExp("^"+wso+"$");REGEX.quad=new RegExp("^"+wso+subject+property+object+graphName+wso+"$")})();module.exports=class NQuads{static parse(input){const dataset=[];const graphs={};const lines=input.split(REGEX.eoln);let lineNumber=0;for(const line of lines){lineNumber++;if(REGEX.empty.test(line)){continue}const match=line.match(REGEX.quad);if(match===null){throw new Error("N-Quads parse error on line "+lineNumber+".")}const quad={subject:null,predicate:null,object:null,graph:null};if(match[1]!==undefined){quad.subject={termType:TYPE_NAMED_NODE,value:match[1]}}else{quad.subject={termType:TYPE_BLANK_NODE,value:match[2]}}quad.predicate={termType:TYPE_NAMED_NODE,value:match[3]};if(match[4]!==undefined){quad.object={termType:TYPE_NAMED_NODE,value:match[4]}}else if(match[5]!==undefined){quad.object={termType:TYPE_BLANK_NODE,value:match[5]}}else{quad.object={termType:TYPE_LITERAL,value:undefined,datatype:{termType:TYPE_NAMED_NODE}};if(match[7]!==undefined){quad.object.datatype.value=match[7]}else if(match[8]!==undefined){quad.object.datatype.value=RDF_LANGSTRING;quad.object.language=match[8]}else{quad.object.datatype.value=XSD_STRING}quad.object.value=_unescape(match[6])}if(match[9]!==undefined){quad.graph={termType:TYPE_NAMED_NODE,value:match[9]}}else if(match[10]!==undefined){quad.graph={termType:TYPE_BLANK_NODE,value:match[10]}}else{quad.graph={termType:TYPE_DEFAULT_GRAPH,value:""}}if(!(quad.graph.value in graphs)){graphs[quad.graph.value]=[quad];dataset.push(quad)}else{let unique=true;const quads=graphs[quad.graph.value];for(const q of quads){if(_compareTriples(q,quad)){unique=false;break}}if(unique){quads.push(quad);dataset.push(quad)}}}return dataset}static serialize(dataset){if(!Array.isArray(dataset)){dataset=NQuads.legacyDatasetToQuads(dataset)}const quads=[];for(const quad of dataset){quads.push(NQuads.serializeQuad(quad))}return quads.sort().join("")}static serializeQuad(quad){const s=quad.subject;const p=quad.predicate;const o=quad.object;const g=quad.graph;let nquad="";if(s.termType===TYPE_NAMED_NODE){nquad+=`<${s.value}>`}else{nquad+=`${s.value}`}nquad+=` <${p.value}> `;if(o.termType===TYPE_NAMED_NODE){nquad+=`<${o.value}>`}else if(o.termType===TYPE_BLANK_NODE){nquad+=o.value}else{nquad+=`"${_escape(o.value)}"`;if(o.datatype.value===RDF_LANGSTRING){if(o.language){nquad+=`@${o.language}`}}else if(o.datatype.value!==XSD_STRING){nquad+=`^^<${o.datatype.value}>`}}if(g.termType===TYPE_NAMED_NODE){nquad+=` <${g.value}>`}else if(g.termType===TYPE_BLANK_NODE){nquad+=` ${g.value}`}nquad+=" .\n";return nquad}static legacyDatasetToQuads(dataset){const quads=[];const termTypeMap={"blank node":TYPE_BLANK_NODE,IRI:TYPE_NAMED_NODE,literal:TYPE_LITERAL};for(const graphName in dataset){const triples=dataset[graphName];triples.forEach((triple=>{const quad={};for(const componentName in triple){const oldComponent=triple[componentName];const newComponent={termType:termTypeMap[oldComponent.type],value:oldComponent.value};if(newComponent.termType===TYPE_LITERAL){newComponent.datatype={termType:TYPE_NAMED_NODE};if("datatype"in oldComponent){newComponent.datatype.value=oldComponent.datatype}if("language"in oldComponent){if(!("datatype"in oldComponent)){newComponent.datatype.value=RDF_LANGSTRING}newComponent.language=oldComponent.language}else if(!("datatype"in oldComponent)){newComponent.datatype.value=XSD_STRING}}quad[componentName]=newComponent}if(graphName==="@default"){quad.graph={termType:TYPE_DEFAULT_GRAPH,value:""}}else{quad.graph={termType:graphName.startsWith("_:")?TYPE_BLANK_NODE:TYPE_NAMED_NODE,value:graphName}}quads.push(quad)}))}return quads}};function _compareTriples(t1,t2){if(!(t1.subject.termType===t2.subject.termType&&t1.object.termType===t2.object.termType)){return false}if(!(t1.subject.value===t2.subject.value&&t1.predicate.value===t2.predicate.value&&t1.object.value===t2.object.value)){return false}if(t1.object.termType!==TYPE_LITERAL){return true}return t1.object.datatype.termType===t2.object.datatype.termType&&t1.object.language===t2.object.language&&t1.object.datatype.value===t2.object.datatype.value}const _escapeRegex=/["\\\n\r]/g;function _escape(s){return s.replace(_escapeRegex,(function(match){switch(match){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}}))}const _unescapeRegex=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g;function _unescape(s){return s.replace(_unescapeRegex,(function(match,code,u,U){if(code){switch(code){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}}if(u){return String.fromCharCode(parseInt(u,16))}if(U){throw new Error("Unsupported U escape")}}))}},{}],385:[function(require,module,exports){"use strict";module.exports=class Permuter{constructor(list){this.current=list.sort();this.done=false;this.dir=new Map;for(let i=0;i<list.length;++i){this.dir.set(list[i],true)}}hasNext(){return!this.done}next(){const{current:current,dir:dir}=this;const rval=current.slice();let k=null;let pos=0;const length=current.length;for(let i=0;i<length;++i){const element=current[i];const left=dir.get(element);if((k===null||element>k)&&(left&&i>0&&element>current[i-1]||!left&&i<length-1&&element>current[i+1])){k=element;pos=i}}if(k===null){this.done=true}else{const swap=dir.get(k)?pos-1:pos+1;current[pos]=current[swap];current[swap]=k;for(const element of current){if(element>k){dir.set(element,!dir.get(element))}}}return rval}}},{}],386:[function(require,module,exports){(function(setImmediate){(function(){"use strict";const IdentifierIssuer=require("./IdentifierIssuer");const MessageDigest=require("./MessageDigest");const Permuter=require("./Permuter");const NQuads=require("./NQuads");module.exports=class URDNA2015{constructor(){this.name="URDNA2015";this.blankNodeInfo=new Map;this.canonicalIssuer=new IdentifierIssuer("_:c14n");this.hashAlgorithm="sha256";this.quads=null}async main(dataset){this.quads=dataset;for(const quad of dataset){this._addBlankNodeQuadInfo({quad:quad,component:quad.subject});this._addBlankNodeQuadInfo({quad:quad,component:quad.object});this._addBlankNodeQuadInfo({quad:quad,component:quad.graph})}const hashToBlankNodes=new Map;const nonNormalized=[...this.blankNodeInfo.keys()];let i=0;for(const id of nonNormalized){if(++i%100===0){await this._yield()}await this._hashAndTrackBlankNode({id:id,hashToBlankNodes:hashToBlankNodes})}const hashes=[...hashToBlankNodes.keys()].sort();const nonUnique=[];for(const hash of hashes){const idList=hashToBlankNodes.get(hash);if(idList.length>1){nonUnique.push(idList);continue}const id=idList[0];this.canonicalIssuer.getId(id)}for(const idList of nonUnique){const hashPathList=[];for(const id of idList){if(this.canonicalIssuer.hasId(id)){continue}const issuer=new IdentifierIssuer("_:b");issuer.getId(id);const result=await this.hashNDegreeQuads(id,issuer);hashPathList.push(result)}hashPathList.sort(_stringHashCompare);for(const result of hashPathList){const oldIds=result.issuer.getOldIds();for(const id of oldIds){this.canonicalIssuer.getId(id)}}}const normalized=[];for(const quad of this.quads){const q={...quad};q.subject=this._useCanonicalId({component:q.subject});q.object=this._useCanonicalId({component:q.object});q.graph=this._useCanonicalId({component:q.graph});normalized.push(NQuads.serializeQuad(q))}normalized.sort();return normalized.join("")}async hashFirstDegreeQuads(id){const nquads=[];const info=this.blankNodeInfo.get(id);const quads=info.quads;for(const quad of quads){const copy={subject:null,predicate:quad.predicate,object:null,graph:null};copy.subject=this.modifyFirstDegreeComponent(id,quad.subject,"subject");copy.object=this.modifyFirstDegreeComponent(id,quad.object,"object");copy.graph=this.modifyFirstDegreeComponent(id,quad.graph,"graph");nquads.push(NQuads.serializeQuad(copy))}nquads.sort();const md=new MessageDigest(this.hashAlgorithm);for(const nquad of nquads){md.update(nquad)}info.hash=await md.digest();return info.hash}async hashRelatedBlankNode(related,quad,issuer,position){let id;if(this.canonicalIssuer.hasId(related)){id=this.canonicalIssuer.getId(related)}else if(issuer.hasId(related)){id=issuer.getId(related)}else{id=this.blankNodeInfo.get(related).hash}const md=new MessageDigest(this.hashAlgorithm);md.update(position);if(position!=="g"){md.update(this.getRelatedPredicate(quad))}md.update(id);return md.digest()}async hashNDegreeQuads(id,issuer){const md=new MessageDigest(this.hashAlgorithm);const hashToRelated=await this.createHashToRelated(id,issuer);const hashes=[...hashToRelated.keys()].sort();for(const hash of hashes){md.update(hash);let chosenPath="";let chosenIssuer;const permuter=new Permuter(hashToRelated.get(hash));let i=0;while(permuter.hasNext()){const permutation=permuter.next();if(++i%3===0){await this._yield()}let issuerCopy=issuer.clone();let path="";const recursionList=[];let nextPermutation=false;for(const related of permutation){if(this.canonicalIssuer.hasId(related)){path+=this.canonicalIssuer.getId(related)}else{if(!issuerCopy.hasId(related)){recursionList.push(related)}path+=issuerCopy.getId(related)}if(chosenPath.length!==0&&path>chosenPath){nextPermutation=true;break}}if(nextPermutation){continue}for(const related of recursionList){const result=await this.hashNDegreeQuads(related,issuerCopy);path+=issuerCopy.getId(related);path+=`<${result.hash}>`;issuerCopy=result.issuer;if(chosenPath.length!==0&&path>chosenPath){nextPermutation=true;break}}if(nextPermutation){continue}if(chosenPath.length===0||path<chosenPath){chosenPath=path;chosenIssuer=issuerCopy}}md.update(chosenPath);issuer=chosenIssuer}return{hash:await md.digest(),issuer:issuer}}modifyFirstDegreeComponent(id,component){if(component.termType!=="BlankNode"){return component}return{termType:"BlankNode",value:component.value===id?"_:a":"_:z"}}getRelatedPredicate(quad){return`<${quad.predicate.value}>`}async createHashToRelated(id,issuer){const hashToRelated=new Map;const quads=this.blankNodeInfo.get(id).quads;let i=0;for(const quad of quads){if(++i%100===0){await this._yield()}await Promise.all([this._addRelatedBlankNodeHash({quad:quad,component:quad.subject,position:"s",id:id,issuer:issuer,hashToRelated:hashToRelated}),this._addRelatedBlankNodeHash({quad:quad,component:quad.object,position:"o",id:id,issuer:issuer,hashToRelated:hashToRelated}),this._addRelatedBlankNodeHash({quad:quad,component:quad.graph,position:"g",id:id,issuer:issuer,hashToRelated:hashToRelated})])}return hashToRelated}async _hashAndTrackBlankNode({id:id,hashToBlankNodes:hashToBlankNodes}){const hash=await this.hashFirstDegreeQuads(id);const idList=hashToBlankNodes.get(hash);if(!idList){hashToBlankNodes.set(hash,[id])}else{idList.push(id)}}_addBlankNodeQuadInfo({quad:quad,component:component}){if(component.termType!=="BlankNode"){return}const id=component.value;const info=this.blankNodeInfo.get(id);if(info){info.quads.add(quad)}else{this.blankNodeInfo.set(id,{quads:new Set([quad]),hash:null})}}async _addRelatedBlankNodeHash({quad:quad,component:component,position:position,id:id,issuer:issuer,hashToRelated:hashToRelated}){if(!(component.termType==="BlankNode"&&component.value!==id)){return}const related=component.value;const hash=await this.hashRelatedBlankNode(related,quad,issuer,position);const entries=hashToRelated.get(hash);if(entries){entries.push(related)}else{hashToRelated.set(hash,[related])}}_useCanonicalId({component:component}){if(component.termType==="BlankNode"&&!component.value.startsWith(this.canonicalIssuer.prefix)){return{termType:"BlankNode",value:this.canonicalIssuer.getId(component.value)}}return component}async _yield(){return new Promise((resolve=>setImmediate(resolve)))}};function _stringHashCompare(a,b){return a.hash<b.hash?-1:a.hash>b.hash?1:0}}).call(this)}).call(this,require("timers").setImmediate)},{"./IdentifierIssuer":382,"./MessageDigest":383,"./NQuads":384,"./Permuter":385,timers:421}],387:[function(require,module,exports){"use strict";const IdentifierIssuer=require("./IdentifierIssuer");const MessageDigest=require("./MessageDigest");const Permuter=require("./Permuter");const NQuads=require("./NQuads");module.exports=class URDNA2015Sync{constructor(){this.name="URDNA2015";this.blankNodeInfo=new Map;this.canonicalIssuer=new IdentifierIssuer("_:c14n");this.hashAlgorithm="sha256";this.quads=null}main(dataset){this.quads=dataset;for(const quad of dataset){this._addBlankNodeQuadInfo({quad:quad,component:quad.subject});this._addBlankNodeQuadInfo({quad:quad,component:quad.object});this._addBlankNodeQuadInfo({quad:quad,component:quad.graph})}const hashToBlankNodes=new Map;const nonNormalized=[...this.blankNodeInfo.keys()];for(const id of nonNormalized){this._hashAndTrackBlankNode({id:id,hashToBlankNodes:hashToBlankNodes})}const hashes=[...hashToBlankNodes.keys()].sort();const nonUnique=[];for(const hash of hashes){const idList=hashToBlankNodes.get(hash);if(idList.length>1){nonUnique.push(idList);continue}const id=idList[0];this.canonicalIssuer.getId(id)}for(const idList of nonUnique){const hashPathList=[];for(const id of idList){if(this.canonicalIssuer.hasId(id)){continue}const issuer=new IdentifierIssuer("_:b");issuer.getId(id);const result=this.hashNDegreeQuads(id,issuer);hashPathList.push(result)}hashPathList.sort(_stringHashCompare);for(const result of hashPathList){const oldIds=result.issuer.getOldIds();for(const id of oldIds){this.canonicalIssuer.getId(id)}}}const normalized=[];for(const quad of this.quads){const q={...quad};q.subject=this._useCanonicalId({component:q.subject});q.object=this._useCanonicalId({component:q.object});q.graph=this._useCanonicalId({component:q.graph});normalized.push(NQuads.serializeQuad(q))}normalized.sort();return normalized.join("")}hashFirstDegreeQuads(id){const nquads=[];const info=this.blankNodeInfo.get(id);const quads=info.quads;for(const quad of quads){const copy={subject:null,predicate:quad.predicate,object:null,graph:null};copy.subject=this.modifyFirstDegreeComponent(id,quad.subject,"subject");copy.object=this.modifyFirstDegreeComponent(id,quad.object,"object");copy.graph=this.modifyFirstDegreeComponent(id,quad.graph,"graph");nquads.push(NQuads.serializeQuad(copy))}nquads.sort();const md=new MessageDigest(this.hashAlgorithm);for(const nquad of nquads){md.update(nquad)}info.hash=md.digest();return info.hash}hashRelatedBlankNode(related,quad,issuer,position){let id;if(this.canonicalIssuer.hasId(related)){id=this.canonicalIssuer.getId(related)}else if(issuer.hasId(related)){id=issuer.getId(related)}else{id=this.blankNodeInfo.get(related).hash}const md=new MessageDigest(this.hashAlgorithm);md.update(position);if(position!=="g"){md.update(this.getRelatedPredicate(quad))}md.update(id);return md.digest()}hashNDegreeQuads(id,issuer){const md=new MessageDigest(this.hashAlgorithm);const hashToRelated=this.createHashToRelated(id,issuer);const hashes=[...hashToRelated.keys()].sort();for(const hash of hashes){md.update(hash);let chosenPath="";let chosenIssuer;const permuter=new Permuter(hashToRelated.get(hash));while(permuter.hasNext()){const permutation=permuter.next();let issuerCopy=issuer.clone();let path="";const recursionList=[];let nextPermutation=false;for(const related of permutation){if(this.canonicalIssuer.hasId(related)){path+=this.canonicalIssuer.getId(related)}else{if(!issuerCopy.hasId(related)){recursionList.push(related)}path+=issuerCopy.getId(related)}if(chosenPath.length!==0&&path>chosenPath){nextPermutation=true;break}}if(nextPermutation){continue}for(const related of recursionList){const result=this.hashNDegreeQuads(related,issuerCopy);path+=issuerCopy.getId(related);path+=`<${result.hash}>`;issuerCopy=result.issuer;if(chosenPath.length!==0&&path>chosenPath){nextPermutation=true;break}}if(nextPermutation){continue}if(chosenPath.length===0||path<chosenPath){chosenPath=path;chosenIssuer=issuerCopy}}md.update(chosenPath);issuer=chosenIssuer}return{hash:md.digest(),issuer:issuer}}modifyFirstDegreeComponent(id,component){if(component.termType!=="BlankNode"){return component}return{termType:"BlankNode",value:component.value===id?"_:a":"_:z"}}getRelatedPredicate(quad){return`<${quad.predicate.value}>`}createHashToRelated(id,issuer){const hashToRelated=new Map;const quads=this.blankNodeInfo.get(id).quads;for(const quad of quads){this._addRelatedBlankNodeHash({quad:quad,component:quad.subject,position:"s",id:id,issuer:issuer,hashToRelated:hashToRelated});this._addRelatedBlankNodeHash({quad:quad,component:quad.object,position:"o",id:id,issuer:issuer,hashToRelated:hashToRelated});this._addRelatedBlankNodeHash({quad:quad,component:quad.graph,position:"g",id:id,issuer:issuer,hashToRelated:hashToRelated})}return hashToRelated}_hashAndTrackBlankNode({id:id,hashToBlankNodes:hashToBlankNodes}){const hash=this.hashFirstDegreeQuads(id);const idList=hashToBlankNodes.get(hash);if(!idList){hashToBlankNodes.set(hash,[id])}else{idList.push(id)}}_addBlankNodeQuadInfo({quad:quad,component:component}){if(component.termType!=="BlankNode"){return}const id=component.value;const info=this.blankNodeInfo.get(id);if(info){info.quads.add(quad)}else{this.blankNodeInfo.set(id,{quads:new Set([quad]),hash:null})}}_addRelatedBlankNodeHash({quad:quad,component:component,position:position,id:id,issuer:issuer,hashToRelated:hashToRelated}){if(!(component.termType==="BlankNode"&&component.value!==id)){return}const related=component.value;const hash=this.hashRelatedBlankNode(related,quad,issuer,position);const entries=hashToRelated.get(hash);if(entries){entries.push(related)}else{hashToRelated.set(hash,[related])}}_useCanonicalId({component:component}){if(component.termType==="BlankNode"&&!component.value.startsWith(this.canonicalIssuer.prefix)){return{termType:"BlankNode",value:this.canonicalIssuer.getId(component.value)}}return component}};function _stringHashCompare(a,b){return a.hash<b.hash?-1:a.hash>b.hash?1:0}},{"./IdentifierIssuer":382,"./MessageDigest":383,"./NQuads":384,"./Permuter":385}],388:[function(require,module,exports){"use strict";const URDNA2015=require("./URDNA2015");module.exports=class URDNA2012 extends URDNA2015{constructor(){super();this.name="URGNA2012";this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(id,component,key){if(component.termType!=="BlankNode"){return component}if(key==="graph"){return{termType:"BlankNode",value:"_:g"}}return{termType:"BlankNode",value:component.value===id?"_:a":"_:z"}}getRelatedPredicate(quad){return quad.predicate.value}async createHashToRelated(id,issuer){const hashToRelated=new Map;const quads=this.blankNodeInfo.get(id).quads;let i=0;for(const quad of quads){let position;let related;if(quad.subject.termType==="BlankNode"&&quad.subject.value!==id){related=quad.subject.value;position="p"}else if(quad.object.termType==="BlankNode"&&quad.object.value!==id){related=quad.object.value;position="r"}else{continue}if(++i%100===0){await this._yield()}const hash=await this.hashRelatedBlankNode(related,quad,issuer,position);const entries=hashToRelated.get(hash);if(entries){entries.push(related)}else{hashToRelated.set(hash,[related])}}return hashToRelated}}},{"./URDNA2015":386}],389:[function(require,module,exports){"use strict";const URDNA2015Sync=require("./URDNA2015Sync");module.exports=class URDNA2012Sync extends URDNA2015Sync{constructor(){super();this.name="URGNA2012";this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(id,component,key){if(component.termType!=="BlankNode"){return component}if(key==="graph"){return{termType:"BlankNode",value:"_:g"}}return{termType:"BlankNode",value:component.value===id?"_:a":"_:z"}}getRelatedPredicate(quad){return quad.predicate.value}createHashToRelated(id,issuer){const hashToRelated=new Map;const quads=this.blankNodeInfo.get(id).quads;for(const quad of quads){let position;let related;if(quad.subject.termType==="BlankNode"&&quad.subject.value!==id){related=quad.subject.value;position="p"}else if(quad.object.termType==="BlankNode"&&quad.object.value!==id){related=quad.object.value;position="r"}else{continue}const hash=this.hashRelatedBlankNode(related,quad,issuer,position);const entries=hashToRelated.get(hash);if(entries){entries.push(related)}else{hashToRelated.set(hash,[related])}}return hashToRelated}}},{"./URDNA2015Sync":387}],390:[function(require,module,exports){"use strict";const URDNA2015=require("./URDNA2015");const URGNA2012=require("./URGNA2012");const URDNA2015Sync=require("./URDNA2015Sync");const URGNA2012Sync=require("./URGNA2012Sync");let rdfCanonizeNative;try{rdfCanonizeNative=require("rdf-canonize-native")}catch(e){}const api={};module.exports=api;api.NQuads=require("./NQuads");api.IdentifierIssuer=require("./IdentifierIssuer");api._rdfCanonizeNative=function(api){if(api){rdfCanonizeNative=api}return rdfCanonizeNative};api.canonize=async function(dataset,options){if(!Array.isArray(dataset)){dataset=api.NQuads.legacyDatasetToQuads(dataset)}if(options.useNative){if(!rdfCanonizeNative){throw new Error("rdf-canonize-native not available")}return new Promise(((resolve,reject)=>rdfCanonizeNative.canonize(dataset,options,((err,canonical)=>err?reject(err):resolve(canonical)))))}if(options.algorithm==="URDNA2015"){return new URDNA2015(options).main(dataset)}if(options.algorithm==="URGNA2012"){return new URGNA2012(options).main(dataset)}if(!("algorithm"in options)){throw new Error("No RDF Dataset Canonicalization algorithm specified.")}throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+options.algorithm)};api._canonizeSync=function(dataset,options){if(!Array.isArray(dataset)){dataset=api.NQuads.legacyDatasetToQuads(dataset)}if(options.useNative){if(rdfCanonizeNative){return rdfCanonizeNative.canonizeSync(dataset,options)}throw new Error("rdf-canonize-native not available")}if(options.algorithm==="URDNA2015"){return new URDNA2015Sync(options).main(dataset)}if(options.algorithm==="URGNA2012"){return new URGNA2012Sync(options).main(dataset)}if(!("algorithm"in options)){throw new Error("No RDF Dataset Canonicalization algorithm specified.")}throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+options.algorithm)}},{"./IdentifierIssuer":382,"./NQuads":384,"./URDNA2015":386,"./URDNA2015Sync":387,"./URGNA2012":388,"./URGNA2012Sync":389,"rdf-canonize-native":148}],391:[function(require,module,exports){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var buffer=require("buffer");var Buffer=buffer.Buffer;function copyProps(src,dst){for(var key in src){dst[key]=src[key]}}if(Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow){module.exports=buffer}else{copyProps(buffer,exports);exports.Buffer=SafeBuffer}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}SafeBuffer.prototype=Object.create(Buffer.prototype);copyProps(Buffer,SafeBuffer);SafeBuffer.from=function(arg,encodingOrOffset,length){if(typeof arg==="number"){throw new TypeError("Argument must not be a number")}return Buffer(arg,encodingOrOffset,length)};SafeBuffer.alloc=function(size,fill,encoding){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}var buf=Buffer(size);if(fill!==undefined){if(typeof encoding==="string"){buf.fill(fill,encoding)}else{buf.fill(fill)}}else{buf.fill(0)}return buf};SafeBuffer.allocUnsafe=function(size){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}return Buffer(size)};SafeBuffer.allocUnsafeSlow=function(size){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}return buffer.SlowBuffer(size)}},{buffer:151}],392:[function(require,module,exports){"use strict";var extend=require("extend");var data={permanent:require("./lib/iana-permanent.json"),provosional:require("./lib/iana-provisional.json"),historical:require("./lib/iana-historical.json")};var allByName={};Object.keys(data).forEach((function(type){data[type].forEach((function(schemeObj){allByName[schemeObj.scheme]=extend(schemeObj,{type:type})}))}));data.unofficial=require("./lib/unofficial.json").filter((function(item){return!allByName[item.scheme]}));data.unofficial.forEach((function(schemeObj){allByName[schemeObj.scheme]=extend(schemeObj,{type:"unofficial"})}));module.exports=extend(data,{allByName:allByName})},{"./lib/iana-historical.json":393,"./lib/iana-permanent.json":394,"./lib/iana-provisional.json":395,"./lib/unofficial.json":396,extend:265}],393:[function(require,module,exports){module.exports=[{scheme:"fax",description:"fax",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2806"},{type:"rfc",href:"http://www.iana.org/go/rfc3966"}]},{scheme:"filesystem",description:"filesystem",reference:[],template:"http://www.iana.org/assignments/uri-schemes/historic/filesystem"},{scheme:"mailserver",description:"Access to data available from mail servers",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6196"}]},{scheme:"modem",description:"modem",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2806"},{type:"rfc",href:"http://www.iana.org/go/rfc3966"}]},{scheme:"pack",description:"pack",reference:[{type:"draft",href:"http://www.iana.org/go/draft-shur-pack-uri-scheme"}],template:"http://www.iana.org/assignments/uri-schemes/historic/pack"},{scheme:"prospero",description:"Prospero Directory Service",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4157"}]},{scheme:"snews",description:"NNTP over SSL/TLS",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5538"}]},{scheme:"videotex",description:"videotex",reference:[{type:"draft",href:"http://www.iana.org/go/draft-mavrakis-videotex-url-spec"},{type:"rfc",href:"http://www.iana.org/go/rfc2122"},{type:"rfc",href:"http://www.iana.org/go/rfc3986"}],template:"http://www.iana.org/assignments/uri-schemes/historic/videotex"},{scheme:"wais",description:"Wide Area Information Servers",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4156"}]},{scheme:"z39.50",description:"Z39.50 information access",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc1738"},{type:"rfc",href:"http://www.iana.org/go/rfc2056"}]}]},{}],394:[function(require,module,exports){module.exports=[{scheme:"aaa",description:"Diameter Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6733"}]},{scheme:"aaas",description:"Diameter Protocol with Secure Transport",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6733"}]},{scheme:"about",description:"about",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6694"}]},{scheme:"acap",description:"application configuration access protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2244"}]},{scheme:"acct",description:"acct",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7565"}]},{scheme:"cap",description:"Calendar Access Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4324"}]},{scheme:"cid",description:"content identifier",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2392"}]},{scheme:"coap",description:"coap",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7252"}]},{scheme:"coaps",description:"coaps",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7252"}]},{scheme:"crid",description:"TV-Anytime Content Reference Identifier",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4078"}]},{scheme:"data",description:"data",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2397"}]},{scheme:"dav",description:"dav",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4918"}]},{scheme:"dict",description:"dictionary service protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2229"}]},{scheme:"dns",description:"Domain Name System",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4501"}]},{scheme:"example",description:"example",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7595"}]},{scheme:"file",description:"Host-specific file names",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc1738"}]},{scheme:"ftp",description:"File Transfer Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc1738"}]},{scheme:"geo",description:"Geographic Locations",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5870"}]},{scheme:"go",description:"go",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3368"}]},{scheme:"gopher",description:"The Gopher Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4266"}]},{scheme:"h323",description:"H.323",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3508"}]},{scheme:"http",description:"Hypertext Transfer Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7230"}]},{scheme:"https",description:"Hypertext Transfer Protocol Secure",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7230"}]},{scheme:"iax",description:"Inter-Asterisk eXchange Version 2",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5456"}]},{scheme:"icap",description:"Internet Content Adaptation Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3507"}]},{scheme:"im",description:"Instant Messaging",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3860"}]},{scheme:"imap",description:"internet message access protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5092"}]},{scheme:"info",description:'Information Assets with Identifiers in Public Namespaces. \n       (section 3) defines an "info" registry \n        of public namespaces, which is maintained by NISO and can be accessed \n        from .',reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4452"}]},{scheme:"ipp",description:"Internet Printing Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3510"}]},{scheme:"ipps",description:"Internet Printing Protocol over HTTPS",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7472"}]},{scheme:"iris",description:"Internet Registry Information Service",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3981"}]},{scheme:"iris.beep",description:"iris.beep",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3983"}]},{scheme:"iris.lwz",description:"iris.lwz",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4993"}]},{scheme:"iris.xpc",description:"iris.xpc",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4992"}]},{scheme:"iris.xpcs",description:"iris.xpcs",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4992"}]},{scheme:"jabber",description:"jabber",reference:[],template:"http://www.iana.org/assignments/uri-schemes/perm/jabber"},{scheme:"ldap",description:"Lightweight Directory Access Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4516"}]},{scheme:"mailto",description:"Electronic mail address",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6068"}]},{scheme:"mid",description:"message identifier",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2392"}]},{scheme:"msrp",description:"Message Session Relay Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4975"}]},{scheme:"msrps",description:"Message Session Relay Protocol Secure",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4975"}]},{scheme:"mtqp",description:"Message Tracking Query Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3887"}]},{scheme:"mupdate",description:"Mailbox Update (MUPDATE) Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3656"}]},{scheme:"news",description:"USENET news",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5538"}]},{scheme:"nfs",description:"network file system protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2224"}]},{scheme:"ni",description:"ni",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6920"}]},{scheme:"nih",description:"nih",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6920"}]},{scheme:"nntp",description:"USENET news using NNTP access",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5538"}]},{scheme:"opaquelocktoken",description:"opaquelocktokent",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4918"}]},{scheme:"pkcs11",description:"PKCS#11",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7512"}]},{scheme:"pop",description:"Post Office Protocol v3",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2384"}]},{scheme:"pres",description:"Presence",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3859"}]},{scheme:"reload",description:"reload",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6940"}]},{scheme:"rtsp",description:"Real-time Streaming Protocol (RTSP)",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2326"},{type:"draft",href:"http://www.iana.org/go/RFC-ietf-mmusic-rfc2326bis-40"}]},{scheme:"rtsps",description:"Real-time Streaming Protocol (RTSP) over TLS",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2326"},{type:"draft",href:"http://www.iana.org/go/RFC-ietf-mmusic-rfc2326bis-40"}]},{scheme:"rtspu",description:"Real-time Streaming Protocol (RTSP) over unreliable datagram transport",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2326"}]},{scheme:"service",description:"service location",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2609"}]},{scheme:"session",description:"session",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6787"}]},{scheme:"shttp",description:"Secure Hypertext Transfer Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2660"}]},{scheme:"sieve",description:"ManageSieve Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5804"}]},{scheme:"sip",description:"session initiation protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3261"}]},{scheme:"sips",description:"secure session initiation protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3261"}]},{scheme:"sms",description:"Short Message Service",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5724"}]},{scheme:"snmp",description:"Simple Network Management Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4088"}]},{scheme:"soap.beep",description:"soap.beep",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4227"}]},{scheme:"soap.beeps",description:"soap.beeps",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4227"}]},{scheme:"stun",description:"stun",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7064"}]},{scheme:"stuns",description:"stuns",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7064"}]},{scheme:"tag",description:"tag",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4151"}]},{scheme:"tel",description:"telephone",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3966"}]},{scheme:"telnet",description:"Reference to interactive sessions",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc4248"}]},{scheme:"tftp",description:"Trivial File Transfer Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3617"}]},{scheme:"thismessage",description:"multipart/related relative reference resolution",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2557"}],template:"http://www.iana.org/assignments/uri-schemes/perm/thismessage"},{scheme:"tip",description:"Transaction Internet Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2371"}]},{scheme:"tn3270",description:"Interactive 3270 emulation sessions",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6270"}]},{scheme:"turn",description:"turn",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7065"}]},{scheme:"turns",description:"turns",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7065"}]},{scheme:"tv",description:"TV Broadcasts",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2838"}]},{scheme:"urn",description:"Uniform Resource Names",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2141"},{type:"registry",href:"http://www.iana.org/assignments/urn-namespaces"}]},{scheme:"vemmi",description:"versatile multimedia interface",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2122"}]},{scheme:"vnc",description:"Remote Framebuffer Protocol",reference:[{type:"draft",href:"http://www.iana.org/go/RFC-warden-appsawg-vnc-scheme-10"}]},{scheme:"ws",description:"WebSocket connections",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6455"}]},{scheme:"wss",description:"Encrypted WebSocket connections",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6455"}]},{scheme:"xcon",description:"xcon",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6501"}]},{scheme:"xcon-userid",description:"xcon-userid",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6501"}]},{scheme:"xmlrpc.beep",description:"xmlrpc.beep",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3529"}]},{scheme:"xmlrpc.beeps",description:"xmlrpc.beeps",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc3529"}]},{scheme:"xmpp",description:"Extensible Messaging and Presence Protocol",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5122"}]},{scheme:"z39.50r",description:"Z39.50 Retrieval",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2056"}]},{scheme:"z39.50s",description:"Z39.50 Session",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc2056"}]}]},{}],395:[function(require,module,exports){module.exports=[{scheme:"acr",description:"acr",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/acr"},{scheme:"adiumxtra",description:"adiumxtra",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/adiumxtra"},{scheme:"afp",description:"afp",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/afp"},{scheme:"afs",description:"Andrew File System global file names",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc1738"}]},{scheme:"aim",description:"aim",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/aim"},{scheme:"appdata",description:"appdata",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/appdata"},{scheme:"apt",description:"apt",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/apt"},{scheme:"attachment",description:"attachment",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/attachment"},{scheme:"aw",description:"aw",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/aw"},{scheme:"barion",description:"barion",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/barion"},{scheme:"beshare",description:"beshare",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/beshare"},{scheme:"bitcoin",description:"bitcoin",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/bitcoin"},{scheme:"blob",description:"blob",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/blob"},{scheme:"bolo",description:"bolo",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/bolo"},{scheme:"callto",description:"callto",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/callto"},{scheme:"chrome",description:"chrome",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/chrome"},{scheme:"chrome-extension",description:"chrome-extension",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/chrome-extension"},{scheme:"com-eventbrite-attendee",description:"com-eventbrite-attendee",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/com-eventbrite-attendee"},{scheme:"content",description:"content",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/content"},{scheme:"cvs",description:"cvs",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/cvs"},{scheme:"dis",description:"dis",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/dis"},{scheme:"dlna-playcontainer",description:"dlna-playcontainer",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/dlna-playcontainer"},{scheme:"dlna-playsingle",description:"dlna-playsingle",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/dlna-playsingle"},{scheme:"dntp",description:"dntp",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/dntp"},{scheme:"dtn",description:"DTNRG research and development",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5050"}]},{scheme:"dvb",description:"dvb",reference:[{type:"draft",href:"http://www.iana.org/go/draft-mcroberts-uri-dvb"}]},{scheme:"ed2k",description:"ed2k",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ed2k"},{scheme:"facetime",description:"facetime",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/facetime"},{scheme:"feed",description:"feed",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/feed"},{scheme:"feedready",description:"feedready",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/feedready"},{scheme:"finger",description:"finger",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/finger"},{scheme:"fish",description:"fish",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/fish"},{scheme:"gg",description:"gg",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/gg"},{scheme:"git",description:"git",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/git"},{scheme:"gizmoproject",description:"gizmoproject",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/gizmoproject"},{scheme:"gtalk",description:"gtalk",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/gtalk"},{scheme:"ham",description:"ham",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7046"}]},{scheme:"hcp",description:"hcp",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/hcp"},{scheme:"icon",description:"icon",reference:[{type:"draft",href:"http://www.iana.org/go/draft-lafayette-icon-uri-scheme"}]},{scheme:"iotdisco",description:"iotdisco",reference:[{type:"uri",href:"http://www.iana.org/assignments/uri-schemes/prov/iotdisco.pdf"}],template:"http://www.iana.org/assignments/uri-schemes/prov/iotdisco"},{scheme:"ipn",description:"ipn",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6260"}]},{scheme:"irc",description:"irc",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/irc"},{scheme:"irc6",description:"irc6",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/irc6"},{scheme:"ircs",description:"ircs",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ircs"},{scheme:"isostore",description:"isostore",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/isostore"},{scheme:"itms",description:"itms",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/itms"},{scheme:"jar",description:"jar",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/jar"},{scheme:"jms",description:"Java Message Service",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc6167"}]},{scheme:"keyparc",description:"keyparc",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/keyparc"},{scheme:"lastfm",description:"lastfm",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/lastfm"},{scheme:"ldaps",description:"ldaps",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ldaps"},{scheme:"magnet",description:"magnet",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/magnet"},{scheme:"maps",description:"maps",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/maps"},{scheme:"market",description:"market",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/market"},{scheme:"message",description:"message",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/message"},{scheme:"mms",description:"mms",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/mms"},{scheme:"ms-access",description:"ms-access",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-access"},{scheme:"ms-drive-to",description:"ms-drive-to",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-drive-to"},{scheme:"ms-enrollment",description:"ms-enrollment",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-enrollment"},{scheme:"ms-excel",description:"ms-excel",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-excel"},{scheme:"ms-getoffice",description:"ms-getoffice",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-getoffice"},{scheme:"ms-help",description:"ms-help",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-help"},{scheme:"ms-infopath",description:"ms-infopath",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-infopath"},{scheme:"ms-media-stream-id",description:"ms-media-stream-id",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-media-stream-id"},{scheme:"ms-powerpoint",description:"ms-powerpoint",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-powerpoint"},{scheme:"ms-project",description:"ms-project",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-project"},{scheme:"ms-publisher",description:"ms-publisher",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-publisher"},{scheme:"ms-search-repair",description:"ms-search-repair",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-search-repair"},{scheme:"ms-secondary-screen-controller",description:"ms-secondary-screen-controller",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-secondary-screen-controller"},{scheme:"ms-secondary-screen-setup",description:"ms-secondary-screen-setup",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-secondary-screen-setup"},{scheme:"ms-settings",description:"ms-settings",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings"},{scheme:"ms-settings-airplanemode",description:"ms-settings-airplanemode",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-airplanemode"},{scheme:"ms-settings-bluetooth",description:"ms-settings-bluetooth",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-bluetooth"},{scheme:"ms-settings-camera",description:"ms-settings-camera",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-camera"},{scheme:"ms-settings-cellular",description:"ms-settings-cellular",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-cellular"},{scheme:"ms-settings-cloudstorage",description:"ms-settings-cloudstorage",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-cloudstorage"},{scheme:"ms-settings-connectabledevices",description:"ms-settings-connectabledevices",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-connectabledevices"},{scheme:"ms-settings-displays-topology",description:"ms-settings-displays-topology",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-displays-topology"},{scheme:"ms-settings-emailandaccounts",description:"ms-settings-emailandaccounts",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-emailandaccounts"},{scheme:"ms-settings-language",description:"ms-settings-language",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-language"},{scheme:"ms-settings-location",description:"ms-settings-location",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-location"},{scheme:"ms-settings-lock",description:"ms-settings-lock",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-lock"},{scheme:"ms-settings-nfctransactions",description:"ms-settings-nfctransactions",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-nfctransactions"},{scheme:"ms-settings-notifications",description:"ms-settings-notifications",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-notifications"},{scheme:"ms-settings-power",description:"ms-settings-power",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-power"},{scheme:"ms-settings-privacy",description:"ms-settings-privacy",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-privacy"},{scheme:"ms-settings-proximity",description:"ms-settings-proximity",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-proximity"},{scheme:"ms-settings-screenrotation",description:"ms-settings-screenrotation",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-screenrotation"},{scheme:"ms-settings-wifi",description:"ms-settings-wifi",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-wifi"},{scheme:"ms-settings-workplace",description:"ms-settings-workplace",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-settings-workplace"},{scheme:"ms-spd",description:"ms-spd",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-spd"},{scheme:"ms-transit-to",description:"ms-transit-to",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-transit-to"},{scheme:"ms-visio",description:"ms-visio",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-visio"},{scheme:"ms-walk-to",description:"ms-walk-to",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-walk-to"},{scheme:"ms-word",description:"ms-word",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ms-word"},{scheme:"msnim",description:"msnim",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/msnim"},{scheme:"mumble",description:"mumble",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/mumble"},{scheme:"mvn",description:"mvn",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/mvn"},{scheme:"notes",description:"notes",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/notes"},{scheme:"oid",description:"oid",reference:[{type:"draft",href:"http://www.iana.org/go/draft-larmouth-oid-iri"}],template:"http://www.iana.org/assignments/uri-schemes/prov/oid"},{scheme:"palm",description:"palm",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/palm"},{scheme:"paparazzi",description:"paparazzi",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/paparazzi"},{scheme:"platform",description:"platform",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/platform"},{scheme:"proxy",description:"proxy",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/proxy"},{scheme:"psyc",description:"psyc",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/psyc"},{scheme:"query",description:"query",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/query"},{scheme:"redis",description:"redis",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/redis"},{scheme:"rediss",description:"rediss",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/rediss"},{scheme:"res",description:"res",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/res"},{scheme:"resource",description:"resource",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/resource"},{scheme:"rmi",description:"rmi",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/rmi"},{scheme:"rsync",description:"rsync",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc5781"}]},{scheme:"rtmfp",description:"rtmfp",reference:[{type:"rfc",href:"http://www.iana.org/go/rfc7425"}],template:"http://www.iana.org/assignments/uri-schemes/prov/rtmfp"},{scheme:"rtmp",description:"rtmp",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/rtmp"},{scheme:"secondlife",description:"query",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/secondlife"},{scheme:"sftp",description:"query",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/sftp"},{scheme:"sgn",description:"sgn",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/sgn"},{scheme:"skype",description:"skype",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/skype"},{scheme:"smb",description:"smb",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/smb"},{scheme:"smtp",description:"smtp",reference:[{type:"draft",href:"http://www.iana.org/go/draft-melnikov-smime-msa-to-mda"}],template:"http://www.iana.org/assignments/uri-schemes/prov/smtp"},{scheme:"soldat",description:"soldat",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/soldat"},{scheme:"spotify",description:"spotify",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/spotify"},{scheme:"ssh",description:"ssh",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ssh"},{scheme:"steam",description:"steam",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/steam"},{scheme:"submit",description:"submit",reference:[{type:"draft",href:"http://www.iana.org/go/draft-melnikov-smime-msa-to-mda"}],template:"http://www.iana.org/assignments/uri-schemes/prov/submit"},{scheme:"svn",description:"svn",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/svn"},{scheme:"teamspeak",description:"teamspeak",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/teamspeak"},{scheme:"teliaeid",description:"teliaeid",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/teliaeid"},{scheme:"things",description:"things",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/things"},{scheme:"tool",description:"tool",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/tool"},{scheme:"udp",description:"udp",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/udp"},{scheme:"unreal",description:"unreal",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/unreal"},{scheme:"ut2004",description:"ut2004",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ut2004"},{scheme:"v-event",description:"v-event",reference:[{type:"draft",href:"http://www.iana.org/go/draft-menderico-v-event-uri"}],template:"http://www.iana.org/assignments/uri-schemes/prov/v-event"},{scheme:"ventrilo",description:"ventrilo",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ventrilo"},{scheme:"view-source",description:"view-source",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/view-source"},{scheme:"webcal",description:"webcal",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/webcal"},{scheme:"wpid",description:"wpid",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/wpid"},{scheme:"wtai",description:"wtai",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/wtai"},{scheme:"wyciwyg",description:"wyciwyg",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/wyciwyg"},{scheme:"xfire",description:"xfire",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/xfire"},{scheme:"xri",description:"xri",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/xri"},{scheme:"ymsgr",description:"ymsgr",reference:[],template:"http://www.iana.org/assignments/uri-schemes/prov/ymsgr"}]},{}],396:[function(require,module,exports){module.exports=[{scheme:"android-app"},{scheme:"webpack"},{scheme:"s3",description:"Amazon Web Services S3 bucket"},{scheme:"gs",description:"Google Cloud Storage"},{scheme:"mqtt",description:"Message Queuing Telemetry Transport Protocol"},{scheme:"modbus+tcp",description:"Modbus over TCP"}]},{}],397:[function(require,module,exports){(function(process){(function(){exports=module.exports=SemVer;var debug;if(typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)){debug=function(){var args=Array.prototype.slice.call(arguments,0);args.unshift("SEMVER");console.log.apply(console,args)}}else{debug=function(){}}exports.SEMVER_SPEC_VERSION="2.0.0";var MAX_LENGTH=256;var MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;var MAX_SAFE_COMPONENT_LENGTH=16;var re=exports.re=[];var src=exports.src=[];var t=exports.tokens={};var R=0;function tok(n){t[n]=R++}tok("NUMERICIDENTIFIER");src[t.NUMERICIDENTIFIER]="0|[1-9]\\d*";tok("NUMERICIDENTIFIERLOOSE");src[t.NUMERICIDENTIFIERLOOSE]="[0-9]+";tok("NONNUMERICIDENTIFIER");src[t.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";tok("MAINVERSION");src[t.MAINVERSION]="("+src[t.NUMERICIDENTIFIER]+")\\."+"("+src[t.NUMERICIDENTIFIER]+")\\."+"("+src[t.NUMERICIDENTIFIER]+")";tok("MAINVERSIONLOOSE");src[t.MAINVERSIONLOOSE]="("+src[t.NUMERICIDENTIFIERLOOSE]+")\\."+"("+src[t.NUMERICIDENTIFIERLOOSE]+")\\."+"("+src[t.NUMERICIDENTIFIERLOOSE]+")";tok("PRERELEASEIDENTIFIER");src[t.PRERELEASEIDENTIFIER]="(?:"+src[t.NUMERICIDENTIFIER]+"|"+src[t.NONNUMERICIDENTIFIER]+")";tok("PRERELEASEIDENTIFIERLOOSE");src[t.PRERELEASEIDENTIFIERLOOSE]="(?:"+src[t.NUMERICIDENTIFIERLOOSE]+"|"+src[t.NONNUMERICIDENTIFIER]+")";tok("PRERELEASE");src[t.PRERELEASE]="(?:-("+src[t.PRERELEASEIDENTIFIER]+"(?:\\."+src[t.PRERELEASEIDENTIFIER]+")*))";tok("PRERELEASELOOSE");src[t.PRERELEASELOOSE]="(?:-?("+src[t.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+src[t.PRERELEASEIDENTIFIERLOOSE]+")*))";tok("BUILDIDENTIFIER");src[t.BUILDIDENTIFIER]="[0-9A-Za-z-]+";tok("BUILD");src[t.BUILD]="(?:\\+("+src[t.BUILDIDENTIFIER]+"(?:\\."+src[t.BUILDIDENTIFIER]+")*))";tok("FULL");tok("FULLPLAIN");src[t.FULLPLAIN]="v?"+src[t.MAINVERSION]+src[t.PRERELEASE]+"?"+src[t.BUILD]+"?";src[t.FULL]="^"+src[t.FULLPLAIN]+"$";tok("LOOSEPLAIN");src[t.LOOSEPLAIN]="[v=\\s]*"+src[t.MAINVERSIONLOOSE]+src[t.PRERELEASELOOSE]+"?"+src[t.BUILD]+"?";tok("LOOSE");src[t.LOOSE]="^"+src[t.LOOSEPLAIN]+"$";tok("GTLT");src[t.GTLT]="((?:<|>)?=?)";tok("XRANGEIDENTIFIERLOOSE");src[t.XRANGEIDENTIFIERLOOSE]=src[t.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*";tok("XRANGEIDENTIFIER");src[t.XRANGEIDENTIFIER]=src[t.NUMERICIDENTIFIER]+"|x|X|\\*";tok("XRANGEPLAIN");src[t.XRANGEPLAIN]="[v=\\s]*("+src[t.XRANGEIDENTIFIER]+")"+"(?:\\.("+src[t.XRANGEIDENTIFIER]+")"+"(?:\\.("+src[t.XRANGEIDENTIFIER]+")"+"(?:"+src[t.PRERELEASE]+")?"+src[t.BUILD]+"?"+")?)?";tok("XRANGEPLAINLOOSE");src[t.XRANGEPLAINLOOSE]="[v=\\s]*("+src[t.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+src[t.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+src[t.XRANGEIDENTIFIERLOOSE]+")"+"(?:"+src[t.PRERELEASELOOSE]+")?"+src[t.BUILD]+"?"+")?)?";tok("XRANGE");src[t.XRANGE]="^"+src[t.GTLT]+"\\s*"+src[t.XRANGEPLAIN]+"$";tok("XRANGELOOSE");src[t.XRANGELOOSE]="^"+src[t.GTLT]+"\\s*"+src[t.XRANGEPLAINLOOSE]+"$";tok("COERCE");src[t.COERCE]="(^|[^\\d])"+"(\\d{1,"+MAX_SAFE_COMPONENT_LENGTH+"})"+"(?:\\.(\\d{1,"+MAX_SAFE_COMPONENT_LENGTH+"}))?"+"(?:\\.(\\d{1,"+MAX_SAFE_COMPONENT_LENGTH+"}))?"+"(?:$|[^\\d])";tok("COERCERTL");re[t.COERCERTL]=new RegExp(src[t.COERCE],"g");tok("LONETILDE");src[t.LONETILDE]="(?:~>?)";tok("TILDETRIM");src[t.TILDETRIM]="(\\s*)"+src[t.LONETILDE]+"\\s+";re[t.TILDETRIM]=new RegExp(src[t.TILDETRIM],"g");var tildeTrimReplace="$1~";tok("TILDE");src[t.TILDE]="^"+src[t.LONETILDE]+src[t.XRANGEPLAIN]+"$";tok("TILDELOOSE");src[t.TILDELOOSE]="^"+src[t.LONETILDE]+src[t.XRANGEPLAINLOOSE]+"$";tok("LONECARET");src[t.LONECARET]="(?:\\^)";tok("CARETTRIM");src[t.CARETTRIM]="(\\s*)"+src[t.LONECARET]+"\\s+";re[t.CARETTRIM]=new RegExp(src[t.CARETTRIM],"g");var caretTrimReplace="$1^";tok("CARET");src[t.CARET]="^"+src[t.LONECARET]+src[t.XRANGEPLAIN]+"$";tok("CARETLOOSE");src[t.CARETLOOSE]="^"+src[t.LONECARET]+src[t.XRANGEPLAINLOOSE]+"$";tok("COMPARATORLOOSE");src[t.COMPARATORLOOSE]="^"+src[t.GTLT]+"\\s*("+src[t.LOOSEPLAIN]+")$|^$";tok("COMPARATOR");src[t.COMPARATOR]="^"+src[t.GTLT]+"\\s*("+src[t.FULLPLAIN]+")$|^$";tok("COMPARATORTRIM");src[t.COMPARATORTRIM]="(\\s*)"+src[t.GTLT]+"\\s*("+src[t.LOOSEPLAIN]+"|"+src[t.XRANGEPLAIN]+")";re[t.COMPARATORTRIM]=new RegExp(src[t.COMPARATORTRIM],"g");var comparatorTrimReplace="$1$2$3";tok("HYPHENRANGE");src[t.HYPHENRANGE]="^\\s*("+src[t.XRANGEPLAIN]+")"+"\\s+-\\s+"+"("+src[t.XRANGEPLAIN]+")"+"\\s*$";tok("HYPHENRANGELOOSE");src[t.HYPHENRANGELOOSE]="^\\s*("+src[t.XRANGEPLAINLOOSE]+")"+"\\s+-\\s+"+"("+src[t.XRANGEPLAINLOOSE]+")"+"\\s*$";tok("STAR");src[t.STAR]="(<|>)?=?\\s*\\*";for(var i=0;i<R;i++){debug(i,src[i]);if(!re[i]){re[i]=new RegExp(src[i])}}exports.parse=parse;function parse(version,options){if(!options||typeof options!=="object"){options={loose:!!options,includePrerelease:false}}if(version instanceof SemVer){return version}if(typeof version!=="string"){return null}if(version.length>MAX_LENGTH){return null}var r=options.loose?re[t.LOOSE]:re[t.FULL];if(!r.test(version)){return null}try{return new SemVer(version,options)}catch(er){return null}}exports.valid=valid;function valid(version,options){var v=parse(version,options);return v?v.version:null}exports.clean=clean;function clean(version,options){var s=parse(version.trim().replace(/^[=v]+/,""),options);return s?s.version:null}exports.SemVer=SemVer;function SemVer(version,options){if(!options||typeof options!=="object"){options={loose:!!options,includePrerelease:false}}if(version instanceof SemVer){if(version.loose===options.loose){return version}else{version=version.version}}else if(typeof version!=="string"){throw new TypeError("Invalid Version: "+version)}if(version.length>MAX_LENGTH){throw new TypeError("version is longer than "+MAX_LENGTH+" characters")}if(!(this instanceof SemVer)){return new SemVer(version,options)}debug("SemVer",version,options);this.options=options;this.loose=!!options.loose;var m=version.trim().match(options.loose?re[t.LOOSE]:re[t.FULL]);if(!m){throw new TypeError("Invalid Version: "+version)}this.raw=version;this.major=+m[1];this.minor=+m[2];this.patch=+m[3];if(this.major>MAX_SAFE_INTEGER||this.major<0){throw new TypeError("Invalid major version")}if(this.minor>MAX_SAFE_INTEGER||this.minor<0){throw new TypeError("Invalid minor version")}if(this.patch>MAX_SAFE_INTEGER||this.patch<0){throw new TypeError("Invalid patch version")}if(!m[4]){this.prerelease=[]}else{this.prerelease=m[4].split(".").map((function(id){if(/^[0-9]+$/.test(id)){var num=+id;if(num>=0&&num<MAX_SAFE_INTEGER){return num}}return id}))}this.build=m[5]?m[5].split("."):[];this.format()}SemVer.prototype.format=function(){this.version=this.major+"."+this.minor+"."+this.patch;if(this.prerelease.length){this.version+="-"+this.prerelease.join(".")}return this.version};SemVer.prototype.toString=function(){return this.version};SemVer.prototype.compare=function(other){debug("SemVer.compare",this.version,this.options,other);if(!(other instanceof SemVer)){other=new SemVer(other,this.options)}return this.compareMain(other)||this.comparePre(other)};SemVer.prototype.compareMain=function(other){if(!(other instanceof SemVer)){other=new SemVer(other,this.options)}return compareIdentifiers(this.major,other.major)||compareIdentifiers(this.minor,other.minor)||compareIdentifiers(this.patch,other.patch)};SemVer.prototype.comparePre=function(other){if(!(other instanceof SemVer)){other=new SemVer(other,this.options)}if(this.prerelease.length&&!other.prerelease.length){return-1}else if(!this.prerelease.length&&other.prerelease.length){return 1}else if(!this.prerelease.length&&!other.prerelease.length){return 0}var i=0;do{var a=this.prerelease[i];var b=other.prerelease[i];debug("prerelease compare",i,a,b);if(a===undefined&&b===undefined){return 0}else if(b===undefined){return 1}else if(a===undefined){return-1}else if(a===b){continue}else{return compareIdentifiers(a,b)}}while(++i)};SemVer.prototype.compareBuild=function(other){if(!(other instanceof SemVer)){other=new SemVer(other,this.options)}var i=0;do{var a=this.build[i];var b=other.build[i];debug("prerelease compare",i,a,b);if(a===undefined&&b===undefined){return 0}else if(b===undefined){return 1}else if(a===undefined){return-1}else if(a===b){continue}else{return compareIdentifiers(a,b)}}while(++i)};SemVer.prototype.inc=function(release,identifier){switch(release){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",identifier);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",identifier);break;case"prepatch":this.prerelease.length=0;this.inc("patch",identifier);this.inc("pre",identifier);break;case"prerelease":if(this.prerelease.length===0){this.inc("patch",identifier)}this.inc("pre",identifier);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0){this.major++}this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0){this.minor++}this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0){this.patch++}this.prerelease=[];break;case"pre":if(this.prerelease.length===0){this.prerelease=[0]}else{var i=this.prerelease.length;while(--i>=0){if(typeof this.prerelease[i]==="number"){this.prerelease[i]++;i=-2}}if(i===-1){this.prerelease.push(0)}}if(identifier){if(this.prerelease[0]===identifier){if(isNaN(this.prerelease[1])){this.prerelease=[identifier,0]}}else{this.prerelease=[identifier,0]}}break;default:throw new Error("invalid increment argument: "+release)}this.format();this.raw=this.version;return this};exports.inc=inc;function inc(version,release,loose,identifier){if(typeof loose==="string"){identifier=loose;loose=undefined}try{return new SemVer(version,loose).inc(release,identifier).version}catch(er){return null}}exports.diff=diff;function diff(version1,version2){if(eq(version1,version2)){return null}else{var v1=parse(version1);var v2=parse(version2);var prefix="";if(v1.prerelease.length||v2.prerelease.length){prefix="pre";var defaultResult="prerelease"}for(var key in v1){if(key==="major"||key==="minor"||key==="patch"){if(v1[key]!==v2[key]){return prefix+key}}}return defaultResult}}exports.compareIdentifiers=compareIdentifiers;var numeric=/^[0-9]+$/;function compareIdentifiers(a,b){var anum=numeric.test(a);var bnum=numeric.test(b);if(anum&&bnum){a=+a;b=+b}return a===b?0:anum&&!bnum?-1:bnum&&!anum?1:a<b?-1:1}exports.rcompareIdentifiers=rcompareIdentifiers;function rcompareIdentifiers(a,b){return compareIdentifiers(b,a)}exports.major=major;function major(a,loose){return new SemVer(a,loose).major}exports.minor=minor;function minor(a,loose){return new SemVer(a,loose).minor}exports.patch=patch;function patch(a,loose){return new SemVer(a,loose).patch}exports.compare=compare;function compare(a,b,loose){return new SemVer(a,loose).compare(new SemVer(b,loose))}exports.compareLoose=compareLoose;function compareLoose(a,b){return compare(a,b,true)}exports.compareBuild=compareBuild;function compareBuild(a,b,loose){var versionA=new SemVer(a,loose);var versionB=new SemVer(b,loose);return versionA.compare(versionB)||versionA.compareBuild(versionB)}exports.rcompare=rcompare;function rcompare(a,b,loose){return compare(b,a,loose)}exports.sort=sort;function sort(list,loose){return list.sort((function(a,b){return exports.compareBuild(a,b,loose)}))}exports.rsort=rsort;function rsort(list,loose){return list.sort((function(a,b){return exports.compareBuild(b,a,loose)}))}exports.gt=gt;function gt(a,b,loose){return compare(a,b,loose)>0}exports.lt=lt;function lt(a,b,loose){return compare(a,b,loose)<0}exports.eq=eq;function eq(a,b,loose){return compare(a,b,loose)===0}exports.neq=neq;function neq(a,b,loose){return compare(a,b,loose)!==0}exports.gte=gte;function gte(a,b,loose){return compare(a,b,loose)>=0}exports.lte=lte;function lte(a,b,loose){return compare(a,b,loose)<=0}exports.cmp=cmp;function cmp(a,op,b,loose){switch(op){case"===":if(typeof a==="object")a=a.version;if(typeof b==="object")b=b.version;return a===b;case"!==":if(typeof a==="object")a=a.version;if(typeof b==="object")b=b.version;return a!==b;case"":case"=":case"==":return eq(a,b,loose);case"!=":return neq(a,b,loose);case">":return gt(a,b,loose);case">=":return gte(a,b,loose);case"<":return lt(a,b,loose);case"<=":return lte(a,b,loose);default:throw new TypeError("Invalid operator: "+op)}}exports.Comparator=Comparator;function Comparator(comp,options){if(!options||typeof options!=="object"){options={loose:!!options,includePrerelease:false}}if(comp instanceof Comparator){if(comp.loose===!!options.loose){return comp}else{comp=comp.value}}if(!(this instanceof Comparator)){return new Comparator(comp,options)}debug("comparator",comp,options);this.options=options;this.loose=!!options.loose;this.parse(comp);if(this.semver===ANY){this.value=""}else{this.value=this.operator+this.semver.version}debug("comp",this)}var ANY={};Comparator.prototype.parse=function(comp){var r=this.options.loose?re[t.COMPARATORLOOSE]:re[t.COMPARATOR];var m=comp.match(r);if(!m){throw new TypeError("Invalid comparator: "+comp)}this.operator=m[1]!==undefined?m[1]:"";if(this.operator==="="){this.operator=""}if(!m[2]){this.semver=ANY}else{this.semver=new SemVer(m[2],this.options.loose)}};Comparator.prototype.toString=function(){return this.value};Comparator.prototype.test=function(version){debug("Comparator.test",version,this.options.loose);if(this.semver===ANY||version===ANY){return true}if(typeof version==="string"){try{version=new SemVer(version,this.options)}catch(er){return false}}return cmp(version,this.operator,this.semver,this.options)};Comparator.prototype.intersects=function(comp,options){if(!(comp instanceof Comparator)){throw new TypeError("a Comparator is required")}if(!options||typeof options!=="object"){options={loose:!!options,includePrerelease:false}}var rangeTmp;if(this.operator===""){if(this.value===""){return true}rangeTmp=new Range(comp.value,options);return satisfies(this.value,rangeTmp,options)}else if(comp.operator===""){if(comp.value===""){return true}rangeTmp=new Range(this.value,options);return satisfies(comp.semver,rangeTmp,options)}var sameDirectionIncreasing=(this.operator===">="||this.operator===">")&&(comp.operator===">="||comp.operator===">");var sameDirectionDecreasing=(this.operator==="<="||this.operator==="<")&&(comp.operator==="<="||comp.operator==="<");var sameSemVer=this.semver.version===comp.semver.version;var differentDirectionsInclusive=(this.operator===">="||this.operator==="<=")&&(comp.operator===">="||comp.operator==="<=");var oppositeDirectionsLessThan=cmp(this.semver,"<",comp.semver,options)&&((this.operator===">="||this.operator===">")&&(comp.operator==="<="||comp.operator==="<"));var oppositeDirectionsGreaterThan=cmp(this.semver,">",comp.semver,options)&&((this.operator==="<="||this.operator==="<")&&(comp.operator===">="||comp.operator===">"));return sameDirectionIncreasing||sameDirectionDecreasing||sameSemVer&&differentDirectionsInclusive||oppositeDirectionsLessThan||oppositeDirectionsGreaterThan};exports.Range=Range;function Range(range,options){if(!options||typeof options!=="object"){options={loose:!!options,includePrerelease:false}}if(range instanceof Range){if(range.loose===!!options.loose&&range.includePrerelease===!!options.includePrerelease){return range}else{return new Range(range.raw,options)}}if(range instanceof Comparator){return new Range(range.value,options)}if(!(this instanceof Range)){return new Range(range,options)}this.options=options;this.loose=!!options.loose;this.includePrerelease=!!options.includePrerelease;this.raw=range;this.set=range.split(/\s*\|\|\s*/).map((function(range){return this.parseRange(range.trim())}),this).filter((function(c){return c.length}));if(!this.set.length){throw new TypeError("Invalid SemVer Range: "+range)}this.format()}Range.prototype.format=function(){this.range=this.set.map((function(comps){return comps.join(" ").trim()})).join("||").trim();return this.range};Range.prototype.toString=function(){return this.range};Range.prototype.parseRange=function(range){var loose=this.options.loose;range=range.trim();var hr=loose?re[t.HYPHENRANGELOOSE]:re[t.HYPHENRANGE];range=range.replace(hr,hyphenReplace);debug("hyphen replace",range);range=range.replace(re[t.COMPARATORTRIM],comparatorTrimReplace);debug("comparator trim",range,re[t.COMPARATORTRIM]);range=range.replace(re[t.TILDETRIM],tildeTrimReplace);range=range.replace(re[t.CARETTRIM],caretTrimReplace);range=range.split(/\s+/).join(" ");var compRe=loose?re[t.COMPARATORLOOSE]:re[t.COMPARATOR];var set=range.split(" ").map((function(comp){return parseComparator(comp,this.options)}),this).join(" ").split(/\s+/);if(this.options.loose){set=set.filter((function(comp){return!!comp.match(compRe)}))}set=set.map((function(comp){return new Comparator(comp,this.options)}),this);return set};Range.prototype.intersects=function(range,options){if(!(range instanceof Range)){throw new TypeError("a Range is required")}return this.set.some((function(thisComparators){return isSatisfiable(thisComparators,options)&&range.set.some((function(rangeComparators){return isSatisfiable(rangeComparators,options)&&thisComparators.every((function(thisComparator){return rangeComparators.every((function(rangeComparator){return thisComparator.intersects(rangeComparator,options)}))}))}))}))};function isSatisfiable(comparators,options){var result=true;var remainingComparators=comparators.slice();var testComparator=remainingComparators.pop();while(result&&remainingComparators.length){result=remainingComparators.every((function(otherComparator){return testComparator.intersects(otherComparator,options)}));testComparator=remainingComparators.pop()}return result}exports.toComparators=toComparators;function toComparators(range,options){return new Range(range,options).set.map((function(comp){return comp.map((function(c){return c.value})).join(" ").trim().split(" ")}))}function parseComparator(comp,options){debug("comp",comp,options);comp=replaceCarets(comp,options);debug("caret",comp);comp=replaceTildes(comp,options);debug("tildes",comp);comp=replaceXRanges(comp,options);debug("xrange",comp);comp=replaceStars(comp,options);debug("stars",comp);return comp}function isX(id){return!id||id.toLowerCase()==="x"||id==="*"}function replaceTildes(comp,options){return comp.trim().split(/\s+/).map((function(comp){return replaceTilde(comp,options)})).join(" ")}function replaceTilde(comp,options){var r=options.loose?re[t.TILDELOOSE]:re[t.TILDE];return comp.replace(r,(function(_,M,m,p,pr){debug("tilde",comp,_,M,m,p,pr);var ret;if(isX(M)){ret=""}else if(isX(m)){ret=">="+M+".0.0 <"+(+M+1)+".0.0"}else if(isX(p)){ret=">="+M+"."+m+".0 <"+M+"."+(+m+1)+".0"}else if(pr){debug("replaceTilde pr",pr);ret=">="+M+"."+m+"."+p+"-"+pr+" <"+M+"."+(+m+1)+".0"}else{ret=">="+M+"."+m+"."+p+" <"+M+"."+(+m+1)+".0"}debug("tilde return",ret);return ret}))}function replaceCarets(comp,options){return comp.trim().split(/\s+/).map((function(comp){return replaceCaret(comp,options)})).join(" ")}function replaceCaret(comp,options){debug("caret",comp,options);var r=options.loose?re[t.CARETLOOSE]:re[t.CARET];return comp.replace(r,(function(_,M,m,p,pr){debug("caret",comp,_,M,m,p,pr);var ret;if(isX(M)){ret=""}else if(isX(m)){ret=">="+M+".0.0 <"+(+M+1)+".0.0"}else if(isX(p)){if(M==="0"){ret=">="+M+"."+m+".0 <"+M+"."+(+m+1)+".0"}else{ret=">="+M+"."+m+".0 <"+(+M+1)+".0.0"}}else if(pr){debug("replaceCaret pr",pr);if(M==="0"){if(m==="0"){ret=">="+M+"."+m+"."+p+"-"+pr+" <"+M+"."+m+"."+(+p+1)}else{ret=">="+M+"."+m+"."+p+"-"+pr+" <"+M+"."+(+m+1)+".0"}}else{ret=">="+M+"."+m+"."+p+"-"+pr+" <"+(+M+1)+".0.0"}}else{debug("no pr");if(M==="0"){if(m==="0"){ret=">="+M+"."+m+"."+p+" <"+M+"."+m+"."+(+p+1)}else{ret=">="+M+"."+m+"."+p+" <"+M+"."+(+m+1)+".0"}}else{ret=">="+M+"."+m+"."+p+" <"+(+M+1)+".0.0"}}debug("caret return",ret);return ret}))}function replaceXRanges(comp,options){debug("replaceXRanges",comp,options);return comp.split(/\s+/).map((function(comp){return replaceXRange(comp,options)})).join(" ")}function replaceXRange(comp,options){comp=comp.trim();var r=options.loose?re[t.XRANGELOOSE]:re[t.XRANGE];return comp.replace(r,(function(ret,gtlt,M,m,p,pr){debug("xRange",comp,ret,gtlt,M,m,p,pr);var xM=isX(M);var xm=xM||isX(m);var xp=xm||isX(p);var anyX=xp;if(gtlt==="="&&anyX){gtlt=""}pr=options.includePrerelease?"-0":"";if(xM){if(gtlt===">"||gtlt==="<"){ret="<0.0.0-0"}else{ret="*"}}else if(gtlt&&anyX){if(xm){m=0}p=0;if(gtlt===">"){gtlt=">=";if(xm){M=+M+1;m=0;p=0}else{m=+m+1;p=0}}else if(gtlt==="<="){gtlt="<";if(xm){M=+M+1}else{m=+m+1}}ret=gtlt+M+"."+m+"."+p+pr}else if(xm){ret=">="+M+".0.0"+pr+" <"+(+M+1)+".0.0"+pr}else if(xp){ret=">="+M+"."+m+".0"+pr+" <"+M+"."+(+m+1)+".0"+pr}debug("xRange return",ret);return ret}))}function replaceStars(comp,options){debug("replaceStars",comp,options);return comp.trim().replace(re[t.STAR],"")}function hyphenReplace($0,from,fM,fm,fp,fpr,fb,to,tM,tm,tp,tpr,tb){if(isX(fM)){from=""}else if(isX(fm)){from=">="+fM+".0.0"}else if(isX(fp)){from=">="+fM+"."+fm+".0"}else{from=">="+from}if(isX(tM)){to=""}else if(isX(tm)){to="<"+(+tM+1)+".0.0"}else if(isX(tp)){to="<"+tM+"."+(+tm+1)+".0"}else if(tpr){to="<="+tM+"."+tm+"."+tp+"-"+tpr}else{to="<="+to}return(from+" "+to).trim()}Range.prototype.test=function(version){if(!version){return false}if(typeof version==="string"){try{version=new SemVer(version,this.options)}catch(er){return false}}for(var i=0;i<this.set.length;i++){if(testSet(this.set[i],version,this.options)){return true}}return false};function testSet(set,version,options){for(var i=0;i<set.length;i++){if(!set[i].test(version)){return false}}if(version.prerelease.length&&!options.includePrerelease){for(i=0;i<set.length;i++){debug(set[i].semver);if(set[i].semver===ANY){continue}if(set[i].semver.prerelease.length>0){var allowed=set[i].semver;if(allowed.major===version.major&&allowed.minor===version.minor&&allowed.patch===version.patch){return true}}}return false}return true}exports.satisfies=satisfies;function satisfies(version,range,options){try{range=new Range(range,options)}catch(er){return false}return range.test(version)}exports.maxSatisfying=maxSatisfying;function maxSatisfying(versions,range,options){var max=null;var maxSV=null;try{var rangeObj=new Range(range,options)}catch(er){return null}versions.forEach((function(v){if(rangeObj.test(v)){if(!max||maxSV.compare(v)===-1){max=v;maxSV=new SemVer(max,options)}}}));return max}exports.minSatisfying=minSatisfying;function minSatisfying(versions,range,options){var min=null;var minSV=null;try{var rangeObj=new Range(range,options)}catch(er){return null}versions.forEach((function(v){if(rangeObj.test(v)){if(!min||minSV.compare(v)===1){min=v;minSV=new SemVer(min,options)}}}));return min}exports.minVersion=minVersion;function minVersion(range,loose){range=new Range(range,loose);var minver=new SemVer("0.0.0");if(range.test(minver)){return minver}minver=new SemVer("0.0.0-0");if(range.test(minver)){return minver}minver=null;for(var i=0;i<range.set.length;++i){var comparators=range.set[i];comparators.forEach((function(comparator){var compver=new SemVer(comparator.semver.version);switch(comparator.operator){case">":if(compver.prerelease.length===0){compver.patch++}else{compver.prerelease.push(0)}compver.raw=compver.format();case"":case">=":if(!minver||gt(minver,compver)){minver=compver}break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+comparator.operator)}}))}if(minver&&range.test(minver)){return minver}return null}exports.validRange=validRange;function validRange(range,options){try{return new Range(range,options).range||"*"}catch(er){return null}}exports.ltr=ltr;function ltr(version,range,options){return outside(version,range,"<",options)}exports.gtr=gtr;function gtr(version,range,options){return outside(version,range,">",options)}exports.outside=outside;function outside(version,range,hilo,options){version=new SemVer(version,options);range=new Range(range,options);var gtfn,ltefn,ltfn,comp,ecomp;switch(hilo){case">":gtfn=gt;ltefn=lte;ltfn=lt;comp=">";ecomp=">=";break;case"<":gtfn=lt;ltefn=gte;ltfn=gt;comp="<";ecomp="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(satisfies(version,range,options)){return false}for(var i=0;i<range.set.length;++i){var comparators=range.set[i];var high=null;var low=null;comparators.forEach((function(comparator){if(comparator.semver===ANY){comparator=new Comparator(">=0.0.0")}high=high||comparator;low=low||comparator;if(gtfn(comparator.semver,high.semver,options)){high=comparator}else if(ltfn(comparator.semver,low.semver,options)){low=comparator}}));if(high.operator===comp||high.operator===ecomp){return false}if((!low.operator||low.operator===comp)&&ltefn(version,low.semver)){return false}else if(low.operator===ecomp&&ltfn(version,low.semver)){return false}}return true}exports.prerelease=prerelease;function prerelease(version,options){var parsed=parse(version,options);return parsed&&parsed.prerelease.length?parsed.prerelease:null}exports.intersects=intersects;function intersects(r1,r2,options){r1=new Range(r1,options);r2=new Range(r2,options);return r1.intersects(r2)}exports.coerce=coerce;function coerce(version,options){if(version instanceof SemVer){return version}if(typeof version==="number"){version=String(version)}if(typeof version!=="string"){return null}options=options||{};var match=null;if(!options.rtl){match=version.match(re[t.COERCE])}else{var next;while((next=re[t.COERCERTL].exec(version))&&(!match||match.index+match[0].length!==version.length)){if(!match||next.index+next[0].length!==match.index+match[0].length){match=next}re[t.COERCERTL].lastIndex=next.index+next[1].length+next[2].length}re[t.COERCERTL].lastIndex=-1}if(match===null){return null}return parse(match[2]+"."+(match[3]||"0")+"."+(match[4]||"0"),options)}}).call(this)}).call(this,require("_process"))},{_process:378}],398:[function(require,module,exports){(function(process,global){(function(){(function(global,undefined){"use strict";if(global.setImmediate){return}var nextHandle=1;var tasksByHandle={};var currentlyRunningATask=false;var doc=global.document;var registerImmediate;function setImmediate(callback){if(typeof callback!=="function"){callback=new Function(""+callback)}var args=new Array(arguments.length-1);for(var i=0;i<args.length;i++){args[i]=arguments[i+1]}var task={callback:callback,args:args};tasksByHandle[nextHandle]=task;registerImmediate(nextHandle);return nextHandle++}function clearImmediate(handle){delete tasksByHandle[handle]}function run(task){var callback=task.callback;var args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(undefined,args);break}}function runIfPresent(handle){if(currentlyRunningATask){setTimeout(runIfPresent,0,handle)}else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=true;try{run(task)}finally{clearImmediate(handle);currentlyRunningATask=false}}}}function installNextTickImplementation(){registerImmediate=function(handle){process.nextTick((function(){runIfPresent(handle)}))}}function canUsePostMessage(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=true;var oldOnMessage=global.onmessage;global.onmessage=function(){postMessageIsAsynchronous=false};global.postMessage("","*");global.onmessage=oldOnMessage;return postMessageIsAsynchronous}}function installPostMessageImplementation(){var messagePrefix="setImmediate$"+Math.random()+"$";var onGlobalMessage=function(event){if(event.source===global&&typeof event.data==="string"&&event.data.indexOf(messagePrefix)===0){runIfPresent(+event.data.slice(messagePrefix.length))}};if(global.addEventListener){global.addEventListener("message",onGlobalMessage,false)}else{global.attachEvent("onmessage",onGlobalMessage)}registerImmediate=function(handle){global.postMessage(messagePrefix+handle,"*")}}function installMessageChannelImplementation(){var channel=new MessageChannel;channel.port1.onmessage=function(event){var handle=event.data;runIfPresent(handle)};registerImmediate=function(handle){channel.port2.postMessage(handle)}}function installReadyStateChangeImplementation(){var html=doc.documentElement;registerImmediate=function(handle){var script=doc.createElement("script");script.onreadystatechange=function(){runIfPresent(handle);script.onreadystatechange=null;html.removeChild(script);script=null};html.appendChild(script)}}function installSetTimeoutImplementation(){registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}}var attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global);attachTo=attachTo&&attachTo.setTimeout?attachTo:global;if({}.toString.call(global.process)==="[object process]"){installNextTickImplementation()}else if(canUsePostMessage()){installPostMessageImplementation()}else if(global.MessageChannel){installMessageChannelImplementation()}else if(doc&&"onreadystatechange"in doc.createElement("script")){installReadyStateChangeImplementation()}else{installSetTimeoutImplementation()}attachTo.setImmediate=setImmediate;attachTo.clearImmediate=clearImmediate})(typeof self==="undefined"?typeof global==="undefined"?this:global:self)}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:378}],399:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function id(d){return d[0]}const deepFlatten=arr=>[].concat(...arr.map((v=>Array.isArray(v)?deepFlatten(v):v)));function flat_string(d){if(d){if(Array.isArray(d))return deepFlatten(d).join("");return d}return""}const grammar={Lexer:undefined,ParserRules:[{name:"Reverse_path",symbols:["Path"]},{name:"Reverse_path$string$1",symbols:[{literal:"<"},{literal:">"}],postprocess:d=>d.join("")},{name:"Reverse_path",symbols:["Reverse_path$string$1"]},{name:"Forward_path$subexpression$1$subexpression$1",symbols:[{literal:"<"},/[pP]/,/[oO]/,/[sS]/,/[tT]/,/[mM]/,/[aA]/,/[sS]/,/[tT]/,/[eE]/,/[rR]/,{literal:"@"}],postprocess:function(d){return d.join("")}},{name:"Forward_path$subexpression$1",symbols:["Forward_path$subexpression$1$subexpression$1","Domain",{literal:">"}]},{name:"Forward_path",symbols:["Forward_path$subexpression$1"]},{name:"Forward_path$subexpression$2",symbols:[{literal:"<"},/[pP]/,/[oO]/,/[sS]/,/[tT]/,/[mM]/,/[aA]/,/[sS]/,/[tT]/,/[eE]/,/[rR]/,{literal:">"}],postprocess:function(d){return d.join("")}},{name:"Forward_path",symbols:["Forward_path$subexpression$2"]},{name:"Forward_path",symbols:["Path"]},{name:"Path$ebnf$1$subexpression$1",symbols:["A_d_l",{literal:":"}]},{name:"Path$ebnf$1",symbols:["Path$ebnf$1$subexpression$1"],postprocess:id},{name:"Path$ebnf$1",symbols:[],postprocess:()=>null},{name:"Path",symbols:[{literal:"<"},"Path$ebnf$1","Mailbox",{literal:">"}]},{name:"A_d_l$ebnf$1",symbols:[]},{name:"A_d_l$ebnf$1$subexpression$1",symbols:[{literal:","},"At_domain"]},{name:"A_d_l$ebnf$1",symbols:["A_d_l$ebnf$1","A_d_l$ebnf$1$subexpression$1"],postprocess:d=>d[0].concat([d[1]])},{name:"A_d_l",symbols:["At_domain","A_d_l$ebnf$1"]},{name:"At_domain",symbols:[{literal:"@"},"Domain"]},{name:"Domain$ebnf$1",symbols:[]},{name:"Domain$ebnf$1$subexpression$1",symbols:[{literal:"."},"sub_domain"]},{name:"Domain$ebnf$1",symbols:["Domain$ebnf$1","Domain$ebnf$1$subexpression$1"],postprocess:d=>d[0].concat([d[1]])},{name:"Domain",symbols:["sub_domain","Domain$ebnf$1"]},{name:"sub_domain",symbols:["U_label"]},{name:"Let_dig",symbols:["ALPHA_DIGIT"],postprocess:id},{name:"Ldh_str$ebnf$1",symbols:[]},{name:"Ldh_str$ebnf$1",symbols:["Ldh_str$ebnf$1","ALPHA_DIG_DASH"],postprocess:d=>d[0].concat([d[1]])},{name:"Ldh_str",symbols:["Ldh_str$ebnf$1","Let_dig"]},{name:"U_Let_dig",symbols:["ALPHA_DIGIT_U"],postprocess:id},{name:"U_Ldh_str$ebnf$1",symbols:[]},{name:"U_Ldh_str$ebnf$1",symbols:["U_Ldh_str$ebnf$1","ALPHA_DIG_DASH_U"],postprocess:d=>d[0].concat([d[1]])},{name:"U_Ldh_str",symbols:["U_Ldh_str$ebnf$1","U_Let_dig"]},{name:"U_label$ebnf$1$subexpression$1",symbols:["U_Ldh_str"]},{name:"U_label$ebnf$1",symbols:["U_label$ebnf$1$subexpression$1"],postprocess:id},{name:"U_label$ebnf$1",symbols:[],postprocess:()=>null},{name:"U_label",symbols:["U_Let_dig","U_label$ebnf$1"]},{name:"address_literal$subexpression$1",symbols:["IPv4_address_literal"]},{name:"address_literal$subexpression$1",symbols:["IPv6_address_literal"]},{name:"address_literal$subexpression$1",symbols:["General_address_literal"]},{name:"address_literal",symbols:[{literal:"["},"address_literal$subexpression$1",{literal:"]"}]},{name:"non_local_part",symbols:["Domain"],postprocess:function(d){return{DomainName:flat_string(d[0])}}},{name:"non_local_part",symbols:["address_literal"],postprocess:function(d){return{AddressLiteral:flat_string(d[0])}}},{name:"Mailbox",symbols:["Local_part",{literal:"@"},"non_local_part"],postprocess:function(d){return{localPart:flat_string(d[0]),domainPart:flat_string(d[2])}}},{name:"Local_part",symbols:["Dot_string"],postprocess:function(d){return{DotString:flat_string(d[0])}}},{name:"Local_part",symbols:["Quoted_string"],postprocess:function(d){return{QuotedString:flat_string(d[0])}}},{name:"Dot_string$ebnf$1",symbols:[]},{name:"Dot_string$ebnf$1$subexpression$1",symbols:[{literal:"."},"Atom"]},{name:"Dot_string$ebnf$1",symbols:["Dot_string$ebnf$1","Dot_string$ebnf$1$subexpression$1"],postprocess:d=>d[0].concat([d[1]])},{name:"Dot_string",symbols:["Atom","Dot_string$ebnf$1"]},{name:"Atom$ebnf$1",symbols:[/[0-9A-Za-z!#$%&'*+\-/=?^_`{|}~\u0080-\uFFFF/]/]},{name:"Atom$ebnf$1",symbols:["Atom$ebnf$1",/[0-9A-Za-z!#$%&'*+\-/=?^_`{|}~\u0080-\uFFFF/]/],postprocess:d=>d[0].concat([d[1]])},{name:"Atom",symbols:["Atom$ebnf$1"]},{name:"Quoted_string$ebnf$1",symbols:[]},{name:"Quoted_string$ebnf$1",symbols:["Quoted_string$ebnf$1","QcontentSMTP"],postprocess:d=>d[0].concat([d[1]])},{name:"Quoted_string",symbols:["DQUOTE","Quoted_string$ebnf$1","DQUOTE"]},{name:"QcontentSMTP",symbols:["qtextSMTP"]},{name:"QcontentSMTP",symbols:["quoted_pairSMTP"]},{name:"quoted_pairSMTP",symbols:[{literal:"\\"},/[\x20-\x7e]/]},{name:"qtextSMTP",symbols:[/[\x20-\x21\x23-\x5b\x5d-\x7e\u0080-\uFFFF]/],postprocess:id},{name:"IPv4_address_literal$macrocall$2",symbols:[{literal:"."},"Snum"]},{name:"IPv4_address_literal$macrocall$1",symbols:["IPv4_address_literal$macrocall$2","IPv4_address_literal$macrocall$2","IPv4_address_literal$macrocall$2"]},{name:"IPv4_address_literal",symbols:["Snum","IPv4_address_literal$macrocall$1"]},{name:"IPv6_address_literal$subexpression$1",symbols:[/[iI]/,/[pP]/,/[vV]/,{literal:"6"},{literal:":"}],postprocess:function(d){return d.join("")}},{name:"IPv6_address_literal",symbols:["IPv6_address_literal$subexpression$1","IPv6_addr"]},{name:"General_address_literal$ebnf$1",symbols:["dcontent"]},{name:"General_address_literal$ebnf$1",symbols:["General_address_literal$ebnf$1","dcontent"],postprocess:d=>d[0].concat([d[1]])},{name:"General_address_literal",symbols:["Standardized_tag",{literal:":"},"General_address_literal$ebnf$1"]},{name:"Standardized_tag",symbols:["Ldh_str"]},{name:"dcontent",symbols:[/[\x21-\x5a\x5e-\x7e]/],postprocess:id},{name:"Snum",symbols:["DIGIT"]},{name:"Snum$subexpression$1",symbols:[/[1-9]/,"DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$1"]},{name:"Snum$subexpression$2",symbols:[{literal:"1"},"DIGIT","DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$2"]},{name:"Snum$subexpression$3",symbols:[{literal:"2"},/[0-4]/,"DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$3"]},{name:"Snum$subexpression$4",symbols:[{literal:"2"},{literal:"5"},/[0-5]/]},{name:"Snum",symbols:["Snum$subexpression$4"]},{name:"IPv6_addr",symbols:["IPv6_full"]},{name:"IPv6_addr",symbols:["IPv6_comp"]},{name:"IPv6_addr",symbols:["IPv6v4_full"]},{name:"IPv6_addr",symbols:["IPv6v4_comp"]},{name:"IPv6_hex",symbols:["HEXDIG"]},{name:"IPv6_hex$subexpression$1",symbols:["HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$1"]},{name:"IPv6_hex$subexpression$2",symbols:["HEXDIG","HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$2"]},{name:"IPv6_hex$subexpression$3",symbols:["HEXDIG","HEXDIG","HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$3"]},{name:"IPv6_full$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_full$macrocall$1",symbols:["IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2"]},{name:"IPv6_full",symbols:["IPv6_hex","IPv6_full$macrocall$1"]},{name:"IPv6_comp$ebnf$1$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_comp$ebnf$1$subexpression$1$macrocall$1",symbols:["IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2"]},{name:"IPv6_comp$ebnf$1$subexpression$1",symbols:["IPv6_hex","IPv6_comp$ebnf$1$subexpression$1$macrocall$1"]},{name:"IPv6_comp$ebnf$1",symbols:["IPv6_comp$ebnf$1$subexpression$1"],postprocess:id},{name:"IPv6_comp$ebnf$1",symbols:[],postprocess:()=>null},{name:"IPv6_comp$string$1",symbols:[{literal:":"},{literal:":"}],postprocess:d=>d.join("")},{name:"IPv6_comp$ebnf$2$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_comp$ebnf$2$subexpression$1$macrocall$1",symbols:["IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2"]},{name:"IPv6_comp$ebnf$2$subexpression$1",symbols:["IPv6_hex","IPv6_comp$ebnf$2$subexpression$1$macrocall$1"]},{name:"IPv6_comp$ebnf$2",symbols:["IPv6_comp$ebnf$2$subexpression$1"],postprocess:id},{name:"IPv6_comp$ebnf$2",symbols:[],postprocess:()=>null},{name:"IPv6_comp",symbols:["IPv6_comp$ebnf$1","IPv6_comp$string$1","IPv6_comp$ebnf$2"]},{name:"IPv6v4_full$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_full$macrocall$1",symbols:["IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2"]},{name:"IPv6v4_full",symbols:["IPv6_hex","IPv6v4_full$macrocall$1",{literal:":"},"IPv4_address_literal"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1$macrocall$1",symbols:["IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1",symbols:["IPv6_hex","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$1"]},{name:"IPv6v4_comp$ebnf$1",symbols:["IPv6v4_comp$ebnf$1$subexpression$1"],postprocess:id},{name:"IPv6v4_comp$ebnf$1",symbols:[],postprocess:()=>null},{name:"IPv6v4_comp$string$1",symbols:[{literal:":"},{literal:":"}],postprocess:d=>d.join("")},{name:"IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_comp$ebnf$2$subexpression$1$macrocall$1",symbols:["IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2"]},{name:"IPv6v4_comp$ebnf$2$subexpression$1",symbols:["IPv6_hex","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$1",{literal:":"}]},{name:"IPv6v4_comp$ebnf$2",symbols:["IPv6v4_comp$ebnf$2$subexpression$1"],postprocess:id},{name:"IPv6v4_comp$ebnf$2",symbols:[],postprocess:()=>null},{name:"IPv6v4_comp",symbols:["IPv6v4_comp$ebnf$1","IPv6v4_comp$string$1","IPv6v4_comp$ebnf$2","IPv4_address_literal"]},{name:"DIGIT",symbols:[/[0-9]/],postprocess:id},{name:"ALPHA_DIGIT_U",symbols:[/[0-9A-Za-z\u0080-\uFFFF]/],postprocess:id},{name:"ALPHA_DIGIT",symbols:[/[0-9A-Za-z]/],postprocess:id},{name:"ALPHA_DIG_DASH",symbols:[/[-0-9A-Za-z]/],postprocess:id},{name:"ALPHA_DIG_DASH_U",symbols:[/[-0-9A-Za-z\u0080-\uFFFF]/],postprocess:id},{name:"HEXDIG",symbols:[/[0-9A-Fa-f]/],postprocess:id},{name:"DQUOTE",symbols:[{literal:'"'}],postprocess:id}],ParserStart:"Reverse_path"};exports.default=grammar},{}],400:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.canonicalize=exports.canonicalize_quoted_string=exports.normalize=exports.normalize_dot_string=exports.parse=void 0;const nearley=require("nearley");const grammar_1=__importDefault(require("./grammar"));grammar_1.default.ParserStart="Mailbox";const grammar=nearley.Grammar.fromCompiled(grammar_1.default);function parse(address){const parser=new nearley.Parser(grammar);parser.feed(address);if(parser.results.length!==1){throw new Error("address parsing failed: ambiguous grammar")}return parser.results[0]}exports.parse=parse;function normalize_dot_string(dot_string){const tagless=function(){const plus_loc=dot_string.indexOf("+");if(plus_loc===-1){return dot_string}return dot_string.substr(0,plus_loc)}();const dotless=tagless.replace(/\./g,"");return dotless.toLowerCase()}exports.normalize_dot_string=normalize_dot_string;function normalize(address){var _a,_b;const a=parse(address);const domain=(_a=a.domainPart.AddressLiteral)!==null&&_a!==void 0?_a:a.domainPart.DomainName.toLowerCase();const local=(_b=a.localPart.QuotedString)!==null&&_b!==void 0?_b:normalize_dot_string(a.localPart.DotString);return`${local}@${domain}`}exports.normalize=normalize;function canonicalize_quoted_string(quoted_string){const unquoted=quoted_string.substr(1).substr(0,quoted_string.length-2);const unescaped=unquoted.replace(/(?:\\(.))/g,"$1");const reescaped=unescaped.replace(/(?:(["\\]))/g,"\\$1");return`"${reescaped}"`}exports.canonicalize_quoted_string=canonicalize_quoted_string;function canonicalize(address){var _a;const a=parse(address);const domain=(_a=a.domainPart.AddressLiteral)!==null&&_a!==void 0?_a:a.domainPart.DomainName.toLowerCase();const local=a.localPart.QuotedString?canonicalize_quoted_string(a.localPart.QuotedString):a.localPart.DotString;return`${local}@${domain}`}exports.canonicalize=canonicalize},{"./grammar":399,nearley:373}],401:[function(require,module,exports){(function(global){(function(){var ClientRequest=require("./lib/request");var response=require("./lib/response");var extend=require("xtend");var statusCodes=require("builtin-status-codes");var url=require("url");var http=exports;http.request=function(opts,cb){if(typeof opts==="string")opts=url.parse(opts);else opts=extend(opts);var defaultProtocol=global.location.protocol.search(/^https?:$/)===-1?"http:":"";var protocol=opts.protocol||defaultProtocol;var host=opts.hostname||opts.host;var port=opts.port;var path=opts.path||"/";if(host&&host.indexOf(":")!==-1)host="["+host+"]";opts.url=(host?protocol+"//"+host:"")+(port?":"+port:"")+path;opts.method=(opts.method||"GET").toUpperCase();opts.headers=opts.headers||{};var req=new ClientRequest(opts);if(cb)req.on("response",cb);return req};http.get=function get(opts,cb){var req=http.request(opts,cb);req.end();return req};http.ClientRequest=ClientRequest;http.IncomingMessage=response.IncomingMessage;http.Agent=function(){};http.Agent.defaultMaxSockets=4;http.globalAgent=new http.Agent;http.STATUS_CODES=statusCodes;http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./lib/request":403,"./lib/response":404,"builtin-status-codes":152,url:437,xtend:478}],402:[function(require,module,exports){(function(global){(function(){exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableStream);exports.writableStream=isFunction(global.WritableStream);exports.abortController=isFunction(global.AbortController);var xhr;function getXHR(){if(xhr!==undefined)return xhr;if(global.XMLHttpRequest){xhr=new global.XMLHttpRequest;try{xhr.open("GET",global.XDomainRequest?"/":"https://example.com")}catch(e){xhr=null}}else{xhr=null}return xhr}function checkTypeSupport(type){var xhr=getXHR();if(!xhr)return false;try{xhr.responseType=type;return xhr.responseType===type}catch(e){}return false}exports.arraybuffer=exports.fetch||checkTypeSupport("arraybuffer");exports.msstream=!exports.fetch&&checkTypeSupport("ms-stream");exports.mozchunkedarraybuffer=!exports.fetch&&checkTypeSupport("moz-chunked-arraybuffer");exports.overrideMimeType=exports.fetch||(getXHR()?isFunction(getXHR().overrideMimeType):false);function isFunction(value){return typeof value==="function"}xhr=null}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],403:[function(require,module,exports){(function(process,global,Buffer){(function(){var capability=require("./capability");var inherits=require("inherits");var response=require("./response");var stream=require("readable-stream");var IncomingMessage=response.IncomingMessage;var rStates=response.readyStates;function decideMode(preferBinary,useFetch){if(capability.fetch&&useFetch){return"fetch"}else if(capability.mozchunkedarraybuffer){return"moz-chunked-arraybuffer"}else if(capability.msstream){return"ms-stream"}else if(capability.arraybuffer&&preferBinary){return"arraybuffer"}else{return"text"}}var ClientRequest=module.exports=function(opts){var self=this;stream.Writable.call(self);self._opts=opts;self._body=[];self._headers={};if(opts.auth)self.setHeader("Authorization","Basic "+Buffer.from(opts.auth).toString("base64"));Object.keys(opts.headers).forEach((function(name){self.setHeader(name,opts.headers[name])}));var preferBinary;var useFetch=true;if(opts.mode==="disable-fetch"||"requestTimeout"in opts&&!capability.abortController){useFetch=false;preferBinary=true}else if(opts.mode==="prefer-streaming"){preferBinary=false}else if(opts.mode==="allow-wrong-content-type"){preferBinary=!capability.overrideMimeType}else if(!opts.mode||opts.mode==="default"||opts.mode==="prefer-fast"){preferBinary=true}else{throw new Error("Invalid value for opts.mode")}self._mode=decideMode(preferBinary,useFetch);self._fetchTimer=null;self._socketTimeout=null;self._socketTimer=null;self.on("finish",(function(){self._onFinish()}))};inherits(ClientRequest,stream.Writable);ClientRequest.prototype.setHeader=function(name,value){var self=this;var lowerName=name.toLowerCase();if(unsafeHeaders.indexOf(lowerName)!==-1)return;self._headers[lowerName]={name:name,value:value}};ClientRequest.prototype.getHeader=function(name){var header=this._headers[name.toLowerCase()];if(header)return header.value;return null};ClientRequest.prototype.removeHeader=function(name){var self=this;delete self._headers[name.toLowerCase()]};ClientRequest.prototype._onFinish=function(){var self=this;if(self._destroyed)return;var opts=self._opts;if("timeout"in opts&&opts.timeout!==0){self.setTimeout(opts.timeout)}var headersObj=self._headers;var body=null;if(opts.method!=="GET"&&opts.method!=="HEAD"){body=new Blob(self._body,{type:(headersObj["content-type"]||{}).value||""})}var headersList=[];Object.keys(headersObj).forEach((function(keyName){var name=headersObj[keyName].name;var value=headersObj[keyName].value;if(Array.isArray(value)){value.forEach((function(v){headersList.push([name,v])}))}else{headersList.push([name,value])}}));if(self._mode==="fetch"){var signal=null;if(capability.abortController){var controller=new AbortController;signal=controller.signal;self._fetchAbortController=controller;if("requestTimeout"in opts&&opts.requestTimeout!==0){self._fetchTimer=global.setTimeout((function(){self.emit("requestTimeout");if(self._fetchAbortController)self._fetchAbortController.abort()}),opts.requestTimeout)}}global.fetch(self._opts.url,{method:self._opts.method,headers:headersList,body:body||undefined,mode:"cors",credentials:opts.withCredentials?"include":"same-origin",signal:signal}).then((function(response){self._fetchResponse=response;self._resetTimers(false);self._connect()}),(function(reason){self._resetTimers(true);if(!self._destroyed)self.emit("error",reason)}))}else{var xhr=self._xhr=new global.XMLHttpRequest;try{xhr.open(self._opts.method,self._opts.url,true)}catch(err){process.nextTick((function(){self.emit("error",err)}));return}if("responseType"in xhr)xhr.responseType=self._mode;if("withCredentials"in xhr)xhr.withCredentials=!!opts.withCredentials;if(self._mode==="text"&&"overrideMimeType"in xhr)xhr.overrideMimeType("text/plain; charset=x-user-defined");if("requestTimeout"in opts){xhr.timeout=opts.requestTimeout;xhr.ontimeout=function(){self.emit("requestTimeout")}}headersList.forEach((function(header){xhr.setRequestHeader(header[0],header[1])}));self._response=null;xhr.onreadystatechange=function(){switch(xhr.readyState){case rStates.LOADING:case rStates.DONE:self._onXHRProgress();break}};if(self._mode==="moz-chunked-arraybuffer"){xhr.onprogress=function(){self._onXHRProgress()}}xhr.onerror=function(){if(self._destroyed)return;self._resetTimers(true);self.emit("error",new Error("XHR error"))};try{xhr.send(body)}catch(err){process.nextTick((function(){self.emit("error",err)}));return}}};function statusValid(xhr){try{var status=xhr.status;return status!==null&&status!==0}catch(e){return false}}ClientRequest.prototype._onXHRProgress=function(){var self=this;self._resetTimers(false);if(!statusValid(self._xhr)||self._destroyed)return;if(!self._response)self._connect();self._response._onXHRProgress(self._resetTimers.bind(self))};ClientRequest.prototype._connect=function(){var self=this;if(self._destroyed)return;self._response=new IncomingMessage(self._xhr,self._fetchResponse,self._mode,self._resetTimers.bind(self));self._response.on("error",(function(err){self.emit("error",err)}));self.emit("response",self._response)};ClientRequest.prototype._write=function(chunk,encoding,cb){var self=this;self._body.push(chunk);cb()};ClientRequest.prototype._resetTimers=function(done){var self=this;global.clearTimeout(self._socketTimer);self._socketTimer=null;if(done){global.clearTimeout(self._fetchTimer);self._fetchTimer=null}else if(self._socketTimeout){self._socketTimer=global.setTimeout((function(){self.emit("timeout")}),self._socketTimeout)}};ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(err){var self=this;self._destroyed=true;self._resetTimers(true);if(self._response)self._response._destroyed=true;if(self._xhr)self._xhr.abort();else if(self._fetchAbortController)self._fetchAbortController.abort();if(err)self.emit("error",err)};ClientRequest.prototype.end=function(data,encoding,cb){var self=this;if(typeof data==="function"){cb=data;data=undefined}stream.Writable.prototype.end.call(self,data,encoding,cb)};ClientRequest.prototype.setTimeout=function(timeout,cb){var self=this;if(cb)self.once("timeout",cb);self._socketTimeout=timeout;self._resetTimers(false)};ClientRequest.prototype.flushHeaders=function(){};ClientRequest.prototype.setNoDelay=function(){};ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"./capability":402,"./response":404,_process:378,buffer:151,inherits:279,"readable-stream":419}],404:[function(require,module,exports){(function(process,global,Buffer){(function(){var capability=require("./capability");var inherits=require("inherits");var stream=require("readable-stream");var rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var IncomingMessage=exports.IncomingMessage=function(xhr,response,mode,resetTimers){var self=this;stream.Readable.call(self);self._mode=mode;self.headers={};self.rawHeaders=[];self.trailers={};self.rawTrailers=[];self.on("end",(function(){process.nextTick((function(){self.emit("close")}))}));if(mode==="fetch"){self._fetchResponse=response;self.url=response.url;self.statusCode=response.status;self.statusMessage=response.statusText;response.headers.forEach((function(header,key){self.headers[key.toLowerCase()]=header;self.rawHeaders.push(key,header)}));if(capability.writableStream){var writable=new WritableStream({write:function(chunk){resetTimers(false);return new Promise((function(resolve,reject){if(self._destroyed){reject()}else if(self.push(Buffer.from(chunk))){resolve()}else{self._resumeFetch=resolve}}))},close:function(){resetTimers(true);if(!self._destroyed)self.push(null)},abort:function(err){resetTimers(true);if(!self._destroyed)self.emit("error",err)}});try{response.body.pipeTo(writable).catch((function(err){resetTimers(true);if(!self._destroyed)self.emit("error",err)}));return}catch(e){}}var reader=response.body.getReader();function read(){reader.read().then((function(result){if(self._destroyed)return;resetTimers(result.done);if(result.done){self.push(null);return}self.push(Buffer.from(result.value));read()})).catch((function(err){resetTimers(true);if(!self._destroyed)self.emit("error",err)}))}read()}else{self._xhr=xhr;self._pos=0;self.url=xhr.responseURL;self.statusCode=xhr.status;self.statusMessage=xhr.statusText;var headers=xhr.getAllResponseHeaders().split(/\r?\n/);headers.forEach((function(header){var matches=header.match(/^([^:]+):\s*(.*)/);if(matches){var key=matches[1].toLowerCase();if(key==="set-cookie"){if(self.headers[key]===undefined){self.headers[key]=[]}self.headers[key].push(matches[2])}else if(self.headers[key]!==undefined){self.headers[key]+=", "+matches[2]}else{self.headers[key]=matches[2]}self.rawHeaders.push(matches[1],matches[2])}}));self._charset="x-user-defined";if(!capability.overrideMimeType){var mimeType=self.rawHeaders["mime-type"];if(mimeType){var charsetMatch=mimeType.match(/;\s*charset=([^;])(;|$)/);if(charsetMatch){self._charset=charsetMatch[1].toLowerCase()}}if(!self._charset)self._charset="utf-8"}}};inherits(IncomingMessage,stream.Readable);IncomingMessage.prototype._read=function(){var self=this;var resolve=self._resumeFetch;if(resolve){self._resumeFetch=null;resolve()}};IncomingMessage.prototype._onXHRProgress=function(resetTimers){var self=this;var xhr=self._xhr;var response=null;switch(self._mode){case"text":response=xhr.responseText;if(response.length>self._pos){var newData=response.substr(self._pos);if(self._charset==="x-user-defined"){var buffer=Buffer.alloc(newData.length);for(var i=0;i<newData.length;i++)buffer[i]=newData.charCodeAt(i)&255;self.push(buffer)}else{self.push(newData,self._charset)}self._pos=response.length}break;case"arraybuffer":if(xhr.readyState!==rStates.DONE||!xhr.response)break;response=xhr.response;self.push(Buffer.from(new Uint8Array(response)));break;case"moz-chunked-arraybuffer":response=xhr.response;if(xhr.readyState!==rStates.LOADING||!response)break;self.push(Buffer.from(new Uint8Array(response)));break;case"ms-stream":response=xhr.response;if(xhr.readyState!==rStates.LOADING)break;var reader=new global.MSStreamReader;reader.onprogress=function(){if(reader.result.byteLength>self._pos){self.push(Buffer.from(new Uint8Array(reader.result.slice(self._pos))));self._pos=reader.result.byteLength}};reader.onload=function(){resetTimers(true);self.push(null)};reader.readAsArrayBuffer(response);break}if(self._xhr.readyState===rStates.DONE&&self._mode!=="ms-stream"){resetTimers(true);self.push(null)}}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"./capability":402,_process:378,buffer:151,inherits:279,"readable-stream":419}],405:[function(require,module,exports){"use strict";function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var codes={};function createErrorType(code,message,Base){if(!Base){Base=Error}function getMessage(arg1,arg2,arg3){if(typeof message==="string"){return message}else{return message(arg1,arg2,arg3)}}var NodeError=function(_Base){_inheritsLoose(NodeError,_Base);function NodeError(arg1,arg2,arg3){return _Base.call(this,getMessage(arg1,arg2,arg3))||this}return NodeError}(Base);NodeError.prototype.name=Base.name;NodeError.prototype.code=code;codes[code]=NodeError}function oneOf(expected,thing){if(Array.isArray(expected)){var len=expected.length;expected=expected.map((function(i){return String(i)}));if(len>2){return"one of ".concat(thing," ").concat(expected.slice(0,len-1).join(", "),", or ")+expected[len-1]}else if(len===2){return"one of ".concat(thing," ").concat(expected[0]," or ").concat(expected[1])}else{return"of ".concat(thing," ").concat(expected[0])}}else{return"of ".concat(thing," ").concat(String(expected))}}function startsWith(str,search,pos){return str.substr(!pos||pos<0?0:+pos,search.length)===search}function endsWith(str,search,this_len){if(this_len===undefined||this_len>str.length){this_len=str.length}return str.substring(this_len-search.length,this_len)===search}function includes(str,search,start){if(typeof start!=="number"){start=0}if(start+search.length>str.length){return false}else{return str.indexOf(search,start)!==-1}}createErrorType("ERR_INVALID_OPT_VALUE",(function(name,value){return'The value "'+value+'" is invalid for option "'+name+'"'}),TypeError);createErrorType("ERR_INVALID_ARG_TYPE",(function(name,expected,actual){var determiner;if(typeof expected==="string"&&startsWith(expected,"not ")){determiner="must not be";expected=expected.replace(/^not /,"")}else{determiner="must be"}var msg;if(endsWith(name," argument")){msg="The ".concat(name," ").concat(determiner," ").concat(oneOf(expected,"type"))}else{var type=includes(name,".")?"property":"argument";msg='The "'.concat(name,'" ').concat(type," ").concat(determiner," ").concat(oneOf(expected,"type"))}msg+=". Received type ".concat(typeof actual);return msg}),TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",(function(name){return"The "+name+" method is not implemented"}));createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",(function(name){return"Cannot call "+name+" after a stream was destroyed"}));createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",(function(arg){return"Unknown encoding: "+arg}),TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");module.exports.codes=codes},{}],406:[function(require,module,exports){(function(process){(function(){"use strict";var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj){keys.push(key)}return keys};module.exports=Duplex;var Readable=require("./_stream_readable");var Writable=require("./_stream_writable");require("inherits")(Duplex,Readable);{var keys=objectKeys(Writable.prototype);for(var v=0;v<keys.length;v++){var method=keys[v];if(!Duplex.prototype[method])Duplex.prototype[method]=Writable.prototype[method]}}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options);Writable.call(this,options);this.allowHalfOpen=true;if(options){if(options.readable===false)this.readable=false;if(options.writable===false)this.writable=false;if(options.allowHalfOpen===false){this.allowHalfOpen=false;this.once("end",onend)}}}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function onend(){if(this._writableState.ended)return;process.nextTick(onEndNT,this)}function onEndNT(self){self.end()}Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function set(value){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=value;this._writableState.destroyed=value}})}).call(this)}).call(this,require("_process"))},{"./_stream_readable":408,"./_stream_writable":410,_process:378,inherits:279}],407:[function(require,module,exports){"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform");require("inherits")(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":409,inherits:279}],408:[function(require,module,exports){(function(process,global){(function(){"use strict";module.exports=Readable;var Duplex;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;var EElistenerCount=function EElistenerCount(emitter,type){return emitter.listeners(type).length};var Stream=require("./internal/streams/stream");var Buffer=require("buffer").Buffer;var OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk)}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}var debugUtil=require("util");var debug;if(debugUtil&&debugUtil.debuglog){debug=debugUtil.debuglog("stream")}else{debug=function debug(){}}var BufferList=require("./internal/streams/buffer_list");var destroyImpl=require("./internal/streams/destroy");var _require=require("./internal/streams/state"),getHighWaterMark=_require.getHighWaterMark;var _require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_STREAM_PUSH_AFTER_EOF=_require$codes.ERR_STREAM_PUSH_AFTER_EOF,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_STREAM_UNSHIFT_AFTER_END_EVENT=_require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;var StringDecoder;var createReadableStreamAsyncIterator;var from;require("inherits")(Readable,Stream);var errorOrDestroy=destroyImpl.errorOrDestroy;var kProxyEvents=["error","close","destroy","pause","resume"];function prependListener(emitter,event,fn){if(typeof emitter.prependListener==="function")return emitter.prependListener(event,fn);if(!emitter._events||!emitter._events[event])emitter.on(event,fn);else if(Array.isArray(emitter._events[event]))emitter._events[event].unshift(fn);else emitter._events[event]=[fn,emitter._events[event]]}function ReadableState(options,stream,isDuplex){Duplex=Duplex||require("./_stream_duplex");options=options||{};if(typeof isDuplex!=="boolean")isDuplex=stream instanceof Duplex;this.objectMode=!!options.objectMode;if(isDuplex)this.objectMode=this.objectMode||!!options.readableObjectMode;this.highWaterMark=getHighWaterMark(this,options,"readableHighWaterMark",isDuplex);this.buffer=new BufferList;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.paused=true;this.emitClose=options.emitClose!==false;this.autoDestroy=!!options.autoDestroy;this.destroyed=false;this.defaultEncoding=options.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)StringDecoder=require("string_decoder/").StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding}}function Readable(options){Duplex=Duplex||require("./_stream_duplex");if(!(this instanceof Readable))return new Readable(options);var isDuplex=this instanceof Duplex;this._readableState=new ReadableState(options,this,isDuplex);this.readable=true;if(options){if(typeof options.read==="function")this._read=options.read;if(typeof options.destroy==="function")this._destroy=options.destroy}Stream.call(this)}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function set(value){if(!this._readableState){return}this._readableState.destroyed=value}});Readable.prototype.destroy=destroyImpl.destroy;Readable.prototype._undestroy=destroyImpl.undestroy;Readable.prototype._destroy=function(err,cb){cb(err)};Readable.prototype.push=function(chunk,encoding){var state=this._readableState;var skipChunkCheck;if(!state.objectMode){if(typeof chunk==="string"){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=Buffer.from(chunk,encoding);encoding=""}skipChunkCheck=true}}else{skipChunkCheck=true}return readableAddChunk(this,chunk,encoding,false,skipChunkCheck)};Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,true,false)};function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){debug("readableAddChunk",chunk);var state=stream._readableState;if(chunk===null){state.reading=false;onEofChunk(stream,state)}else{var er;if(!skipChunkCheck)er=chunkInvalid(state,chunk);if(er){errorOrDestroy(stream,er)}else if(state.objectMode||chunk&&chunk.length>0){if(typeof chunk!=="string"&&!state.objectMode&&Object.getPrototypeOf(chunk)!==Buffer.prototype){chunk=_uint8ArrayToBuffer(chunk)}if(addToFront){if(state.endEmitted)errorOrDestroy(stream,new ERR_STREAM_UNSHIFT_AFTER_END_EVENT);else addChunk(stream,state,chunk,true)}else if(state.ended){errorOrDestroy(stream,new ERR_STREAM_PUSH_AFTER_EOF)}else if(state.destroyed){return false}else{state.reading=false;if(state.decoder&&!encoding){chunk=state.decoder.write(chunk);if(state.objectMode||chunk.length!==0)addChunk(stream,state,chunk,false);else maybeReadMore(stream,state)}else{addChunk(stream,state,chunk,false)}}}else if(!addToFront){state.reading=false;maybeReadMore(stream,state)}}return!state.ended&&(state.length<state.highWaterMark||state.length===0)}function addChunk(stream,state,chunk,addToFront){if(state.flowing&&state.length===0&&!state.sync){state.awaitDrain=0;stream.emit("data",chunk)}else{state.length+=state.objectMode?1:chunk.length;if(addToFront)state.buffer.unshift(chunk);else state.buffer.push(chunk);if(state.needReadable)emitReadable(stream)}maybeReadMore(stream,state)}function chunkInvalid(state,chunk){var er;if(!_isUint8Array(chunk)&&typeof chunk!=="string"&&chunk!==undefined&&!state.objectMode){er=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer","Uint8Array"],chunk)}return er}Readable.prototype.isPaused=function(){return this._readableState.flowing===false};Readable.prototype.setEncoding=function(enc){if(!StringDecoder)StringDecoder=require("string_decoder/").StringDecoder;var decoder=new StringDecoder(enc);this._readableState.decoder=decoder;this._readableState.encoding=this._readableState.decoder.encoding;var p=this._readableState.buffer.head;var content="";while(p!==null){content+=decoder.write(p.data);p=p.next}this._readableState.buffer.clear();if(content!=="")this._readableState.buffer.push(content);this._readableState.length=content.length;return this};var MAX_HWM=1073741824;function computeNewHighWaterMark(n){if(n>=MAX_HWM){n=MAX_HWM}else{n--;n|=n>>>1;n|=n>>>2;n|=n>>>4;n|=n>>>8;n|=n>>>16;n++}return n}function howMuchToRead(n,state){if(n<=0||state.length===0&&state.ended)return 0;if(state.objectMode)return 1;if(n!==n){if(state.flowing&&state.length)return state.buffer.head.data.length;else return state.length}if(n>state.highWaterMark)state.highWaterMark=computeNewHighWaterMark(n);if(n<=state.length)return n;if(!state.ended){state.needReadable=true;return 0}return state.length}Readable.prototype.read=function(n){debug("read",n);n=parseInt(n,10);var state=this._readableState;var nOrig=n;if(n!==0)state.emittedReadable=false;if(n===0&&state.needReadable&&((state.highWaterMark!==0?state.length>=state.highWaterMark:state.length>0)||state.ended)){debug("read: emitReadable",state.length,state.ended);if(state.length===0&&state.ended)endReadable(this);else emitReadable(this);return null}n=howMuchToRead(n,state);if(n===0&&state.ended){if(state.length===0)endReadable(this);return null}var doRead=state.needReadable;debug("need readable",doRead);if(state.length===0||state.length-n<state.highWaterMark){doRead=true;debug("length less than watermark",doRead)}if(state.ended||state.reading){doRead=false;debug("reading or ended",doRead)}else if(doRead){debug("do read");state.reading=true;state.sync=true;if(state.length===0)state.needReadable=true;this._read(state.highWaterMark);state.sync=false;if(!state.reading)n=howMuchToRead(nOrig,state)}var ret;if(n>0)ret=fromList(n,state);else ret=null;if(ret===null){state.needReadable=state.length<=state.highWaterMark;n=0}else{state.length-=n;state.awaitDrain=0}if(state.length===0){if(!state.ended)state.needReadable=true;if(nOrig!==n&&state.ended)endReadable(this)}if(ret!==null)this.emit("data",ret);return ret};function onEofChunk(stream,state){debug("onEofChunk");if(state.ended)return;if(state.decoder){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length}}state.ended=true;if(state.sync){emitReadable(stream)}else{state.needReadable=false;if(!state.emittedReadable){state.emittedReadable=true;emitReadable_(stream)}}}function emitReadable(stream){var state=stream._readableState;debug("emitReadable",state.needReadable,state.emittedReadable);state.needReadable=false;if(!state.emittedReadable){debug("emitReadable",state.flowing);state.emittedReadable=true;process.nextTick(emitReadable_,stream)}}function emitReadable_(stream){var state=stream._readableState;debug("emitReadable_",state.destroyed,state.length,state.ended);if(!state.destroyed&&(state.length||state.ended)){stream.emit("readable");state.emittedReadable=false}state.needReadable=!state.flowing&&!state.ended&&state.length<=state.highWaterMark;flow(stream)}function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;process.nextTick(maybeReadMore_,stream,state)}}function maybeReadMore_(stream,state){while(!state.reading&&!state.ended&&(state.length<state.highWaterMark||state.flowing&&state.length===0)){var len=state.length;debug("maybeReadMore read 0");stream.read(0);if(len===state.length)break}state.readingMore=false}Readable.prototype._read=function(n){errorOrDestroy(this,new ERR_METHOD_NOT_IMPLEMENTED("_read()"))};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break}state.pipesCount+=1;debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:unpipe;if(state.endEmitted)process.nextTick(endFn);else src.once("end",endFn);dest.on("unpipe",onunpipe);function onunpipe(readable,unpipeInfo){debug("onunpipe");if(readable===src){if(unpipeInfo&&unpipeInfo.hasUnpiped===false){unpipeInfo.hasUnpiped=true;cleanup()}}}function onend(){debug("onend");dest.end()}var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=false;function cleanup(){debug("cleanup");dest.removeListener("close",onclose);dest.removeListener("finish",onfinish);dest.removeListener("drain",ondrain);dest.removeListener("error",onerror);dest.removeListener("unpipe",onunpipe);src.removeListener("end",onend);src.removeListener("end",unpipe);src.removeListener("data",ondata);cleanedUp=true;if(state.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))ondrain()}src.on("data",ondata);function ondata(chunk){debug("ondata");var ret=dest.write(chunk);debug("dest.write",ret);if(ret===false){if((state.pipesCount===1&&state.pipes===dest||state.pipesCount>1&&indexOf(state.pipes,dest)!==-1)&&!cleanedUp){debug("false write response, pause",state.awaitDrain);state.awaitDrain++}src.pause()}}function onerror(er){debug("onerror",er);unpipe();dest.removeListener("error",onerror);if(EElistenerCount(dest,"error")===0)errorOrDestroy(dest,er)}prependListener(dest,"error",onerror);function onclose(){dest.removeListener("finish",onfinish);unpipe()}dest.once("close",onclose);function onfinish(){debug("onfinish");dest.removeListener("close",onclose);unpipe()}dest.once("finish",onfinish);function unpipe(){debug("unpipe");src.unpipe(dest)}dest.emit("pipe",src);if(!state.flowing){debug("pipe resume");src.resume()}return dest};function pipeOnDrain(src){return function pipeOnDrainFunctionResult(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain);if(state.awaitDrain)state.awaitDrain--;if(state.awaitDrain===0&&EElistenerCount(src,"data")){state.flowing=true;flow(src)}}}Readable.prototype.unpipe=function(dest){var state=this._readableState;var unpipeInfo={hasUnpiped:false};if(state.pipesCount===0)return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)return this;if(!dest)dest=state.pipes;state.pipes=null;state.pipesCount=0;state.flowing=false;if(dest)dest.emit("unpipe",this,unpipeInfo);return this}if(!dest){var dests=state.pipes;var len=state.pipesCount;state.pipes=null;state.pipesCount=0;state.flowing=false;for(var i=0;i<len;i++){dests[i].emit("unpipe",this,{hasUnpiped:false})}return this}var index=indexOf(state.pipes,dest);if(index===-1)return this;state.pipes.splice(index,1);state.pipesCount-=1;if(state.pipesCount===1)state.pipes=state.pipes[0];dest.emit("unpipe",this,unpipeInfo);return this};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);var state=this._readableState;if(ev==="data"){state.readableListening=this.listenerCount("readable")>0;if(state.flowing!==false)this.resume()}else if(ev==="readable"){if(!state.endEmitted&&!state.readableListening){state.readableListening=state.needReadable=true;state.flowing=false;state.emittedReadable=false;debug("on readable",state.length,state.reading);if(state.length){emitReadable(this)}else if(!state.reading){process.nextTick(nReadingNextTick,this)}}}return res};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.removeListener=function(ev,fn){var res=Stream.prototype.removeListener.call(this,ev,fn);if(ev==="readable"){process.nextTick(updateReadableListening,this)}return res};Readable.prototype.removeAllListeners=function(ev){var res=Stream.prototype.removeAllListeners.apply(this,arguments);if(ev==="readable"||ev===undefined){process.nextTick(updateReadableListening,this)}return res};function updateReadableListening(self){var state=self._readableState;state.readableListening=self.listenerCount("readable")>0;if(state.resumeScheduled&&!state.paused){state.flowing=true}else if(self.listenerCount("data")>0){self.resume()}}function nReadingNextTick(self){debug("readable nexttick read 0");self.read(0)}Readable.prototype.resume=function(){var state=this._readableState;if(!state.flowing){debug("resume");state.flowing=!state.readableListening;resume(this,state)}state.paused=false;return this};function resume(stream,state){if(!state.resumeScheduled){state.resumeScheduled=true;process.nextTick(resume_,stream,state)}}function resume_(stream,state){debug("resume",state.reading);if(!state.reading){stream.read(0)}state.resumeScheduled=false;stream.emit("resume");flow(stream);if(state.flowing&&!state.reading)stream.read(0)}Readable.prototype.pause=function(){debug("call pause flowing=%j",this._readableState.flowing);if(this._readableState.flowing!==false){debug("pause");this._readableState.flowing=false;this.emit("pause")}this._readableState.paused=true;return this};function flow(stream){var state=stream._readableState;debug("flow",state.flowing);while(state.flowing&&stream.read()!==null){}}Readable.prototype.wrap=function(stream){var _this=this;var state=this._readableState;var paused=false;stream.on("end",(function(){debug("wrapped end");if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)_this.push(chunk)}_this.push(null)}));stream.on("data",(function(chunk){debug("wrapped data");if(state.decoder)chunk=state.decoder.write(chunk);if(state.objectMode&&(chunk===null||chunk===undefined))return;else if(!state.objectMode&&(!chunk||!chunk.length))return;var ret=_this.push(chunk);if(!ret){paused=true;stream.pause()}}));for(var i in stream){if(this[i]===undefined&&typeof stream[i]==="function"){this[i]=function methodWrap(method){return function methodWrapReturnFunction(){return stream[method].apply(stream,arguments)}}(i)}}for(var n=0;n<kProxyEvents.length;n++){stream.on(kProxyEvents[n],this.emit.bind(this,kProxyEvents[n]))}this._read=function(n){debug("wrapped _read",n);if(paused){paused=false;stream.resume()}};return this};if(typeof Symbol==="function"){Readable.prototype[Symbol.asyncIterator]=function(){if(createReadableStreamAsyncIterator===undefined){createReadableStreamAsyncIterator=require("./internal/streams/async_iterator")}return createReadableStreamAsyncIterator(this)}}Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:false,get:function get(){return this._readableState.highWaterMark}});Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:false,get:function get(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:false,get:function get(){return this._readableState.flowing},set:function set(state){if(this._readableState){this._readableState.flowing=state}}});Readable._fromList=fromList;Object.defineProperty(Readable.prototype,"readableLength",{enumerable:false,get:function get(){return this._readableState.length}});function fromList(n,state){if(state.length===0)return null;var ret;if(state.objectMode)ret=state.buffer.shift();else if(!n||n>=state.length){if(state.decoder)ret=state.buffer.join("");else if(state.buffer.length===1)ret=state.buffer.first();else ret=state.buffer.concat(state.length);state.buffer.clear()}else{ret=state.buffer.consume(n,state.decoder)}return ret}function endReadable(stream){var state=stream._readableState;debug("endReadable",state.endEmitted);if(!state.endEmitted){state.ended=true;process.nextTick(endReadableNT,state,stream)}}function endReadableNT(state,stream){debug("endReadableNT",state.endEmitted,state.length);if(!state.endEmitted&&state.length===0){state.endEmitted=true;stream.readable=false;stream.emit("end");if(state.autoDestroy){var wState=stream._writableState;if(!wState||wState.autoDestroy&&wState.finished){stream.destroy()}}}}if(typeof Symbol==="function"){Readable.from=function(iterable,opts){if(from===undefined){from=require("./internal/streams/from")}return from(Readable,iterable,opts)}}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x)return i}return-1}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../errors":405,"./_stream_duplex":406,"./internal/streams/async_iterator":411,"./internal/streams/buffer_list":412,"./internal/streams/destroy":413,"./internal/streams/from":415,"./internal/streams/state":417,"./internal/streams/stream":418,_process:378,buffer:151,events:261,inherits:279,"string_decoder/":420,util:148}],409:[function(require,module,exports){"use strict";module.exports=Transform;var _require$codes=require("../errors").codes,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes.ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING=_require$codes.ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0=_require$codes.ERR_TRANSFORM_WITH_LENGTH_0;var Duplex=require("./_stream_duplex");require("inherits")(Transform,Duplex);function afterTransform(er,data){var ts=this._transformState;ts.transforming=false;var cb=ts.writecb;if(cb===null){return this.emit("error",new ERR_MULTIPLE_CALLBACK)}ts.writechunk=null;ts.writecb=null;if(data!=null)this.push(data);cb(er);var rs=this._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){this._read(rs.highWaterMark)}}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);this._transformState={afterTransform:afterTransform.bind(this),needTransform:false,transforming:false,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=true;this._readableState.sync=false;if(options){if(typeof options.transform==="function")this._transform=options.transform;if(typeof options.flush==="function")this._flush=options.flush}this.on("prefinish",prefinish)}function prefinish(){var _this=this;if(typeof this._flush==="function"&&!this._readableState.destroyed){this._flush((function(er,data){done(_this,er,data)}))}else{done(this,null,null)}}Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding)};Transform.prototype._transform=function(chunk,encoding,cb){cb(new ERR_METHOD_NOT_IMPLEMENTED("_transform()"))};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)this._read(rs.highWaterMark)}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)}else{ts.needTransform=true}};Transform.prototype._destroy=function(err,cb){Duplex.prototype._destroy.call(this,err,(function(err2){cb(err2)}))};function done(stream,er,data){if(er)return stream.emit("error",er);if(data!=null)stream.push(data);if(stream._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(stream._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;return stream.push(null)}},{"../errors":405,"./_stream_duplex":406,inherits:279}],410:[function(require,module,exports){(function(process,global){(function(){"use strict";module.exports=Writable;function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;this.next=null}function CorkedRequest(state){var _this=this;this.next=null;this.entry=null;this.finish=function(){onCorkedFinish(_this,state)}}var Duplex;Writable.WritableState=WritableState;var internalUtil={deprecate:require("util-deprecate")};var Stream=require("./internal/streams/stream");var Buffer=require("buffer").Buffer;var OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk)}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}var destroyImpl=require("./internal/streams/destroy");var _require=require("./internal/streams/state"),getHighWaterMark=_require.getHighWaterMark;var _require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes.ERR_MULTIPLE_CALLBACK,ERR_STREAM_CANNOT_PIPE=_require$codes.ERR_STREAM_CANNOT_PIPE,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED,ERR_STREAM_NULL_VALUES=_require$codes.ERR_STREAM_NULL_VALUES,ERR_STREAM_WRITE_AFTER_END=_require$codes.ERR_STREAM_WRITE_AFTER_END,ERR_UNKNOWN_ENCODING=_require$codes.ERR_UNKNOWN_ENCODING;var errorOrDestroy=destroyImpl.errorOrDestroy;require("inherits")(Writable,Stream);function nop(){}function WritableState(options,stream,isDuplex){Duplex=Duplex||require("./_stream_duplex");options=options||{};if(typeof isDuplex!=="boolean")isDuplex=stream instanceof Duplex;this.objectMode=!!options.objectMode;if(isDuplex)this.objectMode=this.objectMode||!!options.writableObjectMode;this.highWaterMark=getHighWaterMark(this,options,"writableHighWaterMark",isDuplex);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.emitClose=options.emitClose!==false;this.autoDestroy=!!options.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function getBuffer(){var current=this.bufferedRequest;var out=[];while(current){out.push(current);current=current.next}return out};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate((function writableStateBufferGetter(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(_){}})();var realHasInstance;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){realHasInstance=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function value(object){if(realHasInstance.call(this,object))return true;if(this!==Writable)return false;return object&&object._writableState instanceof WritableState}})}else{realHasInstance=function realHasInstance(object){return object instanceof this}}function Writable(options){Duplex=Duplex||require("./_stream_duplex");var isDuplex=this instanceof Duplex;if(!isDuplex&&!realHasInstance.call(Writable,this))return new Writable(options);this._writableState=new WritableState(options,this,isDuplex);this.writable=true;if(options){if(typeof options.write==="function")this._write=options.write;if(typeof options.writev==="function")this._writev=options.writev;if(typeof options.destroy==="function")this._destroy=options.destroy;if(typeof options.final==="function")this._final=options.final}Stream.call(this)}Writable.prototype.pipe=function(){errorOrDestroy(this,new ERR_STREAM_CANNOT_PIPE)};function writeAfterEnd(stream,cb){var er=new ERR_STREAM_WRITE_AFTER_END;errorOrDestroy(stream,er);process.nextTick(cb,er)}function validChunk(stream,state,chunk,cb){var er;if(chunk===null){er=new ERR_STREAM_NULL_VALUES}else if(typeof chunk!=="string"&&!state.objectMode){er=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer"],chunk)}if(er){errorOrDestroy(stream,er);process.nextTick(cb,er);return false}return true}Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;var isBuf=!state.objectMode&&_isUint8Array(chunk);if(isBuf&&!Buffer.isBuffer(chunk)){chunk=_uint8ArrayToBuffer(chunk)}if(typeof encoding==="function"){cb=encoding;encoding=null}if(isBuf)encoding="buffer";else if(!encoding)encoding=state.defaultEncoding;if(typeof cb!=="function")cb=nop;if(state.ending)writeAfterEnd(this,cb);else if(isBuf||validChunk(this,state,chunk,cb)){state.pendingcb++;ret=writeOrBuffer(this,state,isBuf,chunk,encoding,cb)}return ret};Writable.prototype.cork=function(){this._writableState.corked++};Writable.prototype.uncork=function(){var state=this._writableState;if(state.corked){state.corked--;if(!state.writing&&!state.corked&&!state.bufferProcessing&&state.bufferedRequest)clearBuffer(this,state)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(encoding){if(typeof encoding==="string")encoding=encoding.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new ERR_UNKNOWN_ENCODING(encoding);this._writableState.defaultEncoding=encoding;return this};Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&typeof chunk==="string"){chunk=Buffer.from(chunk,encoding)}return chunk}Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});function writeOrBuffer(stream,state,isBuf,chunk,encoding,cb){if(!isBuf){var newChunk=decodeChunk(state,chunk,encoding);if(chunk!==newChunk){isBuf=true;encoding="buffer";chunk=newChunk}}var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(!ret)state.needDrain=true;if(state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null};if(last){last.next=state.lastBufferedRequest}else{state.bufferedRequest=state.lastBufferedRequest}state.bufferedRequestCount+=1}else{doWrite(stream,state,false,len,chunk,encoding,cb)}return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;if(state.destroyed)state.onwrite(new ERR_STREAM_DESTROYED("write"));else if(writev)stream._writev(chunk,state.onwrite);else stream._write(chunk,encoding,state.onwrite);state.sync=false}function onwriteError(stream,state,sync,er,cb){--state.pendingcb;if(sync){process.nextTick(cb,er);process.nextTick(finishMaybe,stream,state);stream._writableState.errorEmitted=true;errorOrDestroy(stream,er)}else{cb(er);stream._writableState.errorEmitted=true;errorOrDestroy(stream,er);finishMaybe(stream,state)}}function onwriteStateUpdate(state){state.writing=false;state.writecb=null;state.length-=state.writelen;state.writelen=0}function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;if(typeof cb!=="function")throw new ERR_MULTIPLE_CALLBACK;onwriteStateUpdate(state);if(er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state)||stream.destroyed;if(!finished&&!state.corked&&!state.bufferProcessing&&state.bufferedRequest){clearBuffer(stream,state)}if(sync){process.nextTick(afterWrite,stream,state,finished,cb)}else{afterWrite(stream,state,finished,cb)}}}function afterWrite(stream,state,finished,cb){if(!finished)onwriteDrain(stream,state);state.pendingcb--;cb();finishMaybe(stream,state)}function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit("drain")}}function clearBuffer(stream,state){state.bufferProcessing=true;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount;var buffer=new Array(l);var holder=state.corkedRequestsFree;holder.entry=entry;var count=0;var allBuffers=true;while(entry){buffer[count]=entry;if(!entry.isBuf)allBuffers=false;entry=entry.next;count+=1}buffer.allBuffers=allBuffers;doWrite(stream,state,true,state.length,buffer,"",holder.finish);state.pendingcb++;state.lastBufferedRequest=null;if(holder.next){state.corkedRequestsFree=holder.next;holder.next=null}else{state.corkedRequestsFree=new CorkedRequest(state)}state.bufferedRequestCount=0}else{while(entry){var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,false,len,chunk,encoding,cb);entry=entry.next;state.bufferedRequestCount--;if(state.writing){break}}if(entry===null)state.lastBufferedRequest=null}state.bufferedRequest=entry;state.bufferProcessing=false}Writable.prototype._write=function(chunk,encoding,cb){cb(new ERR_METHOD_NOT_IMPLEMENTED("_write()"))};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(typeof chunk==="function"){cb=chunk;chunk=null;encoding=null}else if(typeof encoding==="function"){cb=encoding;encoding=null}if(chunk!==null&&chunk!==undefined)this.write(chunk,encoding);if(state.corked){state.corked=1;this.uncork()}if(!state.ending)endWritable(this,state,cb);return this};Object.defineProperty(Writable.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function needFinish(state){return state.ending&&state.length===0&&state.bufferedRequest===null&&!state.finished&&!state.writing}function callFinal(stream,state){stream._final((function(err){state.pendingcb--;if(err){errorOrDestroy(stream,err)}state.prefinished=true;stream.emit("prefinish");finishMaybe(stream,state)}))}function prefinish(stream,state){if(!state.prefinished&&!state.finalCalled){if(typeof stream._final==="function"&&!state.destroyed){state.pendingcb++;state.finalCalled=true;process.nextTick(callFinal,stream,state)}else{state.prefinished=true;stream.emit("prefinish")}}}function finishMaybe(stream,state){var need=needFinish(state);if(need){prefinish(stream,state);if(state.pendingcb===0){state.finished=true;stream.emit("finish");if(state.autoDestroy){var rState=stream._readableState;if(!rState||rState.autoDestroy&&rState.endEmitted){stream.destroy()}}}}return need}function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb){if(state.finished)process.nextTick(cb);else stream.once("finish",cb)}state.ended=true;stream.writable=false}function onCorkedFinish(corkReq,state,err){var entry=corkReq.entry;corkReq.entry=null;while(entry){var cb=entry.callback;state.pendingcb--;cb(err);entry=entry.next}state.corkedRequestsFree.next=corkReq}Object.defineProperty(Writable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function set(value){if(!this._writableState){return}this._writableState.destroyed=value}});Writable.prototype.destroy=destroyImpl.destroy;Writable.prototype._undestroy=destroyImpl.undestroy;Writable.prototype._destroy=function(err,cb){cb(err)}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../errors":405,"./_stream_duplex":406,"./internal/streams/destroy":413,"./internal/streams/state":417,"./internal/streams/stream":418,_process:378,buffer:151,inherits:279,"util-deprecate":439}],411:[function(require,module,exports){(function(process){(function(){"use strict";var _Object$setPrototypeO;function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var finished=require("./end-of-stream");var kLastResolve=Symbol("lastResolve");var kLastReject=Symbol("lastReject");var kError=Symbol("error");var kEnded=Symbol("ended");var kLastPromise=Symbol("lastPromise");var kHandlePromise=Symbol("handlePromise");var kStream=Symbol("stream");function createIterResult(value,done){return{value:value,done:done}}function readAndResolve(iter){var resolve=iter[kLastResolve];if(resolve!==null){var data=iter[kStream].read();if(data!==null){iter[kLastPromise]=null;iter[kLastResolve]=null;iter[kLastReject]=null;resolve(createIterResult(data,false))}}}function onReadable(iter){process.nextTick(readAndResolve,iter)}function wrapForNext(lastPromise,iter){return function(resolve,reject){lastPromise.then((function(){if(iter[kEnded]){resolve(createIterResult(undefined,true));return}iter[kHandlePromise](resolve,reject)}),reject)}}var AsyncIteratorPrototype=Object.getPrototypeOf((function(){}));var ReadableStreamAsyncIteratorPrototype=Object.setPrototypeOf((_Object$setPrototypeO={get stream(){return this[kStream]},next:function next(){var _this=this;var error=this[kError];if(error!==null){return Promise.reject(error)}if(this[kEnded]){return Promise.resolve(createIterResult(undefined,true))}if(this[kStream].destroyed){return new Promise((function(resolve,reject){process.nextTick((function(){if(_this[kError]){reject(_this[kError])}else{resolve(createIterResult(undefined,true))}}))}))}var lastPromise=this[kLastPromise];var promise;if(lastPromise){promise=new Promise(wrapForNext(lastPromise,this))}else{var data=this[kStream].read();if(data!==null){return Promise.resolve(createIterResult(data,false))}promise=new Promise(this[kHandlePromise])}this[kLastPromise]=promise;return promise}},_defineProperty(_Object$setPrototypeO,Symbol.asyncIterator,(function(){return this})),_defineProperty(_Object$setPrototypeO,"return",(function _return(){var _this2=this;return new Promise((function(resolve,reject){_this2[kStream].destroy(null,(function(err){if(err){reject(err);return}resolve(createIterResult(undefined,true))}))}))})),_Object$setPrototypeO),AsyncIteratorPrototype);var createReadableStreamAsyncIterator=function createReadableStreamAsyncIterator(stream){var _Object$create;var iterator=Object.create(ReadableStreamAsyncIteratorPrototype,(_Object$create={},_defineProperty(_Object$create,kStream,{value:stream,writable:true}),_defineProperty(_Object$create,kLastResolve,{value:null,writable:true}),_defineProperty(_Object$create,kLastReject,{value:null,writable:true}),_defineProperty(_Object$create,kError,{value:null,writable:true}),_defineProperty(_Object$create,kEnded,{value:stream._readableState.endEmitted,writable:true}),_defineProperty(_Object$create,kHandlePromise,{value:function value(resolve,reject){var data=iterator[kStream].read();if(data){iterator[kLastPromise]=null;iterator[kLastResolve]=null;iterator[kLastReject]=null;resolve(createIterResult(data,false))}else{iterator[kLastResolve]=resolve;iterator[kLastReject]=reject}},writable:true}),_Object$create));iterator[kLastPromise]=null;finished(stream,(function(err){if(err&&err.code!=="ERR_STREAM_PREMATURE_CLOSE"){var reject=iterator[kLastReject];if(reject!==null){iterator[kLastPromise]=null;iterator[kLastResolve]=null;iterator[kLastReject]=null;reject(err)}iterator[kError]=err;return}var resolve=iterator[kLastResolve];if(resolve!==null){iterator[kLastPromise]=null;iterator[kLastResolve]=null;iterator[kLastReject]=null;resolve(createIterResult(undefined,true))}iterator[kEnded]=true}));stream.on("readable",onReadable.bind(null,iterator));return iterator};module.exports=createReadableStreamAsyncIterator}).call(this)}).call(this,require("_process"))},{"./end-of-stream":414,_process:378}],412:[function(require,module,exports){"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var _require=require("buffer"),Buffer=_require.Buffer;var _require2=require("util"),inspect=_require2.inspect;var custom=inspect&&inspect.custom||"inspect";function copyBuffer(src,target,offset){Buffer.prototype.copy.call(src,target,offset)}module.exports=function(){function BufferList(){_classCallCheck(this,BufferList);this.head=null;this.tail=null;this.length=0}_createClass(BufferList,[{key:"push",value:function push(v){var entry={data:v,next:null};if(this.length>0)this.tail.next=entry;else this.head=entry;this.tail=entry;++this.length}},{key:"unshift",value:function unshift(v){var entry={data:v,next:this.head};if(this.length===0)this.tail=entry;this.head=entry;++this.length}},{key:"shift",value:function shift(){if(this.length===0)return;var ret=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return ret}},{key:"clear",value:function clear(){this.head=this.tail=null;this.length=0}},{key:"join",value:function join(s){if(this.length===0)return"";var p=this.head;var ret=""+p.data;while(p=p.next){ret+=s+p.data}return ret}},{key:"concat",value:function concat(n){if(this.length===0)return Buffer.alloc(0);var ret=Buffer.allocUnsafe(n>>>0);var p=this.head;var i=0;while(p){copyBuffer(p.data,ret,i);i+=p.data.length;p=p.next}return ret}},{key:"consume",value:function consume(n,hasStrings){var ret;if(n<this.head.data.length){ret=this.head.data.slice(0,n);this.head.data=this.head.data.slice(n)}else if(n===this.head.data.length){ret=this.shift()}else{ret=hasStrings?this._getString(n):this._getBuffer(n)}return ret}},{key:"first",value:function first(){return this.head.data}},{key:"_getString",value:function _getString(n){var p=this.head;var c=1;var ret=p.data;n-=ret.length;while(p=p.next){var str=p.data;var nb=n>str.length?str.length:n;if(nb===str.length)ret+=str;else ret+=str.slice(0,n);n-=nb;if(n===0){if(nb===str.length){++c;if(p.next)this.head=p.next;else this.head=this.tail=null}else{this.head=p;p.data=str.slice(nb)}break}++c}this.length-=c;return ret}},{key:"_getBuffer",value:function _getBuffer(n){var ret=Buffer.allocUnsafe(n);var p=this.head;var c=1;p.data.copy(ret);n-=p.data.length;while(p=p.next){var buf=p.data;var nb=n>buf.length?buf.length:n;buf.copy(ret,ret.length-n,0,nb);n-=nb;if(n===0){if(nb===buf.length){++c;if(p.next)this.head=p.next;else this.head=this.tail=null}else{this.head=p;p.data=buf.slice(nb)}break}++c}this.length-=c;return ret}},{key:custom,value:function value(_,options){return inspect(this,_objectSpread({},options,{depth:0,customInspect:false}))}}]);return BufferList}()},{buffer:151,util:148}],413:[function(require,module,exports){(function(process){(function(){"use strict";function destroy(err,cb){var _this=this;var readableDestroyed=this._readableState&&this._readableState.destroyed;var writableDestroyed=this._writableState&&this._writableState.destroyed;if(readableDestroyed||writableDestroyed){if(cb){cb(err)}else if(err){if(!this._writableState){process.nextTick(emitErrorNT,this,err)}else if(!this._writableState.errorEmitted){this._writableState.errorEmitted=true;process.nextTick(emitErrorNT,this,err)}}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(err||null,(function(err){if(!cb&&err){if(!_this._writableState){process.nextTick(emitErrorAndCloseNT,_this,err)}else if(!_this._writableState.errorEmitted){_this._writableState.errorEmitted=true;process.nextTick(emitErrorAndCloseNT,_this,err)}else{process.nextTick(emitCloseNT,_this)}}else if(cb){process.nextTick(emitCloseNT,_this);cb(err)}else{process.nextTick(emitCloseNT,_this)}}));return this}function emitErrorAndCloseNT(self,err){emitErrorNT(self,err);emitCloseNT(self)}function emitCloseNT(self){if(self._writableState&&!self._writableState.emitClose)return;if(self._readableState&&!self._readableState.emitClose)return;self.emit("close")}function undestroy(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finalCalled=false;this._writableState.prefinished=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function emitErrorNT(self,err){self.emit("error",err)}function errorOrDestroy(stream,err){var rState=stream._readableState;var wState=stream._writableState;if(rState&&rState.autoDestroy||wState&&wState.autoDestroy)stream.destroy(err);else stream.emit("error",err)}module.exports={destroy:destroy,undestroy:undestroy,errorOrDestroy:errorOrDestroy}}).call(this)}).call(this,require("_process"))},{_process:378}],414:[function(require,module,exports){"use strict";var ERR_STREAM_PREMATURE_CLOSE=require("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function once(callback){var called=false;return function(){if(called)return;called=true;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}callback.apply(this,args)}}function noop(){}function isRequest(stream){return stream.setHeader&&typeof stream.abort==="function"}function eos(stream,opts,callback){if(typeof opts==="function")return eos(stream,null,opts);if(!opts)opts={};callback=once(callback||noop);var readable=opts.readable||opts.readable!==false&&stream.readable;var writable=opts.writable||opts.writable!==false&&stream.writable;var onlegacyfinish=function onlegacyfinish(){if(!stream.writable)onfinish()};var writableEnded=stream._writableState&&stream._writableState.finished;var onfinish=function onfinish(){writable=false;writableEnded=true;if(!readable)callback.call(stream)};var readableEnded=stream._readableState&&stream._readableState.endEmitted;var onend=function onend(){readable=false;readableEnded=true;if(!writable)callback.call(stream)};var onerror=function onerror(err){callback.call(stream,err)};var onclose=function onclose(){var err;if(readable&&!readableEnded){if(!stream._readableState||!stream._readableState.ended)err=new ERR_STREAM_PREMATURE_CLOSE;return callback.call(stream,err)}if(writable&&!writableEnded){if(!stream._writableState||!stream._writableState.ended)err=new ERR_STREAM_PREMATURE_CLOSE;return callback.call(stream,err)}};var onrequest=function onrequest(){stream.req.on("finish",onfinish)};if(isRequest(stream)){stream.on("complete",onfinish);stream.on("abort",onclose);if(stream.req)onrequest();else stream.on("request",onrequest)}else if(writable&&!stream._writableState){stream.on("end",onlegacyfinish);stream.on("close",onlegacyfinish)}stream.on("end",onend);stream.on("finish",onfinish);if(opts.error!==false)stream.on("error",onerror);stream.on("close",onclose);return function(){stream.removeListener("complete",onfinish);stream.removeListener("abort",onclose);stream.removeListener("request",onrequest);if(stream.req)stream.req.removeListener("finish",onfinish);stream.removeListener("end",onlegacyfinish);stream.removeListener("close",onlegacyfinish);stream.removeListener("finish",onfinish);stream.removeListener("end",onend);stream.removeListener("error",onerror);stream.removeListener("close",onclose)}}module.exports=eos},{"../../../errors":405}],415:[function(require,module,exports){module.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],416:[function(require,module,exports){"use strict";var eos;function once(callback){var called=false;return function(){if(called)return;called=true;callback.apply(void 0,arguments)}}var _require$codes=require("../../../errors").codes,ERR_MISSING_ARGS=_require$codes.ERR_MISSING_ARGS,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED;function noop(err){if(err)throw err}function isRequest(stream){return stream.setHeader&&typeof stream.abort==="function"}function destroyer(stream,reading,writing,callback){callback=once(callback);var closed=false;stream.on("close",(function(){closed=true}));if(eos===undefined)eos=require("./end-of-stream");eos(stream,{readable:reading,writable:writing},(function(err){if(err)return callback(err);closed=true;callback()}));var destroyed=false;return function(err){if(closed)return;if(destroyed)return;destroyed=true;if(isRequest(stream))return stream.abort();if(typeof stream.destroy==="function")return stream.destroy();callback(err||new ERR_STREAM_DESTROYED("pipe"))}}function call(fn){fn()}function pipe(from,to){return from.pipe(to)}function popCallback(streams){if(!streams.length)return noop;if(typeof streams[streams.length-1]!=="function")return noop;return streams.pop()}function pipeline(){for(var _len=arguments.length,streams=new Array(_len),_key=0;_key<_len;_key++){streams[_key]=arguments[_key]}var callback=popCallback(streams);if(Array.isArray(streams[0]))streams=streams[0];if(streams.length<2){throw new ERR_MISSING_ARGS("streams")}var error;var destroys=streams.map((function(stream,i){var reading=i<streams.length-1;var writing=i>0;return destroyer(stream,reading,writing,(function(err){if(!error)error=err;if(err)destroys.forEach(call);if(reading)return;destroys.forEach(call);callback(error)}))}));return streams.reduce(pipe)}module.exports=pipeline},{"../../../errors":405,"./end-of-stream":414}],417:[function(require,module,exports){"use strict";var ERR_INVALID_OPT_VALUE=require("../../../errors").codes.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(options,isDuplex,duplexKey){return options.highWaterMark!=null?options.highWaterMark:isDuplex?options[duplexKey]:null}function getHighWaterMark(state,options,duplexKey,isDuplex){var hwm=highWaterMarkFrom(options,isDuplex,duplexKey);if(hwm!=null){if(!(isFinite(hwm)&&Math.floor(hwm)===hwm)||hwm<0){var name=isDuplex?duplexKey:"highWaterMark";throw new ERR_INVALID_OPT_VALUE(name,hwm)}return Math.floor(hwm)}return state.objectMode?16:16*1024}module.exports={getHighWaterMark:getHighWaterMark}},{"../../../errors":405}],418:[function(require,module,exports){module.exports=require("events").EventEmitter},{events:261}],419:[function(require,module,exports){exports=module.exports=require("./lib/_stream_readable.js");exports.Stream=exports;exports.Readable=exports;exports.Writable=require("./lib/_stream_writable.js");exports.Duplex=require("./lib/_stream_duplex.js");exports.Transform=require("./lib/_stream_transform.js");exports.PassThrough=require("./lib/_stream_passthrough.js");exports.finished=require("./lib/internal/streams/end-of-stream.js");exports.pipeline=require("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":406,"./lib/_stream_passthrough.js":407,"./lib/_stream_readable.js":408,"./lib/_stream_transform.js":409,"./lib/_stream_writable.js":410,"./lib/internal/streams/end-of-stream.js":414,"./lib/internal/streams/pipeline.js":416}],420:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer;var isEncoding=Buffer.isEncoding||function(encoding){encoding=""+encoding;switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function _normalizeEncoding(enc){if(!enc)return"utf8";var retried;while(true){switch(enc){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return enc;default:if(retried)return;enc=(""+enc).toLowerCase();retried=true}}}function normalizeEncoding(enc){var nenc=_normalizeEncoding(enc);if(typeof nenc!=="string"&&(Buffer.isEncoding===isEncoding||!isEncoding(enc)))throw new Error("Unknown encoding: "+enc);return nenc||enc}exports.StringDecoder=StringDecoder;function StringDecoder(encoding){this.encoding=normalizeEncoding(encoding);var nb;switch(this.encoding){case"utf16le":this.text=utf16Text;this.end=utf16End;nb=4;break;case"utf8":this.fillLast=utf8FillLast;nb=4;break;case"base64":this.text=base64Text;this.end=base64End;nb=3;break;default:this.write=simpleWrite;this.end=simpleEnd;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=Buffer.allocUnsafe(nb)}StringDecoder.prototype.write=function(buf){if(buf.length===0)return"";var r;var i;if(this.lastNeed){r=this.fillLast(buf);if(r===undefined)return"";i=this.lastNeed;this.lastNeed=0}else{i=0}if(i<buf.length)return r?r+this.text(buf,i):this.text(buf,i);return r||""};StringDecoder.prototype.end=utf8End;StringDecoder.prototype.text=utf8Text;StringDecoder.prototype.fillLast=function(buf){if(this.lastNeed<=buf.length){buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,buf.length);this.lastNeed-=buf.length};function utf8CheckByte(byte){if(byte<=127)return 0;else if(byte>>5===6)return 2;else if(byte>>4===14)return 3;else if(byte>>3===30)return 4;return byte>>6===2?-1:-2}function utf8CheckIncomplete(self,buf,i){var j=buf.length-1;if(j<i)return 0;var nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0)self.lastNeed=nb-1;return nb}if(--j<i||nb===-2)return 0;nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0)self.lastNeed=nb-2;return nb}if(--j<i||nb===-2)return 0;nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0){if(nb===2)nb=0;else self.lastNeed=nb-3}return nb}return 0}function utf8CheckExtraBytes(self,buf,p){if((buf[0]&192)!==128){self.lastNeed=0;return"�"}if(self.lastNeed>1&&buf.length>1){if((buf[1]&192)!==128){self.lastNeed=1;return"�"}if(self.lastNeed>2&&buf.length>2){if((buf[2]&192)!==128){self.lastNeed=2;return"�"}}}}function utf8FillLast(buf){var p=this.lastTotal-this.lastNeed;var r=utf8CheckExtraBytes(this,buf,p);if(r!==undefined)return r;if(this.lastNeed<=buf.length){buf.copy(this.lastChar,p,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}buf.copy(this.lastChar,p,0,buf.length);this.lastNeed-=buf.length}function utf8Text(buf,i){var total=utf8CheckIncomplete(this,buf,i);if(!this.lastNeed)return buf.toString("utf8",i);this.lastTotal=total;var end=buf.length-(total-this.lastNeed);buf.copy(this.lastChar,0,end);return buf.toString("utf8",i,end)}function utf8End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed)return r+"�";return r}function utf16Text(buf,i){if((buf.length-i)%2===0){var r=buf.toString("utf16le",i);if(r){var c=r.charCodeAt(r.length-1);if(c>=55296&&c<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=buf[buf.length-2];this.lastChar[1]=buf[buf.length-1];return r.slice(0,-1)}}return r}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=buf[buf.length-1];return buf.toString("utf16le",i,buf.length-1)}function utf16End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed){var end=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,end)}return r}function base64Text(buf,i){var n=(buf.length-i)%3;if(n===0)return buf.toString("base64",i);this.lastNeed=3-n;this.lastTotal=3;if(n===1){this.lastChar[0]=buf[buf.length-1]}else{this.lastChar[0]=buf[buf.length-2];this.lastChar[1]=buf[buf.length-1]}return buf.toString("base64",i,buf.length-n)}function base64End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed)return r+this.lastChar.toString("base64",0,3-this.lastNeed);return r}function simpleWrite(buf){return buf.toString(this.encoding)}function simpleEnd(buf){return buf&&buf.length?this.write(buf):""}},{"safe-buffer":391}],421:[function(require,module,exports){(function(setImmediate,clearImmediate){(function(){var nextTick=require("process/browser.js").nextTick;var apply=Function.prototype.apply;var slice=Array.prototype.slice;var immediateIds={};var nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)};exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)};exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()};function Timeout(id,clearFn){this._id=id;this._clearFn=clearFn}Timeout.prototype.unref=Timeout.prototype.ref=function(){};Timeout.prototype.close=function(){this._clearFn.call(window,this._id)};exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId);item._idleTimeout=msecs};exports.unenroll=function(item){clearTimeout(item._idleTimeoutId);item._idleTimeout=-1};exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;if(msecs>=0){item._idleTimeoutId=setTimeout((function onTimeout(){if(item._onTimeout)item._onTimeout()}),msecs)}};exports.setImmediate=typeof setImmediate==="function"?setImmediate:function(fn){var id=nextImmediateId++;var args=arguments.length<2?false:slice.call(arguments,1);immediateIds[id]=true;nextTick((function onNextTick(){if(immediateIds[id]){if(args){fn.apply(null,args)}else{fn.call(null)}exports.clearImmediate(id)}}));return id};exports.clearImmediate=typeof clearImmediate==="function"?clearImmediate:function(id){delete immediateIds[id]}}).call(this)}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":378,timers:421}],422:[function(require,module,exports){"use strict";module.exports=2147483647},{}],423:[function(require,module,exports){"use strict";var toPosInt=require("es5-ext/number/to-pos-integer"),maxTimeout=require("./max-timeout");module.exports=function(value){value=toPosInt(value);if(value>maxTimeout)throw new TypeError(value+" exceeds maximum possible timeout");return value}},{"./max-timeout":422,"es5-ext/number/to-pos-integer":208}],424:[function(require,module,exports){"use strict";var isPrototype=require("../prototype/is");module.exports=function(value){if(typeof value!=="function")return false;if(!hasOwnProperty.call(value,"length"))return false;try{if(typeof value.length!=="number")return false;if(typeof value.call!=="function")return false;if(typeof value.apply!=="function")return false}catch(error){return false}return!isPrototype(value)}},{"../prototype/is":431}],425:[function(require,module,exports){"use strict";var isValue=require("../value/is"),isObject=require("../object/is"),stringCoerce=require("../string/coerce"),toShortString=require("./to-short-string");var resolveMessage=function(message,value){return message.replace("%v",toShortString(value))};module.exports=function(value,defaultMessage,inputOptions){if(!isObject(inputOptions))throw new TypeError(resolveMessage(defaultMessage,value));if(!isValue(value)){if("default"in inputOptions)return inputOptions["default"];if(inputOptions.isOptional)return null}var errorMessage=stringCoerce(inputOptions.errorMessage);if(!isValue(errorMessage))errorMessage=defaultMessage;throw new TypeError(resolveMessage(errorMessage,value))}},{"../object/is":428,"../string/coerce":432,"../value/is":434,"./to-short-string":427}],426:[function(require,module,exports){"use strict";module.exports=function(value){try{return value.toString()}catch(error){try{return String(value)}catch(error2){return null}}}},{}],427:[function(require,module,exports){"use strict";var safeToString=require("./safe-to-string");var reNewLine=/[\n\r\u2028\u2029]/g;module.exports=function(value){var string=safeToString(value);if(string===null)return"<Non-coercible to string value>";if(string.length>100)string=string.slice(0,99)+"…";string=string.replace(reNewLine,(function(char){switch(char){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}));return string}},{"./safe-to-string":426}],428:[function(require,module,exports){"use strict";var isValue=require("../value/is");var possibleTypes={object:true,function:true,undefined:true};module.exports=function(value){if(!isValue(value))return false;return hasOwnProperty.call(possibleTypes,typeof value)}},{"../value/is":434}],429:[function(require,module,exports){"use strict";var resolveException=require("../lib/resolve-exception"),is=require("./is");module.exports=function(value){if(is(value))return value;return resolveException(value,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":425,"./is":430}],430:[function(require,module,exports){"use strict";var isFunction=require("../function/is");var classRe=/^\s*class[\s{/}]/,functionToString=Function.prototype.toString;module.exports=function(value){if(!isFunction(value))return false;if(classRe.test(functionToString.call(value)))return false;return true}},{"../function/is":424}],431:[function(require,module,exports){"use strict";var isObject=require("../object/is");module.exports=function(value){if(!isObject(value))return false;try{if(!value.constructor)return false;return value.constructor.prototype===value}catch(error){return false}}},{"../object/is":428}],432:[function(require,module,exports){"use strict";var isValue=require("../value/is"),isObject=require("../object/is");var objectToString=Object.prototype.toString;module.exports=function(value){if(!isValue(value))return null;if(isObject(value)){var valueToString=value.toString;if(typeof valueToString!=="function")return null;if(valueToString===objectToString)return null}try{return""+value}catch(error){return null}}},{"../object/is":428,"../value/is":434}],433:[function(require,module,exports){"use strict";var resolveException=require("../lib/resolve-exception"),is=require("./is");module.exports=function(value){if(is(value))return value;return resolveException(value,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":425,"./is":434}],434:[function(require,module,exports){"use strict";var _undefined=void 0;module.exports=function(value){return value!==_undefined&&value!==null}},{}],435:[function(require,module,exports){
/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports):typeof define==="function"&&define.amd?define(["exports"],factory):factory(global.URI=global.URI||{})})(this,(function(exports){"use strict";function merge(){for(var _len=arguments.length,sets=Array(_len),_key=0;_key<_len;_key++){sets[_key]=arguments[_key]}if(sets.length>1){sets[0]=sets[0].slice(0,-1);var xl=sets.length-1;for(var x=1;x<xl;++x){sets[x]=sets[x].slice(1,-1)}sets[xl]=sets[xl].slice(1);return sets.join("")}else{return sets[0]}}function subexp(str){return"(?:"+str+")"}function typeOf(o){return o===undefined?"undefined":o===null?"null":Object.prototype.toString.call(o).split(" ").pop().split("]").shift().toLowerCase()}function toUpperCase(str){return str.toUpperCase()}function toArray(obj){return obj!==undefined&&obj!==null?obj instanceof Array?obj:typeof obj.length!=="number"||obj.split||obj.setInterval||obj.call?[obj]:Array.prototype.slice.call(obj):[]}function assign(target,source){var obj=target;if(source){for(var key in source){obj[key]=source[key]}}return obj}function buildExps(isIRI){var ALPHA$$="[A-Za-z]",CR$="[\\x0D]",DIGIT$$="[0-9]",DQUOTE$$="[\\x22]",HEXDIG$$=merge(DIGIT$$,"[A-Fa-f]"),LF$$="[\\x0A]",SP$$="[\\x20]",PCT_ENCODED$=subexp(subexp("%[EFef]"+HEXDIG$$+"%"+HEXDIG$$+HEXDIG$$+"%"+HEXDIG$$+HEXDIG$$)+"|"+subexp("%[89A-Fa-f]"+HEXDIG$$+"%"+HEXDIG$$+HEXDIG$$)+"|"+subexp("%"+HEXDIG$$+HEXDIG$$)),GEN_DELIMS$$="[\\:\\/\\?\\#\\[\\]\\@]",SUB_DELIMS$$="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",RESERVED$$=merge(GEN_DELIMS$$,SUB_DELIMS$$),UCSCHAR$$=isIRI?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",IPRIVATE$$=isIRI?"[\\uE000-\\uF8FF]":"[]",UNRESERVED$$=merge(ALPHA$$,DIGIT$$,"[\\-\\.\\_\\~]",UCSCHAR$$),SCHEME$=subexp(ALPHA$$+merge(ALPHA$$,DIGIT$$,"[\\+\\-\\.]")+"*"),USERINFO$=subexp(subexp(PCT_ENCODED$+"|"+merge(UNRESERVED$$,SUB_DELIMS$$,"[\\:]"))+"*"),DEC_OCTET$=subexp(subexp("25[0-5]")+"|"+subexp("2[0-4]"+DIGIT$$)+"|"+subexp("1"+DIGIT$$+DIGIT$$)+"|"+subexp("[1-9]"+DIGIT$$)+"|"+DIGIT$$),DEC_OCTET_RELAXED$=subexp(subexp("25[0-5]")+"|"+subexp("2[0-4]"+DIGIT$$)+"|"+subexp("1"+DIGIT$$+DIGIT$$)+"|"+subexp("0?[1-9]"+DIGIT$$)+"|0?0?"+DIGIT$$),IPV4ADDRESS$=subexp(DEC_OCTET_RELAXED$+"\\."+DEC_OCTET_RELAXED$+"\\."+DEC_OCTET_RELAXED$+"\\."+DEC_OCTET_RELAXED$),H16$=subexp(HEXDIG$$+"{1,4}"),LS32$=subexp(subexp(H16$+"\\:"+H16$)+"|"+IPV4ADDRESS$),IPV6ADDRESS1$=subexp(subexp(H16$+"\\:")+"{6}"+LS32$),IPV6ADDRESS2$=subexp("\\:\\:"+subexp(H16$+"\\:")+"{5}"+LS32$),IPV6ADDRESS3$=subexp(subexp(H16$)+"?\\:\\:"+subexp(H16$+"\\:")+"{4}"+LS32$),IPV6ADDRESS4$=subexp(subexp(subexp(H16$+"\\:")+"{0,1}"+H16$)+"?\\:\\:"+subexp(H16$+"\\:")+"{3}"+LS32$),IPV6ADDRESS5$=subexp(subexp(subexp(H16$+"\\:")+"{0,2}"+H16$)+"?\\:\\:"+subexp(H16$+"\\:")+"{2}"+LS32$),IPV6ADDRESS6$=subexp(subexp(subexp(H16$+"\\:")+"{0,3}"+H16$)+"?\\:\\:"+H16$+"\\:"+LS32$),IPV6ADDRESS7$=subexp(subexp(subexp(H16$+"\\:")+"{0,4}"+H16$)+"?\\:\\:"+LS32$),IPV6ADDRESS8$=subexp(subexp(subexp(H16$+"\\:")+"{0,5}"+H16$)+"?\\:\\:"+H16$),IPV6ADDRESS9$=subexp(subexp(subexp(H16$+"\\:")+"{0,6}"+H16$)+"?\\:\\:"),IPV6ADDRESS$=subexp([IPV6ADDRESS1$,IPV6ADDRESS2$,IPV6ADDRESS3$,IPV6ADDRESS4$,IPV6ADDRESS5$,IPV6ADDRESS6$,IPV6ADDRESS7$,IPV6ADDRESS8$,IPV6ADDRESS9$].join("|")),ZONEID$=subexp(subexp(UNRESERVED$$+"|"+PCT_ENCODED$)+"+"),IPV6ADDRZ$=subexp(IPV6ADDRESS$+"\\%25"+ZONEID$),IPV6ADDRZ_RELAXED$=subexp(IPV6ADDRESS$+subexp("\\%25|\\%(?!"+HEXDIG$$+"{2})")+ZONEID$),IPVFUTURE$=subexp("[vV]"+HEXDIG$$+"+\\."+merge(UNRESERVED$$,SUB_DELIMS$$,"[\\:]")+"+"),IP_LITERAL$=subexp("\\["+subexp(IPV6ADDRZ_RELAXED$+"|"+IPV6ADDRESS$+"|"+IPVFUTURE$)+"\\]"),REG_NAME$=subexp(subexp(PCT_ENCODED$+"|"+merge(UNRESERVED$$,SUB_DELIMS$$))+"*"),HOST$=subexp(IP_LITERAL$+"|"+IPV4ADDRESS$+"(?!"+REG_NAME$+")"+"|"+REG_NAME$),PORT$=subexp(DIGIT$$+"*"),AUTHORITY$=subexp(subexp(USERINFO$+"@")+"?"+HOST$+subexp("\\:"+PORT$)+"?"),PCHAR$=subexp(PCT_ENCODED$+"|"+merge(UNRESERVED$$,SUB_DELIMS$$,"[\\:\\@]")),SEGMENT$=subexp(PCHAR$+"*"),SEGMENT_NZ$=subexp(PCHAR$+"+"),SEGMENT_NZ_NC$=subexp(subexp(PCT_ENCODED$+"|"+merge(UNRESERVED$$,SUB_DELIMS$$,"[\\@]"))+"+"),PATH_ABEMPTY$=subexp(subexp("\\/"+SEGMENT$)+"*"),PATH_ABSOLUTE$=subexp("\\/"+subexp(SEGMENT_NZ$+PATH_ABEMPTY$)+"?"),PATH_NOSCHEME$=subexp(SEGMENT_NZ_NC$+PATH_ABEMPTY$),PATH_ROOTLESS$=subexp(SEGMENT_NZ$+PATH_ABEMPTY$),PATH_EMPTY$="(?!"+PCHAR$+")",PATH$=subexp(PATH_ABEMPTY$+"|"+PATH_ABSOLUTE$+"|"+PATH_NOSCHEME$+"|"+PATH_ROOTLESS$+"|"+PATH_EMPTY$),QUERY$=subexp(subexp(PCHAR$+"|"+merge("[\\/\\?]",IPRIVATE$$))+"*"),FRAGMENT$=subexp(subexp(PCHAR$+"|[\\/\\?]")+"*"),HIER_PART$=subexp(subexp("\\/\\/"+AUTHORITY$+PATH_ABEMPTY$)+"|"+PATH_ABSOLUTE$+"|"+PATH_ROOTLESS$+"|"+PATH_EMPTY$),URI$=subexp(SCHEME$+"\\:"+HIER_PART$+subexp("\\?"+QUERY$)+"?"+subexp("\\#"+FRAGMENT$)+"?"),RELATIVE_PART$=subexp(subexp("\\/\\/"+AUTHORITY$+PATH_ABEMPTY$)+"|"+PATH_ABSOLUTE$+"|"+PATH_NOSCHEME$+"|"+PATH_EMPTY$),RELATIVE$=subexp(RELATIVE_PART$+subexp("\\?"+QUERY$)+"?"+subexp("\\#"+FRAGMENT$)+"?"),URI_REFERENCE$=subexp(URI$+"|"+RELATIVE$),ABSOLUTE_URI$=subexp(SCHEME$+"\\:"+HIER_PART$+subexp("\\?"+QUERY$)+"?"),GENERIC_REF$="^("+SCHEME$+")\\:"+subexp(subexp("\\/\\/("+subexp("("+USERINFO$+")@")+"?("+HOST$+")"+subexp("\\:("+PORT$+")")+"?)")+"?("+PATH_ABEMPTY$+"|"+PATH_ABSOLUTE$+"|"+PATH_ROOTLESS$+"|"+PATH_EMPTY$+")")+subexp("\\?("+QUERY$+")")+"?"+subexp("\\#("+FRAGMENT$+")")+"?$",RELATIVE_REF$="^(){0}"+subexp(subexp("\\/\\/("+subexp("("+USERINFO$+")@")+"?("+HOST$+")"+subexp("\\:("+PORT$+")")+"?)")+"?("+PATH_ABEMPTY$+"|"+PATH_ABSOLUTE$+"|"+PATH_NOSCHEME$+"|"+PATH_EMPTY$+")")+subexp("\\?("+QUERY$+")")+"?"+subexp("\\#("+FRAGMENT$+")")+"?$",ABSOLUTE_REF$="^("+SCHEME$+")\\:"+subexp(subexp("\\/\\/("+subexp("("+USERINFO$+")@")+"?("+HOST$+")"+subexp("\\:("+PORT$+")")+"?)")+"?("+PATH_ABEMPTY$+"|"+PATH_ABSOLUTE$+"|"+PATH_ROOTLESS$+"|"+PATH_EMPTY$+")")+subexp("\\?("+QUERY$+")")+"?$",SAMEDOC_REF$="^"+subexp("\\#("+FRAGMENT$+")")+"?$",AUTHORITY_REF$="^"+subexp("("+USERINFO$+")@")+"?("+HOST$+")"+subexp("\\:("+PORT$+")")+"?$";return{NOT_SCHEME:new RegExp(merge("[^]",ALPHA$$,DIGIT$$,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(merge("[^\\%\\:]",UNRESERVED$$,SUB_DELIMS$$),"g"),NOT_HOST:new RegExp(merge("[^\\%\\[\\]\\:]",UNRESERVED$$,SUB_DELIMS$$),"g"),NOT_PATH:new RegExp(merge("[^\\%\\/\\:\\@]",UNRESERVED$$,SUB_DELIMS$$),"g"),NOT_PATH_NOSCHEME:new RegExp(merge("[^\\%\\/\\@]",UNRESERVED$$,SUB_DELIMS$$),"g"),NOT_QUERY:new RegExp(merge("[^\\%]",UNRESERVED$$,SUB_DELIMS$$,"[\\:\\@\\/\\?]",IPRIVATE$$),"g"),NOT_FRAGMENT:new RegExp(merge("[^\\%]",UNRESERVED$$,SUB_DELIMS$$,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(merge("[^]",UNRESERVED$$,SUB_DELIMS$$),"g"),UNRESERVED:new RegExp(UNRESERVED$$,"g"),OTHER_CHARS:new RegExp(merge("[^\\%]",UNRESERVED$$,RESERVED$$),"g"),PCT_ENCODED:new RegExp(PCT_ENCODED$,"g"),IPV4ADDRESS:new RegExp("^("+IPV4ADDRESS$+")$"),IPV6ADDRESS:new RegExp("^\\[?("+IPV6ADDRESS$+")"+subexp(subexp("\\%25|\\%(?!"+HEXDIG$$+"{2})")+"("+ZONEID$+")")+"?\\]?$")}}var URI_PROTOCOL=buildExps(false);var IRI_PROTOCOL=buildExps(true);var slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var toConsumableArray=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}else{return Array.from(arr)}};var maxInt=2147483647;var base=36;var tMin=1;var tMax=26;var skew=38;var damp=700;var initialBias=72;var initialN=128;var delimiter="-";var regexPunycode=/^xn--/;var regexNonASCII=/[^\0-\x7E]/;var regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g;var errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"};var baseMinusTMin=base-tMin;var floor=Math.floor;var stringFromCharCode=String.fromCharCode;function error$1(type){throw new RangeError(errors[type])}function map(array,fn){var result=[];var length=array.length;while(length--){result[length]=fn(array[length])}return result}function mapDomain(string,fn){var parts=string.split("@");var result="";if(parts.length>1){result=parts[0]+"@";string=parts[1]}string=string.replace(regexSeparators,".");var labels=string.split(".");var encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){var output=[];var counter=0;var length=string.length;while(counter<length){var value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){var extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}var ucs2encode=function ucs2encode(array){return String.fromCodePoint.apply(String,toConsumableArray(array))};var basicToDigit=function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22}if(codePoint-65<26){return codePoint-65}if(codePoint-97<26){return codePoint-97}return base};var digitToBasic=function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)};var adapt=function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))};var decode=function decode(input){var output=[];var inputLength=input.length;var i=0;var n=initialN;var bias=initialBias;var basic=input.lastIndexOf(delimiter);if(basic<0){basic=0}for(var j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error$1("not-basic")}output.push(input.charCodeAt(j))}for(var index=basic>0?basic+1:0;index<inputLength;){var oldi=i;for(var w=1,k=base;;k+=base){if(index>=inputLength){error$1("invalid-input")}var digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error$1("overflow")}i+=digit*w;var t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break}var baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error$1("overflow")}w*=baseMinusT}var out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error$1("overflow")}n+=floor(i/out);i%=out;output.splice(i++,0,n)}return String.fromCodePoint.apply(String,output)};var encode=function encode(input){var output=[];input=ucs2decode(input);var inputLength=input.length;var n=initialN;var delta=0;var bias=initialBias;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=input[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _currentValue2=_step.value;if(_currentValue2<128){output.push(stringFromCharCode(_currentValue2))}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}var basicLength=output.length;var handledCPCount=basicLength;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){var m=maxInt;var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=input[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var currentValue=_step2.value;if(currentValue>=n&&currentValue<m){m=currentValue}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}var handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error$1("overflow")}delta+=(m-n)*handledCPCountPlusOne;n=m;var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=input[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _currentValue=_step3.value;if(_currentValue<n&&++delta>maxInt){error$1("overflow")}if(_currentValue==n){var q=delta;for(var k=base;;k+=base){var t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break}var qMinusT=q-t;var baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}++delta;++n}return output.join("")};var toUnicode=function toUnicode(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))};var toASCII=function toASCII(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))};var punycode={version:"2.1.0",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};var SCHEMES={};function pctEncChar(chr){var c=chr.charCodeAt(0);var e=void 0;if(c<16)e="%0"+c.toString(16).toUpperCase();else if(c<128)e="%"+c.toString(16).toUpperCase();else if(c<2048)e="%"+(c>>6|192).toString(16).toUpperCase()+"%"+(c&63|128).toString(16).toUpperCase();else e="%"+(c>>12|224).toString(16).toUpperCase()+"%"+(c>>6&63|128).toString(16).toUpperCase()+"%"+(c&63|128).toString(16).toUpperCase();return e}function pctDecChars(str){var newStr="";var i=0;var il=str.length;while(i<il){var c=parseInt(str.substr(i+1,2),16);if(c<128){newStr+=String.fromCharCode(c);i+=3}else if(c>=194&&c<224){if(il-i>=6){var c2=parseInt(str.substr(i+4,2),16);newStr+=String.fromCharCode((c&31)<<6|c2&63)}else{newStr+=str.substr(i,6)}i+=6}else if(c>=224){if(il-i>=9){var _c=parseInt(str.substr(i+4,2),16);var c3=parseInt(str.substr(i+7,2),16);newStr+=String.fromCharCode((c&15)<<12|(_c&63)<<6|c3&63)}else{newStr+=str.substr(i,9)}i+=9}else{newStr+=str.substr(i,3);i+=3}}return newStr}function _normalizeComponentEncoding(components,protocol){function decodeUnreserved(str){var decStr=pctDecChars(str);return!decStr.match(protocol.UNRESERVED)?str:decStr}if(components.scheme)components.scheme=String(components.scheme).replace(protocol.PCT_ENCODED,decodeUnreserved).toLowerCase().replace(protocol.NOT_SCHEME,"");if(components.userinfo!==undefined)components.userinfo=String(components.userinfo).replace(protocol.PCT_ENCODED,decodeUnreserved).replace(protocol.NOT_USERINFO,pctEncChar).replace(protocol.PCT_ENCODED,toUpperCase);if(components.host!==undefined)components.host=String(components.host).replace(protocol.PCT_ENCODED,decodeUnreserved).toLowerCase().replace(protocol.NOT_HOST,pctEncChar).replace(protocol.PCT_ENCODED,toUpperCase);if(components.path!==undefined)components.path=String(components.path).replace(protocol.PCT_ENCODED,decodeUnreserved).replace(components.scheme?protocol.NOT_PATH:protocol.NOT_PATH_NOSCHEME,pctEncChar).replace(protocol.PCT_ENCODED,toUpperCase);if(components.query!==undefined)components.query=String(components.query).replace(protocol.PCT_ENCODED,decodeUnreserved).replace(protocol.NOT_QUERY,pctEncChar).replace(protocol.PCT_ENCODED,toUpperCase);if(components.fragment!==undefined)components.fragment=String(components.fragment).replace(protocol.PCT_ENCODED,decodeUnreserved).replace(protocol.NOT_FRAGMENT,pctEncChar).replace(protocol.PCT_ENCODED,toUpperCase);return components}function _stripLeadingZeros(str){return str.replace(/^0*(.*)/,"$1")||"0"}function _normalizeIPv4(host,protocol){var matches=host.match(protocol.IPV4ADDRESS)||[];var _matches=slicedToArray(matches,2),address=_matches[1];if(address){return address.split(".").map(_stripLeadingZeros).join(".")}else{return host}}function _normalizeIPv6(host,protocol){var matches=host.match(protocol.IPV6ADDRESS)||[];var _matches2=slicedToArray(matches,3),address=_matches2[1],zone=_matches2[2];if(address){var _address$toLowerCase$=address.toLowerCase().split("::").reverse(),_address$toLowerCase$2=slicedToArray(_address$toLowerCase$,2),last=_address$toLowerCase$2[0],first=_address$toLowerCase$2[1];var firstFields=first?first.split(":").map(_stripLeadingZeros):[];var lastFields=last.split(":").map(_stripLeadingZeros);var isLastFieldIPv4Address=protocol.IPV4ADDRESS.test(lastFields[lastFields.length-1]);var fieldCount=isLastFieldIPv4Address?7:8;var lastFieldsStart=lastFields.length-fieldCount;var fields=Array(fieldCount);for(var x=0;x<fieldCount;++x){fields[x]=firstFields[x]||lastFields[lastFieldsStart+x]||""}if(isLastFieldIPv4Address){fields[fieldCount-1]=_normalizeIPv4(fields[fieldCount-1],protocol)}var allZeroFields=fields.reduce((function(acc,field,index){if(!field||field==="0"){var lastLongest=acc[acc.length-1];if(lastLongest&&lastLongest.index+lastLongest.length===index){lastLongest.length++}else{acc.push({index:index,length:1})}}return acc}),[]);var longestZeroFields=allZeroFields.sort((function(a,b){return b.length-a.length}))[0];var newHost=void 0;if(longestZeroFields&&longestZeroFields.length>1){var newFirst=fields.slice(0,longestZeroFields.index);var newLast=fields.slice(longestZeroFields.index+longestZeroFields.length);newHost=newFirst.join(":")+"::"+newLast.join(":")}else{newHost=fields.join(":")}if(zone){newHost+="%"+zone}return newHost}else{return host}}var URI_PARSE=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i;var NO_MATCH_IS_UNDEFINED="".match(/(){0}/)[1]===undefined;function parse(uriString){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var components={};var protocol=options.iri!==false?IRI_PROTOCOL:URI_PROTOCOL;if(options.reference==="suffix")uriString=(options.scheme?options.scheme+":":"")+"//"+uriString;var matches=uriString.match(URI_PARSE);if(matches){if(NO_MATCH_IS_UNDEFINED){components.scheme=matches[1];components.userinfo=matches[3];components.host=matches[4];components.port=parseInt(matches[5],10);components.path=matches[6]||"";components.query=matches[7];components.fragment=matches[8];if(isNaN(components.port)){components.port=matches[5]}}else{components.scheme=matches[1]||undefined;components.userinfo=uriString.indexOf("@")!==-1?matches[3]:undefined;components.host=uriString.indexOf("//")!==-1?matches[4]:undefined;components.port=parseInt(matches[5],10);components.path=matches[6]||"";components.query=uriString.indexOf("?")!==-1?matches[7]:undefined;components.fragment=uriString.indexOf("#")!==-1?matches[8]:undefined;if(isNaN(components.port)){components.port=uriString.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?matches[4]:undefined}}if(components.host){components.host=_normalizeIPv6(_normalizeIPv4(components.host,protocol),protocol)}if(components.scheme===undefined&&components.userinfo===undefined&&components.host===undefined&&components.port===undefined&&!components.path&&components.query===undefined){components.reference="same-document"}else if(components.scheme===undefined){components.reference="relative"}else if(components.fragment===undefined){components.reference="absolute"}else{components.reference="uri"}if(options.reference&&options.reference!=="suffix"&&options.reference!==components.reference){components.error=components.error||"URI is not a "+options.reference+" reference."}var schemeHandler=SCHEMES[(options.scheme||components.scheme||"").toLowerCase()];if(!options.unicodeSupport&&(!schemeHandler||!schemeHandler.unicodeSupport)){if(components.host&&(options.domainHost||schemeHandler&&schemeHandler.domainHost)){try{components.host=punycode.toASCII(components.host.replace(protocol.PCT_ENCODED,pctDecChars).toLowerCase())}catch(e){components.error=components.error||"Host's domain name can not be converted to ASCII via punycode: "+e}}_normalizeComponentEncoding(components,URI_PROTOCOL)}else{_normalizeComponentEncoding(components,protocol)}if(schemeHandler&&schemeHandler.parse){schemeHandler.parse(components,options)}}else{components.error=components.error||"URI can not be parsed."}return components}function _recomposeAuthority(components,options){var protocol=options.iri!==false?IRI_PROTOCOL:URI_PROTOCOL;var uriTokens=[];if(components.userinfo!==undefined){uriTokens.push(components.userinfo);uriTokens.push("@")}if(components.host!==undefined){uriTokens.push(_normalizeIPv6(_normalizeIPv4(String(components.host),protocol),protocol).replace(protocol.IPV6ADDRESS,(function(_,$1,$2){return"["+$1+($2?"%25"+$2:"")+"]"})))}if(typeof components.port==="number"||typeof components.port==="string"){uriTokens.push(":");uriTokens.push(String(components.port))}return uriTokens.length?uriTokens.join(""):undefined}var RDS1=/^\.\.?\//;var RDS2=/^\/\.(\/|$)/;var RDS3=/^\/\.\.(\/|$)/;var RDS5=/^\/?(?:.|\n)*?(?=\/|$)/;function removeDotSegments(input){var output=[];while(input.length){if(input.match(RDS1)){input=input.replace(RDS1,"")}else if(input.match(RDS2)){input=input.replace(RDS2,"/")}else if(input.match(RDS3)){input=input.replace(RDS3,"/");output.pop()}else if(input==="."||input===".."){input=""}else{var im=input.match(RDS5);if(im){var s=im[0];input=input.slice(s.length);output.push(s)}else{throw new Error("Unexpected dot segment condition")}}}return output.join("")}function serialize(components){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var protocol=options.iri?IRI_PROTOCOL:URI_PROTOCOL;var uriTokens=[];var schemeHandler=SCHEMES[(options.scheme||components.scheme||"").toLowerCase()];if(schemeHandler&&schemeHandler.serialize)schemeHandler.serialize(components,options);if(components.host){if(protocol.IPV6ADDRESS.test(components.host)){}else if(options.domainHost||schemeHandler&&schemeHandler.domainHost){try{components.host=!options.iri?punycode.toASCII(components.host.replace(protocol.PCT_ENCODED,pctDecChars).toLowerCase()):punycode.toUnicode(components.host)}catch(e){components.error=components.error||"Host's domain name can not be converted to "+(!options.iri?"ASCII":"Unicode")+" via punycode: "+e}}}_normalizeComponentEncoding(components,protocol);if(options.reference!=="suffix"&&components.scheme){uriTokens.push(components.scheme);uriTokens.push(":")}var authority=_recomposeAuthority(components,options);if(authority!==undefined){if(options.reference!=="suffix"){uriTokens.push("//")}uriTokens.push(authority);if(components.path&&components.path.charAt(0)!=="/"){uriTokens.push("/")}}if(components.path!==undefined){var s=components.path;if(!options.absolutePath&&(!schemeHandler||!schemeHandler.absolutePath)){s=removeDotSegments(s)}if(authority===undefined){s=s.replace(/^\/\//,"/%2F")}uriTokens.push(s)}if(components.query!==undefined){uriTokens.push("?");uriTokens.push(components.query)}if(components.fragment!==undefined){uriTokens.push("#");uriTokens.push(components.fragment)}return uriTokens.join("")}function resolveComponents(base,relative){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var skipNormalization=arguments[3];var target={};if(!skipNormalization){base=parse(serialize(base,options),options);relative=parse(serialize(relative,options),options)}options=options||{};if(!options.tolerant&&relative.scheme){target.scheme=relative.scheme;target.userinfo=relative.userinfo;target.host=relative.host;target.port=relative.port;target.path=removeDotSegments(relative.path||"");target.query=relative.query}else{if(relative.userinfo!==undefined||relative.host!==undefined||relative.port!==undefined){target.userinfo=relative.userinfo;target.host=relative.host;target.port=relative.port;target.path=removeDotSegments(relative.path||"");target.query=relative.query}else{if(!relative.path){target.path=base.path;if(relative.query!==undefined){target.query=relative.query}else{target.query=base.query}}else{if(relative.path.charAt(0)==="/"){target.path=removeDotSegments(relative.path)}else{if((base.userinfo!==undefined||base.host!==undefined||base.port!==undefined)&&!base.path){target.path="/"+relative.path}else if(!base.path){target.path=relative.path}else{target.path=base.path.slice(0,base.path.lastIndexOf("/")+1)+relative.path}target.path=removeDotSegments(target.path)}target.query=relative.query}target.userinfo=base.userinfo;target.host=base.host;target.port=base.port}target.scheme=base.scheme}target.fragment=relative.fragment;return target}function resolve(baseURI,relativeURI,options){var schemelessOptions=assign({scheme:"null"},options);return serialize(resolveComponents(parse(baseURI,schemelessOptions),parse(relativeURI,schemelessOptions),schemelessOptions,true),schemelessOptions)}function normalize(uri,options){if(typeof uri==="string"){uri=serialize(parse(uri,options),options)}else if(typeOf(uri)==="object"){uri=parse(serialize(uri,options),options)}return uri}function equal(uriA,uriB,options){if(typeof uriA==="string"){uriA=serialize(parse(uriA,options),options)}else if(typeOf(uriA)==="object"){uriA=serialize(uriA,options)}if(typeof uriB==="string"){uriB=serialize(parse(uriB,options),options)}else if(typeOf(uriB)==="object"){uriB=serialize(uriB,options)}return uriA===uriB}function escapeComponent(str,options){return str&&str.toString().replace(!options||!options.iri?URI_PROTOCOL.ESCAPE:IRI_PROTOCOL.ESCAPE,pctEncChar)}function unescapeComponent(str,options){return str&&str.toString().replace(!options||!options.iri?URI_PROTOCOL.PCT_ENCODED:IRI_PROTOCOL.PCT_ENCODED,pctDecChars)}var handler={scheme:"http",domainHost:true,parse:function parse(components,options){if(!components.host){components.error=components.error||"HTTP URIs must have a host."}return components},serialize:function serialize(components,options){var secure=String(components.scheme).toLowerCase()==="https";if(components.port===(secure?443:80)||components.port===""){components.port=undefined}if(!components.path){components.path="/"}return components}};var handler$1={scheme:"https",domainHost:handler.domainHost,parse:handler.parse,serialize:handler.serialize};function isSecure(wsComponents){return typeof wsComponents.secure==="boolean"?wsComponents.secure:String(wsComponents.scheme).toLowerCase()==="wss"}var handler$2={scheme:"ws",domainHost:true,parse:function parse(components,options){var wsComponents=components;wsComponents.secure=isSecure(wsComponents);wsComponents.resourceName=(wsComponents.path||"/")+(wsComponents.query?"?"+wsComponents.query:"");wsComponents.path=undefined;wsComponents.query=undefined;return wsComponents},serialize:function serialize(wsComponents,options){if(wsComponents.port===(isSecure(wsComponents)?443:80)||wsComponents.port===""){wsComponents.port=undefined}if(typeof wsComponents.secure==="boolean"){wsComponents.scheme=wsComponents.secure?"wss":"ws";wsComponents.secure=undefined}if(wsComponents.resourceName){var _wsComponents$resourc=wsComponents.resourceName.split("?"),_wsComponents$resourc2=slicedToArray(_wsComponents$resourc,2),path=_wsComponents$resourc2[0],query=_wsComponents$resourc2[1];wsComponents.path=path&&path!=="/"?path:undefined;wsComponents.query=query;wsComponents.resourceName=undefined}wsComponents.fragment=undefined;return wsComponents}};var handler$3={scheme:"wss",domainHost:handler$2.domainHost,parse:handler$2.parse,serialize:handler$2.serialize};var O={};var isIRI=true;var UNRESERVED$$="[A-Za-z0-9\\-\\.\\_\\~"+(isIRI?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]";var HEXDIG$$="[0-9A-Fa-f]";var PCT_ENCODED$=subexp(subexp("%[EFef]"+HEXDIG$$+"%"+HEXDIG$$+HEXDIG$$+"%"+HEXDIG$$+HEXDIG$$)+"|"+subexp("%[89A-Fa-f]"+HEXDIG$$+"%"+HEXDIG$$+HEXDIG$$)+"|"+subexp("%"+HEXDIG$$+HEXDIG$$));var ATEXT$$="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]";var QTEXT$$="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]";var VCHAR$$=merge(QTEXT$$,'[\\"\\\\]');var SOME_DELIMS$$="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]";var UNRESERVED=new RegExp(UNRESERVED$$,"g");var PCT_ENCODED=new RegExp(PCT_ENCODED$,"g");var NOT_LOCAL_PART=new RegExp(merge("[^]",ATEXT$$,"[\\.]",'[\\"]',VCHAR$$),"g");var NOT_HFNAME=new RegExp(merge("[^]",UNRESERVED$$,SOME_DELIMS$$),"g");var NOT_HFVALUE=NOT_HFNAME;function decodeUnreserved(str){var decStr=pctDecChars(str);return!decStr.match(UNRESERVED)?str:decStr}var handler$4={scheme:"mailto",parse:function parse$$1(components,options){var mailtoComponents=components;var to=mailtoComponents.to=mailtoComponents.path?mailtoComponents.path.split(","):[];mailtoComponents.path=undefined;if(mailtoComponents.query){var unknownHeaders=false;var headers={};var hfields=mailtoComponents.query.split("&");for(var x=0,xl=hfields.length;x<xl;++x){var hfield=hfields[x].split("=");switch(hfield[0]){case"to":var toAddrs=hfield[1].split(",");for(var _x=0,_xl=toAddrs.length;_x<_xl;++_x){to.push(toAddrs[_x])}break;case"subject":mailtoComponents.subject=unescapeComponent(hfield[1],options);break;case"body":mailtoComponents.body=unescapeComponent(hfield[1],options);break;default:unknownHeaders=true;headers[unescapeComponent(hfield[0],options)]=unescapeComponent(hfield[1],options);break}}if(unknownHeaders)mailtoComponents.headers=headers}mailtoComponents.query=undefined;for(var _x2=0,_xl2=to.length;_x2<_xl2;++_x2){var addr=to[_x2].split("@");addr[0]=unescapeComponent(addr[0]);if(!options.unicodeSupport){try{addr[1]=punycode.toASCII(unescapeComponent(addr[1],options).toLowerCase())}catch(e){mailtoComponents.error=mailtoComponents.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}}else{addr[1]=unescapeComponent(addr[1],options).toLowerCase()}to[_x2]=addr.join("@")}return mailtoComponents},serialize:function serialize$$1(mailtoComponents,options){var components=mailtoComponents;var to=toArray(mailtoComponents.to);if(to){for(var x=0,xl=to.length;x<xl;++x){var toAddr=String(to[x]);var atIdx=toAddr.lastIndexOf("@");var localPart=toAddr.slice(0,atIdx).replace(PCT_ENCODED,decodeUnreserved).replace(PCT_ENCODED,toUpperCase).replace(NOT_LOCAL_PART,pctEncChar);var domain=toAddr.slice(atIdx+1);try{domain=!options.iri?punycode.toASCII(unescapeComponent(domain,options).toLowerCase()):punycode.toUnicode(domain)}catch(e){components.error=components.error||"Email address's domain name can not be converted to "+(!options.iri?"ASCII":"Unicode")+" via punycode: "+e}to[x]=localPart+"@"+domain}components.path=to.join(",")}var headers=mailtoComponents.headers=mailtoComponents.headers||{};if(mailtoComponents.subject)headers["subject"]=mailtoComponents.subject;if(mailtoComponents.body)headers["body"]=mailtoComponents.body;var fields=[];for(var name in headers){if(headers[name]!==O[name]){fields.push(name.replace(PCT_ENCODED,decodeUnreserved).replace(PCT_ENCODED,toUpperCase).replace(NOT_HFNAME,pctEncChar)+"="+headers[name].replace(PCT_ENCODED,decodeUnreserved).replace(PCT_ENCODED,toUpperCase).replace(NOT_HFVALUE,pctEncChar))}}if(fields.length){components.query=fields.join("&")}return components}};var URN_PARSE=/^([^\:]+)\:(.*)/;var handler$5={scheme:"urn",parse:function parse$$1(components,options){var matches=components.path&&components.path.match(URN_PARSE);var urnComponents=components;if(matches){var scheme=options.scheme||urnComponents.scheme||"urn";var nid=matches[1].toLowerCase();var nss=matches[2];var urnScheme=scheme+":"+(options.nid||nid);var schemeHandler=SCHEMES[urnScheme];urnComponents.nid=nid;urnComponents.nss=nss;urnComponents.path=undefined;if(schemeHandler){urnComponents=schemeHandler.parse(urnComponents,options)}}else{urnComponents.error=urnComponents.error||"URN can not be parsed."}return urnComponents},serialize:function serialize$$1(urnComponents,options){var scheme=options.scheme||urnComponents.scheme||"urn";var nid=urnComponents.nid;var urnScheme=scheme+":"+(options.nid||nid);var schemeHandler=SCHEMES[urnScheme];if(schemeHandler){urnComponents=schemeHandler.serialize(urnComponents,options)}var uriComponents=urnComponents;var nss=urnComponents.nss;uriComponents.path=(nid||options.nid)+":"+nss;return uriComponents}};var UUID=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;var handler$6={scheme:"urn:uuid",parse:function parse(urnComponents,options){var uuidComponents=urnComponents;uuidComponents.uuid=uuidComponents.nss;uuidComponents.nss=undefined;if(!options.tolerant&&(!uuidComponents.uuid||!uuidComponents.uuid.match(UUID))){uuidComponents.error=uuidComponents.error||"UUID is not valid."}return uuidComponents},serialize:function serialize(uuidComponents,options){var urnComponents=uuidComponents;urnComponents.nss=(uuidComponents.uuid||"").toLowerCase();return urnComponents}};SCHEMES[handler.scheme]=handler;SCHEMES[handler$1.scheme]=handler$1;SCHEMES[handler$2.scheme]=handler$2;SCHEMES[handler$3.scheme]=handler$3;SCHEMES[handler$4.scheme]=handler$4;SCHEMES[handler$5.scheme]=handler$5;SCHEMES[handler$6.scheme]=handler$6;exports.SCHEMES=SCHEMES;exports.pctEncChar=pctEncChar;exports.pctDecChars=pctDecChars;exports.parse=parse;exports.removeDotSegments=removeDotSegments;exports.serialize=serialize;exports.resolveComponents=resolveComponents;exports.resolve=resolve;exports.normalize=normalize;exports.equal=equal;exports.escapeComponent=escapeComponent;exports.unescapeComponent=unescapeComponent;Object.defineProperty(exports,"__esModule",{value:true})}))},{}],436:[function(require,module,exports){(function(root){var URL_REGEX=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/;var FIRST_SEGMENT_REGEX=/^([^\/?#]*)(.*)$/;var SLASH_DOT_REGEX=/(?:\/|^)\.(?=\/)/g;var SLASH_DOT_DOT_REGEX=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g;var URLToolkit={buildAbsoluteURL:function(baseURL,relativeURL,opts){opts=opts||{};baseURL=baseURL.trim();relativeURL=relativeURL.trim();if(!relativeURL){if(!opts.alwaysNormalize){return baseURL}var basePartsForNormalise=URLToolkit.parseURL(baseURL);if(!basePartsForNormalise){throw new Error("Error trying to parse base URL.")}basePartsForNormalise.path=URLToolkit.normalizePath(basePartsForNormalise.path);return URLToolkit.buildURLFromParts(basePartsForNormalise)}var relativeParts=URLToolkit.parseURL(relativeURL);if(!relativeParts){throw new Error("Error trying to parse relative URL.")}if(relativeParts.scheme){if(!opts.alwaysNormalize){return relativeURL}relativeParts.path=URLToolkit.normalizePath(relativeParts.path);return URLToolkit.buildURLFromParts(relativeParts)}var baseParts=URLToolkit.parseURL(baseURL);if(!baseParts){throw new Error("Error trying to parse base URL.")}if(!baseParts.netLoc&&baseParts.path&&baseParts.path[0]!=="/"){var pathParts=FIRST_SEGMENT_REGEX.exec(baseParts.path);baseParts.netLoc=pathParts[1];baseParts.path=pathParts[2]}if(baseParts.netLoc&&!baseParts.path){baseParts.path="/"}var builtParts={scheme:baseParts.scheme,netLoc:relativeParts.netLoc,path:null,params:relativeParts.params,query:relativeParts.query,fragment:relativeParts.fragment};if(!relativeParts.netLoc){builtParts.netLoc=baseParts.netLoc;if(relativeParts.path[0]!=="/"){if(!relativeParts.path){builtParts.path=baseParts.path;if(!relativeParts.params){builtParts.params=baseParts.params;if(!relativeParts.query){builtParts.query=baseParts.query}}}else{var baseURLPath=baseParts.path;var newPath=baseURLPath.substring(0,baseURLPath.lastIndexOf("/")+1)+relativeParts.path;builtParts.path=URLToolkit.normalizePath(newPath)}}}if(builtParts.path===null){builtParts.path=opts.alwaysNormalize?URLToolkit.normalizePath(relativeParts.path):relativeParts.path}return URLToolkit.buildURLFromParts(builtParts)},parseURL:function(url){var parts=URL_REGEX.exec(url);if(!parts){return null}return{scheme:parts[1]||"",netLoc:parts[2]||"",path:parts[3]||"",params:parts[4]||"",query:parts[5]||"",fragment:parts[6]||""}},normalizePath:function(path){path=path.split("").reverse().join("").replace(SLASH_DOT_REGEX,"");while(path.length!==(path=path.replace(SLASH_DOT_DOT_REGEX,"")).length){}return path.split("").reverse().join("")},buildURLFromParts:function(parts){return parts.scheme+parts.netLoc+parts.path+parts.params+parts.query+parts.fragment}};if(typeof exports==="object"&&typeof module==="object")module.exports=URLToolkit;else if(typeof define==="function"&&define.amd)define([],(function(){return URLToolkit}));else if(typeof exports==="object")exports["URLToolkit"]=URLToolkit;else root["URLToolkit"]=URLToolkit})(this)},{}],437:[function(require,module,exports){"use strict";var punycode=require("punycode");var util=require("./util");exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;exports.Url=Url;function Url(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:true,"javascript:":true},hostlessProtocol={javascript:true,"javascript:":true},slashedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;u.parse(url,parseQueryString,slashesDenoteHost);return u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url)){throw new TypeError("Parameter 'url' must be a string, not "+typeof url)}var queryIndex=url.indexOf("?"),splitter=queryIndex!==-1&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/");url=uSplit.join(splitter);var rest=url;rest=rest.trim();if(!slashesDenoteHost&&url.split("#").length===1){var simplePath=simplePathPattern.exec(rest);if(simplePath){this.path=rest;this.href=rest;this.pathname=simplePath[1];if(simplePath[2]){this.search=simplePath[2];if(parseQueryString){this.query=querystring.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(parseQueryString){this.search="";this.query={}}return this}}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto;rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);this.slashes=true}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var hostEnd=-1;for(var i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}var auth,atSign;if(hostEnd===-1){atSign=rest.lastIndexOf("@")}else{atSign=rest.lastIndexOf("@",hostEnd)}if(atSign!==-1){auth=rest.slice(0,atSign);rest=rest.slice(atSign+1);this.auth=decodeURIComponent(auth)}hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}if(hostEnd===-1)hostEnd=rest.length;this.host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd);this.parseHost();this.hostname=this.hostname||"";var ipv6Hostname=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part)continue;if(!part.match(hostnamePartPattern)){var newpart="";for(var j=0,k=part.length;j<k;j++){if(part.charCodeAt(j)>127){newpart+="x"}else{newpart+=part[j]}}if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2])}if(notHost.length){rest="/"+notHost.join(".")+rest}this.hostname=validParts.join(".");break}}}}if(this.hostname.length>hostnameMaxLen){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!ipv6Hostname){this.hostname=punycode.toASCII(this.hostname)}var p=this.port?":"+this.port:"";var h=this.hostname||"";this.host=h+p;this.href+=this.host;if(ipv6Hostname){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(rest[0]!=="/"){rest="/"+rest}}}if(!unsafeProtocol[lowerProto]){for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(rest.indexOf(ae)===-1)continue;var esc=encodeURIComponent(ae);if(esc===ae){esc=escape(ae)}rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");if(hash!==-1){this.hash=rest.substr(hash);rest=rest.slice(0,hash)}var qm=rest.indexOf("?");if(qm!==-1){this.search=rest.substr(qm);this.query=rest.substr(qm+1);if(parseQueryString){this.query=querystring.parse(this.query)}rest=rest.slice(0,qm)}else if(parseQueryString){this.search="";this.query={}}if(rest)this.pathname=rest;if(slashedProtocol[lowerProto]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var p=this.pathname||"";var s=this.search||"";this.path=p+s}this.href=this.format();return this};function urlFormat(obj){if(util.isString(obj))obj=urlParse(obj);if(!(obj instanceof Url))return Url.prototype.format.call(obj);return obj.format()}Url.prototype.format=function(){var auth=this.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@"}var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=false,query="";if(this.host){host=auth+this.host}else if(this.hostname){host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){host+=":"+this.port}}if(this.query&&util.isObject(this.query)&&Object.keys(this.query).length){query=querystring.stringify(this.query)}var search=this.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":")protocol+=":";if(this.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/")pathname="/"+pathname}else if(!host){host=""}if(hash&&hash.charAt(0)!=="#")hash="#"+hash;if(search&&search.charAt(0)!=="?")search="?"+search;pathname=pathname.replace(/[?#]/g,(function(match){return encodeURIComponent(match)}));search=search.replace("#","%23");return protocol+host+pathname+search+hash};function urlResolve(source,relative){return urlParse(source,false,true).resolve(relative)}Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,false,true)).format()};function urlResolveObject(source,relative){if(!source)return relative;return urlParse(source,false,true).resolveObject(relative)}Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,false,true);relative=rel}var result=new Url;var tkeys=Object.keys(this);for(var tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}result.hash=relative.hash;if(relative.href===""){result.href=result.format();return result}if(relative.slashes&&!relative.protocol){var rkeys=Object.keys(relative);for(var rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];if(rkey!=="protocol")result[rkey]=relative[rkey]}if(slashedProtocol[result.protocol]&&result.hostname&&!result.pathname){result.path=result.pathname="/"}result.href=result.format();return result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){var keys=Object.keys(relative);for(var v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}result.href=result.format();return result}result.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift()));if(!relative.host)relative.host="";if(!relative.hostname)relative.hostname="";if(relPath[0]!=="")relPath.unshift("");if(relPath.length<2)relPath.unshift("");result.pathname=relPath.join("/")}else{result.pathname=relative.pathname}result.search=relative.search;result.query=relative.query;result.host=relative.host||"";result.auth=relative.auth;result.hostname=relative.hostname||relative.host;result.port=relative.port;if(result.pathname||result.search){var p=result.pathname||"";var s=result.search||"";result.path=p+s}result.slashes=result.slashes||relative.slashes;result.href=result.format();return result}var isSourceAbs=result.pathname&&result.pathname.charAt(0)==="/",isRelAbs=relative.host||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic){result.hostname="";result.port=null;if(result.host){if(srcPath[0]==="")srcPath[0]=result.host;else srcPath.unshift(result.host)}result.host="";if(relative.protocol){relative.hostname=null;relative.port=null;if(relative.host){if(relPath[0]==="")relPath[0]=relative.host;else relPath.unshift(relative.host)}relative.host=null}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="")}if(isRelAbs){result.host=relative.host||relative.host===""?relative.host:result.host;result.hostname=relative.hostname||relative.hostname===""?relative.hostname:result.hostname;result.search=relative.search;result.query=relative.query;srcPath=relPath}else if(relPath.length){if(!srcPath)srcPath=[];srcPath.pop();srcPath=srcPath.concat(relPath);result.search=relative.search;result.query=relative.query}else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}result.search=relative.search;result.query=relative.query;if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.href=result.format();return result}if(!srcPath.length){result.pathname=null;if(result.search){result.path="/"+result.search}else{result.path=null}result.href=result.format();return result}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last==="."){srcPath.splice(i,1)}else if(last===".."){srcPath.splice(i,1);up++}else if(up){srcPath.splice(i,1);up--}}if(!mustEndAbs&&!removeAllDots){for(;up--;up){srcPath.unshift("..")}}if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/")){srcPath.unshift("")}if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/"){srcPath.push("")}var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}mustEndAbs=mustEndAbs||result.host&&srcPath.length;if(mustEndAbs&&!isAbsolute){srcPath.unshift("")}if(!srcPath.length){result.pathname=null;result.path=null}else{result.pathname=srcPath.join("/")}if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.auth=relative.auth||result.auth;result.slashes=result.slashes||relative.slashes;result.href=result.format();return result};Url.prototype.parseHost=function(){var host=this.host;var port=portPattern.exec(host);if(port){port=port[0];if(port!==":"){this.port=port.substr(1)}host=host.substr(0,host.length-port.length)}if(host)this.hostname=host}},{"./util":438,punycode:150,querystring:381}],438:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return typeof arg==="string"},isObject:function(arg){return typeof arg==="object"&&arg!==null},isNull:function(arg){return arg===null},isNullOrUndefined:function(arg){return arg==null}}},{}],439:[function(require,module,exports){(function(global){(function(){module.exports=deprecate;function deprecate(fn,msg){if(config("noDeprecation")){return fn}var warned=false;function deprecated(){if(!warned){if(config("throwDeprecation")){throw new Error(msg)}else if(config("traceDeprecation")){console.trace(msg)}else{console.warn(msg)}warned=true}return fn.apply(this,arguments)}return deprecated}function config(name){try{if(!global.localStorage)return false}catch(_){return false}var val=global.localStorage[name];if(null==val)return false;return String(val).toLowerCase()==="true"}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],440:[function(require,module,exports){arguments[4][143][0].apply(exports,arguments)},{dup:143}],441:[function(require,module,exports){"use strict";var isArgumentsObject=require("is-arguments");var isGeneratorFunction=require("is-generator-function");var whichTypedArray=require("which-typed-array");var isTypedArray=require("is-typed-array");function uncurryThis(f){return f.call.bind(f)}var BigIntSupported=typeof BigInt!=="undefined";var SymbolSupported=typeof Symbol!=="undefined";var ObjectToString=uncurryThis(Object.prototype.toString);var numberValue=uncurryThis(Number.prototype.valueOf);var stringValue=uncurryThis(String.prototype.valueOf);var booleanValue=uncurryThis(Boolean.prototype.valueOf);if(BigIntSupported){var bigIntValue=uncurryThis(BigInt.prototype.valueOf)}if(SymbolSupported){var symbolValue=uncurryThis(Symbol.prototype.valueOf)}function checkBoxedPrimitive(value,prototypeValueOf){if(typeof value!=="object"){return false}try{prototypeValueOf(value);return true}catch(e){return false}}exports.isArgumentsObject=isArgumentsObject;exports.isGeneratorFunction=isGeneratorFunction;exports.isTypedArray=isTypedArray;function isPromise(input){return typeof Promise!=="undefined"&&input instanceof Promise||input!==null&&typeof input==="object"&&typeof input.then==="function"&&typeof input.catch==="function"}exports.isPromise=isPromise;function isArrayBufferView(value){if(typeof ArrayBuffer!=="undefined"&&ArrayBuffer.isView){return ArrayBuffer.isView(value)}return isTypedArray(value)||isDataView(value)}exports.isArrayBufferView=isArrayBufferView;function isUint8Array(value){return whichTypedArray(value)==="Uint8Array"}exports.isUint8Array=isUint8Array;function isUint8ClampedArray(value){return whichTypedArray(value)==="Uint8ClampedArray"}exports.isUint8ClampedArray=isUint8ClampedArray;function isUint16Array(value){return whichTypedArray(value)==="Uint16Array"}exports.isUint16Array=isUint16Array;function isUint32Array(value){return whichTypedArray(value)==="Uint32Array"}exports.isUint32Array=isUint32Array;function isInt8Array(value){return whichTypedArray(value)==="Int8Array"}exports.isInt8Array=isInt8Array;function isInt16Array(value){return whichTypedArray(value)==="Int16Array"}exports.isInt16Array=isInt16Array;function isInt32Array(value){return whichTypedArray(value)==="Int32Array"}exports.isInt32Array=isInt32Array;function isFloat32Array(value){return whichTypedArray(value)==="Float32Array"}exports.isFloat32Array=isFloat32Array;function isFloat64Array(value){return whichTypedArray(value)==="Float64Array"}exports.isFloat64Array=isFloat64Array;function isBigInt64Array(value){return whichTypedArray(value)==="BigInt64Array"}exports.isBigInt64Array=isBigInt64Array;function isBigUint64Array(value){return whichTypedArray(value)==="BigUint64Array"}exports.isBigUint64Array=isBigUint64Array;function isMapToString(value){return ObjectToString(value)==="[object Map]"}isMapToString.working=typeof Map!=="undefined"&&isMapToString(new Map);function isMap(value){if(typeof Map==="undefined"){return false}return isMapToString.working?isMapToString(value):value instanceof Map}exports.isMap=isMap;function isSetToString(value){return ObjectToString(value)==="[object Set]"}isSetToString.working=typeof Set!=="undefined"&&isSetToString(new Set);function isSet(value){if(typeof Set==="undefined"){return false}return isSetToString.working?isSetToString(value):value instanceof Set}exports.isSet=isSet;function isWeakMapToString(value){return ObjectToString(value)==="[object WeakMap]"}isWeakMapToString.working=typeof WeakMap!=="undefined"&&isWeakMapToString(new WeakMap);function isWeakMap(value){if(typeof WeakMap==="undefined"){return false}return isWeakMapToString.working?isWeakMapToString(value):value instanceof WeakMap}exports.isWeakMap=isWeakMap;function isWeakSetToString(value){return ObjectToString(value)==="[object WeakSet]"}isWeakSetToString.working=typeof WeakSet!=="undefined"&&isWeakSetToString(new WeakSet);function isWeakSet(value){return isWeakSetToString(value)}exports.isWeakSet=isWeakSet;function isArrayBufferToString(value){return ObjectToString(value)==="[object ArrayBuffer]"}isArrayBufferToString.working=typeof ArrayBuffer!=="undefined"&&isArrayBufferToString(new ArrayBuffer);function isArrayBuffer(value){if(typeof ArrayBuffer==="undefined"){return false}return isArrayBufferToString.working?isArrayBufferToString(value):value instanceof ArrayBuffer}exports.isArrayBuffer=isArrayBuffer;function isDataViewToString(value){return ObjectToString(value)==="[object DataView]"}isDataViewToString.working=typeof ArrayBuffer!=="undefined"&&typeof DataView!=="undefined"&&isDataViewToString(new DataView(new ArrayBuffer(1),0,1));function isDataView(value){if(typeof DataView==="undefined"){return false}return isDataViewToString.working?isDataViewToString(value):value instanceof DataView}exports.isDataView=isDataView;var SharedArrayBufferCopy=typeof SharedArrayBuffer!=="undefined"?SharedArrayBuffer:undefined;function isSharedArrayBufferToString(value){return ObjectToString(value)==="[object SharedArrayBuffer]"}function isSharedArrayBuffer(value){if(typeof SharedArrayBufferCopy==="undefined"){return false}if(typeof isSharedArrayBufferToString.working==="undefined"){isSharedArrayBufferToString.working=isSharedArrayBufferToString(new SharedArrayBufferCopy)}return isSharedArrayBufferToString.working?isSharedArrayBufferToString(value):value instanceof SharedArrayBufferCopy}exports.isSharedArrayBuffer=isSharedArrayBuffer;function isAsyncFunction(value){return ObjectToString(value)==="[object AsyncFunction]"}exports.isAsyncFunction=isAsyncFunction;function isMapIterator(value){return ObjectToString(value)==="[object Map Iterator]"}exports.isMapIterator=isMapIterator;function isSetIterator(value){return ObjectToString(value)==="[object Set Iterator]"}exports.isSetIterator=isSetIterator;function isGeneratorObject(value){return ObjectToString(value)==="[object Generator]"}exports.isGeneratorObject=isGeneratorObject;function isWebAssemblyCompiledModule(value){return ObjectToString(value)==="[object WebAssembly.Module]"}exports.isWebAssemblyCompiledModule=isWebAssemblyCompiledModule;function isNumberObject(value){return checkBoxedPrimitive(value,numberValue)}exports.isNumberObject=isNumberObject;function isStringObject(value){return checkBoxedPrimitive(value,stringValue)}exports.isStringObject=isStringObject;function isBooleanObject(value){return checkBoxedPrimitive(value,booleanValue)}exports.isBooleanObject=isBooleanObject;function isBigIntObject(value){return BigIntSupported&&checkBoxedPrimitive(value,bigIntValue)}exports.isBigIntObject=isBigIntObject;function isSymbolObject(value){return SymbolSupported&&checkBoxedPrimitive(value,symbolValue)}exports.isSymbolObject=isSymbolObject;function isBoxedPrimitive(value){return isNumberObject(value)||isStringObject(value)||isBooleanObject(value)||isBigIntObject(value)||isSymbolObject(value)}exports.isBoxedPrimitive=isBoxedPrimitive;function isAnyArrayBuffer(value){return typeof Uint8Array!=="undefined"&&(isArrayBuffer(value)||isSharedArrayBuffer(value))}exports.isAnyArrayBuffer=isAnyArrayBuffer;["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(method){Object.defineProperty(exports,method,{enumerable:false,value:function(){throw new Error(method+" is not supported in userland")}})}))},{"is-arguments":281,"is-generator-function":283,"is-typed-array":285,"which-typed-array":443}],442:[function(require,module,exports){(function(process){(function(){var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function getOwnPropertyDescriptors(obj){var keys=Object.keys(obj);var descriptors={};for(var i=0;i<keys.length;i++){descriptors[keys[i]]=Object.getOwnPropertyDescriptor(obj,keys[i])}return descriptors};var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,(function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}));for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};exports.deprecate=function(fn,msg){if(typeof process!=="undefined"&&process.noDeprecation===true){return fn}if(typeof process==="undefined"){return function(){return exports.deprecate(fn,msg).apply(this,arguments)}}var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg)}else if(process.traceDeprecation){console.trace(msg)}else{console.error(msg)}warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnvRegex=/^$/;if(process.env.NODE_DEBUG){var debugEnv=process.env.NODE_DEBUG;debugEnv=debugEnv.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase();debugEnvRegex=new RegExp("^"+debugEnv+"$","i")}exports.debuglog=function(set){set=set.toUpperCase();if(!debugs[set]){if(debugEnvRegex.test(set)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else{debugs[set]=function(){}}}return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach((function(val,idx){hash[val]=true}));return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value)}if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0)){return formatError(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}))}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}keys.forEach((function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}}));return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map((function(line){return"  "+line})).join("\n").substr(2)}else{str="\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce((function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}exports.types=require("./support/types");function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;exports.types.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;exports.types.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;exports.types.isNativeError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=require("./support/isBuffer");function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=require("inherits");exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var kCustomPromisifiedSymbol=typeof Symbol!=="undefined"?Symbol("util.promisify.custom"):undefined;exports.promisify=function promisify(original){if(typeof original!=="function")throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&original[kCustomPromisifiedSymbol]){var fn=original[kCustomPromisifiedSymbol];if(typeof fn!=="function"){throw new TypeError('The "util.promisify.custom" argument must be of type Function')}Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:false,writable:false,configurable:true});return fn}function fn(){var promiseResolve,promiseReject;var promise=new Promise((function(resolve,reject){promiseResolve=resolve;promiseReject=reject}));var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i])}args.push((function(err,value){if(err){promiseReject(err)}else{promiseResolve(value)}}));try{original.apply(this,args)}catch(err){promiseReject(err)}return promise}Object.setPrototypeOf(fn,Object.getPrototypeOf(original));if(kCustomPromisifiedSymbol)Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:false,writable:false,configurable:true});return Object.defineProperties(fn,getOwnPropertyDescriptors(original))};exports.promisify.custom=kCustomPromisifiedSymbol;function callbackifyOnRejected(reason,cb){if(!reason){var newReason=new Error("Promise was rejected with a falsy value");newReason.reason=reason;reason=newReason}return cb(reason)}function callbackify(original){if(typeof original!=="function"){throw new TypeError('The "original" argument must be of type Function')}function callbackified(){var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i])}var maybeCb=args.pop();if(typeof maybeCb!=="function"){throw new TypeError("The last argument must be of type Function")}var self=this;var cb=function(){return maybeCb.apply(self,arguments)};original.apply(this,args).then((function(ret){process.nextTick(cb.bind(null,null,ret))}),(function(rej){process.nextTick(callbackifyOnRejected.bind(null,rej,cb))}))}Object.setPrototypeOf(callbackified,Object.getPrototypeOf(original));Object.defineProperties(callbackified,getOwnPropertyDescriptors(original));return callbackified}exports.callbackify=callbackify}).call(this)}).call(this,require("_process"))},{"./support/isBuffer":440,"./support/types":441,_process:378,inherits:279}],443:[function(require,module,exports){(function(global){(function(){"use strict";var forEach=require("for-each");var availableTypedArrays=require("available-typed-arrays");var callBound=require("call-bind/callBound");var $toString=callBound("Object.prototype.toString");var hasToStringTag=require("has-tostringtag/shams")();var g=typeof globalThis==="undefined"?global:globalThis;var typedArrays=availableTypedArrays();var $slice=callBound("String.prototype.slice");var toStrTags={};var gOPD=require("es-abstract/helpers/getOwnPropertyDescriptor");var getPrototypeOf=Object.getPrototypeOf;if(hasToStringTag&&gOPD&&getPrototypeOf){forEach(typedArrays,(function(typedArray){if(typeof g[typedArray]==="function"){var arr=new g[typedArray];if(Symbol.toStringTag in arr){var proto=getPrototypeOf(arr);var descriptor=gOPD(proto,Symbol.toStringTag);if(!descriptor){var superProto=getPrototypeOf(proto);descriptor=gOPD(superProto,Symbol.toStringTag)}toStrTags[typedArray]=descriptor.get}}}))}var tryTypedArrays=function tryAllTypedArrays(value){var foundName=false;forEach(toStrTags,(function(getter,typedArray){if(!foundName){try{var name=getter.call(value);if(name===typedArray){foundName=name}}catch(e){}}}));return foundName};var isTypedArray=require("is-typed-array");module.exports=function whichTypedArray(value){if(!isTypedArray(value)){return false}if(!hasToStringTag||!(Symbol.toStringTag in value)){return $slice($toString(value),8,-1)}return tryTypedArrays(value)}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"available-typed-arrays":145,"call-bind/callBound":153,"es-abstract/helpers/getOwnPropertyDescriptor":180,"for-each":267,"has-tostringtag/shams":273,"is-typed-array":285}],444:[function(require,module,exports){module.exports={title:"Thing Model",version:"1.1-05-September-2022",description:"JSON Schema for validating Thing Models. This is automatically generated from the WoT TD Schema.",$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/w3c/wot-thing-description/main/validation/tm-json-schema-validation.json",definitions:{anyUri:{type:"string"},description:{type:"string"},descriptions:{type:"object",additionalProperties:{type:"string"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},title:{type:"string"},titles:{type:"object",additionalProperties:{type:"string"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},security:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},scopes:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},subprotocol:{type:"string",examples:["longpoll","websub","sse"]},"thing-context-td-uri-v1":{type:"string",const:"https://www.w3.org/2019/wot/td/v1"},"thing-context-td-uri-v1.1":{type:"string",const:"https://www.w3.org/2022/wot/td/v1.1"},"thing-context-td-uri-temp":{type:"string",const:"http://www.w3.org/ns/td"},"thing-context":{anyOf:[{$comment:"New context URI with other vocabularies after it but not the old one",type:"array",items:[{$ref:"#/definitions/thing-context-td-uri-v1.1"}],additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}],not:{$ref:"#/definitions/thing-context-td-uri-v1"}}},{$comment:"Only the new context URI",$ref:"#/definitions/thing-context-td-uri-v1.1"},{$comment:"Old context URI, followed by the new one and possibly other vocabularies. minItems and contains are required since prefixItems does not say all items should be provided",type:"array",prefixItems:[{$ref:"#/definitions/thing-context-td-uri-v1"},{$ref:"#/definitions/thing-context-td-uri-v1.1"}],minItems:2,contains:{$ref:"#/definitions/thing-context-td-uri-v1.1"},additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}]}},{$comment:"Old context URI, followed by possibly other vocabularies. minItems and contains are required since prefixItems does not say all items should be provided",type:"array",prefixItems:[{$ref:"#/definitions/thing-context-td-uri-v1"}],minItems:1,contains:{$ref:"#/definitions/thing-context-td-uri-v1"},additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}]}},{$comment:"Only the new context URI",$ref:"#/definitions/thing-context-td-uri-v1"}]},bcp47_string:{type:"string",pattern:"^(((([A-Za-z]{2,3}(-([A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-([A-Za-z]{4}))?(-([A-Za-z]{2}|[0-9]{3}))?(-([A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-([0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(x(-[A-Za-z0-9]{1,8})+))?)|(x(-[A-Za-z0-9]{1,8})+)|((en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang)))$"},type_declaration:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},"dataSchema-type":{type:"string",anyOf:[{enum:["boolean","integer","number","string","object","array","null"]},{$ref:"#/definitions/placeholder-pattern"}]},dataSchema:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},title:{$ref:"#/definitions/title"},descriptions:{$ref:"#/definitions/descriptions"},titles:{$ref:"#/definitions/titles"},writeOnly:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},readOnly:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},oneOf:{type:"array",items:{$ref:"#/definitions/dataSchema"}},unit:{type:"string"},enum:{anyOf:[{type:"array",minItems:1,uniqueItems:true},{$ref:"#/definitions/placeholder-pattern"}]},format:{type:"string"},const:{},default:{},contentEncoding:{type:"string"},contentMediaType:{type:"string"},type:{$ref:"#/definitions/dataSchema-type"},items:{oneOf:[{$ref:"#/definitions/dataSchema"},{type:"array",items:{$ref:"#/definitions/dataSchema"}}]},maxItems:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},minItems:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},minimum:{anyOf:[{type:"number"},{$ref:"#/definitions/placeholder-pattern"}]},maximum:{anyOf:[{type:"number"},{$ref:"#/definitions/placeholder-pattern"}]},exclusiveMinimum:{type:"number"},exclusiveMaximum:{type:"number"},minLength:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},maxLength:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},multipleOf:{$ref:"#/definitions/multipleOfDefinition"},properties:{additionalProperties:{$ref:"#/definitions/dataSchema"}},required:{anyOf:[{type:"array",items:{type:"string"}},{$ref:"#/definitions/placeholder-pattern"}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},additionalResponsesDefinition:{type:"array",items:{type:"object",properties:{contentType:{type:"string"},schema:{type:"string"},success:{type:"boolean"}}}},multipleOfDefinition:{anyOf:[{type:["integer","number"],exclusiveMinimum:0},{$ref:"#/definitions/placeholder-pattern"}]},expectedResponse:{type:"object",properties:{contentType:{type:"string"}},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_base:{type:"object",properties:{op:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},href:{$ref:"#/definitions/anyUri"},contentType:{type:"string"},contentCoding:{type:"string"},subprotocol:{$ref:"#/definitions/subprotocol"},security:{$ref:"#/definitions/security"},scopes:{$ref:"#/definitions/scopes"},response:{$ref:"#/definitions/expectedResponse"},additionalResponses:{$ref:"#/definitions/additionalResponsesDefinition"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_property:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",anyOf:[{enum:["readproperty","writeproperty","observeproperty","unobserveproperty"]},{$ref:"#/definitions/placeholder-pattern"}]},{type:"array",items:{type:"string",anyOf:[{enum:["readproperty","writeproperty","observeproperty","unobserveproperty"]},{$ref:"#/definitions/placeholder-pattern"}]}}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_action:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",anyOf:[{enum:["invokeaction","queryaction","cancelaction"]},{$ref:"#/definitions/placeholder-pattern"}]},{type:"array",items:{type:"string",anyOf:[{enum:["invokeaction","queryaction","cancelaction"]},{$ref:"#/definitions/placeholder-pattern"}]}}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_event:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",anyOf:[{enum:["subscribeevent","unsubscribeevent"]},{$ref:"#/definitions/placeholder-pattern"}]},{type:"array",items:{type:"string",anyOf:[{enum:["subscribeevent","unsubscribeevent"]},{$ref:"#/definitions/placeholder-pattern"}]}}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_root:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",anyOf:[{enum:["readallproperties","writeallproperties","readmultipleproperties","writemultipleproperties","observeallproperties","unobserveallproperties","queryallactions","subscribeallevents","unsubscribeallevents"]},{$ref:"#/definitions/placeholder-pattern"}]},{type:"array",items:{type:"string",anyOf:[{enum:["readallproperties","writeallproperties","readmultipleproperties","writemultipleproperties","observeallproperties","unobserveallproperties","queryallactions","subscribeallevents","unsubscribeallevents"]},{$ref:"#/definitions/placeholder-pattern"}]}}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form:{$comment:"This is NOT for validation purposes but for automatic generation of TS types. For more info, please see: https://github.com/w3c/wot-thing-description/pull/1319#issuecomment-994950057",oneOf:[{$ref:"#/definitions/form_element_property"},{$ref:"#/definitions/form_element_action"},{$ref:"#/definitions/form_element_event"},{$ref:"#/definitions/form_element_root"}]},property_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_property"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},observable:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},writeOnly:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},readOnly:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},oneOf:{type:"array",items:{$ref:"#/definitions/dataSchema"}},unit:{type:"string"},enum:{anyOf:[{type:"array",minItems:1,uniqueItems:true},{$ref:"#/definitions/placeholder-pattern"}]},format:{type:"string"},const:{},default:{},type:{$ref:"#/definitions/dataSchema-type"},items:{oneOf:[{$ref:"#/definitions/dataSchema"},{type:"array",items:{$ref:"#/definitions/dataSchema"}}]},maxItems:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},minItems:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},minimum:{anyOf:[{type:"number"},{$ref:"#/definitions/placeholder-pattern"}]},maximum:{anyOf:[{type:"number"},{$ref:"#/definitions/placeholder-pattern"}]},exclusiveMinimum:{type:"number"},exclusiveMaximum:{type:"number"},minLength:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},maxLength:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},multipleOf:{$ref:"#/definitions/multipleOfDefinition"},properties:{additionalProperties:{$ref:"#/definitions/dataSchema"}},required:{anyOf:[{type:"array",items:{type:"string"}},{$ref:"#/definitions/placeholder-pattern"}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},action_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_action"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},input:{$ref:"#/definitions/dataSchema"},output:{$ref:"#/definitions/dataSchema"},safe:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},idempotent:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},synchronous:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},event_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_event"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},subscription:{$ref:"#/definitions/dataSchema"},data:{$ref:"#/definitions/dataSchema"},dataResponse:{$ref:"#/definitions/dataSchema"},cancellation:{$ref:"#/definitions/dataSchema"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},base_link_element:{type:"object",properties:{href:{$ref:"#/definitions/anyUri"},type:{type:"string"},rel:{type:"string"},anchor:{$ref:"#/definitions/anyUri"},hreflang:{anyOf:[{$ref:"#/definitions/bcp47_string"},{type:"array",items:{$ref:"#/definitions/bcp47_string"}}]},instanceName:{type:"string"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},link_element:{allOf:[{$ref:"#/definitions/base_link_element"},{not:{description:"A basic link element should not contain sizes",type:"object",properties:{sizes:{}},required:["sizes"]}},{not:{description:"A basic link element should not contain icon",properties:{rel:{anyOf:[{enum:["icon"]},{$ref:"#/definitions/placeholder-pattern"}]}},required:["rel"]}}]},icon_link_element:{allOf:[{$ref:"#/definitions/base_link_element"},{properties:{rel:{const:"icon"},sizes:{type:"string",pattern:"[0-9]*x[0-9]+"}},required:["rel"]}]},additionalSecurityScheme:{description:"Applies to additional SecuritySchemes not defined in the WoT TD specification.",$comment:"Additional SecuritySchemes should always be defined via a context extension, using a prefixed value for the scheme. This prefix (e.g. 'ace', see the example below) must contain at least one character in order to reference a valid JSON-LD context extension.",examples:[{scheme:"ace:ACESecurityScheme","ace:as":"coaps://as.example.com/token","ace:audience":"coaps://rs.example.com","ace:scopes":["limited","special"],"ace:cnonce":true}],type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",pattern:".+:.*"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},noSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["nosec"]},{$ref:"#/definitions/placeholder-pattern"}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},autoSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["auto"]},{$ref:"#/definitions/placeholder-pattern"}]}},not:{required:["name"]},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},comboSecurityScheme:{oneOf:[{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["combo"]},{$ref:"#/definitions/placeholder-pattern"}]},oneOf:{type:"array",minItems:2,items:{type:"string"}},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true},{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["combo"]},{$ref:"#/definitions/placeholder-pattern"}]},allOf:{type:"array",minItems:2,items:{type:"string"}},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true}]},basicSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["basic"]},{$ref:"#/definitions/placeholder-pattern"}]},in:{type:"string",anyOf:[{enum:["header","query","body","cookie","auto"]},{$ref:"#/definitions/placeholder-pattern"}]},name:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},digestSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["digest"]},{$ref:"#/definitions/placeholder-pattern"}]},qop:{type:"string",anyOf:[{enum:["auth","auth-int"]},{$ref:"#/definitions/placeholder-pattern"}]},in:{type:"string",anyOf:[{enum:["header","query","body","cookie","auto"]},{$ref:"#/definitions/placeholder-pattern"}]},name:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},apiKeySecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["apikey"]},{$ref:"#/definitions/placeholder-pattern"}]},in:{type:"string",anyOf:[{enum:["header","query","body","cookie","uri","auto"]},{$ref:"#/definitions/placeholder-pattern"}]},name:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},bearerSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["bearer"]},{$ref:"#/definitions/placeholder-pattern"}]},authorization:{$ref:"#/definitions/anyUri"},alg:{type:"string"},format:{type:"string"},in:{type:"string",anyOf:[{enum:["header","query","body","cookie","auto"]},{$ref:"#/definitions/placeholder-pattern"}]},name:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},pskSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["psk"]},{$ref:"#/definitions/placeholder-pattern"}]},identity:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},oAuth2SecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["oauth2"]},{$ref:"#/definitions/placeholder-pattern"}]},authorization:{$ref:"#/definitions/anyUri"},token:{$ref:"#/definitions/anyUri"},refresh:{$ref:"#/definitions/anyUri"},scopes:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},flow:{anyOf:[{type:"string"},{type:"string",anyOf:[{enum:["code","client","device"]},{$ref:"#/definitions/placeholder-pattern"}]}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},securityScheme:{anyOf:[{$ref:"#/definitions/noSecurityScheme"},{$ref:"#/definitions/autoSecurityScheme"},{$ref:"#/definitions/comboSecurityScheme"},{$ref:"#/definitions/basicSecurityScheme"},{$ref:"#/definitions/digestSecurityScheme"},{$ref:"#/definitions/apiKeySecurityScheme"},{$ref:"#/definitions/bearerSecurityScheme"},{$ref:"#/definitions/pskSecurityScheme"},{$ref:"#/definitions/oAuth2SecurityScheme"},{$ref:"#/definitions/additionalSecurityScheme"}]},tm_type_declaration:{oneOf:[{type:"string",const:"tm:ThingModel"},{type:"array",items:{type:"string"},contains:{const:"tm:ThingModel"}}]},"placeholder-pattern":{type:"string",pattern:"^.*[{]{2}[ -~]+[}]{2}.*$"},tm_optional:{type:"array",items:{$comment:"this first checks for the general structure of /properties/myProp and then prohibits using / 3 times",allOf:[{type:"string",pattern:"^((/properties/)|(/actions/)|(/events/))(([^/]))",$comment:"regex tests available at https://regex101.com/r/UgOzrJ/1"},{not:{type:"string",pattern:"(/)(.*\\1){2}",$comment:"regex tests available at https://regex101.com/r/Ytzd72/1"}}]}},tm_ref:{type:"string",format:"uri-reference"}},type:"object",properties:{id:{type:"string"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},properties:{type:"object",additionalProperties:{$ref:"#/definitions/property_element"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},actions:{type:"object",additionalProperties:{$ref:"#/definitions/action_element"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},events:{type:"object",additionalProperties:{$ref:"#/definitions/event_element"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},version:{anyOf:[{type:"object",properties:{model:{type:"string"}},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}},not:{type:"object",properties:{instance:{type:"string"}},required:["instance"]}},{$ref:"#/definitions/placeholder-pattern"}]},links:{type:"array",items:{oneOf:[{$ref:"#/definitions/link_element"},{$ref:"#/definitions/icon_link_element"}]}},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_root"}},base:{$ref:"#/definitions/anyUri"},securityDefinitions:{type:"object",minProperties:1,additionalProperties:{$ref:"#/definitions/securityScheme"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},schemaDefinitions:{type:"object",minProperties:1,additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},support:{$ref:"#/definitions/anyUri"},created:{type:"string"},modified:{type:"string"},profile:{oneOf:[{$ref:"#/definitions/anyUri"},{type:"array",minItems:1,items:{$ref:"#/definitions/anyUri"}}]},security:{oneOf:[{type:"string"},{type:"array",minItems:1,items:{type:"string"}}]},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},"@type":{$ref:"#/definitions/tm_type_declaration"},"@context":{$ref:"#/definitions/thing-context"},"tm:optional":{$ref:"#/definitions/tm_optional"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}},required:["@context","@type"]}},{}],445:[function(require,module,exports){(function(){module.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},{}],446:[function(require,module,exports){(function(){module.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},{}],447:[function(require,module,exports){(function(){var assign,getValue,isArray,isEmpty,isFunction,isObject,isPlainObject,hasProp={}.hasOwnProperty;assign=function(target,...sources){var i,key,len,source;if(isFunction(Object.assign)){Object.assign.apply(null,arguments)}else{for(i=0,len=sources.length;i<len;i++){source=sources[i];if(source!=null){for(key in source){if(!hasProp.call(source,key))continue;target[key]=source[key]}}}}return target};isFunction=function(val){return!!val&&Object.prototype.toString.call(val)==="[object Function]"};isObject=function(val){var ref;return!!val&&((ref=typeof val)==="function"||ref==="object")};isArray=function(val){if(isFunction(Array.isArray)){return Array.isArray(val)}else{return Object.prototype.toString.call(val)==="[object Array]"}};isEmpty=function(val){var key;if(isArray(val)){return!val.length}else{for(key in val){if(!hasProp.call(val,key))continue;return false}return true}};isPlainObject=function(val){var ctor,proto;return isObject(val)&&(proto=Object.getPrototypeOf(val))&&(ctor=proto.constructor)&&typeof ctor==="function"&&ctor instanceof ctor&&Function.prototype.toString.call(ctor)===Function.prototype.toString.call(Object)};getValue=function(obj){if(isFunction(obj.valueOf)){return obj.valueOf()}else{return obj}};module.exports.assign=assign;module.exports.isFunction=isFunction;module.exports.isObject=isObject;module.exports.isArray=isArray;module.exports.isEmpty=isEmpty;module.exports.isPlainObject=isPlainObject;module.exports.getValue=getValue}).call(this)},{}],448:[function(require,module,exports){(function(){module.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},{}],449:[function(require,module,exports){(function(){var NodeType,XMLAttribute,XMLNode;NodeType=require("./NodeType");XMLNode=require("./XMLNode");module.exports=XMLAttribute=function(){class XMLAttribute{constructor(parent,name,value){this.parent=parent;if(this.parent){this.options=this.parent.options;this.stringify=this.parent.stringify}if(name==null){throw new Error("Missing attribute name. "+this.debugInfo(name))}this.name=this.stringify.name(name);this.value=this.stringify.attValue(value);this.type=NodeType.Attribute;this.isId=false;this.schemaTypeInfo=null}clone(){return Object.create(this)}toString(options){return this.options.writer.attribute(this,this.options.writer.filterOptions(options))}debugInfo(name){name=name||this.name;if(name==null){return"parent: <"+this.parent.name+">"}else{return"attribute: {"+name+"}, parent: <"+this.parent.name+">"}}isEqualNode(node){if(node.namespaceURI!==this.namespaceURI){return false}if(node.prefix!==this.prefix){return false}if(node.localName!==this.localName){return false}if(node.value!==this.value){return false}return true}}Object.defineProperty(XMLAttribute.prototype,"nodeType",{get:function(){return this.type}});Object.defineProperty(XMLAttribute.prototype,"ownerElement",{get:function(){return this.parent}});Object.defineProperty(XMLAttribute.prototype,"textContent",{get:function(){return this.value},set:function(value){return this.value=value||""}});Object.defineProperty(XMLAttribute.prototype,"namespaceURI",{get:function(){return""}});Object.defineProperty(XMLAttribute.prototype,"prefix",{get:function(){return""}});Object.defineProperty(XMLAttribute.prototype,"localName",{get:function(){return this.name}});Object.defineProperty(XMLAttribute.prototype,"specified",{get:function(){return true}});return XMLAttribute}.call(this)}).call(this)},{"./NodeType":446,"./XMLNode":468}],450:[function(require,module,exports){(function(){var NodeType,XMLCData,XMLCharacterData;NodeType=require("./NodeType");XMLCharacterData=require("./XMLCharacterData");module.exports=XMLCData=class XMLCData extends XMLCharacterData{constructor(parent,text){super(parent);if(text==null){throw new Error("Missing CDATA text. "+this.debugInfo())}this.name="#cdata-section";this.type=NodeType.CData;this.value=this.stringify.cdata(text)}clone(){return Object.create(this)}toString(options){return this.options.writer.cdata(this,this.options.writer.filterOptions(options))}}}).call(this)},{"./NodeType":446,"./XMLCharacterData":451}],451:[function(require,module,exports){(function(){var XMLCharacterData,XMLNode;XMLNode=require("./XMLNode");module.exports=XMLCharacterData=function(){class XMLCharacterData extends XMLNode{constructor(parent){super(parent);this.value=""}clone(){return Object.create(this)}substringData(offset,count){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendData(arg){throw new Error("This DOM method is not implemented."+this.debugInfo())}insertData(offset,arg){throw new Error("This DOM method is not implemented."+this.debugInfo())}deleteData(offset,count){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceData(offset,count,arg){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(node){if(!super.isEqualNode(node)){return false}if(node.data!==this.data){return false}return true}}Object.defineProperty(XMLCharacterData.prototype,"data",{get:function(){return this.value},set:function(value){return this.value=value||""}});Object.defineProperty(XMLCharacterData.prototype,"length",{get:function(){return this.value.length}});Object.defineProperty(XMLCharacterData.prototype,"textContent",{get:function(){return this.value},set:function(value){return this.value=value||""}});return XMLCharacterData}.call(this)}).call(this)},{"./XMLNode":468}],452:[function(require,module,exports){(function(){var NodeType,XMLCharacterData,XMLComment;NodeType=require("./NodeType");XMLCharacterData=require("./XMLCharacterData");module.exports=XMLComment=class XMLComment extends XMLCharacterData{constructor(parent,text){super(parent);if(text==null){throw new Error("Missing comment text. "+this.debugInfo())}this.name="#comment";this.type=NodeType.Comment;this.value=this.stringify.comment(text)}clone(){return Object.create(this)}toString(options){return this.options.writer.comment(this,this.options.writer.filterOptions(options))}}}).call(this)},{"./NodeType":446,"./XMLCharacterData":451}],453:[function(require,module,exports){(function(){var XMLDOMConfiguration,XMLDOMErrorHandler,XMLDOMStringList;XMLDOMErrorHandler=require("./XMLDOMErrorHandler");XMLDOMStringList=require("./XMLDOMStringList");module.exports=XMLDOMConfiguration=function(){class XMLDOMConfiguration{constructor(){var clonedSelf;this.defaultParams={"canonical-form":false,"cdata-sections":false,comments:false,"datatype-normalization":false,"element-content-whitespace":true,entities:true,"error-handler":new XMLDOMErrorHandler,infoset:true,"validate-if-schema":false,namespaces:true,"namespace-declarations":true,"normalize-characters":false,"schema-location":"","schema-type":"","split-cdata-sections":true,validate:false,"well-formed":true};this.params=clonedSelf=Object.create(this.defaultParams)}getParameter(name){if(this.params.hasOwnProperty(name)){return this.params[name]}else{return null}}canSetParameter(name,value){return true}setParameter(name,value){if(value!=null){return this.params[name]=value}else{return delete this.params[name]}}}Object.defineProperty(XMLDOMConfiguration.prototype,"parameterNames",{get:function(){return new XMLDOMStringList(Object.keys(this.defaultParams))}});return XMLDOMConfiguration}.call(this)}).call(this)},{"./XMLDOMErrorHandler":454,"./XMLDOMStringList":456}],454:[function(require,module,exports){(function(){var XMLDOMErrorHandler;module.exports=XMLDOMErrorHandler=class XMLDOMErrorHandler{constructor(){}handleError(error){throw new Error(error)}}}).call(this)},{}],455:[function(require,module,exports){(function(){var XMLDOMImplementation;module.exports=XMLDOMImplementation=class XMLDOMImplementation{hasFeature(feature,version){return true}createDocumentType(qualifiedName,publicId,systemId){throw new Error("This DOM method is not implemented.")}createDocument(namespaceURI,qualifiedName,doctype){throw new Error("This DOM method is not implemented.")}createHTMLDocument(title){throw new Error("This DOM method is not implemented.")}getFeature(feature,version){throw new Error("This DOM method is not implemented.")}}}).call(this)},{}],456:[function(require,module,exports){(function(){var XMLDOMStringList;module.exports=XMLDOMStringList=function(){class XMLDOMStringList{constructor(arr){this.arr=arr||[]}item(index){return this.arr[index]||null}contains(str){return this.arr.indexOf(str)!==-1}}Object.defineProperty(XMLDOMStringList.prototype,"length",{get:function(){return this.arr.length}});return XMLDOMStringList}.call(this)}).call(this)},{}],457:[function(require,module,exports){(function(){var NodeType,XMLDTDAttList,XMLNode;XMLNode=require("./XMLNode");NodeType=require("./NodeType");module.exports=XMLDTDAttList=class XMLDTDAttList extends XMLNode{constructor(parent,elementName,attributeName,attributeType,defaultValueType,defaultValue){super(parent);if(elementName==null){throw new Error("Missing DTD element name. "+this.debugInfo())}if(attributeName==null){throw new Error("Missing DTD attribute name. "+this.debugInfo(elementName))}if(!attributeType){throw new Error("Missing DTD attribute type. "+this.debugInfo(elementName))}if(!defaultValueType){throw new Error("Missing DTD attribute default. "+this.debugInfo(elementName))}if(defaultValueType.indexOf("#")!==0){defaultValueType="#"+defaultValueType}if(!defaultValueType.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/)){throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(elementName))}if(defaultValue&&!defaultValueType.match(/^(#FIXED|#DEFAULT)$/)){throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(elementName))}this.elementName=this.stringify.name(elementName);this.type=NodeType.AttributeDeclaration;this.attributeName=this.stringify.name(attributeName);this.attributeType=this.stringify.dtdAttType(attributeType);if(defaultValue){this.defaultValue=this.stringify.dtdAttDefault(defaultValue)}this.defaultValueType=defaultValueType}toString(options){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(options))}}}).call(this)},{"./NodeType":446,"./XMLNode":468}],458:[function(require,module,exports){(function(){var NodeType,XMLDTDElement,XMLNode;XMLNode=require("./XMLNode");NodeType=require("./NodeType");module.exports=XMLDTDElement=class XMLDTDElement extends XMLNode{constructor(parent,name,value){super(parent);if(name==null){throw new Error("Missing DTD element name. "+this.debugInfo())}if(!value){value="(#PCDATA)"}if(Array.isArray(value)){value="("+value.join(",")+")"}this.name=this.stringify.name(name);this.type=NodeType.ElementDeclaration;this.value=this.stringify.dtdElementValue(value)}toString(options){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(options))}}}).call(this)},{"./NodeType":446,"./XMLNode":468}],459:[function(require,module,exports){(function(){var NodeType,XMLDTDEntity,XMLNode,isObject;({isObject:isObject}=require("./Utility"));XMLNode=require("./XMLNode");NodeType=require("./NodeType");module.exports=XMLDTDEntity=function(){class XMLDTDEntity extends XMLNode{constructor(parent,pe,name,value){super(parent);if(name==null){throw new Error("Missing DTD entity name. "+this.debugInfo(name))}if(value==null){throw new Error("Missing DTD entity value. "+this.debugInfo(name))}this.pe=!!pe;this.name=this.stringify.name(name);this.type=NodeType.EntityDeclaration;if(!isObject(value)){this.value=this.stringify.dtdEntityValue(value);this.internal=true}else{if(!value.pubID&&!value.sysID){throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(name))}if(value.pubID&&!value.sysID){throw new Error("System identifier is required for a public external entity. "+this.debugInfo(name))}this.internal=false;if(value.pubID!=null){this.pubID=this.stringify.dtdPubID(value.pubID)}if(value.sysID!=null){this.sysID=this.stringify.dtdSysID(value.sysID)}if(value.nData!=null){this.nData=this.stringify.dtdNData(value.nData)}if(this.pe&&this.nData){throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(name))}}}toString(options){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(options))}}Object.defineProperty(XMLDTDEntity.prototype,"publicId",{get:function(){return this.pubID}});Object.defineProperty(XMLDTDEntity.prototype,"systemId",{get:function(){return this.sysID}});Object.defineProperty(XMLDTDEntity.prototype,"notationName",{get:function(){return this.nData||null}});Object.defineProperty(XMLDTDEntity.prototype,"inputEncoding",{get:function(){return null}});Object.defineProperty(XMLDTDEntity.prototype,"xmlEncoding",{get:function(){return null}});Object.defineProperty(XMLDTDEntity.prototype,"xmlVersion",{get:function(){return null}});return XMLDTDEntity}.call(this)}).call(this)},{"./NodeType":446,"./Utility":447,"./XMLNode":468}],460:[function(require,module,exports){(function(){var NodeType,XMLDTDNotation,XMLNode;XMLNode=require("./XMLNode");NodeType=require("./NodeType");module.exports=XMLDTDNotation=function(){class XMLDTDNotation extends XMLNode{constructor(parent,name,value){super(parent);if(name==null){throw new Error("Missing DTD notation name. "+this.debugInfo(name))}if(!value.pubID&&!value.sysID){throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(name))}this.name=this.stringify.name(name);this.type=NodeType.NotationDeclaration;if(value.pubID!=null){this.pubID=this.stringify.dtdPubID(value.pubID)}if(value.sysID!=null){this.sysID=this.stringify.dtdSysID(value.sysID)}}toString(options){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(options))}}Object.defineProperty(XMLDTDNotation.prototype,"publicId",{get:function(){return this.pubID}});Object.defineProperty(XMLDTDNotation.prototype,"systemId",{get:function(){return this.sysID}});return XMLDTDNotation}.call(this)}).call(this)},{"./NodeType":446,"./XMLNode":468}],461:[function(require,module,exports){(function(){var NodeType,XMLDeclaration,XMLNode,isObject;({isObject:isObject}=require("./Utility"));XMLNode=require("./XMLNode");NodeType=require("./NodeType");module.exports=XMLDeclaration=class XMLDeclaration extends XMLNode{constructor(parent,version,encoding,standalone){super(parent);if(isObject(version)){({version:version,encoding:encoding,standalone:standalone}=version)}if(!version){version="1.0"}this.type=NodeType.Declaration;this.version=this.stringify.xmlVersion(version);if(encoding!=null){this.encoding=this.stringify.xmlEncoding(encoding)}if(standalone!=null){this.standalone=this.stringify.xmlStandalone(standalone)}}toString(options){return this.options.writer.declaration(this,this.options.writer.filterOptions(options))}}}).call(this)},{"./NodeType":446,"./Utility":447,"./XMLNode":468}],462:[function(require,module,exports){(function(){var NodeType,XMLDTDAttList,XMLDTDElement,XMLDTDEntity,XMLDTDNotation,XMLDocType,XMLNamedNodeMap,XMLNode,isObject;({isObject:isObject}=require("./Utility"));XMLNode=require("./XMLNode");NodeType=require("./NodeType");XMLDTDAttList=require("./XMLDTDAttList");XMLDTDEntity=require("./XMLDTDEntity");XMLDTDElement=require("./XMLDTDElement");XMLDTDNotation=require("./XMLDTDNotation");XMLNamedNodeMap=require("./XMLNamedNodeMap");module.exports=XMLDocType=function(){class XMLDocType extends XMLNode{constructor(parent,pubID,sysID){var child,i,len,ref;super(parent);this.type=NodeType.DocType;if(parent.children){ref=parent.children;for(i=0,len=ref.length;i<len;i++){child=ref[i];if(child.type===NodeType.Element){this.name=child.name;break}}}this.documentObject=parent;if(isObject(pubID)){({pubID:pubID,sysID:sysID}=pubID)}if(sysID==null){[sysID,pubID]=[pubID,sysID]}if(pubID!=null){this.pubID=this.stringify.dtdPubID(pubID)}if(sysID!=null){this.sysID=this.stringify.dtdSysID(sysID)}}element(name,value){var child;child=new XMLDTDElement(this,name,value);this.children.push(child);return this}attList(elementName,attributeName,attributeType,defaultValueType,defaultValue){var child;child=new XMLDTDAttList(this,elementName,attributeName,attributeType,defaultValueType,defaultValue);this.children.push(child);return this}entity(name,value){var child;child=new XMLDTDEntity(this,false,name,value);this.children.push(child);return this}pEntity(name,value){var child;child=new XMLDTDEntity(this,true,name,value);this.children.push(child);return this}notation(name,value){var child;child=new XMLDTDNotation(this,name,value);this.children.push(child);return this}toString(options){return this.options.writer.docType(this,this.options.writer.filterOptions(options))}ele(name,value){return this.element(name,value)}att(elementName,attributeName,attributeType,defaultValueType,defaultValue){return this.attList(elementName,attributeName,attributeType,defaultValueType,defaultValue)}ent(name,value){return this.entity(name,value)}pent(name,value){return this.pEntity(name,value)}not(name,value){return this.notation(name,value)}up(){return this.root()||this.documentObject}isEqualNode(node){if(!super.isEqualNode(node)){return false}if(node.name!==this.name){return false}if(node.publicId!==this.publicId){return false}if(node.systemId!==this.systemId){return false}return true}}Object.defineProperty(XMLDocType.prototype,"entities",{get:function(){var child,i,len,nodes,ref;nodes={};ref=this.children;for(i=0,len=ref.length;i<len;i++){child=ref[i];if(child.type===NodeType.EntityDeclaration&&!child.pe){nodes[child.name]=child}}return new XMLNamedNodeMap(nodes)}});Object.defineProperty(XMLDocType.prototype,"notations",{get:function(){var child,i,len,nodes,ref;nodes={};ref=this.children;for(i=0,len=ref.length;i<len;i++){child=ref[i];if(child.type===NodeType.NotationDeclaration){nodes[child.name]=child}}return new XMLNamedNodeMap(nodes)}});Object.defineProperty(XMLDocType.prototype,"publicId",{get:function(){return this.pubID}});Object.defineProperty(XMLDocType.prototype,"systemId",{get:function(){return this.sysID}});Object.defineProperty(XMLDocType.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});return XMLDocType}.call(this)}).call(this)},{"./NodeType":446,"./Utility":447,"./XMLDTDAttList":457,"./XMLDTDElement":458,"./XMLDTDEntity":459,"./XMLDTDNotation":460,"./XMLNamedNodeMap":467,"./XMLNode":468}],463:[function(require,module,exports){(function(){var NodeType,XMLDOMConfiguration,XMLDOMImplementation,XMLDocument,XMLNode,XMLStringWriter,XMLStringifier,isPlainObject;({isPlainObject:isPlainObject}=require("./Utility"));XMLDOMImplementation=require("./XMLDOMImplementation");XMLDOMConfiguration=require("./XMLDOMConfiguration");XMLNode=require("./XMLNode");NodeType=require("./NodeType");XMLStringifier=require("./XMLStringifier");XMLStringWriter=require("./XMLStringWriter");module.exports=XMLDocument=function(){class XMLDocument extends XMLNode{constructor(options){super(null);this.name="#document";this.type=NodeType.Document;this.documentURI=null;this.domConfig=new XMLDOMConfiguration;options||(options={});if(!options.writer){options.writer=new XMLStringWriter}this.options=options;this.stringify=new XMLStringifier(options)}end(writer){var writerOptions;writerOptions={};if(!writer){writer=this.options.writer}else if(isPlainObject(writer)){writerOptions=writer;writer=this.options.writer}return writer.document(this,writer.filterOptions(writerOptions))}toString(options){return this.options.writer.document(this,this.options.writer.filterOptions(options))}createElement(tagName){throw new Error("This DOM method is not implemented."+this.debugInfo())}createDocumentFragment(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTextNode(data){throw new Error("This DOM method is not implemented."+this.debugInfo())}createComment(data){throw new Error("This DOM method is not implemented."+this.debugInfo())}createCDATASection(data){throw new Error("This DOM method is not implemented."+this.debugInfo())}createProcessingInstruction(target,data){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttribute(name){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEntityReference(name){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(tagname){throw new Error("This DOM method is not implemented."+this.debugInfo())}importNode(importedNode,deep){throw new Error("This DOM method is not implemented."+this.debugInfo())}createElementNS(namespaceURI,qualifiedName){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttributeNS(namespaceURI,qualifiedName){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(namespaceURI,localName){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementById(elementId){throw new Error("This DOM method is not implemented."+this.debugInfo())}adoptNode(source){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalizeDocument(){throw new Error("This DOM method is not implemented."+this.debugInfo())}renameNode(node,namespaceURI,qualifiedName){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(classNames){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEvent(eventInterface){throw new Error("This DOM method is not implemented."+this.debugInfo())}createRange(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createNodeIterator(root,whatToShow,filter){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTreeWalker(root,whatToShow,filter){throw new Error("This DOM method is not implemented."+this.debugInfo())}}Object.defineProperty(XMLDocument.prototype,"implementation",{value:new XMLDOMImplementation});Object.defineProperty(XMLDocument.prototype,"doctype",{get:function(){var child,i,len,ref;ref=this.children;for(i=0,len=ref.length;i<len;i++){child=ref[i];if(child.type===NodeType.DocType){return child}}return null}});Object.defineProperty(XMLDocument.prototype,"documentElement",{get:function(){return this.rootObject||null}});Object.defineProperty(XMLDocument.prototype,"inputEncoding",{get:function(){return null}});Object.defineProperty(XMLDocument.prototype,"strictErrorChecking",{get:function(){return false}});Object.defineProperty(XMLDocument.prototype,"xmlEncoding",{get:function(){if(this.children.length!==0&&this.children[0].type===NodeType.Declaration){return this.children[0].encoding}else{return null}}});Object.defineProperty(XMLDocument.prototype,"xmlStandalone",{get:function(){if(this.children.length!==0&&this.children[0].type===NodeType.Declaration){return this.children[0].standalone==="yes"}else{return false}}});Object.defineProperty(XMLDocument.prototype,"xmlVersion",{get:function(){if(this.children.length!==0&&this.children[0].type===NodeType.Declaration){return this.children[0].version}else{return"1.0"}}});Object.defineProperty(XMLDocument.prototype,"URL",{get:function(){return this.documentURI}});Object.defineProperty(XMLDocument.prototype,"origin",{get:function(){return null}});Object.defineProperty(XMLDocument.prototype,"compatMode",{get:function(){return null}});Object.defineProperty(XMLDocument.prototype,"characterSet",{get:function(){return null}});Object.defineProperty(XMLDocument.prototype,"contentType",{get:function(){return null}});return XMLDocument}.call(this)}).call(this)},{"./NodeType":446,"./Utility":447,"./XMLDOMConfiguration":453,"./XMLDOMImplementation":455,"./XMLNode":468,"./XMLStringWriter":473,"./XMLStringifier":474}],464:[function(require,module,exports){(function(){var NodeType,WriterState,XMLAttribute,XMLCData,XMLComment,XMLDTDAttList,XMLDTDElement,XMLDTDEntity,XMLDTDNotation,XMLDeclaration,XMLDocType,XMLDocument,XMLDocumentCB,XMLElement,XMLProcessingInstruction,XMLRaw,XMLStringWriter,XMLStringifier,XMLText,getValue,isFunction,isObject,isPlainObject,hasProp={}.hasOwnProperty;({isObject:isObject,isFunction:isFunction,isPlainObject:isPlainObject,getValue:getValue}=require("./Utility"));NodeType=require("./NodeType");XMLDocument=require("./XMLDocument");XMLElement=require("./XMLElement");XMLCData=require("./XMLCData");XMLComment=require("./XMLComment");XMLRaw=require("./XMLRaw");XMLText=require("./XMLText");XMLProcessingInstruction=require("./XMLProcessingInstruction");XMLDeclaration=require("./XMLDeclaration");XMLDocType=require("./XMLDocType");XMLDTDAttList=require("./XMLDTDAttList");XMLDTDEntity=require("./XMLDTDEntity");XMLDTDElement=require("./XMLDTDElement");XMLDTDNotation=require("./XMLDTDNotation");XMLAttribute=require("./XMLAttribute");XMLStringifier=require("./XMLStringifier");XMLStringWriter=require("./XMLStringWriter");WriterState=require("./WriterState");module.exports=XMLDocumentCB=class XMLDocumentCB{constructor(options,onData,onEnd){var writerOptions;this.name="?xml";this.type=NodeType.Document;options||(options={});writerOptions={};if(!options.writer){options.writer=new XMLStringWriter}else if(isPlainObject(options.writer)){writerOptions=options.writer;options.writer=new XMLStringWriter}this.options=options;this.writer=options.writer;this.writerOptions=this.writer.filterOptions(writerOptions);this.stringify=new XMLStringifier(options);this.onDataCallback=onData||function(){};this.onEndCallback=onEnd||function(){};this.currentNode=null;this.currentLevel=-1;this.openTags={};this.documentStarted=false;this.documentCompleted=false;this.root=null}createChildNode(node){var att,attName,attributes,child,i,len,ref,ref1;switch(node.type){case NodeType.CData:this.cdata(node.value);break;case NodeType.Comment:this.comment(node.value);break;case NodeType.Element:attributes={};ref=node.attribs;for(attName in ref){if(!hasProp.call(ref,attName))continue;att=ref[attName];attributes[attName]=att.value}this.node(node.name,attributes);break;case NodeType.Dummy:this.dummy();break;case NodeType.Raw:this.raw(node.value);break;case NodeType.Text:this.text(node.value);break;case NodeType.ProcessingInstruction:this.instruction(node.target,node.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+node.constructor.name)}ref1=node.children;for(i=0,len=ref1.length;i<len;i++){child=ref1[i];this.createChildNode(child);if(child.type===NodeType.Element){this.up()}}return this}dummy(){return this}node(name,attributes,text){if(name==null){throw new Error("Missing node name.")}if(this.root&&this.currentLevel===-1){throw new Error("Document can only have one root node. "+this.debugInfo(name))}this.openCurrent();name=getValue(name);if(attributes==null){attributes={}}attributes=getValue(attributes);if(!isObject(attributes)){[text,attributes]=[attributes,text]}this.currentNode=new XMLElement(this,name,attributes);this.currentNode.children=false;this.currentLevel++;this.openTags[this.currentLevel]=this.currentNode;if(text!=null){this.text(text)}return this}element(name,attributes,text){var child,i,len,oldValidationFlag,ref,root;if(this.currentNode&&this.currentNode.type===NodeType.DocType){this.dtdElement(...arguments)}else{if(Array.isArray(name)||isObject(name)||isFunction(name)){oldValidationFlag=this.options.noValidation;this.options.noValidation=true;root=new XMLDocument(this.options).element("TEMP_ROOT");root.element(name);this.options.noValidation=oldValidationFlag;ref=root.children;for(i=0,len=ref.length;i<len;i++){child=ref[i];this.createChildNode(child);if(child.type===NodeType.Element){this.up()}}}else{this.node(name,attributes,text)}}return this}attribute(name,value){var attName,attValue;if(!this.currentNode||this.currentNode.children){throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(name))}if(name!=null){name=getValue(name)}if(isObject(name)){for(attName in name){if(!hasProp.call(name,attName))continue;attValue=name[attName];this.attribute(attName,attValue)}}else{if(isFunction(value)){value=value.apply()}if(this.options.keepNullAttributes&&value==null){this.currentNode.attribs[name]=new XMLAttribute(this,name,"")}else if(value!=null){this.currentNode.attribs[name]=new XMLAttribute(this,name,value)}}return this}text(value){var node;this.openCurrent();node=new XMLText(this,value);this.onData(this.writer.text(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}cdata(value){var node;this.openCurrent();node=new XMLCData(this,value);this.onData(this.writer.cdata(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}comment(value){var node;this.openCurrent();node=new XMLComment(this,value);this.onData(this.writer.comment(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}raw(value){var node;this.openCurrent();node=new XMLRaw(this,value);this.onData(this.writer.raw(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}instruction(target,value){var i,insTarget,insValue,len,node;this.openCurrent();if(target!=null){target=getValue(target)}if(value!=null){value=getValue(value)}if(Array.isArray(target)){for(i=0,len=target.length;i<len;i++){insTarget=target[i];this.instruction(insTarget)}}else if(isObject(target)){for(insTarget in target){if(!hasProp.call(target,insTarget))continue;insValue=target[insTarget];this.instruction(insTarget,insValue)}}else{if(isFunction(value)){value=value.apply()}node=new XMLProcessingInstruction(this,target,value);this.onData(this.writer.processingInstruction(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1)}return this}declaration(version,encoding,standalone){var node;this.openCurrent();if(this.documentStarted){throw new Error("declaration() must be the first node.")}node=new XMLDeclaration(this,version,encoding,standalone);this.onData(this.writer.declaration(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}doctype(root,pubID,sysID){this.openCurrent();if(root==null){throw new Error("Missing root node name.")}if(this.root){throw new Error("dtd() must come before the root node.")}this.currentNode=new XMLDocType(this,pubID,sysID);this.currentNode.rootNodeName=root;this.currentNode.children=false;this.currentLevel++;this.openTags[this.currentLevel]=this.currentNode;return this}dtdElement(name,value){var node;this.openCurrent();node=new XMLDTDElement(this,name,value);this.onData(this.writer.dtdElement(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}attList(elementName,attributeName,attributeType,defaultValueType,defaultValue){var node;this.openCurrent();node=new XMLDTDAttList(this,elementName,attributeName,attributeType,defaultValueType,defaultValue);this.onData(this.writer.dtdAttList(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}entity(name,value){var node;this.openCurrent();node=new XMLDTDEntity(this,false,name,value);this.onData(this.writer.dtdEntity(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}pEntity(name,value){var node;this.openCurrent();node=new XMLDTDEntity(this,true,name,value);this.onData(this.writer.dtdEntity(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}notation(name,value){var node;this.openCurrent();node=new XMLDTDNotation(this,name,value);this.onData(this.writer.dtdNotation(node,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}up(){if(this.currentLevel<0){throw new Error("The document node has no parent.")}if(this.currentNode){if(this.currentNode.children){this.closeNode(this.currentNode)}else{this.openNode(this.currentNode)}this.currentNode=null}else{this.closeNode(this.openTags[this.currentLevel])}delete this.openTags[this.currentLevel];this.currentLevel--;return this}end(){while(this.currentLevel>=0){this.up()}return this.onEnd()}openCurrent(){if(this.currentNode){this.currentNode.children=true;return this.openNode(this.currentNode)}}openNode(node){var att,chunk,name,ref;if(!node.isOpen){if(!this.root&&this.currentLevel===0&&node.type===NodeType.Element){this.root=node}chunk="";if(node.type===NodeType.Element){this.writerOptions.state=WriterState.OpenTag;chunk=this.writer.indent(node,this.writerOptions,this.currentLevel)+"<"+node.name;ref=node.attribs;for(name in ref){if(!hasProp.call(ref,name))continue;att=ref[name];chunk+=this.writer.attribute(att,this.writerOptions,this.currentLevel)}chunk+=(node.children?">":"/>")+this.writer.endline(node,this.writerOptions,this.currentLevel);this.writerOptions.state=WriterState.InsideTag}else{this.writerOptions.state=WriterState.OpenTag;chunk=this.writer.indent(node,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+node.rootNodeName;if(node.pubID&&node.sysID){chunk+=' PUBLIC "'+node.pubID+'" "'+node.sysID+'"'}else if(node.sysID){chunk+=' SYSTEM "'+node.sysID+'"'}if(node.children){chunk+=" [";this.writerOptions.state=WriterState.InsideTag}else{this.writerOptions.state=WriterState.CloseTag;chunk+=">"}chunk+=this.writer.endline(node,this.writerOptions,this.currentLevel)}this.onData(chunk,this.currentLevel);return node.isOpen=true}}closeNode(node){var chunk;if(!node.isClosed){chunk="";this.writerOptions.state=WriterState.CloseTag;if(node.type===NodeType.Element){chunk=this.writer.indent(node,this.writerOptions,this.currentLevel)+"</"+node.name+">"+this.writer.endline(node,this.writerOptions,this.currentLevel)}else{chunk=this.writer.indent(node,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(node,this.writerOptions,this.currentLevel)}this.writerOptions.state=WriterState.None;this.onData(chunk,this.currentLevel);return node.isClosed=true}}onData(chunk,level){this.documentStarted=true;return this.onDataCallback(chunk,level+1)}onEnd(){this.documentCompleted=true;return this.onEndCallback()}debugInfo(name){if(name==null){return""}else{return"node: <"+name+">"}}ele(){return this.element(...arguments)}nod(name,attributes,text){return this.node(name,attributes,text)}txt(value){return this.text(value)}dat(value){return this.cdata(value)}com(value){return this.comment(value)}ins(target,value){return this.instruction(target,value)}dec(version,encoding,standalone){return this.declaration(version,encoding,standalone)}dtd(root,pubID,sysID){return this.doctype(root,pubID,sysID)}e(name,attributes,text){return this.element(name,attributes,text)}n(name,attributes,text){return this.node(name,attributes,text)}t(value){return this.text(value)}d(value){return this.cdata(value)}c(value){return this.comment(value)}r(value){return this.raw(value)}i(target,value){return this.instruction(target,value)}att(){if(this.currentNode&&this.currentNode.type===NodeType.DocType){return this.attList(...arguments)}else{return this.attribute(...arguments)}}a(){if(this.currentNode&&this.currentNode.type===NodeType.DocType){return this.attList(...arguments)}else{return this.attribute(...arguments)}}ent(name,value){return this.entity(name,value)}pent(name,value){return this.pEntity(name,value)}not(name,value){return this.notation(name,value)}}}).call(this)},{"./NodeType":446,"./Utility":447,"./WriterState":448,"./XMLAttribute":449,"./XMLCData":450,"./XMLComment":452,"./XMLDTDAttList":457,"./XMLDTDElement":458,"./XMLDTDEntity":459,"./XMLDTDNotation":460,"./XMLDeclaration":461,"./XMLDocType":462,"./XMLDocument":463,"./XMLElement":466,"./XMLProcessingInstruction":470,"./XMLRaw":471,"./XMLStringWriter":473,"./XMLStringifier":474,"./XMLText":475}],465:[function(require,module,exports){(function(){var NodeType,XMLDummy,XMLNode;XMLNode=require("./XMLNode");NodeType=require("./NodeType");module.exports=XMLDummy=class XMLDummy extends XMLNode{constructor(parent){super(parent);this.type=NodeType.Dummy}clone(){return Object.create(this)}toString(options){return""}}}).call(this)},{"./NodeType":446,"./XMLNode":468}],466:[function(require,module,exports){(function(){var NodeType,XMLAttribute,XMLElement,XMLNamedNodeMap,XMLNode,getValue,isFunction,isObject,hasProp={}.hasOwnProperty;({isObject:isObject,isFunction:isFunction,getValue:getValue}=require("./Utility"));XMLNode=require("./XMLNode");NodeType=require("./NodeType");XMLAttribute=require("./XMLAttribute");XMLNamedNodeMap=require("./XMLNamedNodeMap");module.exports=XMLElement=function(){class XMLElement extends XMLNode{constructor(parent,name,attributes){var child,j,len,ref;super(parent);if(name==null){throw new Error("Missing element name. "+this.debugInfo())}this.name=this.stringify.name(name);this.type=NodeType.Element;this.attribs={};this.schemaTypeInfo=null;if(attributes!=null){this.attribute(attributes)}if(parent.type===NodeType.Document){this.isRoot=true;this.documentObject=parent;parent.rootObject=this;if(parent.children){ref=parent.children;for(j=0,len=ref.length;j<len;j++){child=ref[j];if(child.type===NodeType.DocType){child.name=this.name;break}}}}}clone(){var att,attName,clonedSelf,ref;clonedSelf=Object.create(this);if(clonedSelf.isRoot){clonedSelf.documentObject=null}clonedSelf.attribs={};ref=this.attribs;for(attName in ref){if(!hasProp.call(ref,attName))continue;att=ref[attName];clonedSelf.attribs[attName]=att.clone()}clonedSelf.children=[];this.children.forEach((function(child){var clonedChild;clonedChild=child.clone();clonedChild.parent=clonedSelf;return clonedSelf.children.push(clonedChild)}));return clonedSelf}attribute(name,value){var attName,attValue;if(name!=null){name=getValue(name)}if(isObject(name)){for(attName in name){if(!hasProp.call(name,attName))continue;attValue=name[attName];this.attribute(attName,attValue)}}else{if(isFunction(value)){value=value.apply()}if(this.options.keepNullAttributes&&value==null){this.attribs[name]=new XMLAttribute(this,name,"")}else if(value!=null){this.attribs[name]=new XMLAttribute(this,name,value)}}return this}removeAttribute(name){var attName,j,len;if(name==null){throw new Error("Missing attribute name. "+this.debugInfo())}name=getValue(name);if(Array.isArray(name)){for(j=0,len=name.length;j<len;j++){attName=name[j];delete this.attribs[attName]}}else{delete this.attribs[name]}return this}toString(options){return this.options.writer.element(this,this.options.writer.filterOptions(options))}att(name,value){return this.attribute(name,value)}a(name,value){return this.attribute(name,value)}getAttribute(name){if(this.attribs.hasOwnProperty(name)){return this.attribs[name].value}else{return null}}setAttribute(name,value){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNode(name){if(this.attribs.hasOwnProperty(name)){return this.attribs[name]}else{return null}}setAttributeNode(newAttr){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNode(oldAttr){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(name){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNS(namespaceURI,localName){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNS(namespaceURI,qualifiedName,value){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNS(namespaceURI,localName){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNodeNS(namespaceURI,localName){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNodeNS(newAttr){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(namespaceURI,localName){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasAttribute(name){return this.attribs.hasOwnProperty(name)}hasAttributeNS(namespaceURI,localName){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttribute(name,isId){if(this.attribs.hasOwnProperty(name)){return this.attribs[name].isId}else{return isId}}setIdAttributeNS(namespaceURI,localName,isId){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttributeNode(idAttr,isId){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(tagname){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(namespaceURI,localName){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(classNames){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(node){var i,j,ref;if(!super.isEqualNode(node)){return false}if(node.namespaceURI!==this.namespaceURI){return false}if(node.prefix!==this.prefix){return false}if(node.localName!==this.localName){return false}if(node.attribs.length!==this.attribs.length){return false}for(i=j=0,ref=this.attribs.length-1;0<=ref?j<=ref:j>=ref;i=0<=ref?++j:--j){if(!this.attribs[i].isEqualNode(node.attribs[i])){return false}}return true}}Object.defineProperty(XMLElement.prototype,"tagName",{get:function(){return this.name}});Object.defineProperty(XMLElement.prototype,"namespaceURI",{get:function(){return""}});Object.defineProperty(XMLElement.prototype,"prefix",{get:function(){return""}});Object.defineProperty(XMLElement.prototype,"localName",{get:function(){return this.name}});Object.defineProperty(XMLElement.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});Object.defineProperty(XMLElement.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});Object.defineProperty(XMLElement.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});Object.defineProperty(XMLElement.prototype,"attributes",{get:function(){if(!this.attributeMap||!this.attributeMap.nodes){this.attributeMap=new XMLNamedNodeMap(this.attribs)}return this.attributeMap}});return XMLElement}.call(this)}).call(this)},{"./NodeType":446,"./Utility":447,"./XMLAttribute":449,"./XMLNamedNodeMap":467,"./XMLNode":468}],467:[function(require,module,exports){(function(){var XMLNamedNodeMap;module.exports=XMLNamedNodeMap=function(){class XMLNamedNodeMap{constructor(nodes){this.nodes=nodes}clone(){return this.nodes=null}getNamedItem(name){return this.nodes[name]}setNamedItem(node){var oldNode;oldNode=this.nodes[node.nodeName];this.nodes[node.nodeName]=node;return oldNode||null}removeNamedItem(name){var oldNode;oldNode=this.nodes[name];delete this.nodes[name];return oldNode||null}item(index){return this.nodes[Object.keys(this.nodes)[index]]||null}getNamedItemNS(namespaceURI,localName){throw new Error("This DOM method is not implemented.")}setNamedItemNS(node){throw new Error("This DOM method is not implemented.")}removeNamedItemNS(namespaceURI,localName){throw new Error("This DOM method is not implemented.")}}Object.defineProperty(XMLNamedNodeMap.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}});return XMLNamedNodeMap}.call(this)}).call(this)},{}],468:[function(require,module,exports){(function(){var DocumentPosition,NodeType,XMLCData,XMLComment,XMLDeclaration,XMLDocType,XMLDummy,XMLElement,XMLNamedNodeMap,XMLNode,XMLNodeList,XMLProcessingInstruction,XMLRaw,XMLText,getValue,isEmpty,isFunction,isObject,hasProp={}.hasOwnProperty,splice=[].splice;({isObject:isObject,isFunction:isFunction,isEmpty:isEmpty,getValue:getValue}=require("./Utility"));XMLElement=null;XMLCData=null;XMLComment=null;XMLDeclaration=null;XMLDocType=null;XMLRaw=null;XMLText=null;XMLProcessingInstruction=null;XMLDummy=null;NodeType=null;XMLNodeList=null;XMLNamedNodeMap=null;DocumentPosition=null;module.exports=XMLNode=function(){class XMLNode{constructor(parent1){this.parent=parent1;if(this.parent){this.options=this.parent.options;this.stringify=this.parent.stringify}this.value=null;this.children=[];this.baseURI=null;if(!XMLElement){XMLElement=require("./XMLElement");XMLCData=require("./XMLCData");XMLComment=require("./XMLComment");XMLDeclaration=require("./XMLDeclaration");XMLDocType=require("./XMLDocType");XMLRaw=require("./XMLRaw");XMLText=require("./XMLText");XMLProcessingInstruction=require("./XMLProcessingInstruction");XMLDummy=require("./XMLDummy");NodeType=require("./NodeType");XMLNodeList=require("./XMLNodeList");XMLNamedNodeMap=require("./XMLNamedNodeMap");DocumentPosition=require("./DocumentPosition")}}setParent(parent){var child,j,len,ref1,results;this.parent=parent;if(parent){this.options=parent.options;this.stringify=parent.stringify}ref1=this.children;results=[];for(j=0,len=ref1.length;j<len;j++){child=ref1[j];results.push(child.setParent(this))}return results}element(name,attributes,text){var childNode,item,j,k,key,lastChild,len,len1,val;lastChild=null;if(attributes===null&&text==null){[attributes,text]=[{},null]}if(attributes==null){attributes={}}attributes=getValue(attributes);if(!isObject(attributes)){[text,attributes]=[attributes,text]}if(name!=null){name=getValue(name)}if(Array.isArray(name)){for(j=0,len=name.length;j<len;j++){item=name[j];lastChild=this.element(item)}}else if(isFunction(name)){lastChild=this.element(name.apply())}else if(isObject(name)){for(key in name){if(!hasProp.call(name,key))continue;val=name[key];if(isFunction(val)){val=val.apply()}if(!this.options.ignoreDecorators&&this.stringify.convertAttKey&&key.indexOf(this.stringify.convertAttKey)===0){lastChild=this.attribute(key.substr(this.stringify.convertAttKey.length),val)}else if(!this.options.separateArrayItems&&Array.isArray(val)&&isEmpty(val)){lastChild=this.dummy()}else if(isObject(val)&&isEmpty(val)){lastChild=this.element(key)}else if(!this.options.keepNullNodes&&val==null){lastChild=this.dummy()}else if(!this.options.separateArrayItems&&Array.isArray(val)){for(k=0,len1=val.length;k<len1;k++){item=val[k];childNode={};childNode[key]=item;lastChild=this.element(childNode)}}else if(isObject(val)){if(!this.options.ignoreDecorators&&this.stringify.convertTextKey&&key.indexOf(this.stringify.convertTextKey)===0){lastChild=this.element(val)}else{lastChild=this.element(key);lastChild.element(val)}}else{lastChild=this.element(key,val)}}}else if(!this.options.keepNullNodes&&text===null){lastChild=this.dummy()}else{if(!this.options.ignoreDecorators&&this.stringify.convertTextKey&&name.indexOf(this.stringify.convertTextKey)===0){lastChild=this.text(text)}else if(!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&name.indexOf(this.stringify.convertCDataKey)===0){lastChild=this.cdata(text)}else if(!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&name.indexOf(this.stringify.convertCommentKey)===0){lastChild=this.comment(text)}else if(!this.options.ignoreDecorators&&this.stringify.convertRawKey&&name.indexOf(this.stringify.convertRawKey)===0){lastChild=this.raw(text)}else if(!this.options.ignoreDecorators&&this.stringify.convertPIKey&&name.indexOf(this.stringify.convertPIKey)===0){lastChild=this.instruction(name.substr(this.stringify.convertPIKey.length),text)}else{lastChild=this.node(name,attributes,text)}}if(lastChild==null){throw new Error("Could not create any elements with: "+name+". "+this.debugInfo())}return lastChild}insertBefore(name,attributes,text){var child,i,newChild,refChild,removed;if(name!=null?name.type:void 0){newChild=name;refChild=attributes;newChild.setParent(this);if(refChild){i=children.indexOf(refChild);removed=children.splice(i);children.push(newChild);Array.prototype.push.apply(children,removed)}else{children.push(newChild)}return newChild}else{if(this.isRoot){throw new Error("Cannot insert elements at root level. "+this.debugInfo(name))}i=this.parent.children.indexOf(this);removed=this.parent.children.splice(i);child=this.parent.element(name,attributes,text);Array.prototype.push.apply(this.parent.children,removed);return child}}insertAfter(name,attributes,text){var child,i,removed;if(this.isRoot){throw new Error("Cannot insert elements at root level. "+this.debugInfo(name))}i=this.parent.children.indexOf(this);removed=this.parent.children.splice(i+1);child=this.parent.element(name,attributes,text);Array.prototype.push.apply(this.parent.children,removed);return child}remove(){var i,ref1;if(this.isRoot){throw new Error("Cannot remove the root element. "+this.debugInfo())}i=this.parent.children.indexOf(this);splice.apply(this.parent.children,[i,i-i+1].concat(ref1=[])),ref1;return this.parent}node(name,attributes,text){var child;if(name!=null){name=getValue(name)}attributes||(attributes={});attributes=getValue(attributes);if(!isObject(attributes)){[text,attributes]=[attributes,text]}child=new XMLElement(this,name,attributes);if(text!=null){child.text(text)}this.children.push(child);return child}text(value){var child;if(isObject(value)){this.element(value)}child=new XMLText(this,value);this.children.push(child);return this}cdata(value){var child;child=new XMLCData(this,value);this.children.push(child);return this}comment(value){var child;child=new XMLComment(this,value);this.children.push(child);return this}commentBefore(value){var child,i,removed;i=this.parent.children.indexOf(this);removed=this.parent.children.splice(i);child=this.parent.comment(value);Array.prototype.push.apply(this.parent.children,removed);return this}commentAfter(value){var child,i,removed;i=this.parent.children.indexOf(this);removed=this.parent.children.splice(i+1);child=this.parent.comment(value);Array.prototype.push.apply(this.parent.children,removed);return this}raw(value){var child;child=new XMLRaw(this,value);this.children.push(child);return this}dummy(){var child;child=new XMLDummy(this);return child}instruction(target,value){var insTarget,insValue,instruction,j,len;if(target!=null){target=getValue(target)}if(value!=null){value=getValue(value)}if(Array.isArray(target)){for(j=0,len=target.length;j<len;j++){insTarget=target[j];this.instruction(insTarget)}}else if(isObject(target)){for(insTarget in target){if(!hasProp.call(target,insTarget))continue;insValue=target[insTarget];this.instruction(insTarget,insValue)}}else{if(isFunction(value)){value=value.apply()}instruction=new XMLProcessingInstruction(this,target,value);this.children.push(instruction)}return this}instructionBefore(target,value){var child,i,removed;i=this.parent.children.indexOf(this);removed=this.parent.children.splice(i);child=this.parent.instruction(target,value);Array.prototype.push.apply(this.parent.children,removed);return this}instructionAfter(target,value){var child,i,removed;i=this.parent.children.indexOf(this);removed=this.parent.children.splice(i+1);child=this.parent.instruction(target,value);Array.prototype.push.apply(this.parent.children,removed);return this}declaration(version,encoding,standalone){var doc,xmldec;doc=this.document();xmldec=new XMLDeclaration(doc,version,encoding,standalone);if(doc.children.length===0){doc.children.unshift(xmldec)}else if(doc.children[0].type===NodeType.Declaration){doc.children[0]=xmldec}else{doc.children.unshift(xmldec)}return doc.root()||doc}dtd(pubID,sysID){var child,doc,doctype,i,j,k,len,len1,ref1,ref2;doc=this.document();doctype=new XMLDocType(doc,pubID,sysID);ref1=doc.children;for(i=j=0,len=ref1.length;j<len;i=++j){child=ref1[i];if(child.type===NodeType.DocType){doc.children[i]=doctype;return doctype}}ref2=doc.children;for(i=k=0,len1=ref2.length;k<len1;i=++k){child=ref2[i];if(child.isRoot){doc.children.splice(i,0,doctype);return doctype}}doc.children.push(doctype);return doctype}up(){if(this.isRoot){throw new Error("The root node has no parent. Use doc() if you need to get the document object.")}return this.parent}root(){var node;node=this;while(node){if(node.type===NodeType.Document){return node.rootObject}else if(node.isRoot){return node}else{node=node.parent}}}document(){var node;node=this;while(node){if(node.type===NodeType.Document){return node}else{node=node.parent}}}end(options){return this.document().end(options)}prev(){var i;i=this.parent.children.indexOf(this);if(i<1){throw new Error("Already at the first node. "+this.debugInfo())}return this.parent.children[i-1]}next(){var i;i=this.parent.children.indexOf(this);if(i===-1||i===this.parent.children.length-1){throw new Error("Already at the last node. "+this.debugInfo())}return this.parent.children[i+1]}importDocument(doc){var child,clonedRoot,j,len,ref1;clonedRoot=doc.root().clone();clonedRoot.parent=this;clonedRoot.isRoot=false;this.children.push(clonedRoot);if(this.type===NodeType.Document){clonedRoot.isRoot=true;clonedRoot.documentObject=this;this.rootObject=clonedRoot;if(this.children){ref1=this.children;for(j=0,len=ref1.length;j<len;j++){child=ref1[j];if(child.type===NodeType.DocType){child.name=clonedRoot.name;break}}}}return this}debugInfo(name){var ref1,ref2;name=name||this.name;if(name==null&&!((ref1=this.parent)!=null?ref1.name:void 0)){return""}else if(name==null){return"parent: <"+this.parent.name+">"}else if(!((ref2=this.parent)!=null?ref2.name:void 0)){return"node: <"+name+">"}else{return"node: <"+name+">, parent: <"+this.parent.name+">"}}ele(name,attributes,text){return this.element(name,attributes,text)}nod(name,attributes,text){return this.node(name,attributes,text)}txt(value){return this.text(value)}dat(value){return this.cdata(value)}com(value){return this.comment(value)}ins(target,value){return this.instruction(target,value)}doc(){return this.document()}dec(version,encoding,standalone){return this.declaration(version,encoding,standalone)}e(name,attributes,text){return this.element(name,attributes,text)}n(name,attributes,text){return this.node(name,attributes,text)}t(value){return this.text(value)}d(value){return this.cdata(value)}c(value){return this.comment(value)}r(value){return this.raw(value)}i(target,value){return this.instruction(target,value)}u(){return this.up()}importXMLBuilder(doc){return this.importDocument(doc)}attribute(name,value){throw new Error("attribute() applies to element nodes only.")}att(name,value){return this.attribute(name,value)}a(name,value){return this.attribute(name,value)}removeAttribute(name){throw new Error("attribute() applies to element nodes only.")}replaceChild(newChild,oldChild){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeChild(oldChild){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendChild(newChild){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasChildNodes(){return this.children.length!==0}cloneNode(deep){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalize(){throw new Error("This DOM method is not implemented."+this.debugInfo())}isSupported(feature,version){return true}hasAttributes(){return this.attribs.length!==0}compareDocumentPosition(other){var ref,res;ref=this;if(ref===other){return 0}else if(this.document()!==other.document()){res=DocumentPosition.Disconnected|DocumentPosition.ImplementationSpecific;if(Math.random()<.5){res|=DocumentPosition.Preceding}else{res|=DocumentPosition.Following}return res}else if(ref.isAncestor(other)){return DocumentPosition.Contains|DocumentPosition.Preceding}else if(ref.isDescendant(other)){return DocumentPosition.Contains|DocumentPosition.Following}else if(ref.isPreceding(other)){return DocumentPosition.Preceding}else{return DocumentPosition.Following}}isSameNode(other){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupPrefix(namespaceURI){throw new Error("This DOM method is not implemented."+this.debugInfo())}isDefaultNamespace(namespaceURI){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupNamespaceURI(prefix){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(node){var i,j,ref1;if(node.nodeType!==this.nodeType){return false}if(node.children.length!==this.children.length){return false}for(i=j=0,ref1=this.children.length-1;0<=ref1?j<=ref1:j>=ref1;i=0<=ref1?++j:--j){if(!this.children[i].isEqualNode(node.children[i])){return false}}return true}getFeature(feature,version){throw new Error("This DOM method is not implemented."+this.debugInfo())}setUserData(key,data,handler){throw new Error("This DOM method is not implemented."+this.debugInfo())}getUserData(key){throw new Error("This DOM method is not implemented."+this.debugInfo())}contains(other){if(!other){return false}return other===this||this.isDescendant(other)}isDescendant(node){var child,isDescendantChild,j,len,ref1;ref1=this.children;for(j=0,len=ref1.length;j<len;j++){child=ref1[j];if(node===child){return true}isDescendantChild=child.isDescendant(node);if(isDescendantChild){return true}}return false}isAncestor(node){return node.isDescendant(this)}isPreceding(node){var nodePos,thisPos;nodePos=this.treePosition(node);thisPos=this.treePosition(this);if(nodePos===-1||thisPos===-1){return false}else{return nodePos<thisPos}}isFollowing(node){var nodePos,thisPos;nodePos=this.treePosition(node);thisPos=this.treePosition(this);if(nodePos===-1||thisPos===-1){return false}else{return nodePos>thisPos}}treePosition(node){var found,pos;pos=0;found=false;this.foreachTreeNode(this.document(),(function(childNode){pos++;if(!found&&childNode===node){return found=true}}));if(found){return pos}else{return-1}}foreachTreeNode(node,func){var child,j,len,ref1,res;node||(node=this.document());ref1=node.children;for(j=0,len=ref1.length;j<len;j++){child=ref1[j];if(res=func(child)){return res}else{res=this.foreachTreeNode(child,func);if(res){return res}}}}}Object.defineProperty(XMLNode.prototype,"nodeName",{get:function(){return this.name}});Object.defineProperty(XMLNode.prototype,"nodeType",{get:function(){return this.type}});Object.defineProperty(XMLNode.prototype,"nodeValue",{get:function(){return this.value}});Object.defineProperty(XMLNode.prototype,"parentNode",{get:function(){return this.parent}});Object.defineProperty(XMLNode.prototype,"childNodes",{get:function(){if(!this.childNodeList||!this.childNodeList.nodes){this.childNodeList=new XMLNodeList(this.children)}return this.childNodeList}});Object.defineProperty(XMLNode.prototype,"firstChild",{get:function(){return this.children[0]||null}});Object.defineProperty(XMLNode.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}});Object.defineProperty(XMLNode.prototype,"previousSibling",{get:function(){var i;i=this.parent.children.indexOf(this);return this.parent.children[i-1]||null}});Object.defineProperty(XMLNode.prototype,"nextSibling",{get:function(){var i;i=this.parent.children.indexOf(this);return this.parent.children[i+1]||null}});Object.defineProperty(XMLNode.prototype,"ownerDocument",{get:function(){return this.document()||null}});Object.defineProperty(XMLNode.prototype,"textContent",{get:function(){var child,j,len,ref1,str;if(this.nodeType===NodeType.Element||this.nodeType===NodeType.DocumentFragment){str="";ref1=this.children;for(j=0,len=ref1.length;j<len;j++){child=ref1[j];if(child.textContent){str+=child.textContent}}return str}else{return null}},set:function(value){throw new Error("This DOM method is not implemented."+this.debugInfo())}});return XMLNode}.call(this)}).call(this)},{"./DocumentPosition":445,"./NodeType":446,"./Utility":447,"./XMLCData":450,"./XMLComment":452,"./XMLDeclaration":461,"./XMLDocType":462,"./XMLDummy":465,"./XMLElement":466,"./XMLNamedNodeMap":467,"./XMLNodeList":469,"./XMLProcessingInstruction":470,"./XMLRaw":471,"./XMLText":475}],469:[function(require,module,exports){(function(){var XMLNodeList;module.exports=XMLNodeList=function(){class XMLNodeList{constructor(nodes){this.nodes=nodes}clone(){return this.nodes=null}item(index){return this.nodes[index]||null}}Object.defineProperty(XMLNodeList.prototype,"length",{get:function(){return this.nodes.length||0}});return XMLNodeList}.call(this)}).call(this)},{}],470:[function(require,module,exports){(function(){var NodeType,XMLCharacterData,XMLProcessingInstruction;NodeType=require("./NodeType");XMLCharacterData=require("./XMLCharacterData");module.exports=XMLProcessingInstruction=class XMLProcessingInstruction extends XMLCharacterData{constructor(parent,target,value){super(parent);if(target==null){throw new Error("Missing instruction target. "+this.debugInfo())}this.type=NodeType.ProcessingInstruction;this.target=this.stringify.insTarget(target);this.name=this.target;if(value){this.value=this.stringify.insValue(value)}}clone(){return Object.create(this)}toString(options){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(options))}isEqualNode(node){if(!super.isEqualNode(node)){return false}if(node.target!==this.target){return false}return true}}}).call(this)},{"./NodeType":446,"./XMLCharacterData":451}],471:[function(require,module,exports){(function(){var NodeType,XMLNode,XMLRaw;NodeType=require("./NodeType");XMLNode=require("./XMLNode");module.exports=XMLRaw=class XMLRaw extends XMLNode{constructor(parent,text){super(parent);if(text==null){throw new Error("Missing raw text. "+this.debugInfo())}this.type=NodeType.Raw;this.value=this.stringify.raw(text)}clone(){return Object.create(this)}toString(options){return this.options.writer.raw(this,this.options.writer.filterOptions(options))}}}).call(this)},{"./NodeType":446,"./XMLNode":468}],472:[function(require,module,exports){(function(){var NodeType,WriterState,XMLStreamWriter,XMLWriterBase,hasProp={}.hasOwnProperty;NodeType=require("./NodeType");XMLWriterBase=require("./XMLWriterBase");WriterState=require("./WriterState");module.exports=XMLStreamWriter=class XMLStreamWriter extends XMLWriterBase{constructor(stream,options){super(options);this.stream=stream}endline(node,options,level){if(node.isLastRootNode&&options.state===WriterState.CloseTag){return""}else{return super.endline(node,options,level)}}document(doc,options){var child,i,j,k,len1,len2,ref,ref1,results;ref=doc.children;for(i=j=0,len1=ref.length;j<len1;i=++j){child=ref[i];child.isLastRootNode=i===doc.children.length-1}options=this.filterOptions(options);ref1=doc.children;results=[];for(k=0,len2=ref1.length;k<len2;k++){child=ref1[k];results.push(this.writeChildNode(child,options,0))}return results}cdata(node,options,level){return this.stream.write(super.cdata(node,options,level))}comment(node,options,level){return this.stream.write(super.comment(node,options,level))}declaration(node,options,level){return this.stream.write(super.declaration(node,options,level))}docType(node,options,level){var child,j,len1,ref;level||(level=0);this.openNode(node,options,level);options.state=WriterState.OpenTag;this.stream.write(this.indent(node,options,level));this.stream.write("<!DOCTYPE "+node.root().name);if(node.pubID&&node.sysID){this.stream.write(' PUBLIC "'+node.pubID+'" "'+node.sysID+'"')}else if(node.sysID){this.stream.write(' SYSTEM "'+node.sysID+'"')}if(node.children.length>0){this.stream.write(" [");this.stream.write(this.endline(node,options,level));options.state=WriterState.InsideTag;ref=node.children;for(j=0,len1=ref.length;j<len1;j++){child=ref[j];this.writeChildNode(child,options,level+1)}options.state=WriterState.CloseTag;this.stream.write("]")}options.state=WriterState.CloseTag;this.stream.write(options.spaceBeforeSlash+">");this.stream.write(this.endline(node,options,level));options.state=WriterState.None;return this.closeNode(node,options,level)}element(node,options,level){var att,attLen,child,childNodeCount,firstChildNode,j,len,len1,name,prettySuppressed,r,ratt,ref,ref1,ref2,rline;level||(level=0);this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<"+node.name;if(options.pretty&&options.width>0){len=r.length;ref=node.attribs;for(name in ref){if(!hasProp.call(ref,name))continue;att=ref[name];ratt=this.attribute(att,options,level);attLen=ratt.length;if(len+attLen>options.width){rline=this.indent(node,options,level+1)+ratt;r+=this.endline(node,options,level)+rline;len=rline.length}else{rline=" "+ratt;r+=rline;len+=rline.length}}}else{ref1=node.attribs;for(name in ref1){if(!hasProp.call(ref1,name))continue;att=ref1[name];r+=this.attribute(att,options,level)}}this.stream.write(r);childNodeCount=node.children.length;firstChildNode=childNodeCount===0?null:node.children[0];if(childNodeCount===0||node.children.every((function(e){return(e.type===NodeType.Text||e.type===NodeType.Raw||e.type===NodeType.CData)&&e.value===""}))){if(options.allowEmpty){this.stream.write(">");options.state=WriterState.CloseTag;this.stream.write("</"+node.name+">")}else{options.state=WriterState.CloseTag;this.stream.write(options.spaceBeforeSlash+"/>")}}else if(options.pretty&&childNodeCount===1&&(firstChildNode.type===NodeType.Text||firstChildNode.type===NodeType.Raw||firstChildNode.type===NodeType.CData)&&firstChildNode.value!=null){this.stream.write(">");options.state=WriterState.InsideTag;options.suppressPrettyCount++;prettySuppressed=true;this.writeChildNode(firstChildNode,options,level+1);options.suppressPrettyCount--;prettySuppressed=false;options.state=WriterState.CloseTag;this.stream.write("</"+node.name+">")}else{this.stream.write(">"+this.endline(node,options,level));options.state=WriterState.InsideTag;ref2=node.children;for(j=0,len1=ref2.length;j<len1;j++){child=ref2[j];this.writeChildNode(child,options,level+1)}options.state=WriterState.CloseTag;this.stream.write(this.indent(node,options,level)+"</"+node.name+">")}this.stream.write(this.endline(node,options,level));options.state=WriterState.None;return this.closeNode(node,options,level)}processingInstruction(node,options,level){return this.stream.write(super.processingInstruction(node,options,level))}raw(node,options,level){return this.stream.write(super.raw(node,options,level))}text(node,options,level){return this.stream.write(super.text(node,options,level))}dtdAttList(node,options,level){return this.stream.write(super.dtdAttList(node,options,level))}dtdElement(node,options,level){return this.stream.write(super.dtdElement(node,options,level))}dtdEntity(node,options,level){return this.stream.write(super.dtdEntity(node,options,level))}dtdNotation(node,options,level){return this.stream.write(super.dtdNotation(node,options,level))}}}).call(this)},{"./NodeType":446,"./WriterState":448,"./XMLWriterBase":476}],473:[function(require,module,exports){(function(){var XMLStringWriter,XMLWriterBase;XMLWriterBase=require("./XMLWriterBase");module.exports=XMLStringWriter=class XMLStringWriter extends XMLWriterBase{constructor(options){super(options)}document(doc,options){var child,i,len,r,ref;options=this.filterOptions(options);r="";ref=doc.children;for(i=0,len=ref.length;i<len;i++){child=ref[i];r+=this.writeChildNode(child,options,0)}if(options.pretty&&r.slice(-options.newline.length)===options.newline){r=r.slice(0,-options.newline.length)}return r}}}).call(this)},{"./XMLWriterBase":476}],474:[function(require,module,exports){(function(){var XMLStringifier,hasProp={}.hasOwnProperty;module.exports=XMLStringifier=function(){class XMLStringifier{constructor(options){var key,ref,value;this.assertLegalChar=this.assertLegalChar.bind(this);this.assertLegalName=this.assertLegalName.bind(this);options||(options={});this.options=options;if(!this.options.version){this.options.version="1.0"}ref=options.stringify||{};for(key in ref){if(!hasProp.call(ref,key))continue;value=ref[key];this[key]=value}}name(val){if(this.options.noValidation){return val}return this.assertLegalName(""+val||"")}text(val){if(this.options.noValidation){return val}return this.assertLegalChar(this.textEscape(""+val||""))}cdata(val){if(this.options.noValidation){return val}val=""+val||"";val=val.replace("]]>","]]]]><![CDATA[>");return this.assertLegalChar(val)}comment(val){if(this.options.noValidation){return val}val=""+val||"";if(val.match(/--/)){throw new Error("Comment text cannot contain double-hypen: "+val)}return this.assertLegalChar(val)}raw(val){if(this.options.noValidation){return val}return""+val||""}attValue(val){if(this.options.noValidation){return val}return this.assertLegalChar(this.attEscape(val=""+val||""))}insTarget(val){if(this.options.noValidation){return val}return this.assertLegalChar(""+val||"")}insValue(val){if(this.options.noValidation){return val}val=""+val||"";if(val.match(/\?>/)){throw new Error("Invalid processing instruction value: "+val)}return this.assertLegalChar(val)}xmlVersion(val){if(this.options.noValidation){return val}val=""+val||"";if(!val.match(/1\.[0-9]+/)){throw new Error("Invalid version number: "+val)}return val}xmlEncoding(val){if(this.options.noValidation){return val}val=""+val||"";if(!val.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/)){throw new Error("Invalid encoding: "+val)}return this.assertLegalChar(val)}xmlStandalone(val){if(this.options.noValidation){return val}if(val){return"yes"}else{return"no"}}dtdPubID(val){if(this.options.noValidation){return val}return this.assertLegalChar(""+val||"")}dtdSysID(val){if(this.options.noValidation){return val}return this.assertLegalChar(""+val||"")}dtdElementValue(val){if(this.options.noValidation){return val}return this.assertLegalChar(""+val||"")}dtdAttType(val){if(this.options.noValidation){return val}return this.assertLegalChar(""+val||"")}dtdAttDefault(val){if(this.options.noValidation){return val}return this.assertLegalChar(""+val||"")}dtdEntityValue(val){if(this.options.noValidation){return val}return this.assertLegalChar(""+val||"")}dtdNData(val){if(this.options.noValidation){return val}return this.assertLegalChar(""+val||"")}assertLegalChar(str){var regex,res;if(this.options.noValidation){return str}if(this.options.version==="1.0"){regex=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g;if(this.options.invalidCharReplacement!==void 0){str=str.replace(regex,this.options.invalidCharReplacement)}else if(res=str.match(regex)){throw new Error(`Invalid character in string: ${str} at index ${res.index}`)}}else if(this.options.version==="1.1"){regex=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g;if(this.options.invalidCharReplacement!==void 0){str=str.replace(regex,this.options.invalidCharReplacement)}else if(res=str.match(regex)){throw new Error(`Invalid character in string: ${str} at index ${res.index}`)}}return str}assertLegalName(str){var regex;if(this.options.noValidation){return str}str=this.assertLegalChar(str);regex=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/;if(!str.match(regex)){throw new Error(`Invalid character in name: ${str}`)}return str}textEscape(str){var ampregex;if(this.options.noValidation){return str}ampregex=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g;return str.replace(ampregex,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")}attEscape(str){var ampregex;if(this.options.noValidation){return str}ampregex=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g;return str.replace(ampregex,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}}XMLStringifier.prototype.convertAttKey="@";XMLStringifier.prototype.convertPIKey="?";XMLStringifier.prototype.convertTextKey="#text";XMLStringifier.prototype.convertCDataKey="#cdata";XMLStringifier.prototype.convertCommentKey="#comment";XMLStringifier.prototype.convertRawKey="#raw";return XMLStringifier}.call(this)}).call(this)},{}],475:[function(require,module,exports){(function(){var NodeType,XMLCharacterData,XMLText;NodeType=require("./NodeType");XMLCharacterData=require("./XMLCharacterData");module.exports=XMLText=function(){class XMLText extends XMLCharacterData{constructor(parent,text){super(parent);if(text==null){throw new Error("Missing element text. "+this.debugInfo())}this.name="#text";this.type=NodeType.Text;this.value=this.stringify.text(text)}clone(){return Object.create(this)}toString(options){return this.options.writer.text(this,this.options.writer.filterOptions(options))}splitText(offset){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceWholeText(content){throw new Error("This DOM method is not implemented."+this.debugInfo())}}Object.defineProperty(XMLText.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}});Object.defineProperty(XMLText.prototype,"wholeText",{get:function(){var next,prev,str;str="";prev=this.previousSibling;while(prev){str=prev.data+str;prev=prev.previousSibling}str+=this.data;next=this.nextSibling;while(next){str=str+next.data;next=next.nextSibling}return str}});return XMLText}.call(this)}).call(this)},{"./NodeType":446,"./XMLCharacterData":451}],476:[function(require,module,exports){(function(){var NodeType,WriterState,XMLCData,XMLComment,XMLDTDAttList,XMLDTDElement,XMLDTDEntity,XMLDTDNotation,XMLDeclaration,XMLDocType,XMLDummy,XMLElement,XMLProcessingInstruction,XMLRaw,XMLText,XMLWriterBase,assign,hasProp={}.hasOwnProperty;({assign:assign}=require("./Utility"));NodeType=require("./NodeType");XMLDeclaration=require("./XMLDeclaration");XMLDocType=require("./XMLDocType");XMLCData=require("./XMLCData");XMLComment=require("./XMLComment");XMLElement=require("./XMLElement");XMLRaw=require("./XMLRaw");XMLText=require("./XMLText");XMLProcessingInstruction=require("./XMLProcessingInstruction");XMLDummy=require("./XMLDummy");XMLDTDAttList=require("./XMLDTDAttList");XMLDTDElement=require("./XMLDTDElement");XMLDTDEntity=require("./XMLDTDEntity");XMLDTDNotation=require("./XMLDTDNotation");WriterState=require("./WriterState");module.exports=XMLWriterBase=class XMLWriterBase{constructor(options){var key,ref,value;options||(options={});this.options=options;ref=options.writer||{};for(key in ref){if(!hasProp.call(ref,key))continue;value=ref[key];this["_"+key]=this[key];this[key]=value}}filterOptions(options){var filteredOptions,ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7;options||(options={});options=assign({},this.options,options);filteredOptions={writer:this};filteredOptions.pretty=options.pretty||false;filteredOptions.allowEmpty=options.allowEmpty||false;filteredOptions.indent=(ref=options.indent)!=null?ref:"  ";filteredOptions.newline=(ref1=options.newline)!=null?ref1:"\n";filteredOptions.offset=(ref2=options.offset)!=null?ref2:0;filteredOptions.width=(ref3=options.width)!=null?ref3:0;filteredOptions.dontPrettyTextNodes=(ref4=(ref5=options.dontPrettyTextNodes)!=null?ref5:options.dontprettytextnodes)!=null?ref4:0;filteredOptions.spaceBeforeSlash=(ref6=(ref7=options.spaceBeforeSlash)!=null?ref7:options.spacebeforeslash)!=null?ref6:"";if(filteredOptions.spaceBeforeSlash===true){filteredOptions.spaceBeforeSlash=" "}filteredOptions.suppressPrettyCount=0;filteredOptions.user={};filteredOptions.state=WriterState.None;return filteredOptions}indent(node,options,level){var indentLevel;if(!options.pretty||options.suppressPrettyCount){return""}else if(options.pretty){indentLevel=(level||0)+options.offset+1;if(indentLevel>0){return new Array(indentLevel).join(options.indent)}}return""}endline(node,options,level){if(!options.pretty||options.suppressPrettyCount){return""}else{return options.newline}}attribute(att,options,level){var r;this.openAttribute(att,options,level);if(options.pretty&&options.width>0){r=att.name+'="'+att.value+'"'}else{r=" "+att.name+'="'+att.value+'"'}this.closeAttribute(att,options,level);return r}cdata(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<![CDATA[";options.state=WriterState.InsideTag;r+=node.value;options.state=WriterState.CloseTag;r+="]]>"+this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}comment(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"\x3c!-- ";options.state=WriterState.InsideTag;r+=node.value;options.state=WriterState.CloseTag;r+=" --\x3e"+this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}declaration(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<?xml";options.state=WriterState.InsideTag;r+=' version="'+node.version+'"';if(node.encoding!=null){r+=' encoding="'+node.encoding+'"'}if(node.standalone!=null){r+=' standalone="'+node.standalone+'"'}options.state=WriterState.CloseTag;r+=options.spaceBeforeSlash+"?>";r+=this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}docType(node,options,level){var child,i,len1,r,ref;level||(level=0);this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level);r+="<!DOCTYPE "+node.root().name;if(node.pubID&&node.sysID){r+=' PUBLIC "'+node.pubID+'" "'+node.sysID+'"'}else if(node.sysID){r+=' SYSTEM "'+node.sysID+'"'}if(node.children.length>0){r+=" [";r+=this.endline(node,options,level);options.state=WriterState.InsideTag;ref=node.children;for(i=0,len1=ref.length;i<len1;i++){child=ref[i];r+=this.writeChildNode(child,options,level+1)}options.state=WriterState.CloseTag;r+="]"}options.state=WriterState.CloseTag;r+=options.spaceBeforeSlash+">";r+=this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}element(node,options,level){var att,attLen,child,childNodeCount,firstChildNode,i,j,len,len1,len2,name,prettySuppressed,r,ratt,ref,ref1,ref2,ref3,rline;level||(level=0);prettySuppressed=false;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<"+node.name;if(options.pretty&&options.width>0){len=r.length;ref=node.attribs;for(name in ref){if(!hasProp.call(ref,name))continue;att=ref[name];ratt=this.attribute(att,options,level);attLen=ratt.length;if(len+attLen>options.width){rline=this.indent(node,options,level+1)+ratt;r+=this.endline(node,options,level)+rline;len=rline.length}else{rline=" "+ratt;r+=rline;len+=rline.length}}}else{ref1=node.attribs;for(name in ref1){if(!hasProp.call(ref1,name))continue;att=ref1[name];r+=this.attribute(att,options,level)}}childNodeCount=node.children.length;firstChildNode=childNodeCount===0?null:node.children[0];if(childNodeCount===0||node.children.every((function(e){return(e.type===NodeType.Text||e.type===NodeType.Raw||e.type===NodeType.CData)&&e.value===""}))){if(options.allowEmpty){r+=">";options.state=WriterState.CloseTag;r+="</"+node.name+">"+this.endline(node,options,level)}else{options.state=WriterState.CloseTag;r+=options.spaceBeforeSlash+"/>"+this.endline(node,options,level)}}else if(options.pretty&&childNodeCount===1&&(firstChildNode.type===NodeType.Text||firstChildNode.type===NodeType.Raw||firstChildNode.type===NodeType.CData)&&firstChildNode.value!=null){r+=">";options.state=WriterState.InsideTag;options.suppressPrettyCount++;prettySuppressed=true;r+=this.writeChildNode(firstChildNode,options,level+1);options.suppressPrettyCount--;prettySuppressed=false;options.state=WriterState.CloseTag;r+="</"+node.name+">"+this.endline(node,options,level)}else{if(options.dontPrettyTextNodes){ref2=node.children;for(i=0,len1=ref2.length;i<len1;i++){child=ref2[i];if((child.type===NodeType.Text||child.type===NodeType.Raw||child.type===NodeType.CData)&&child.value!=null){options.suppressPrettyCount++;prettySuppressed=true;break}}}r+=">"+this.endline(node,options,level);options.state=WriterState.InsideTag;ref3=node.children;for(j=0,len2=ref3.length;j<len2;j++){child=ref3[j];r+=this.writeChildNode(child,options,level+1)}options.state=WriterState.CloseTag;r+=this.indent(node,options,level)+"</"+node.name+">";if(prettySuppressed){options.suppressPrettyCount--}r+=this.endline(node,options,level);options.state=WriterState.None}this.closeNode(node,options,level);return r}writeChildNode(node,options,level){switch(node.type){case NodeType.CData:return this.cdata(node,options,level);case NodeType.Comment:return this.comment(node,options,level);case NodeType.Element:return this.element(node,options,level);case NodeType.Raw:return this.raw(node,options,level);case NodeType.Text:return this.text(node,options,level);case NodeType.ProcessingInstruction:return this.processingInstruction(node,options,level);case NodeType.Dummy:return"";case NodeType.Declaration:return this.declaration(node,options,level);case NodeType.DocType:return this.docType(node,options,level);case NodeType.AttributeDeclaration:return this.dtdAttList(node,options,level);case NodeType.ElementDeclaration:return this.dtdElement(node,options,level);case NodeType.EntityDeclaration:return this.dtdEntity(node,options,level);case NodeType.NotationDeclaration:return this.dtdNotation(node,options,level);default:throw new Error("Unknown XML node type: "+node.constructor.name)}}processingInstruction(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<?";options.state=WriterState.InsideTag;r+=node.target;if(node.value){r+=" "+node.value}options.state=WriterState.CloseTag;r+=options.spaceBeforeSlash+"?>";r+=this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}raw(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level);options.state=WriterState.InsideTag;r+=node.value;options.state=WriterState.CloseTag;r+=this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}text(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level);options.state=WriterState.InsideTag;r+=node.value;options.state=WriterState.CloseTag;r+=this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}dtdAttList(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<!ATTLIST";options.state=WriterState.InsideTag;r+=" "+node.elementName+" "+node.attributeName+" "+node.attributeType;if(node.defaultValueType!=="#DEFAULT"){r+=" "+node.defaultValueType}if(node.defaultValue){r+=' "'+node.defaultValue+'"'}options.state=WriterState.CloseTag;r+=options.spaceBeforeSlash+">"+this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}dtdElement(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<!ELEMENT";options.state=WriterState.InsideTag;r+=" "+node.name+" "+node.value;options.state=WriterState.CloseTag;r+=options.spaceBeforeSlash+">"+this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}dtdEntity(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<!ENTITY";options.state=WriterState.InsideTag;if(node.pe){r+=" %"}r+=" "+node.name;if(node.value){r+=' "'+node.value+'"'}else{if(node.pubID&&node.sysID){r+=' PUBLIC "'+node.pubID+'" "'+node.sysID+'"'}else if(node.sysID){r+=' SYSTEM "'+node.sysID+'"'}if(node.nData){r+=" NDATA "+node.nData}}options.state=WriterState.CloseTag;r+=options.spaceBeforeSlash+">"+this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}dtdNotation(node,options,level){var r;this.openNode(node,options,level);options.state=WriterState.OpenTag;r=this.indent(node,options,level)+"<!NOTATION";options.state=WriterState.InsideTag;r+=" "+node.name;if(node.pubID&&node.sysID){r+=' PUBLIC "'+node.pubID+'" "'+node.sysID+'"'}else if(node.pubID){r+=' PUBLIC "'+node.pubID+'"'}else if(node.sysID){r+=' SYSTEM "'+node.sysID+'"'}options.state=WriterState.CloseTag;r+=options.spaceBeforeSlash+">"+this.endline(node,options,level);options.state=WriterState.None;this.closeNode(node,options,level);return r}openNode(node,options,level){}closeNode(node,options,level){}openAttribute(att,options,level){}closeAttribute(att,options,level){}}}).call(this)},{"./NodeType":446,"./Utility":447,"./WriterState":448,"./XMLCData":450,"./XMLComment":452,"./XMLDTDAttList":457,"./XMLDTDElement":458,"./XMLDTDEntity":459,"./XMLDTDNotation":460,"./XMLDeclaration":461,"./XMLDocType":462,"./XMLDummy":465,"./XMLElement":466,"./XMLProcessingInstruction":470,"./XMLRaw":471,"./XMLText":475}],477:[function(require,module,exports){(function(){var NodeType,WriterState,XMLDOMImplementation,XMLDocument,XMLDocumentCB,XMLStreamWriter,XMLStringWriter,assign,isFunction;({assign:assign,isFunction:isFunction}=require("./Utility"));XMLDOMImplementation=require("./XMLDOMImplementation");XMLDocument=require("./XMLDocument");XMLDocumentCB=require("./XMLDocumentCB");XMLStringWriter=require("./XMLStringWriter");XMLStreamWriter=require("./XMLStreamWriter");NodeType=require("./NodeType");WriterState=require("./WriterState");module.exports.create=function(name,xmldec,doctype,options){var doc,root;if(name==null){throw new Error("Root element needs a name.")}options=assign({},xmldec,doctype,options);doc=new XMLDocument(options);root=doc.element(name);if(!options.headless){doc.declaration(options);if(options.pubID!=null||options.sysID!=null){doc.dtd(options)}}return root};module.exports.begin=function(options,onData,onEnd){if(isFunction(options)){[onData,onEnd]=[options,onData];options={}}if(onData){return new XMLDocumentCB(options,onData,onEnd)}else{return new XMLDocument(options)}};module.exports.stringWriter=function(options){return new XMLStringWriter(options)};module.exports.streamWriter=function(stream,options){return new XMLStreamWriter(stream,options)};module.exports.implementation=new XMLDOMImplementation;module.exports.nodeType=NodeType;module.exports.writerState=WriterState}).call(this)},{"./NodeType":446,"./Utility":447,"./WriterState":448,"./XMLDOMImplementation":455,"./XMLDocument":463,"./XMLDocumentCB":464,"./XMLStreamWriter":472,"./XMLStringWriter":473}],478:[function(require,module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target}},{}],479:[function(require,module,exports){const jsonValidator=require("json-dup-key-validator");const bcp47pattern=/^(?:(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))$|^((?:[a-z]{2,3}(?:(?:-[a-z]{3}){1,3})?)|[a-z]{4}|[a-z]{5,8})(?:-([a-z]{4}))?(?:-([a-z]{2}|\d{3}))?((?:-(?:[\da-z]{5,8}|\d[\da-z]{3}))*)?((?:-[\da-wy-z](?:-[\da-z]{2,8})+)*)?(-x(?:-[\da-z]{1,8})+)?$|^(x(?:-[\da-z]{1,8})+)$/i;const fetch=require("node-fetch");const fs=require("fs");const jsonDiff=require("json-diff");module.exports={checkPropUniqueness:checkPropUniqueness,checkSecurity:checkSecurity,checkMultiLangConsistency:checkMultiLangConsistency,checkLinksRelTypeCount:checkLinksRelTypeCount,checkUriSecurity:checkUriSecurity,checkTmOptionalPointer:checkTmOptionalPointer,checkLinkedAffordances:checkLinkedAffordances,checkLinkedStructure:checkLinkedStructure};const resolvePath=(object,path,defaultValue)=>path.split(/[\.\[\]\'\"]/).filter((p=>p)).reduce(((o,p)=>o?o[p]:defaultValue),object);function checkPropUniqueness(tdString){const results=[];try{jsonValidator.parse(tdString,false);const td=JSON.parse(tdString);let tdInteractions=[];if(td.hasOwnProperty("properties")){tdInteractions=tdInteractions.concat(Object.keys(td.properties));results.push({ID:"td-properties_uniqueness",Status:"pass",Comment:""})}else{results.push({ID:"td-properties_uniqueness",Status:"not-impl",Comment:"no properties"})}if(td.hasOwnProperty("actions")){tdInteractions=tdInteractions.concat(Object.keys(td.actions));results.push({ID:"td-actions_uniqueness",Status:"pass",Comment:""})}else{results.push({ID:"td-actions_uniqueness",Status:"not-impl",Comment:"no actions"})}if(td.hasOwnProperty("events")){tdInteractions=tdInteractions.concat(Object.keys(td.events));results.push({ID:"td-events_uniqueness",Status:"pass",Comment:""})}else{results.push({ID:"td-events_uniqueness",Status:"not-impl",Comment:"no events"})}return results}catch(error){const errorString=error.toString();const startQuote=errorString.indexOf('"');const restString=errorString.slice(startQuote+1);const endQuote=restString.indexOf('"');const interactionName=restString.slice(0,endQuote);const td=JSON.parse(tdString);if(td.hasOwnProperty("properties")){const tdProperties=td.properties;if(tdProperties.hasOwnProperty(interactionName)){results.push({ID:"td-properties_uniqueness",Status:"fail",Comment:"duplicate property names at "+td.title});tdString=tdString.replace(interactionName,"duplicateName")}else{results.push({ID:"td-properties_uniqueness",Status:"pass",Comment:""})}}else{results.push({ID:"td-properties_uniqueness",Status:"not-impl",Comment:"no properties"})}if(td.hasOwnProperty("actions")){const tdActions=td.actions;if(tdActions.hasOwnProperty(interactionName)){results.push({ID:"td-actions_uniqueness",Status:"fail",Comment:"duplicate action names at "+td.title});tdString=tdString.replace(interactionName,"duplicateName")}else{results.push({ID:"td-actions_uniqueness",Status:"pass",Comment:""})}}else{results.push({ID:"td-actions_uniqueness",Status:"not-impl",Comment:"no actions"})}if(td.hasOwnProperty("events")){const tdEvents=td.events;if(tdEvents.hasOwnProperty(interactionName)){results.push({ID:"td-events_uniqueness",Status:"fail",Comment:"duplicate event names at "+td.title});tdString=tdString.replace(interactionName,"duplicateName")}else{results.push({ID:"td-events_uniqueness",Status:"pass",Comment:""})}}else{results.push({ID:"td-events_uniqueness",Status:"not-impl",Comment:"no events"})}return results}}function checkSecurity(td){const results=[];if(td.hasOwnProperty("securityDefinitions")){const securityDefinitionsObject=td.securityDefinitions;const securityDefinitions=Object.keys(securityDefinitionsObject);const rootSecurity=td.security;if(securityContains(securityDefinitions,rootSecurity)){}else{results.push({ID:"td-security-scheme-name",Status:"fail",Comment:"used a non defined security scheme in root level at "+td.title});return results}if(td.hasOwnProperty("properties")){tdProperties=Object.keys(td.properties);for(let i=0;i<tdProperties.length;i++){const curPropertyName=tdProperties[i];const curProperty=td.properties[curPropertyName];const curForms=curProperty.forms;for(let j=0;j<curForms.length;j++){const curForm=curForms[j];if(curForm.hasOwnProperty("security")){const curSecurity=curForm.security;if(securityContains(securityDefinitions,curSecurity)){}else{results.push({ID:"td-security-scheme-name",Status:"fail",Comment:"used a non defined security scheme in a property form at "+td.title});return results}}}}}if(td.hasOwnProperty("actions")){tdActions=Object.keys(td.actions);for(let i=0;i<tdActions.length;i++){const curActionName=tdActions[i];const curAction=td.actions[curActionName];const curForms=curAction.forms;for(let j=0;j<curForms.length;j++){const curForm=curForms[j];if(curForm.hasOwnProperty("security")){const curSecurity=curForm.security;if(securityContains(securityDefinitions,curSecurity)){}else{results.push({ID:"td-security-scheme-name",Status:"fail",Comment:"used a non defined security scheme in an action form at "+td.title});return results}}}}}if(td.hasOwnProperty("events")){tdEvents=Object.keys(td.events);for(let i=0;i<tdEvents.length;i++){const curEventName=tdEvents[i];const curEvent=td.events[curEventName];const curForms=curEvent.forms;for(let j=0;j<curForms.length;j++){const curForm=curForms[j];if(curForm.hasOwnProperty("security")){const curSecurity=curForm.security;if(securityContains(securityDefinitions,curSecurity)){}else{results.push({ID:"td-security-scheme-name",Status:"fail",Comment:"used a non defined security scheme in an event form at "+td.title});return results}}}}}results.push({ID:"td-security-scheme-name",Status:"pass"});return results}return results}function securityContains(parent,child){if(typeof child==="string"){child=[child]}return child.every((elem=>parent.indexOf(elem)>-1))}function checkMultiLangConsistency(td){const results=[];const multiLang=[];const isTdTitlesDescriptions=[];if(td.hasOwnProperty("titles")){const rootTitlesObject=td.titles;const rootTitles=Object.keys(rootTitlesObject);multiLang.push(rootTitles);isTdTitlesDescriptions.push({["root_title"]:isStringObjectKeyValue(td.title,rootTitlesObject)})}if(td.hasOwnProperty("descriptions")){const rootDescriptionsObject=td.descriptions;const rootDescriptions=Object.keys(rootDescriptionsObject);multiLang.push(rootDescriptions);if(td.hasOwnProperty("description")){isTdTitlesDescriptions.push({["root_description"]:isStringObjectKeyValue(td.description,rootDescriptionsObject)})}}if(td.hasOwnProperty("properties")){tdProperties=Object.keys(td.properties);for(let i=0;i<tdProperties.length;i++){const curPropertyName=tdProperties[i];const curProperty=td.properties[curPropertyName];if(curProperty.hasOwnProperty("titles")){const titlesKeys=Object.keys(curProperty.titles);multiLang.push(titlesKeys);if(curProperty.hasOwnProperty("title")){isTdTitlesDescriptions.push({["property_"+curPropertyName+"_title"]:isStringObjectKeyValue(curProperty.title,curProperty.titles)})}}if(curProperty.hasOwnProperty("descriptions")){const descriptionsKeys=Object.keys(curProperty.descriptions);multiLang.push(descriptionsKeys);if(curProperty.hasOwnProperty("description")){isTdTitlesDescriptions.push({["property_"+curPropertyName+"_desc"]:isStringObjectKeyValue(curProperty.description,curProperty.descriptions)})}}}}if(td.hasOwnProperty("actions")){tdActions=Object.keys(td.actions);for(let i=0;i<tdActions.length;i++){const curActionName=tdActions[i];const curAction=td.actions[curActionName];if(curAction.hasOwnProperty("titles")){const titlesKeys=Object.keys(curAction.titles);multiLang.push(titlesKeys);if(curAction.hasOwnProperty("title")){isTdTitlesDescriptions.push({["action_"+curActionName+"_title"]:isStringObjectKeyValue(curAction.title,curAction.titles)})}}if(curAction.hasOwnProperty("descriptions")){const descriptionsKeys=Object.keys(curAction.descriptions);multiLang.push(descriptionsKeys);if(curAction.hasOwnProperty("description")){isTdTitlesDescriptions.push({["action_"+curActionName+"_desc"]:isStringObjectKeyValue(curAction.description,curAction.descriptions)})}}}}if(td.hasOwnProperty("events")){tdEvents=Object.keys(td.events);for(let i=0;i<tdEvents.length;i++){const curEventName=tdEvents[i];const curEvent=td.events[curEventName];if(curEvent.hasOwnProperty("titles")){const titlesKeys=Object.keys(curEvent.titles);multiLang.push(titlesKeys);if(curEvent.hasOwnProperty("title")){isTdTitlesDescriptions.push({["event_"+curEventName+"_title"]:isStringObjectKeyValue(curEvent.title,curEvent.titles)})}}if(curEvent.hasOwnProperty("descriptions")){const descriptionsKeys=Object.keys(curEvent.descriptions);multiLang.push(descriptionsKeys);if(curEvent.hasOwnProperty("description")){isTdTitlesDescriptions.push({["event_"+curEventName+"_desc"]:isStringObjectKeyValue(curEvent.description,curEvent.descriptions)})}}}}if(arrayArraysItemsEqual(multiLang)){results.push({ID:"td-multi-languages-consistent",Status:"pass"})}else{results.push({ID:"td-multi-languages-consistent",Status:"fail",Comment:"not all multilang objects have same language tags at "+td.title})}const flatArray=[];for(let index=0;index<multiLang.length;index++){let arrayElement=multiLang[index];arrayElement=JSON.parse(arrayElement);for(let e=0;e<arrayElement.length;e++){const stringElement=arrayElement[e];flatArray.push(stringElement)}}const isBCP47=checkBCP47array(flatArray);if(isBCP47==="ok"){results.push({ID:"td-multilanguage-language-tag",Status:"pass"})}else{results.push({ID:"td-multilanguage-language-tag",Status:"fail",Comment:isBCP47+" is not a BCP47 tag at "+td.title})}if(isTdTitlesDescriptions.length===0){results.push({ID:"td-titles-descriptions",Status:"not-impl",Comment:"no multilang objects in the td"});return results}for(let index=0;index<isTdTitlesDescriptions.length;index++){const element=isTdTitlesDescriptions[index];const elementName=Object.keys(element);if(element[elementName]){}else{results.push({ID:"td-titles-descriptions",Status:"fail",Comment:elementName+" is not on the multilang object at the same level at "+td.title});return results}}results.push({ID:"td-titles-descriptions",Status:"pass"});return results}function arrayArraysItemsEqual(myArray){if(myArray.length===0)return true;for(let i=myArray.length;i--;){myArray[i]=JSON.stringify(myArray[i])}for(let i=myArray.length;i--;){if(i===0){return true}if(myArray[i]!==myArray[i-1]){return false}}}function checkBCP47array(myArray){for(let index=0;index<myArray.length;index++){const element=myArray[index];if(bcp47pattern.test(element)){}else{return element}}return"ok"}function isStringObjectKeyValue(searchedString,searchedObject){const objKeys=Object.keys(searchedObject);if(objKeys.length===0)return false;for(let index=0;index<objKeys.length;index++){const element=objKeys[index];if(searchedObject[element]===searchedString){return true}else{}}return false}function checkAzeri(myMultiLangArray){for(let index=0;index<myMultiLangArray.length;index++){const element=myMultiLangArray[index];if(element==="az"){return"fail"}else if(element==="az-Latn"||element==="az-Arab"){return"pass"}}return"not-impl"}function checkLinksRelTypeCount(td){const results=[];if(td.hasOwnProperty("links")){let typeCount=0;for(let i=0;i<td.links.length;i++){const element=td.links[i];if(element.hasOwnProperty("rel")){if(element.rel==="type"){typeCount++}}}if(typeCount===0){results.push({ID:"tm-rel-type-maximum",Status:"not-impl",Comment:"no rel:type in any link"})}else if(typeCount===1){results.push({ID:"tm-rel-type-maximum",Status:"pass",Comment:""})}else{results.push({ID:"tm-rel-type-maximum",Status:"fail",Comment:"too many rel:type in links array at "+td.title})}}else{results.push({ID:"tm-rel-type-maximum",Status:"not-impl",Comment:"no links array in the td"})}return results}function checkUriSecurity(td){const results=[];if(td.hasOwnProperty("securityDefinitions")){const securityDefinitionsObject=td.securityDefinitions;const securityDefinitionsNames=Object.keys(securityDefinitionsObject);const securityUriVariables=[];for(let index=0;index<securityDefinitionsNames.length;index++){const curSecurityDefinition=securityDefinitionsObject[securityDefinitionsNames[index]];if(curSecurityDefinition.scheme==="apikey"){if(curSecurityDefinition.hasOwnProperty("in")){if(curSecurityDefinition.in==="uri"){if(curSecurityDefinition.hasOwnProperty("name")){securityUriVariables.push(curSecurityDefinition.name)}}}}}if(securityUriVariables.length===0){results.push({ID:"td-security-in-uri-variable",Status:"not-impl",Comment:"no use of name in a uri apikey scheme"});results.push({ID:"td-security-uri-variables-distinct",Status:"not-impl",Comment:"no use of name in a uri apikey scheme"});return results}else{let uriVariablesResult="not-impl";let uriVariablesDistinctResult="not-impl";let rootUriVariables=[];if(td.hasOwnProperty("uriVariables")){rootUriVariables=Object.keys(td.uriVariables)}if(td.hasOwnProperty("properties")){tdProperties=Object.keys(td.properties);for(let i=0;i<tdProperties.length;i++){const curPropertyName=tdProperties[i];const curProperty=td.properties[curPropertyName];const curForms=curProperty.forms;for(let j=0;j<curForms.length;j++){const curForm=curForms[j];if(curForm.hasOwnProperty("href")){const curHref=curForm.href;if(securityUriVariables.some((v=>curHref.includes(v)))){if(uriVariablesResult!=="fail"){uriVariablesResult="pass"}}}}if(curProperty.hasOwnProperty("uriVariables")){curPropertyUriVariables=Object.keys(curProperty.uriVariables);curPropertyUriVariables.push(...rootUriVariables);if(curPropertyUriVariables.length>0){const filteredArray=curPropertyUriVariables.filter((value=>securityUriVariables.includes(value)));if(filteredArray.length>0){uriVariablesDistinctResult="fail"}else{if(uriVariablesDistinctResult!=="fail"){uriVariablesDistinctResult="pass"}}}}else{if(uriVariablesDistinctResult!=="fail"){uriVariablesDistinctResult="pass"}}}}if(td.hasOwnProperty("actions")){tdActions=Object.keys(td.actions);for(let i=0;i<tdActions.length;i++){const curActionName=tdActions[i];const curAction=td.actions[curActionName];const curForms=curAction.forms;for(let j=0;j<curForms.length;j++){const curForm=curForms[j];if(curForm.hasOwnProperty("href")){const curHref=curForm.href;if(securityUriVariables.some((v=>curHref.includes(v)))){if(uriVariablesResult!=="fail"){uriVariablesResult="pass"}}}}if(curAction.hasOwnProperty("uriVariables")){curActionUriVariables=Object.keys(curAction.uriVariables);curActionUriVariables.push(...rootUriVariables);if(curActionUriVariables.length>0){const filteredArray=curActionUriVariables.filter((value=>securityUriVariables.includes(value)));if(filteredArray.length>0){uriVariablesDistinctResult="fail"}else{if(uriVariablesDistinctResult!=="fail"){uriVariablesDistinctResult="pass"}}}else{if(uriVariablesDistinctResult!=="fail"){uriVariablesDistinctResult="pass"}}}}}if(td.hasOwnProperty("events")){tdEvents=Object.keys(td.events);for(let i=0;i<tdEvents.length;i++){const curEventName=tdEvents[i];const curEvent=td.events[curEventName];const curForms=curEvent.forms;for(let j=0;j<curForms.length;j++){const curForm=curForms[j];if(curForm.hasOwnProperty("href")){const curHref=curForm.href;if(securityUriVariables.some((v=>curHref.includes(v)))){if(uriVariablesResult!=="fail"){uriVariablesResult="pass"}}}}if(curEvent.hasOwnProperty("uriVariables")){curEventUriVariables=Object.keys(curEvent.uriVariables);curEventUriVariables.push(...rootUriVariables);if(curEventUriVariables.length>0){const filteredArray=curEventUriVariables.filter((value=>securityUriVariables.includes(value)));if(filteredArray.length>0){uriVariablesDistinctResult="fail"}else{if(uriVariablesDistinctResult!=="fail"){uriVariablesDistinctResult="pass"}}}else{if(uriVariablesDistinctResult!=="fail"){uriVariablesDistinctResult="pass"}}}}}results.push({ID:"td-security-in-uri-variable",Status:uriVariablesResult});results.push({ID:"td-security-in-uri-variable-distinct",Status:uriVariablesDistinctResult});return results}results.push({ID:"td-security-scheme-name",Status:"pass"});return results}return results}function checkTmOptionalPointer(td){const results=[];if(td.hasOwnProperty("tm:optional")){td["tm:optional"].forEach((element=>{element=element.substring(1);element=element.replace("/",".");const pathTarget=resolvePath(td,element,"noTarget");if(pathTarget==="noTarget"||pathTarget===undefined){results.push({ID:"tm-tmOptional-resolver",Status:"fail",Comment:"tm:optional does not resolve to an affordance at "+td.title})}else{results.push({ID:"tm-tmOptional-resolver",Status:"pass",Comment:""})}}))}else{results.push({ID:"tm-tmOptional-resolver",Status:"not-impl",Comment:"no use of tm:optional"})}return results}async function fetchLinkedTm(td){if(!td.links){return{success:false,status:"not-impl",comment:"td does not link to tm"}}let typeLink=td.links.filter((e=>e.rel==="type"));if(typeLink.length!==1){return typeLink.length<1?{success:false,status:"not-impl",comment:"td does not link to tm"}:{success:false,status:"fail",comment:"td links to more than one tm at "+td.title}}typeLink=typeLink[0];const fileFetcher=async url=>{try{return{success:true,data:JSON.parse(fs.readFileSync(url.split("file://")[1]))}}catch{return{success:false,error:"make sure you are not using file:// links inside non-browser environment"}}};const httpFetcher=async url=>{try{return{success:true,data:await(await fetch(url)).json()}}catch{return{success:false,error:"make sure related tm is valid JSON and is not under CORS"}}};const fetcher=typeLink.href.startsWith("file://")?fileFetcher:httpFetcher;const result=await fetcher(typeLink.href);if(!result.success){return{success:false,status:"warning",comment:result.error}}const ThingModelHelpers=new(require("@node-wot/td-tools").ThingModelHelpers);const map={};for(const match of JSON.stringify(result.data).match(/{{.*?}}/g)||[]){const key=match.substring(2,match.length-2);map[key]=match}try{const tm=await ThingModelHelpers.getPartialTDs(result.data,{map:map});return{success:true,tm:tm[0]}}catch(err){return{success:false,status:"warning",comment:err}}}async function checkLinkedAffordances(td){const ASSERTION_REQUIRED="thing-model-td-generation-processor-type";const ASSERTION_OPTIONAL="thing-model-td-generation-processor-optional";const tmResult=await fetchLinkedTm(td);if(!tmResult.success){return[{ID:ASSERTION_REQUIRED,Status:tmResult.status,Comment:tmResult.comment},{ID:ASSERTION_OPTIONAL,Status:tmResult.status,Comment:tmResult.comment}]}const tm=tmResult.tm;const tmAffordances={};for(const affordanceType of["properties","actions","events"]){tmAffordances[affordanceType]={all:Object.keys(tm[affordanceType]||{}),optional:(tm["tm:optional"]||[]).map((e=>{const x=e.split("/");if(x[1]===affordanceType)return x[2];return null})).filter((e=>e))}}const isSubset=(arr1,arr2)=>arr2.every((e=>arr1.includes(e)));const haveIntersection=(arr1,arr2)=>arr1.some((e=>arr2.includes(e)));const results=[];let requiredAssertion=false;let optionalAssertion=false;for(const affordanceType of["properties","actions","events"]){const required=tmAffordances[affordanceType].all.filter((e=>!tmAffordances[affordanceType].optional.includes(e)));if(!isSubset(Object.keys(td[affordanceType]||{}),required)&&!requiredAssertion){requiredAssertion=true;results.push({ID:ASSERTION_REQUIRED,Status:"fail",Comment:"some required affordances are missing at "+td.title})}const optional=tmAffordances[affordanceType].optional;if(haveIntersection(Object.keys(td[affordanceType]||{}),optional)&&!optionalAssertion){optionalAssertion=true;results.push({ID:ASSERTION_OPTIONAL,Status:"pass",Comment:""})}if(requiredAssertion&&optionalAssertion)break}if(!requiredAssertion&&!optionalAssertion){return[{ID:ASSERTION_REQUIRED,Status:"pass",Comment:""},{ID:ASSERTION_OPTIONAL,Status:"not-impl",Comment:""}]}if(requiredAssertion){results.push({ID:ASSERTION_OPTIONAL,Status:"not-impl",Comment:""})}else{results.unshift({ID:ASSERTION_REQUIRED,Status:"pass",Comment:""})}return results}async function checkLinkedStructure(td){const ASSERTION_NAME="thing-model-td-generation-processor-imports";const tmResult=await fetchLinkedTm(td);if(!tmResult.success){return[{ID:ASSERTION_NAME,Status:tmResult.status,Comment:tmResult.comment}]}const tm=tmResult.tm;const diff=jsonDiff.diff(tm,td);const missingKeys=[];const checkKeys=(obj,path="")=>{for(const key of Object.keys(obj)){const newPath=`${path}/${key.split("__deleted")[0]}`;if(key.endsWith("__deleted")&&!key.startsWith("tm:")&&!key.startsWith("@type")){if(tm["tm:optional"]&&tm["tm:optional"].includes(newPath)){continue}missingKeys.push(newPath)}if(typeof obj[key]==="object")checkKeys(obj[key],newPath)}};const diffValues=[];let skipNext=false;const checkValues=(obj,path="")=>{for(const key of Object.keys(obj)){if(!key.endsWith("__added")&&!key.endsWith("__deleted")&&!key.startsWith("tm:")&&key!=="@type"&&key!=="$comment"&&key!=="id"&&key!=="version"&&key!=="links"){if(skipNext){skipNext=false;continue}if(key=="__new"||key=="__old"){if(/{{.*?}}/.test(obj["__old"].toString())){continue}diffValues.push(path);skipNext=true;continue}const newPath=`${path}/${key.split("__")[0]}`;if(typeof obj[key]==="object")checkValues(obj[key],newPath)}}};checkKeys(diff);checkValues(diff);if(missingKeys.length>0||diffValues.length>0){let comment;if(missingKeys.length>0&&diffValues.length>0){comment=`${missingKeys.join(", ")} - imposed by tm but missing at ${td.title}\n`;comment+="In addition, ";comment+=`values of TM keys diverge: ${diffValues.join(", ")}`}else if(missingKeys.length>0){comment=`${missingKeys.join(", ")} - imposed by tm but missing at ${td.title}`}else{comment=`Values of TM keys diverge at ${td.title}: ${diffValues.join(", ")}`}return[{ID:ASSERTION_NAME,Status:"fail",Comment:comment}]}return[{ID:ASSERTION_NAME,Status:"pass",Comment:""}]}},{"@node-wot/td-tools":6,fs:149,"json-diff":312,"json-dup-key-validator":314,"node-fetch":375}],480:[function(require,module,exports){module.exports={title:"Thing Description",version:"1.1-10-June-2022",description:"JSON Schema for validating TD instances against the TD information model. For a TD to validate this schema it must contain all the default terms defined in Section 5.4",$schema:"http://json-schema.org/draft-07/schema#",definitions:{anyUri:{type:"string"},description:{type:"string"},descriptions:{type:"object",additionalProperties:{type:"string"}},title:{type:"string"},titles:{type:"object",additionalProperties:{type:"string"}},security:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},scopes:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},subprotocol:{type:"string",examples:["longpoll","websub","sse"]},"thing-context-td-uri-v1":{type:"string",const:"https://www.w3.org/2019/wot/td/v1"},"thing-context-td-uri-v1.1":{type:"string",const:"https://www.w3.org/2022/wot/td/v1.1"},"thing-context-td-uri-temp":{type:"string",const:"http://www.w3.org/ns/td"},"thing-context":{anyOf:[{$comment:"New context URI with other vocabularies after it but not the old one",type:"array",items:[{$ref:"#/definitions/thing-context-td-uri-v1.1"}],additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}],not:{$ref:"#/definitions/thing-context-td-uri-v1"}}},{$comment:"Only the new context URI",$ref:"#/definitions/thing-context-td-uri-v1.1"},{$comment:"Old context URI, followed by the new one and possibly other vocabularies. minItems and contains are required since prefixItems does not say all items should be provided",type:"array",prefixItems:[{$ref:"#/definitions/thing-context-td-uri-v1"},{$ref:"#/definitions/thing-context-td-uri-v1.1"}],minItems:2,contains:{$ref:"#/definitions/thing-context-td-uri-v1.1"},additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}]}},{$comment:"Old context URI, followed by possibly other vocabularies. minItems and contains are required since prefixItems does not say all items should be provided",type:"array",prefixItems:[{$ref:"#/definitions/thing-context-td-uri-v1"}],minItems:1,contains:{$ref:"#/definitions/thing-context-td-uri-v1"},additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}]}},{$comment:"Only the new context URI",$ref:"#/definitions/thing-context-td-uri-v1"}]},type_declaration:{oneOf:[{type:"string",not:{const:"tm:ThingModel"}},{type:"array",items:{type:"string",not:{const:"tm:ThingModel"}}}]},"dataSchema-type":{type:"string",enum:["boolean","integer","number","string","object","array","null"]},dataSchema:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},title:{$ref:"#/definitions/title"},descriptions:{$ref:"#/definitions/descriptions"},titles:{$ref:"#/definitions/titles"},writeOnly:{type:"boolean"},readOnly:{type:"boolean"},oneOf:{type:"array",items:{$ref:"#/definitions/dataSchema"}},unit:{type:"string"},enum:{type:"array",minItems:1,uniqueItems:true},format:{type:"string"},const:{},default:{},contentEncoding:{type:"string"},contentMediaType:{type:"string"},type:{$ref:"#/definitions/dataSchema-type"},items:{oneOf:[{$ref:"#/definitions/dataSchema"},{type:"array",items:{$ref:"#/definitions/dataSchema"}}]},maxItems:{type:"integer",minimum:0},minItems:{type:"integer",minimum:0},minimum:{type:"number"},maximum:{type:"number"},exclusiveMinimum:{type:"number"},exclusiveMaximum:{type:"number"},minLength:{type:"integer",minimum:0},maxLength:{type:"integer",minimum:0},multipleOf:{$ref:"#/definitions/multipleOfDefinition"},properties:{additionalProperties:{$ref:"#/definitions/dataSchema"}},required:{type:"array",items:{type:"string"}}},required:["readOnly","writeOnly"]},additionalResponsesDefinition:{type:"array",items:{type:"object",properties:{contentType:{type:"string"},schema:{type:"string"},success:{type:"boolean"}},required:["contentType","success"]}},multipleOfDefinition:{type:["integer","number"],exclusiveMinimum:0},expectedResponse:{type:"object",properties:{contentType:{type:"string"}}},form_element_base:{type:"object",properties:{op:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},href:{$ref:"#/definitions/anyUri"},contentType:{type:"string"},contentCoding:{type:"string"},subprotocol:{$ref:"#/definitions/subprotocol"},security:{$ref:"#/definitions/security"},scopes:{$ref:"#/definitions/scopes"},response:{$ref:"#/definitions/expectedResponse"},additionalResponses:{$ref:"#/definitions/additionalResponsesDefinition"}},required:["href","contentType","op"],additionalProperties:true},form_element_property:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",enum:["readproperty","writeproperty","observeproperty","unobserveproperty"]},{type:"array",items:{type:"string",enum:["readproperty","writeproperty","observeproperty","unobserveproperty"]}}]}},additionalProperties:true},form_element_action:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",enum:["invokeaction","queryaction","cancelaction"]},{type:"array",items:{type:"string",enum:["invokeaction","queryaction","cancelaction"]}}]}},additionalProperties:true},form_element_event:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",enum:["subscribeevent","unsubscribeevent"]},{type:"array",items:{type:"string",enum:["subscribeevent","unsubscribeevent"]}}]}},additionalProperties:true},form_element_root:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",enum:["readallproperties","writeallproperties","readmultipleproperties","writemultipleproperties","observeallproperties","unobserveallproperties","queryallactions","subscribeallevents","unsubscribeallevents"]},{type:"array",items:{type:"string",enum:["readallproperties","writeallproperties","readmultipleproperties","writemultipleproperties","observeallproperties","unobserveallproperties","queryallactions","subscribeallevents","unsubscribeallevents"]}}]}},additionalProperties:true},form:{$comment:"This is NOT for validation purposes but for automatic generation of TS types. For more info, please see: https://github.com/w3c/wot-thing-description/pull/1319#issuecomment-994950057",oneOf:[{$ref:"#/definitions/form_element_property"},{$ref:"#/definitions/form_element_action"},{$ref:"#/definitions/form_element_event"},{$ref:"#/definitions/form_element_root"}]},property_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_property"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"}},observable:{type:"boolean"},writeOnly:{type:"boolean"},readOnly:{type:"boolean"},oneOf:{type:"array",items:{$ref:"#/definitions/dataSchema"}},unit:{type:"string"},enum:{type:"array",minItems:1,uniqueItems:true},format:{type:"string"},const:{},default:{},type:{$ref:"#/definitions/dataSchema-type"},items:{oneOf:[{$ref:"#/definitions/dataSchema"},{type:"array",items:{$ref:"#/definitions/dataSchema"}}]},maxItems:{type:"integer",minimum:0},minItems:{type:"integer",minimum:0},minimum:{type:"number"},maximum:{type:"number"},exclusiveMinimum:{type:"number"},exclusiveMaximum:{type:"number"},minLength:{type:"integer",minimum:0},maxLength:{type:"integer",minimum:0},multipleOf:{$ref:"#/definitions/multipleOfDefinition"},properties:{additionalProperties:{$ref:"#/definitions/dataSchema"}},required:{type:"array",items:{type:"string"}}},required:["forms","readOnly","writeOnly","observable"],additionalProperties:true},action_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_action"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"}},input:{$ref:"#/definitions/dataSchema"},output:{$ref:"#/definitions/dataSchema"},safe:{type:"boolean"},idempotent:{type:"boolean"},synchronous:{type:"boolean"}},required:["forms","safe","idempotent"],additionalProperties:true},event_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_event"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"}},subscription:{$ref:"#/definitions/dataSchema"},data:{$ref:"#/definitions/dataSchema"},dataResponse:{$ref:"#/definitions/dataSchema"},cancellation:{$ref:"#/definitions/dataSchema"}},required:["forms"],additionalProperties:true},base_link_element:{type:"object",properties:{href:{$ref:"#/definitions/anyUri"},type:{type:"string"},rel:{type:"string"},anchor:{$ref:"#/definitions/anyUri"}},required:["href"],additionalProperties:true},link_element:{allOf:[{$ref:"#/definitions/base_link_element"},{not:{description:"A basic link element should not contain sizes",type:"object",properties:{sizes:{}},required:["sizes"]}},{not:{description:"A basic link element should not contain icon or tm:extends",properties:{rel:{enum:["icon","tm:extends"]}},required:["rel"]}}]},icon_link_element:{allOf:[{$ref:"#/definitions/base_link_element"},{properties:{rel:{const:"icon"},sizes:{type:"string",pattern:"[0-9]*x[0-9]+"}},required:["rel"]}]},additionalSecurityScheme:{description:"Applies to additional SecuritySchemes not defined in the WoT TD specification.",$comment:"Additional SecuritySchemes should always be defined via a context extension, using a prefixed value for the scheme. This prefix (e.g. 'ace', see the example below) must contain at least one character in order to reference a valid JSON-LD context extension.",examples:[{scheme:"ace:ACESecurityScheme","ace:as":"coaps://as.example.com/token","ace:audience":"coaps://rs.example.com","ace:scopes":["limited","special"],"ace:cnonce":true}],type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",pattern:".+:.*"}},required:["scheme"]},noSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["nosec"]}},required:["scheme"]},autoSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["auto"]}},required:["scheme"]},comboSecurityScheme:{oneOf:[{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["combo"]},oneOf:{type:"array",minItems:2,items:{type:"string"}}},required:["scheme","oneOf"]},{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["combo"]},allOf:{type:"array",minItems:2,items:{type:"string"}}},required:["scheme","allOf"]}]},basicSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["basic"]},in:{type:"string",enum:["header","query","body","cookie","auto"]},name:{type:"string"}},required:["scheme","in"]},digestSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["digest"]},qop:{type:"string",enum:["auth","auth-int"]},in:{type:"string",enum:["header","query","body","cookie","auto"]},name:{type:"string"}},required:["scheme","in","qop"]},apiKeySecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["apikey"]},in:{type:"string",enum:["header","query","body","uri","auto","cookie"]},name:{type:"string"}},required:["scheme","in"]},bearerSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["bearer"]},authorization:{$ref:"#/definitions/anyUri"},alg:{type:"string"},format:{type:"string"},in:{type:"string",enum:["header","query","body","cookie","auto"]},name:{type:"string"}},required:["scheme","alg","format","in"]},pskSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["psk"]},identity:{type:"string"}},required:["scheme"]},oAuth2SecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["oauth2"]},authorization:{$ref:"#/definitions/anyUri"},token:{$ref:"#/definitions/anyUri"},refresh:{$ref:"#/definitions/anyUri"},scopes:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},flow:{anyOf:[{type:"string"},{type:"string",enum:["code","client","device"]}]}},required:["scheme"]},securityScheme:{oneOf:[{$ref:"#/definitions/noSecurityScheme"},{$ref:"#/definitions/autoSecurityScheme"},{$ref:"#/definitions/comboSecurityScheme"},{$ref:"#/definitions/basicSecurityScheme"},{$ref:"#/definitions/digestSecurityScheme"},{$ref:"#/definitions/apiKeySecurityScheme"},{$ref:"#/definitions/bearerSecurityScheme"},{$ref:"#/definitions/pskSecurityScheme"},{$ref:"#/definitions/oAuth2SecurityScheme"},{$ref:"#/definitions/additionalSecurityScheme"}]}},type:"object",properties:{id:{type:"string",format:"uri"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},properties:{type:"object",additionalProperties:{$ref:"#/definitions/property_element"}},actions:{type:"object",additionalProperties:{$ref:"#/definitions/action_element"}},events:{type:"object",additionalProperties:{$ref:"#/definitions/event_element"}},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},version:{type:"object",properties:{instance:{type:"string"}},required:["instance"]},links:{type:"array",items:{oneOf:[{$ref:"#/definitions/link_element"},{$ref:"#/definitions/icon_link_element"}]}},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_root"}},base:{$ref:"#/definitions/anyUri"},securityDefinitions:{type:"object",minProperties:1,additionalProperties:{$ref:"#/definitions/securityScheme"}},schemaDefinitions:{type:"object",minProperties:1,additionalProperties:{$ref:"#/definitions/dataSchema"}},support:{$ref:"#/definitions/anyUri"},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"},profile:{oneOf:[{$ref:"#/definitions/anyUri"},{type:"array",minItems:1,items:{$ref:"#/definitions/anyUri"}}]},security:{oneOf:[{type:"string"},{type:"array",minItems:1,items:{type:"string"}}]},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"}},"@type":{$ref:"#/definitions/type_declaration"},"@context":{$ref:"#/definitions/thing-context"}},required:["title","security","securityDefinitions","@context"],additionalProperties:true}},{}],481:[function(require,module,exports){module.exports={title:"Thing Description",version:"1.1-05-September-2022",description:"JSON Schema for validating TD instances against the TD information model. TD instances can be with or without terms that have default values",$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/w3c/wot-thing-description/main/validation/td-json-schema-validation.json",definitions:{anyUri:{type:"string"},description:{type:"string"},descriptions:{type:"object",additionalProperties:{type:"string"}},title:{type:"string"},titles:{type:"object",additionalProperties:{type:"string"}},security:{oneOf:[{type:"array",items:{type:"string"},minItems:1},{type:"string"}]},scopes:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},subprotocol:{type:"string",examples:["longpoll","websub","sse"]},"thing-context-td-uri-v1":{type:"string",const:"https://www.w3.org/2019/wot/td/v1"},"thing-context-td-uri-v1.1":{type:"string",const:"https://www.w3.org/2022/wot/td/v1.1"},"thing-context-td-uri-temp":{type:"string",const:"http://www.w3.org/ns/td"},"thing-context":{anyOf:[{$comment:"New context URI with other vocabularies after it but not the old one",type:"array",items:[{$ref:"#/definitions/thing-context-td-uri-v1.1"}],additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}],not:{$ref:"#/definitions/thing-context-td-uri-v1"}}},{$comment:"Only the new context URI",$ref:"#/definitions/thing-context-td-uri-v1.1"},{$comment:"Old context URI, followed by the new one and possibly other vocabularies. minItems and contains are required since prefixItems does not say all items should be provided",type:"array",prefixItems:[{$ref:"#/definitions/thing-context-td-uri-v1"},{$ref:"#/definitions/thing-context-td-uri-v1.1"}],minItems:2,contains:{$ref:"#/definitions/thing-context-td-uri-v1.1"},additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}]}},{$comment:"Old context URI, followed by possibly other vocabularies. minItems and contains are required since prefixItems does not say all items should be provided",type:"array",prefixItems:[{$ref:"#/definitions/thing-context-td-uri-v1"}],minItems:1,contains:{$ref:"#/definitions/thing-context-td-uri-v1"},additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}]}},{$comment:"Only the new context URI",$ref:"#/definitions/thing-context-td-uri-v1"}]},bcp47_string:{type:"string",pattern:"^(((([A-Za-z]{2,3}(-([A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-([A-Za-z]{4}))?(-([A-Za-z]{2}|[0-9]{3}))?(-([A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-([0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(x(-[A-Za-z0-9]{1,8})+))?)|(x(-[A-Za-z0-9]{1,8})+)|((en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang)))$"},type_declaration:{oneOf:[{type:"string",not:{const:"tm:ThingModel"}},{type:"array",items:{type:"string",not:{const:"tm:ThingModel"}}}]},"dataSchema-type":{type:"string",enum:["boolean","integer","number","string","object","array","null"]},dataSchema:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},title:{$ref:"#/definitions/title"},descriptions:{$ref:"#/definitions/descriptions"},titles:{$ref:"#/definitions/titles"},writeOnly:{type:"boolean"},readOnly:{type:"boolean"},oneOf:{type:"array",items:{$ref:"#/definitions/dataSchema"}},unit:{type:"string"},enum:{type:"array",minItems:1,uniqueItems:true},format:{type:"string"},const:{},default:{},contentEncoding:{type:"string"},contentMediaType:{type:"string"},type:{$ref:"#/definitions/dataSchema-type"},items:{oneOf:[{$ref:"#/definitions/dataSchema"},{type:"array",items:{$ref:"#/definitions/dataSchema"}}]},maxItems:{type:"integer",minimum:0},minItems:{type:"integer",minimum:0},minimum:{type:"number"},maximum:{type:"number"},exclusiveMinimum:{type:"number"},exclusiveMaximum:{type:"number"},minLength:{type:"integer",minimum:0},maxLength:{type:"integer",minimum:0},multipleOf:{$ref:"#/definitions/multipleOfDefinition"},properties:{additionalProperties:{$ref:"#/definitions/dataSchema"}},required:{type:"array",items:{type:"string"}}}},additionalResponsesDefinition:{type:"array",items:{type:"object",properties:{contentType:{type:"string"},schema:{type:"string"},success:{type:"boolean"}}}},multipleOfDefinition:{type:["integer","number"],exclusiveMinimum:0},expectedResponse:{type:"object",properties:{contentType:{type:"string"}}},form_element_base:{type:"object",properties:{op:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},href:{$ref:"#/definitions/anyUri"},contentType:{type:"string"},contentCoding:{type:"string"},subprotocol:{$ref:"#/definitions/subprotocol"},security:{$ref:"#/definitions/security"},scopes:{$ref:"#/definitions/scopes"},response:{$ref:"#/definitions/expectedResponse"},additionalResponses:{$ref:"#/definitions/additionalResponsesDefinition"}},required:["href"],additionalProperties:true},form_element_property:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",enum:["readproperty","writeproperty","observeproperty","unobserveproperty"]},{type:"array",items:{type:"string",enum:["readproperty","writeproperty","observeproperty","unobserveproperty"]}}]}},additionalProperties:true},form_element_action:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",enum:["invokeaction","queryaction","cancelaction"]},{type:"array",items:{type:"string",enum:["invokeaction","queryaction","cancelaction"]}}]}},additionalProperties:true},form_element_event:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",enum:["subscribeevent","unsubscribeevent"]},{type:"array",items:{type:"string",enum:["subscribeevent","unsubscribeevent"]}}]}},additionalProperties:true},form_element_root:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",enum:["readallproperties","writeallproperties","readmultipleproperties","writemultipleproperties","observeallproperties","unobserveallproperties","queryallactions","subscribeallevents","unsubscribeallevents"]},{type:"array",items:{type:"string",enum:["readallproperties","writeallproperties","readmultipleproperties","writemultipleproperties","observeallproperties","unobserveallproperties","queryallactions","subscribeallevents","unsubscribeallevents"]}}]}},additionalProperties:true,required:["op"]},form:{$comment:"This is NOT for validation purposes but for automatic generation of TS types. For more info, please see: https://github.com/w3c/wot-thing-description/pull/1319#issuecomment-994950057",oneOf:[{$ref:"#/definitions/form_element_property"},{$ref:"#/definitions/form_element_action"},{$ref:"#/definitions/form_element_event"},{$ref:"#/definitions/form_element_root"}]},property_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_property"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"}},observable:{type:"boolean"},writeOnly:{type:"boolean"},readOnly:{type:"boolean"},oneOf:{type:"array",items:{$ref:"#/definitions/dataSchema"}},unit:{type:"string"},enum:{type:"array",minItems:1,uniqueItems:true},format:{type:"string"},const:{},default:{},type:{$ref:"#/definitions/dataSchema-type"},items:{oneOf:[{$ref:"#/definitions/dataSchema"},{type:"array",items:{$ref:"#/definitions/dataSchema"}}]},maxItems:{type:"integer",minimum:0},minItems:{type:"integer",minimum:0},minimum:{type:"number"},maximum:{type:"number"},exclusiveMinimum:{type:"number"},exclusiveMaximum:{type:"number"},minLength:{type:"integer",minimum:0},maxLength:{type:"integer",minimum:0},multipleOf:{$ref:"#/definitions/multipleOfDefinition"},properties:{additionalProperties:{$ref:"#/definitions/dataSchema"}},required:{type:"array",items:{type:"string"}}},required:["forms"],additionalProperties:true},action_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_action"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"}},input:{$ref:"#/definitions/dataSchema"},output:{$ref:"#/definitions/dataSchema"},safe:{type:"boolean"},idempotent:{type:"boolean"},synchronous:{type:"boolean"}},required:["forms"],additionalProperties:true},event_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_event"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"}},subscription:{$ref:"#/definitions/dataSchema"},data:{$ref:"#/definitions/dataSchema"},dataResponse:{$ref:"#/definitions/dataSchema"},cancellation:{$ref:"#/definitions/dataSchema"}},required:["forms"],additionalProperties:true},base_link_element:{type:"object",properties:{href:{$ref:"#/definitions/anyUri"},type:{type:"string"},rel:{type:"string"},anchor:{$ref:"#/definitions/anyUri"},hreflang:{anyOf:[{$ref:"#/definitions/bcp47_string"},{type:"array",items:{$ref:"#/definitions/bcp47_string"}}]}},required:["href"],additionalProperties:true},link_element:{allOf:[{$ref:"#/definitions/base_link_element"},{not:{description:"A basic link element should not contain sizes",type:"object",properties:{sizes:{}},required:["sizes"]}},{not:{description:"A basic link element should not contain icon or tm:extends",properties:{rel:{enum:["icon","tm:extends"]}},required:["rel"]}}]},icon_link_element:{allOf:[{$ref:"#/definitions/base_link_element"},{properties:{rel:{const:"icon"},sizes:{type:"string",pattern:"[0-9]*x[0-9]+"}},required:["rel"]}]},additionalSecurityScheme:{description:"Applies to additional SecuritySchemes not defined in the WoT TD specification.",$comment:"Additional SecuritySchemes should always be defined via a context extension, using a prefixed value for the scheme. This prefix (e.g. 'ace', see the example below) must contain at least one character in order to reference a valid JSON-LD context extension.",examples:[{scheme:"ace:ACESecurityScheme","ace:as":"coaps://as.example.com/token","ace:audience":"coaps://rs.example.com","ace:scopes":["limited","special"],"ace:cnonce":true}],type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",pattern:".+:.*"}},required:["scheme"],additionalProperties:true},noSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["nosec"]}},required:["scheme"],additionalProperties:true},autoSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["auto"]}},not:{required:["name"]},required:["scheme"],additionalProperties:true},comboSecurityScheme:{oneOf:[{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["combo"]},oneOf:{type:"array",minItems:2,items:{type:"string"}}},required:["scheme","oneOf"],additionalProperties:true},{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["combo"]},allOf:{type:"array",minItems:2,items:{type:"string"}}},required:["scheme","allOf"],additionalProperties:true}]},basicSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["basic"]},in:{type:"string",enum:["header","query","body","cookie","auto"]},name:{type:"string"}},required:["scheme"],additionalProperties:true},digestSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["digest"]},qop:{type:"string",enum:["auth","auth-int"]},in:{type:"string",enum:["header","query","body","cookie","auto"]},name:{type:"string"}},required:["scheme"],additionalProperties:true},apiKeySecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["apikey"]},in:{type:"string",enum:["header","query","body","cookie","uri","auto"]},name:{type:"string"}},required:["scheme"],additionalProperties:true},bearerSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["bearer"]},authorization:{$ref:"#/definitions/anyUri"},alg:{type:"string"},format:{type:"string"},in:{type:"string",enum:["header","query","body","cookie","auto"]},name:{type:"string"}},required:["scheme"],additionalProperties:true},pskSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["psk"]},identity:{type:"string"}},required:["scheme"],additionalProperties:true},oAuth2SecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",enum:["oauth2"]},authorization:{$ref:"#/definitions/anyUri"},token:{$ref:"#/definitions/anyUri"},refresh:{$ref:"#/definitions/anyUri"},scopes:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},flow:{anyOf:[{type:"string"},{type:"string",enum:["code","client","device"]}]}},required:["scheme"],additionalProperties:true},securityScheme:{oneOf:[{$ref:"#/definitions/noSecurityScheme"},{$ref:"#/definitions/autoSecurityScheme"},{$ref:"#/definitions/comboSecurityScheme"},{$ref:"#/definitions/basicSecurityScheme"},{$ref:"#/definitions/digestSecurityScheme"},{$ref:"#/definitions/apiKeySecurityScheme"},{$ref:"#/definitions/bearerSecurityScheme"},{$ref:"#/definitions/pskSecurityScheme"},{$ref:"#/definitions/oAuth2SecurityScheme"},{$ref:"#/definitions/additionalSecurityScheme"}]}},type:"object",properties:{id:{type:"string",format:"uri"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},properties:{type:"object",additionalProperties:{$ref:"#/definitions/property_element"}},actions:{type:"object",additionalProperties:{$ref:"#/definitions/action_element"}},events:{type:"object",additionalProperties:{$ref:"#/definitions/event_element"}},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},version:{type:"object",properties:{instance:{type:"string"}},required:["instance"]},links:{type:"array",items:{oneOf:[{$ref:"#/definitions/link_element"},{$ref:"#/definitions/icon_link_element"}]}},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_root"}},base:{$ref:"#/definitions/anyUri"},securityDefinitions:{type:"object",minProperties:1,additionalProperties:{$ref:"#/definitions/securityScheme"}},schemaDefinitions:{type:"object",minProperties:1,additionalProperties:{$ref:"#/definitions/dataSchema"}},support:{$ref:"#/definitions/anyUri"},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"},profile:{oneOf:[{$ref:"#/definitions/anyUri"},{type:"array",minItems:1,items:{$ref:"#/definitions/anyUri"}}]},security:{oneOf:[{type:"string"},{type:"array",minItems:1,items:{type:"string"}}]},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"}},"@type":{$ref:"#/definitions/type_declaration"},"@context":{$ref:"#/definitions/thing-context"}},required:["title","security","securityDefinitions","@context"],additionalProperties:true}},{}],482:[function(require,module,exports){module.exports={title:"Thing Model",version:"1.1-05-September-2022",description:"JSON Schema for validating Thing Models. This is automatically generated from the WoT TD Schema.",$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/w3c/wot-thing-description/main/validation/tm-json-schema-validation.json",definitions:{anyUri:{type:"string"},description:{type:"string"},descriptions:{type:"object",additionalProperties:{type:"string"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},title:{type:"string"},titles:{type:"object",additionalProperties:{type:"string"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},security:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},scopes:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},subprotocol:{type:"string",examples:["longpoll","websub","sse"]},"thing-context-td-uri-v1":{type:"string",const:"https://www.w3.org/2019/wot/td/v1"},"thing-context-td-uri-v1.1":{type:"string",const:"https://www.w3.org/2022/wot/td/v1.1"},"thing-context-td-uri-temp":{type:"string",const:"http://www.w3.org/ns/td"},"thing-context":{anyOf:[{$comment:"New context URI with other vocabularies after it but not the old one",type:"array",items:[{$ref:"#/definitions/thing-context-td-uri-v1.1"}],additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}],not:{$ref:"#/definitions/thing-context-td-uri-v1"}}},{$comment:"Only the new context URI",$ref:"#/definitions/thing-context-td-uri-v1.1"},{$comment:"Old context URI, followed by the new one and possibly other vocabularies. minItems and contains are required since prefixItems does not say all items should be provided",type:"array",prefixItems:[{$ref:"#/definitions/thing-context-td-uri-v1"},{$ref:"#/definitions/thing-context-td-uri-v1.1"}],minItems:2,contains:{$ref:"#/definitions/thing-context-td-uri-v1.1"},additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}]}},{$comment:"Old context URI, followed by possibly other vocabularies. minItems and contains are required since prefixItems does not say all items should be provided",type:"array",prefixItems:[{$ref:"#/definitions/thing-context-td-uri-v1"}],minItems:1,contains:{$ref:"#/definitions/thing-context-td-uri-v1"},additionalItems:{anyOf:[{$ref:"#/definitions/anyUri"},{type:"object"}]}},{$comment:"Only the new context URI",$ref:"#/definitions/thing-context-td-uri-v1"}]},bcp47_string:{type:"string",pattern:"^(((([A-Za-z]{2,3}(-([A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-([A-Za-z]{4}))?(-([A-Za-z]{2}|[0-9]{3}))?(-([A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-([0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(x(-[A-Za-z0-9]{1,8})+))?)|(x(-[A-Za-z0-9]{1,8})+)|((en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang)))$"},type_declaration:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},"dataSchema-type":{type:"string",anyOf:[{enum:["boolean","integer","number","string","object","array","null"]},{$ref:"#/definitions/placeholder-pattern"}]},dataSchema:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},title:{$ref:"#/definitions/title"},descriptions:{$ref:"#/definitions/descriptions"},titles:{$ref:"#/definitions/titles"},writeOnly:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},readOnly:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},oneOf:{type:"array",items:{$ref:"#/definitions/dataSchema"}},unit:{type:"string"},enum:{anyOf:[{type:"array",minItems:1,uniqueItems:true},{$ref:"#/definitions/placeholder-pattern"}]},format:{type:"string"},const:{},default:{},contentEncoding:{type:"string"},contentMediaType:{type:"string"},type:{$ref:"#/definitions/dataSchema-type"},items:{oneOf:[{$ref:"#/definitions/dataSchema"},{type:"array",items:{$ref:"#/definitions/dataSchema"}}]},maxItems:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},minItems:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},minimum:{anyOf:[{type:"number"},{$ref:"#/definitions/placeholder-pattern"}]},maximum:{anyOf:[{type:"number"},{$ref:"#/definitions/placeholder-pattern"}]},exclusiveMinimum:{type:"number"},exclusiveMaximum:{type:"number"},minLength:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},maxLength:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},multipleOf:{$ref:"#/definitions/multipleOfDefinition"},properties:{additionalProperties:{$ref:"#/definitions/dataSchema"}},required:{anyOf:[{type:"array",items:{type:"string"}},{$ref:"#/definitions/placeholder-pattern"}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},additionalResponsesDefinition:{type:"array",items:{type:"object",properties:{contentType:{type:"string"},schema:{type:"string"},success:{type:"boolean"}}}},multipleOfDefinition:{anyOf:[{type:["integer","number"],exclusiveMinimum:0},{$ref:"#/definitions/placeholder-pattern"}]},expectedResponse:{type:"object",properties:{contentType:{type:"string"}},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_base:{type:"object",properties:{op:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},href:{$ref:"#/definitions/anyUri"},contentType:{type:"string"},contentCoding:{type:"string"},subprotocol:{$ref:"#/definitions/subprotocol"},security:{$ref:"#/definitions/security"},scopes:{$ref:"#/definitions/scopes"},response:{$ref:"#/definitions/expectedResponse"},additionalResponses:{$ref:"#/definitions/additionalResponsesDefinition"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_property:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",anyOf:[{enum:["readproperty","writeproperty","observeproperty","unobserveproperty"]},{$ref:"#/definitions/placeholder-pattern"}]},{type:"array",items:{type:"string",anyOf:[{enum:["readproperty","writeproperty","observeproperty","unobserveproperty"]},{$ref:"#/definitions/placeholder-pattern"}]}}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_action:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",anyOf:[{enum:["invokeaction","queryaction","cancelaction"]},{$ref:"#/definitions/placeholder-pattern"}]},{type:"array",items:{type:"string",anyOf:[{enum:["invokeaction","queryaction","cancelaction"]},{$ref:"#/definitions/placeholder-pattern"}]}}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_event:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",anyOf:[{enum:["subscribeevent","unsubscribeevent"]},{$ref:"#/definitions/placeholder-pattern"}]},{type:"array",items:{type:"string",anyOf:[{enum:["subscribeevent","unsubscribeevent"]},{$ref:"#/definitions/placeholder-pattern"}]}}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form_element_root:{allOf:[{$ref:"#/definitions/form_element_base"}],type:"object",properties:{op:{oneOf:[{type:"string",anyOf:[{enum:["readallproperties","writeallproperties","readmultipleproperties","writemultipleproperties","observeallproperties","unobserveallproperties","queryallactions","subscribeallevents","unsubscribeallevents"]},{$ref:"#/definitions/placeholder-pattern"}]},{type:"array",items:{type:"string",anyOf:[{enum:["readallproperties","writeallproperties","readmultipleproperties","writemultipleproperties","observeallproperties","unobserveallproperties","queryallactions","subscribeallevents","unsubscribeallevents"]},{$ref:"#/definitions/placeholder-pattern"}]}}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},form:{$comment:"This is NOT for validation purposes but for automatic generation of TS types. For more info, please see: https://github.com/w3c/wot-thing-description/pull/1319#issuecomment-994950057",oneOf:[{$ref:"#/definitions/form_element_property"},{$ref:"#/definitions/form_element_action"},{$ref:"#/definitions/form_element_event"},{$ref:"#/definitions/form_element_root"}]},property_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_property"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},observable:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},writeOnly:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},readOnly:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},oneOf:{type:"array",items:{$ref:"#/definitions/dataSchema"}},unit:{type:"string"},enum:{anyOf:[{type:"array",minItems:1,uniqueItems:true},{$ref:"#/definitions/placeholder-pattern"}]},format:{type:"string"},const:{},default:{},type:{$ref:"#/definitions/dataSchema-type"},items:{oneOf:[{$ref:"#/definitions/dataSchema"},{type:"array",items:{$ref:"#/definitions/dataSchema"}}]},maxItems:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},minItems:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},minimum:{anyOf:[{type:"number"},{$ref:"#/definitions/placeholder-pattern"}]},maximum:{anyOf:[{type:"number"},{$ref:"#/definitions/placeholder-pattern"}]},exclusiveMinimum:{type:"number"},exclusiveMaximum:{type:"number"},minLength:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},maxLength:{anyOf:[{type:"integer",minimum:0},{$ref:"#/definitions/placeholder-pattern"}]},multipleOf:{$ref:"#/definitions/multipleOfDefinition"},properties:{additionalProperties:{$ref:"#/definitions/dataSchema"}},required:{anyOf:[{type:"array",items:{type:"string"}},{$ref:"#/definitions/placeholder-pattern"}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},action_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_action"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},input:{$ref:"#/definitions/dataSchema"},output:{$ref:"#/definitions/dataSchema"},safe:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},idempotent:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},synchronous:{anyOf:[{type:"boolean"},{$ref:"#/definitions/placeholder-pattern"}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},event_element:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_event"}},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},subscription:{$ref:"#/definitions/dataSchema"},data:{$ref:"#/definitions/dataSchema"},dataResponse:{$ref:"#/definitions/dataSchema"},cancellation:{$ref:"#/definitions/dataSchema"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},base_link_element:{type:"object",properties:{href:{$ref:"#/definitions/anyUri"},type:{type:"string"},rel:{type:"string"},anchor:{$ref:"#/definitions/anyUri"},hreflang:{anyOf:[{$ref:"#/definitions/bcp47_string"},{type:"array",items:{$ref:"#/definitions/bcp47_string"}}]},instanceName:{type:"string"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},link_element:{allOf:[{$ref:"#/definitions/base_link_element"},{not:{description:"A basic link element should not contain sizes",type:"object",properties:{sizes:{}},required:["sizes"]}},{not:{description:"A basic link element should not contain icon",properties:{rel:{anyOf:[{enum:["icon"]},{$ref:"#/definitions/placeholder-pattern"}]}},required:["rel"]}}]},icon_link_element:{allOf:[{$ref:"#/definitions/base_link_element"},{properties:{rel:{const:"icon"},sizes:{type:"string",pattern:"[0-9]*x[0-9]+"}},required:["rel"]}]},additionalSecurityScheme:{description:"Applies to additional SecuritySchemes not defined in the WoT TD specification.",$comment:"Additional SecuritySchemes should always be defined via a context extension, using a prefixed value for the scheme. This prefix (e.g. 'ace', see the example below) must contain at least one character in order to reference a valid JSON-LD context extension.",examples:[{scheme:"ace:ACESecurityScheme","ace:as":"coaps://as.example.com/token","ace:audience":"coaps://rs.example.com","ace:scopes":["limited","special"],"ace:cnonce":true}],type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",pattern:".+:.*"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},noSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["nosec"]},{$ref:"#/definitions/placeholder-pattern"}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},autoSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["auto"]},{$ref:"#/definitions/placeholder-pattern"}]}},not:{required:["name"]},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},comboSecurityScheme:{oneOf:[{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["combo"]},{$ref:"#/definitions/placeholder-pattern"}]},oneOf:{type:"array",minItems:2,items:{type:"string"}},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true},{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["combo"]},{$ref:"#/definitions/placeholder-pattern"}]},allOf:{type:"array",minItems:2,items:{type:"string"}},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true}]},basicSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["basic"]},{$ref:"#/definitions/placeholder-pattern"}]},in:{type:"string",anyOf:[{enum:["header","query","body","cookie","auto"]},{$ref:"#/definitions/placeholder-pattern"}]},name:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},digestSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["digest"]},{$ref:"#/definitions/placeholder-pattern"}]},qop:{type:"string",anyOf:[{enum:["auth","auth-int"]},{$ref:"#/definitions/placeholder-pattern"}]},in:{type:"string",anyOf:[{enum:["header","query","body","cookie","auto"]},{$ref:"#/definitions/placeholder-pattern"}]},name:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},apiKeySecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["apikey"]},{$ref:"#/definitions/placeholder-pattern"}]},in:{type:"string",anyOf:[{enum:["header","query","body","cookie","uri","auto"]},{$ref:"#/definitions/placeholder-pattern"}]},name:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},bearerSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["bearer"]},{$ref:"#/definitions/placeholder-pattern"}]},authorization:{$ref:"#/definitions/anyUri"},alg:{type:"string"},format:{type:"string"},in:{type:"string",anyOf:[{enum:["header","query","body","cookie","auto"]},{$ref:"#/definitions/placeholder-pattern"}]},name:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},pskSecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["psk"]},{$ref:"#/definitions/placeholder-pattern"}]},identity:{type:"string"},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},oAuth2SecurityScheme:{type:"object",properties:{"@type":{$ref:"#/definitions/type_declaration"},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},proxy:{$ref:"#/definitions/anyUri"},scheme:{type:"string",anyOf:[{enum:["oauth2"]},{$ref:"#/definitions/placeholder-pattern"}]},authorization:{$ref:"#/definitions/anyUri"},token:{$ref:"#/definitions/anyUri"},refresh:{$ref:"#/definitions/anyUri"},scopes:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]},flow:{anyOf:[{type:"string"},{type:"string",anyOf:[{enum:["code","client","device"]},{$ref:"#/definitions/placeholder-pattern"}]}]},"tm:ref":{$ref:"#/definitions/tm_ref"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},securityScheme:{anyOf:[{$ref:"#/definitions/noSecurityScheme"},{$ref:"#/definitions/autoSecurityScheme"},{$ref:"#/definitions/comboSecurityScheme"},{$ref:"#/definitions/basicSecurityScheme"},{$ref:"#/definitions/digestSecurityScheme"},{$ref:"#/definitions/apiKeySecurityScheme"},{$ref:"#/definitions/bearerSecurityScheme"},{$ref:"#/definitions/pskSecurityScheme"},{$ref:"#/definitions/oAuth2SecurityScheme"},{$ref:"#/definitions/additionalSecurityScheme"}]},tm_type_declaration:{oneOf:[{type:"string",const:"tm:ThingModel"},{type:"array",items:{type:"string"},contains:{const:"tm:ThingModel"}}]},"placeholder-pattern":{type:"string",pattern:"^.*[{]{2}[ -~]+[}]{2}.*$"},tm_optional:{type:"array",items:{$comment:"this first checks for the general structure of /properties/myProp and then prohibits using / 3 times",allOf:[{type:"string",pattern:"^((/properties/)|(/actions/)|(/events/))(([^/]))",$comment:"regex tests available at https://regex101.com/r/UgOzrJ/1"},{not:{type:"string",pattern:"(/)(.*\\1){2}",$comment:"regex tests available at https://regex101.com/r/Ytzd72/1"}}]}},tm_ref:{type:"string",format:"uri-reference"}},type:"object",properties:{id:{type:"string"},title:{$ref:"#/definitions/title"},titles:{$ref:"#/definitions/titles"},properties:{type:"object",additionalProperties:{$ref:"#/definitions/property_element"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},actions:{type:"object",additionalProperties:{$ref:"#/definitions/action_element"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},events:{type:"object",additionalProperties:{$ref:"#/definitions/event_element"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},description:{$ref:"#/definitions/description"},descriptions:{$ref:"#/definitions/descriptions"},version:{anyOf:[{type:"object",properties:{model:{type:"string"}},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}},not:{type:"object",properties:{instance:{type:"string"}},required:["instance"]}},{$ref:"#/definitions/placeholder-pattern"}]},links:{type:"array",items:{oneOf:[{$ref:"#/definitions/link_element"},{$ref:"#/definitions/icon_link_element"}]}},forms:{type:"array",minItems:1,items:{$ref:"#/definitions/form_element_root"}},base:{$ref:"#/definitions/anyUri"},securityDefinitions:{type:"object",minProperties:1,additionalProperties:{$ref:"#/definitions/securityScheme"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},schemaDefinitions:{type:"object",minProperties:1,additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},support:{$ref:"#/definitions/anyUri"},created:{type:"string"},modified:{type:"string"},profile:{oneOf:[{$ref:"#/definitions/anyUri"},{type:"array",minItems:1,items:{$ref:"#/definitions/anyUri"}}]},security:{oneOf:[{type:"string"},{type:"array",minItems:1,items:{type:"string"}}]},uriVariables:{type:"object",additionalProperties:{$ref:"#/definitions/dataSchema"},propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}}},"@type":{$ref:"#/definitions/tm_type_declaration"},"@context":{$ref:"#/definitions/thing-context"},"tm:optional":{$ref:"#/definitions/tm_optional"}},additionalProperties:true,propertyNames:{not:{$ref:"#/definitions/placeholder-pattern"}},required:["@context","@type"]}},{}]},{},[1])(1)}));